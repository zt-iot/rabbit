{ desc = Typed.Type {id = ("readonly_t", 0); typclass = Input.CFsys}; env = 
{ Env.vars =
  [(("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Type {id = ("alice_t", 0); typclass = Input.CProc}; env = 
{ Env.vars =
  [(("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Type {id = ("bob_t", 0); typclass = Input.CProc}; env = 
{ Env.vars =
  [(("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Type {id = ("attacker_ty", 0); typclass = Input.CProc}; env = 
{ Env.vars =
  [(("bob_t", 0), Env.ProcTypeDef); (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Type {id = ("udp_t", 0); typclass = (Input.CChan [])}; env = 
{ Env.vars =
  [(("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.EqThyFunc {id = ("vk", 0);
           fun_desc =
           (Typed.DesugaredTypeSig
              [(Env.FParamSecurity "sign_key_alice");
                (Env.FParamSimple ("verkey",
                   [(Env.FParamTyParamSimple ("message", []))]))
                ])}; env = { Env.vars =
                             [(("udp_t", 0),
                               (Env.ChanTypeDef
                                  [(Env.TyParamProduct (
                                      (Env.TyParamSecurity "client_msg"),
                                      (Env.TyParamSecurity "client_sig")))
                                    ]));
                               (("conn_client", 0),
                                (Env.SecurityTypeDef ("connection", [])));
                               (("sign_key_alice", 0),
                                (Env.SecurityTypeDef ("sigkey",
                                   [(Env.TyParamSecurity "client_msg")])));
                               (("client_sig", 0),
                                (Env.SecurityTypeDef ("signature", [])));
                               (("client_msg", 0),
                                (Env.SecurityTypeDef ("message", [])));
                               (("attacker_ty", 0), Env.ProcTypeDef);
                               (("bob_t", 0), Env.ProcTypeDef);
                               (("alice_t", 0), Env.ProcTypeDef);
                               (("readonly_t", 0), Env.FilesysTypeDef);
                               (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                               (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                               (("signature", 0), (Env.SimpleTypeDef []));
                               (("message", 0), (Env.SimpleTypeDef []));
                               (("connection", 0), (Env.SimpleTypeDef []));
                               (("unit", 0), (Env.SimpleTypeDef []));
                               (("bool", 0), (Env.SimpleTypeDef []));
                               (("string", 0), (Env.SimpleTypeDef []))];
                             facts =
                             ref ([("BobClose", (Env.Global, (Some 0)));
                                    ("IntegrityFail", (Env.Global, (Some 1)));
                                    ("IntegritySuccess",
                                     (Env.Global, (Some 1)));
                                    ("AliceClose", (Env.Global, (Some 0)));
                                    ("MsgSend", (Env.Global, (Some 1)));
                                    ("Out", (Env.Global, (Some 1)));
                                    ("In", (Env.Global, (Some 1)));
                                    ("exit", (Env.Channel, (Some 0)));
                                    ("Returned", (Env.Channel, (Some 1)));
                                    ("invoke", (Env.Channel, (Some 3)));
                                    ("conn", (Env.Channel, (Some 0)));
                                    ("chid", (Env.Structure, (Some 1)));
                                    ("ack", (Env.Channel, (Some 0)));
                                    ("req", (Env.Channel, (Some 0)));
                                    ("store", (Env.Channel, (Some 1)))])
                             } }
{ desc = Typed.EqThyFunc {id = ("sign", 0);
           fun_desc =
           (Typed.DesugaredTypeSig
              [(Env.FParamSecurity "client_msg");
                (Env.FParamSecurity "sign_key_alice");
                (Env.FParamSecurity "client_sig")])}; env = { Env.vars =
                                                              [(("vk", 0),
                                                                (Env.ExtFun 1));
                                                                (("udp_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                (("conn_client",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                (("sign_key_alice",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                (("client_sig",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                (("client_msg",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                (("attacker_ty",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("bob_t", 0),
                                                                 Env.ProcTypeDef);
                                                                (("alice_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("readonly_t",
                                                                  0),
                                                                 Env.FilesysTypeDef);
                                                                (("verkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("sigkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("signature",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("message",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("connection",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("unit", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("bool", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("string", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []))
                                                                ];
                                                              facts =
                                                              ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } }
{ desc = Typed.EqThyFunc {id = ("fst", 0);
           fun_desc =
           (Typed.DesugaredTypeSig
              [(Env.FParamProduct ((Env.FParamPoly "'a"),
                  (Env.FParamPoly "'b")));
                (Env.FParamPoly "'a")])}; env = { Env.vars =
                                                  [(("sign", 0),
                                                    (Env.ExtFun 2));
                                                    (("vk", 0),
                                                     (Env.ExtFun 1));
                                                    (("udp_t", 0),
                                                     (Env.ChanTypeDef
                                                        [(Env.TyParamProduct (
                                                            (Env.TyParamSecurity
                                                               "client_msg"),
                                                            (Env.TyParamSecurity
                                                               "client_sig")
                                                            ))
                                                          ]));
                                                    (("conn_client", 0),
                                                     (Env.SecurityTypeDef (
                                                        "connection", 
                                                        [])));
                                                    (("sign_key_alice", 0),
                                                     (Env.SecurityTypeDef (
                                                        "sigkey",
                                                        [(Env.TyParamSecurity
                                                            "client_msg")
                                                          ]
                                                        )));
                                                    (("client_sig", 0),
                                                     (Env.SecurityTypeDef (
                                                        "signature", 
                                                        [])));
                                                    (("client_msg", 0),
                                                     (Env.SecurityTypeDef (
                                                        "message", [])));
                                                    (("attacker_ty", 0),
                                                     Env.ProcTypeDef);
                                                    (("bob_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("alice_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("readonly_t", 0),
                                                     Env.FilesysTypeDef);
                                                    (("verkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("sigkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("signature", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("message", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("connection", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("unit", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("bool", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("string", 0),
                                                     (Env.SimpleTypeDef []))
                                                    ];
                                                  facts =
                                                  ref ([("BobClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                         ("IntegrityFail",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("IntegritySuccess",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("AliceClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                         ("MsgSend",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("Out",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("In",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("Returned",
                                                          (Env.Channel,
                                                           (Some 1)));
                                                         ("invoke",
                                                          (Env.Channel,
                                                           (Some 3)));
                                                         ("conn",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("chid",
                                                          (Env.Structure,
                                                           (Some 1)));
                                                         ("ack",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("req",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("store",
                                                          (Env.Channel,
                                                           (Some 1)))
                                                         ])
                                                  } }
{ desc = Typed.EqThyFunc {id = ("snd", 0);
           fun_desc =
           (Typed.DesugaredTypeSig
              [(Env.FParamProduct ((Env.FParamPoly "'a"),
                  (Env.FParamPoly "'b")));
                (Env.FParamPoly "'b")])}; env = { Env.vars =
                                                  [(("fst", 0),
                                                    (Env.ExtFun 1));
                                                    (("sign", 0),
                                                     (Env.ExtFun 2));
                                                    (("vk", 0),
                                                     (Env.ExtFun 1));
                                                    (("udp_t", 0),
                                                     (Env.ChanTypeDef
                                                        [(Env.TyParamProduct (
                                                            (Env.TyParamSecurity
                                                               "client_msg"),
                                                            (Env.TyParamSecurity
                                                               "client_sig")
                                                            ))
                                                          ]));
                                                    (("conn_client", 0),
                                                     (Env.SecurityTypeDef (
                                                        "connection", 
                                                        [])));
                                                    (("sign_key_alice", 0),
                                                     (Env.SecurityTypeDef (
                                                        "sigkey",
                                                        [(Env.TyParamSecurity
                                                            "client_msg")
                                                          ]
                                                        )));
                                                    (("client_sig", 0),
                                                     (Env.SecurityTypeDef (
                                                        "signature", 
                                                        [])));
                                                    (("client_msg", 0),
                                                     (Env.SecurityTypeDef (
                                                        "message", [])));
                                                    (("attacker_ty", 0),
                                                     Env.ProcTypeDef);
                                                    (("bob_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("alice_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("readonly_t", 0),
                                                     Env.FilesysTypeDef);
                                                    (("verkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("sigkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("signature", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("message", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("connection", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("unit", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("bool", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("string", 0),
                                                     (Env.SimpleTypeDef []))
                                                    ];
                                                  facts =
                                                  ref ([("BobClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                         ("IntegrityFail",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("IntegritySuccess",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("AliceClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                         ("MsgSend",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("Out",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("In",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("Returned",
                                                          (Env.Channel,
                                                           (Some 1)));
                                                         ("invoke",
                                                          (Env.Channel,
                                                           (Some 3)));
                                                         ("conn",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("chid",
                                                          (Env.Structure,
                                                           (Some 1)));
                                                         ("ack",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("req",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("store",
                                                          (Env.Channel,
                                                           (Some 1)))
                                                         ])
                                                  } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("fst", 0),
                        [{ desc = (Typed.Tuple
                                     [{ desc = Typed.Ident {id = ("x", 1);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 1));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("y", 2),
                                           (Env.Var (Syntax.Meta 2)));
                                           (("x", 1),
                                            (Env.Var (Syntax.Meta 1)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("vk", 0), (Env.ExtFun 1));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyParamProduct (
                                                   (Env.TyParamSecurity
                                                      "client_msg"),
                                                   (Env.TyParamSecurity
                                                      "client_sig")
                                                   ))
                                                 ]));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("sign_key_alice", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TyParamSecurity
                                                   "client_msg")
                                                 ]
                                               )));
                                           (("client_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_msg", 0),
                                            (Env.SecurityTypeDef ("message",
                                               [])));
                                           (("attacker_ty", 0),
                                            Env.ProcTypeDef);
                                           (("bob_t", 0), Env.ProcTypeDef);
                                           (("alice_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("message", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("y", 2);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 2));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("y", 2),
                                           (Env.Var (Syntax.Meta 2)));
                                           (("x", 1),
                                            (Env.Var (Syntax.Meta 1)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("vk", 0), (Env.ExtFun 1));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyParamProduct (
                                                   (Env.TyParamSecurity
                                                      "client_msg"),
                                                   (Env.TyParamSecurity
                                                      "client_sig")
                                                   ))
                                                 ]));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("sign_key_alice", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TyParamSecurity
                                                   "client_msg")
                                                 ]
                                               )));
                                           (("client_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_msg", 0),
                                            (Env.SecurityTypeDef ("message",
                                               [])));
                                           (("attacker_ty", 0),
                                            Env.ProcTypeDef);
                                           (("bob_t", 0), Env.ProcTypeDef);
                                           (("alice_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("message", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]); env = { Env.vars =
                                                   [(("y", 2),
                                                     (Env.Var (Syntax.Meta 2)));
                                                     (("x", 1),
                                                      (Env.Var
                                                         (Syntax.Meta 1)));
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                          ]
                        )); env = { Env.vars =
                                    [(("y", 2), (Env.Var (Syntax.Meta 2)));
                                      (("x", 1), (Env.Var (Syntax.Meta 1)));
                                      (("snd", 0), (Env.ExtFun 1));
                                      (("fst", 0), (Env.ExtFun 1));
                                      (("sign", 0), (Env.ExtFun 2));
                                      (("vk", 0), (Env.ExtFun 1));
                                      (("udp_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyParamProduct (
                                              (Env.TyParamSecurity
                                                 "client_msg"),
                                              (Env.TyParamSecurity
                                                 "client_sig")
                                              ))
                                            ]));
                                      (("conn_client", 0),
                                       (Env.SecurityTypeDef ("connection", 
                                          [])));
                                      (("sign_key_alice", 0),
                                       (Env.SecurityTypeDef ("sigkey",
                                          [(Env.TyParamSecurity "client_msg")
                                            ]
                                          )));
                                      (("client_sig", 0),
                                       (Env.SecurityTypeDef ("signature", 
                                          [])));
                                      (("client_msg", 0),
                                       (Env.SecurityTypeDef ("message", [])));
                                      (("attacker_ty", 0), Env.ProcTypeDef);
                                      (("bob_t", 0), Env.ProcTypeDef);
                                      (("alice_t", 0), Env.ProcTypeDef);
                                      (("readonly_t", 0), Env.FilesysTypeDef);
                                      (("verkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("sigkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("signature", 0),
                                       (Env.SimpleTypeDef []));
                                      (("message", 0), (Env.SimpleTypeDef []));
                                      (("connection", 0),
                                       (Env.SimpleTypeDef []));
                                      (("unit", 0), (Env.SimpleTypeDef []));
                                      (("bool", 0), (Env.SimpleTypeDef []));
                                      (("string", 0), (Env.SimpleTypeDef []))
                                      ];
                                    facts =
                                    ref ([("BobClose", (Env.Global, (Some 0)));
                                           ("IntegrityFail",
                                            (Env.Global, (Some 1)));
                                           ("IntegritySuccess",
                                            (Env.Global, (Some 1)));
                                           ("AliceClose",
                                            (Env.Global, (Some 0)));
                                           ("MsgSend", (Env.Global, (Some 1)));
                                           ("Out", (Env.Global, (Some 1)));
                                           ("In", (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("x", 1);
                       desc = (Env.Var (Syntax.Meta 1)); param = None}; env = 
            { Env.vars =
              [(("y", 2), (Env.Var (Syntax.Meta 2)));
                (("x", 1), (Env.Var (Syntax.Meta 1)));
                (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
                (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
                (("udp_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
                        (Env.TyParamSecurity "client_sig")))
                      ]));
                (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
                (("sign_key_alice", 0),
                 (Env.SecurityTypeDef ("sigkey",
                    [(Env.TyParamSecurity "client_msg")])));
                (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
                (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
                (("attacker_ty", 0), Env.ProcTypeDef);
                (("bob_t", 0), Env.ProcTypeDef);
                (("alice_t", 0), Env.ProcTypeDef);
                (("readonly_t", 0), Env.FilesysTypeDef);
                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("signature", 0), (Env.SimpleTypeDef []));
                (("message", 0), (Env.SimpleTypeDef []));
                (("connection", 0), (Env.SimpleTypeDef []));
                (("unit", 0), (Env.SimpleTypeDef []));
                (("bool", 0), (Env.SimpleTypeDef []));
                (("string", 0), (Env.SimpleTypeDef []))];
              facts =
              ref ([("BobClose", (Env.Global, (Some 0)));
                     ("IntegrityFail", (Env.Global, (Some 1)));
                     ("IntegritySuccess", (Env.Global, (Some 1)));
                     ("AliceClose", (Env.Global, (Some 0)));
                     ("MsgSend", (Env.Global, (Some 1)));
                     ("Out", (Env.Global, (Some 1)));
                     ("In", (Env.Global, (Some 1)));
                     ("exit", (Env.Channel, (Some 0)));
                     ("Returned", (Env.Channel, (Some 1)));
                     ("invoke", (Env.Channel, (Some 3)));
                     ("conn", (Env.Channel, (Some 0)));
                     ("chid", (Env.Structure, (Some 1)));
                     ("ack", (Env.Channel, (Some 0)));
                     ("req", (Env.Channel, (Some 0)));
                     ("store", (Env.Channel, (Some 1)))])
              } }
            )); env = { Env.vars =
                        [(("y", 2), (Env.Var (Syntax.Meta 2)));
                          (("x", 1), (Env.Var (Syntax.Meta 1)));
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("vk", 0), (Env.ExtFun 1));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyParamProduct (
                                  (Env.TyParamSecurity "client_msg"),
                                  (Env.TyParamSecurity "client_sig")))
                                ]));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("sign_key_alice", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TyParamSecurity "client_msg")])));
                          (("client_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_msg", 0),
                           (Env.SecurityTypeDef ("message", [])));
                          (("attacker_ty", 0), Env.ProcTypeDef);
                          (("bob_t", 0), Env.ProcTypeDef);
                          (("alice_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("message", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("snd", 0),
                        [{ desc = (Typed.Tuple
                                     [{ desc = Typed.Ident {id = ("x", 3);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 3));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("y", 4),
                                           (Env.Var (Syntax.Meta 4)));
                                           (("x", 3),
                                            (Env.Var (Syntax.Meta 3)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("vk", 0), (Env.ExtFun 1));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyParamProduct (
                                                   (Env.TyParamSecurity
                                                      "client_msg"),
                                                   (Env.TyParamSecurity
                                                      "client_sig")
                                                   ))
                                                 ]));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("sign_key_alice", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TyParamSecurity
                                                   "client_msg")
                                                 ]
                                               )));
                                           (("client_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_msg", 0),
                                            (Env.SecurityTypeDef ("message",
                                               [])));
                                           (("attacker_ty", 0),
                                            Env.ProcTypeDef);
                                           (("bob_t", 0), Env.ProcTypeDef);
                                           (("alice_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("message", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("y", 4);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 4));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("y", 4),
                                           (Env.Var (Syntax.Meta 4)));
                                           (("x", 3),
                                            (Env.Var (Syntax.Meta 3)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("vk", 0), (Env.ExtFun 1));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyParamProduct (
                                                   (Env.TyParamSecurity
                                                      "client_msg"),
                                                   (Env.TyParamSecurity
                                                      "client_sig")
                                                   ))
                                                 ]));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("sign_key_alice", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TyParamSecurity
                                                   "client_msg")
                                                 ]
                                               )));
                                           (("client_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_msg", 0),
                                            (Env.SecurityTypeDef ("message",
                                               [])));
                                           (("attacker_ty", 0),
                                            Env.ProcTypeDef);
                                           (("bob_t", 0), Env.ProcTypeDef);
                                           (("alice_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("message", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]); env = { Env.vars =
                                                   [(("y", 4),
                                                     (Env.Var (Syntax.Meta 4)));
                                                     (("x", 3),
                                                      (Env.Var
                                                         (Syntax.Meta 3)));
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                          ]
                        )); env = { Env.vars =
                                    [(("y", 4), (Env.Var (Syntax.Meta 4)));
                                      (("x", 3), (Env.Var (Syntax.Meta 3)));
                                      (("snd", 0), (Env.ExtFun 1));
                                      (("fst", 0), (Env.ExtFun 1));
                                      (("sign", 0), (Env.ExtFun 2));
                                      (("vk", 0), (Env.ExtFun 1));
                                      (("udp_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyParamProduct (
                                              (Env.TyParamSecurity
                                                 "client_msg"),
                                              (Env.TyParamSecurity
                                                 "client_sig")
                                              ))
                                            ]));
                                      (("conn_client", 0),
                                       (Env.SecurityTypeDef ("connection", 
                                          [])));
                                      (("sign_key_alice", 0),
                                       (Env.SecurityTypeDef ("sigkey",
                                          [(Env.TyParamSecurity "client_msg")
                                            ]
                                          )));
                                      (("client_sig", 0),
                                       (Env.SecurityTypeDef ("signature", 
                                          [])));
                                      (("client_msg", 0),
                                       (Env.SecurityTypeDef ("message", [])));
                                      (("attacker_ty", 0), Env.ProcTypeDef);
                                      (("bob_t", 0), Env.ProcTypeDef);
                                      (("alice_t", 0), Env.ProcTypeDef);
                                      (("readonly_t", 0), Env.FilesysTypeDef);
                                      (("verkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("sigkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("signature", 0),
                                       (Env.SimpleTypeDef []));
                                      (("message", 0), (Env.SimpleTypeDef []));
                                      (("connection", 0),
                                       (Env.SimpleTypeDef []));
                                      (("unit", 0), (Env.SimpleTypeDef []));
                                      (("bool", 0), (Env.SimpleTypeDef []));
                                      (("string", 0), (Env.SimpleTypeDef []))
                                      ];
                                    facts =
                                    ref ([("BobClose", (Env.Global, (Some 0)));
                                           ("IntegrityFail",
                                            (Env.Global, (Some 1)));
                                           ("IntegritySuccess",
                                            (Env.Global, (Some 1)));
                                           ("AliceClose",
                                            (Env.Global, (Some 0)));
                                           ("MsgSend", (Env.Global, (Some 1)));
                                           ("Out", (Env.Global, (Some 1)));
                                           ("In", (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("y", 4);
                       desc = (Env.Var (Syntax.Meta 4)); param = None}; env = 
            { Env.vars =
              [(("y", 4), (Env.Var (Syntax.Meta 4)));
                (("x", 3), (Env.Var (Syntax.Meta 3)));
                (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
                (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
                (("udp_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
                        (Env.TyParamSecurity "client_sig")))
                      ]));
                (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
                (("sign_key_alice", 0),
                 (Env.SecurityTypeDef ("sigkey",
                    [(Env.TyParamSecurity "client_msg")])));
                (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
                (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
                (("attacker_ty", 0), Env.ProcTypeDef);
                (("bob_t", 0), Env.ProcTypeDef);
                (("alice_t", 0), Env.ProcTypeDef);
                (("readonly_t", 0), Env.FilesysTypeDef);
                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("signature", 0), (Env.SimpleTypeDef []));
                (("message", 0), (Env.SimpleTypeDef []));
                (("connection", 0), (Env.SimpleTypeDef []));
                (("unit", 0), (Env.SimpleTypeDef []));
                (("bool", 0), (Env.SimpleTypeDef []));
                (("string", 0), (Env.SimpleTypeDef []))];
              facts =
              ref ([("BobClose", (Env.Global, (Some 0)));
                     ("IntegrityFail", (Env.Global, (Some 1)));
                     ("IntegritySuccess", (Env.Global, (Some 1)));
                     ("AliceClose", (Env.Global, (Some 0)));
                     ("MsgSend", (Env.Global, (Some 1)));
                     ("Out", (Env.Global, (Some 1)));
                     ("In", (Env.Global, (Some 1)));
                     ("exit", (Env.Channel, (Some 0)));
                     ("Returned", (Env.Channel, (Some 1)));
                     ("invoke", (Env.Channel, (Some 3)));
                     ("conn", (Env.Channel, (Some 0)));
                     ("chid", (Env.Structure, (Some 1)));
                     ("ack", (Env.Channel, (Some 0)));
                     ("req", (Env.Channel, (Some 0)));
                     ("store", (Env.Channel, (Some 1)))])
              } }
            )); env = { Env.vars =
                        [(("y", 4), (Env.Var (Syntax.Meta 4)));
                          (("x", 3), (Env.Var (Syntax.Meta 3)));
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("vk", 0), (Env.ExtFun 1));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyParamProduct (
                                  (Env.TyParamSecurity "client_msg"),
                                  (Env.TyParamSecurity "client_sig")))
                                ]));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("sign_key_alice", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TyParamSecurity "client_msg")])));
                          (("client_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_msg", 0),
                           (Env.SecurityTypeDef ("message", [])));
                          (("attacker_ty", 0), Env.ProcTypeDef);
                          (("bob_t", 0), Env.ProcTypeDef);
                          (("alice_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("message", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = Typed.EqThyFunc {id = ("true", 0);
           fun_desc =
           (Typed.DesugaredTypeSig [(Env.FParamSimple ("bool", []))])}; env = 
{ Env.vars =
  [(("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.EqThyFunc {id = ("verify", 0);
           fun_desc =
           (Typed.DesugaredTypeSig
              [(Env.FParamSimple ("signature", []));
                (Env.FParamSimple ("message", []));
                (Env.FParamSimple ("verkey",
                   [(Env.FParamTyParamSimple ("message", []))]));
                (Env.FParamSimple ("bool", []))])}; env = { Env.vars =
                                                            [(("true", 0),
                                                              Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("vk", 0),
                                                               (Env.ExtFun 1));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                              (("conn_client",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "connection",
                                                                  [])));
                                                              (("sign_key_alice",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "sigkey",
                                                                  [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                  )));
                                                              (("client_sig",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "signature",
                                                                  [])));
                                                              (("client_msg",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "message",
                                                                  [])));
                                                              (("attacker_ty",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("bob_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("alice_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("verkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("sigkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("signature",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("message", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("connection",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("unit", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("bool", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("string", 0),
                                                               (Env.SimpleTypeDef
                                                                  []))
                                                              ];
                                                            facts =
                                                            ref ([("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("verify", 0),
                        [{ desc = (Typed.Apply (("sign", 0),
                                     [{ desc = Typed.Ident {id = ("d", 5);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 5));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("k", 6),
                                           (Env.Var (Syntax.Meta 6)));
                                           (("d", 5),
                                            (Env.Var (Syntax.Meta 5)));
                                           (("verify", 0), (Env.ExtFun 3));
                                           (("true", 0), Env.ExtConst);
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("vk", 0), (Env.ExtFun 1));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyParamProduct (
                                                   (Env.TyParamSecurity
                                                      "client_msg"),
                                                   (Env.TyParamSecurity
                                                      "client_sig")
                                                   ))
                                                 ]));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("sign_key_alice", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TyParamSecurity
                                                   "client_msg")
                                                 ]
                                               )));
                                           (("client_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_msg", 0),
                                            (Env.SecurityTypeDef ("message",
                                               [])));
                                           (("attacker_ty", 0),
                                            Env.ProcTypeDef);
                                           (("bob_t", 0), Env.ProcTypeDef);
                                           (("alice_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("message", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("k", 6);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 6));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("k", 6),
                                           (Env.Var (Syntax.Meta 6)));
                                           (("d", 5),
                                            (Env.Var (Syntax.Meta 5)));
                                           (("verify", 0), (Env.ExtFun 3));
                                           (("true", 0), Env.ExtConst);
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("vk", 0), (Env.ExtFun 1));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyParamProduct (
                                                   (Env.TyParamSecurity
                                                      "client_msg"),
                                                   (Env.TyParamSecurity
                                                      "client_sig")
                                                   ))
                                                 ]));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("sign_key_alice", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TyParamSecurity
                                                   "client_msg")
                                                 ]
                                               )));
                                           (("client_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_msg", 0),
                                            (Env.SecurityTypeDef ("message",
                                               [])));
                                           (("attacker_ty", 0),
                                            Env.ProcTypeDef);
                                           (("bob_t", 0), Env.ProcTypeDef);
                                           (("alice_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("message", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]
                                     )); env = { Env.vars =
                                                 [(("k", 6),
                                                   (Env.Var (Syntax.Meta 6)));
                                                   (("d", 5),
                                                    (Env.Var (Syntax.Meta 5)));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                          { desc = Typed.Ident {id = ("d", 5);
                                     desc = (Env.Var (Syntax.Meta 5));
                                     param = None}; env = { Env.vars =
                                                            [(("k", 6),
                                                              (Env.Var
                                                                 (Syntax.Meta
                                                                    6)));
                                                              (("d", 5),
                                                               (Env.Var
                                                                  (Syntax.Meta
                                                                    5)));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("vk", 0),
                                                               (Env.ExtFun 1));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                              (("conn_client",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "connection",
                                                                  [])));
                                                              (("sign_key_alice",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "sigkey",
                                                                  [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                  )));
                                                              (("client_sig",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "signature",
                                                                  [])));
                                                              (("client_msg",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "message",
                                                                  [])));
                                                              (("attacker_ty",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("bob_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("alice_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("verkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("sigkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("signature",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("message", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("connection",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("unit", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("bool", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("string", 0),
                                                               (Env.SimpleTypeDef
                                                                  []))
                                                              ];
                                                            facts =
                                                            ref ([("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } };
                          { desc = (Typed.Apply (("vk", 0),
                                      [{ desc = Typed.Ident {id = ("k", 6);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 6));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("k", 6),
                                            (Env.Var (Syntax.Meta 6)));
                                            (("d", 5),
                                             (Env.Var (Syntax.Meta 5)));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("vk", 0), (Env.ExtFun 1));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyParamProduct (
                                                    (Env.TyParamSecurity
                                                       "client_msg"),
                                                    (Env.TyParamSecurity
                                                       "client_sig")
                                                    ))
                                                  ]));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("sign_key_alice", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TyParamSecurity
                                                    "client_msg")
                                                  ]
                                                )));
                                            (("client_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_msg", 0),
                                             (Env.SecurityTypeDef ("message",
                                                [])));
                                            (("attacker_ty", 0),
                                             Env.ProcTypeDef);
                                            (("bob_t", 0), Env.ProcTypeDef);
                                            (("alice_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("message", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]
                                      )); env = { Env.vars =
                                                  [(("k", 6),
                                                    (Env.Var (Syntax.Meta 6)));
                                                    (("d", 5),
                                                     (Env.Var (Syntax.Meta 5)));
                                                    (("verify", 0),
                                                     (Env.ExtFun 3));
                                                    (("true", 0),
                                                     Env.ExtConst);
                                                    (("snd", 0),
                                                     (Env.ExtFun 1));
                                                    (("fst", 0),
                                                     (Env.ExtFun 1));
                                                    (("sign", 0),
                                                     (Env.ExtFun 2));
                                                    (("vk", 0),
                                                     (Env.ExtFun 1));
                                                    (("udp_t", 0),
                                                     (Env.ChanTypeDef
                                                        [(Env.TyParamProduct (
                                                            (Env.TyParamSecurity
                                                               "client_msg"),
                                                            (Env.TyParamSecurity
                                                               "client_sig")
                                                            ))
                                                          ]));
                                                    (("conn_client", 0),
                                                     (Env.SecurityTypeDef (
                                                        "connection", 
                                                        [])));
                                                    (("sign_key_alice", 0),
                                                     (Env.SecurityTypeDef (
                                                        "sigkey",
                                                        [(Env.TyParamSecurity
                                                            "client_msg")
                                                          ]
                                                        )));
                                                    (("client_sig", 0),
                                                     (Env.SecurityTypeDef (
                                                        "signature", 
                                                        [])));
                                                    (("client_msg", 0),
                                                     (Env.SecurityTypeDef (
                                                        "message", [])));
                                                    (("attacker_ty", 0),
                                                     Env.ProcTypeDef);
                                                    (("bob_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("alice_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("readonly_t", 0),
                                                     Env.FilesysTypeDef);
                                                    (("verkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("sigkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("signature", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("message", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("connection", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("unit", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("bool", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("string", 0),
                                                     (Env.SimpleTypeDef []))
                                                    ];
                                                  facts =
                                                  ref ([("BobClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                         ("IntegrityFail",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("IntegritySuccess",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("AliceClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                         ("MsgSend",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("Out",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("In",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("Returned",
                                                          (Env.Channel,
                                                           (Some 1)));
                                                         ("invoke",
                                                          (Env.Channel,
                                                           (Some 3)));
                                                         ("conn",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("chid",
                                                          (Env.Structure,
                                                           (Some 1)));
                                                         ("ack",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("req",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("store",
                                                          (Env.Channel,
                                                           (Some 1)))
                                                         ])
                                                  } }
                          ]
                        )); env = { Env.vars =
                                    [(("k", 6), (Env.Var (Syntax.Meta 6)));
                                      (("d", 5), (Env.Var (Syntax.Meta 5)));
                                      (("verify", 0), (Env.ExtFun 3));
                                      (("true", 0), Env.ExtConst);
                                      (("snd", 0), (Env.ExtFun 1));
                                      (("fst", 0), (Env.ExtFun 1));
                                      (("sign", 0), (Env.ExtFun 2));
                                      (("vk", 0), (Env.ExtFun 1));
                                      (("udp_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyParamProduct (
                                              (Env.TyParamSecurity
                                                 "client_msg"),
                                              (Env.TyParamSecurity
                                                 "client_sig")
                                              ))
                                            ]));
                                      (("conn_client", 0),
                                       (Env.SecurityTypeDef ("connection", 
                                          [])));
                                      (("sign_key_alice", 0),
                                       (Env.SecurityTypeDef ("sigkey",
                                          [(Env.TyParamSecurity "client_msg")
                                            ]
                                          )));
                                      (("client_sig", 0),
                                       (Env.SecurityTypeDef ("signature", 
                                          [])));
                                      (("client_msg", 0),
                                       (Env.SecurityTypeDef ("message", [])));
                                      (("attacker_ty", 0), Env.ProcTypeDef);
                                      (("bob_t", 0), Env.ProcTypeDef);
                                      (("alice_t", 0), Env.ProcTypeDef);
                                      (("readonly_t", 0), Env.FilesysTypeDef);
                                      (("verkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("sigkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("signature", 0),
                                       (Env.SimpleTypeDef []));
                                      (("message", 0), (Env.SimpleTypeDef []));
                                      (("connection", 0),
                                       (Env.SimpleTypeDef []));
                                      (("unit", 0), (Env.SimpleTypeDef []));
                                      (("bool", 0), (Env.SimpleTypeDef []));
                                      (("string", 0), (Env.SimpleTypeDef []))
                                      ];
                                    facts =
                                    ref ([("BobClose", (Env.Global, (Some 0)));
                                           ("IntegrityFail",
                                            (Env.Global, (Some 1)));
                                           ("IntegritySuccess",
                                            (Env.Global, (Some 1)));
                                           ("AliceClose",
                                            (Env.Global, (Some 0)));
                                           ("MsgSend", (Env.Global, (Some 1)));
                                           ("Out", (Env.Global, (Some 1)));
                                           ("In", (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("true", 0); desc = Env.ExtConst;
                       param = None}; env = { Env.vars =
                                              [(("k", 6),
                                                (Env.Var (Syntax.Meta 6)));
                                                (("d", 5),
                                                 (Env.Var (Syntax.Meta 5)));
                                                (("verify", 0),
                                                 (Env.ExtFun 3));
                                                (("true", 0), Env.ExtConst);
                                                (("snd", 0), (Env.ExtFun 1));
                                                (("fst", 0), (Env.ExtFun 1));
                                                (("sign", 0), (Env.ExtFun 2));
                                                (("vk", 0), (Env.ExtFun 1));
                                                (("udp_t", 0),
                                                 (Env.ChanTypeDef
                                                    [(Env.TyParamProduct (
                                                        (Env.TyParamSecurity
                                                           "client_msg"),
                                                        (Env.TyParamSecurity
                                                           "client_sig")
                                                        ))
                                                      ]));
                                                (("conn_client", 0),
                                                 (Env.SecurityTypeDef (
                                                    "connection", [])));
                                                (("sign_key_alice", 0),
                                                 (Env.SecurityTypeDef (
                                                    "sigkey",
                                                    [(Env.TyParamSecurity
                                                        "client_msg")
                                                      ]
                                                    )));
                                                (("client_sig", 0),
                                                 (Env.SecurityTypeDef (
                                                    "signature", [])));
                                                (("client_msg", 0),
                                                 (Env.SecurityTypeDef (
                                                    "message", [])));
                                                (("attacker_ty", 0),
                                                 Env.ProcTypeDef);
                                                (("bob_t", 0),
                                                 Env.ProcTypeDef);
                                                (("alice_t", 0),
                                                 Env.ProcTypeDef);
                                                (("readonly_t", 0),
                                                 Env.FilesysTypeDef);
                                                (("verkey", 0),
                                                 (Env.SimpleTypeDef ["'a"]));
                                                (("sigkey", 0),
                                                 (Env.SimpleTypeDef ["'a"]));
                                                (("signature", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("message", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("connection", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("unit", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("bool", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("string", 0),
                                                 (Env.SimpleTypeDef []))
                                                ];
                                              facts =
                                              ref ([("BobClose",
                                                     (Env.Global, (Some 0)));
                                                     ("IntegrityFail",
                                                      (Env.Global, (Some 1)));
                                                     ("IntegritySuccess",
                                                      (Env.Global, (Some 1)));
                                                     ("AliceClose",
                                                      (Env.Global, (Some 0)));
                                                     ("MsgSend",
                                                      (Env.Global, (Some 1)));
                                                     ("Out",
                                                      (Env.Global, (Some 1)));
                                                     ("In",
                                                      (Env.Global, (Some 1)));
                                                     ("exit",
                                                      (Env.Channel, (Some 0)));
                                                     ("Returned",
                                                      (Env.Channel, (Some 1)));
                                                     ("invoke",
                                                      (Env.Channel, (Some 3)));
                                                     ("conn",
                                                      (Env.Channel, (Some 0)));
                                                     ("chid",
                                                      (Env.Structure,
                                                       (Some 1)));
                                                     ("ack",
                                                      (Env.Channel, (Some 0)));
                                                     ("req",
                                                      (Env.Channel, (Some 0)));
                                                     ("store",
                                                      (Env.Channel, (Some 1)))
                                                     ])
                                              } }
            )); env = { Env.vars =
                        [(("k", 6), (Env.Var (Syntax.Meta 6)));
                          (("d", 5), (Env.Var (Syntax.Meta 5)));
                          (("verify", 0), (Env.ExtFun 3));
                          (("true", 0), Env.ExtConst);
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("vk", 0), (Env.ExtFun 1));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyParamProduct (
                                  (Env.TyParamSecurity "client_msg"),
                                  (Env.TyParamSecurity "client_sig")))
                                ]));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("sign_key_alice", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TyParamSecurity "client_msg")])));
                          (("client_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_msg", 0),
                           (Env.SecurityTypeDef ("message", [])));
                          (("attacker_ty", 0), Env.ProcTypeDef);
                          (("bob_t", 0), Env.ProcTypeDef);
                          (("alice_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("message", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = Typed.Syscall {id = ("send", 0);
           fun_sig =
           (Typed.DesSMFunTyped ([("c", 7); ("v", 8)],
              [(Env.FParamChannel [(Env.FParamTyParamPoly "'a")]);
                (Env.FParamPoly "'a")],
              (Env.FParamSimple ("unit", []))));
           cmd =
           { desc = (Typed.Put
                       [{ desc = Typed.Channel {
                                   channel =
                                   { desc = Typed.Ident {id = ("c", 7);
                                              desc = (Env.Var (Syntax.Loc 7));
                                              param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 8),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    8)));
                                                                    ((
                                                                    "c", 7),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    7)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                   name = "store";
                                   args =
                                   [{ desc = Typed.Ident {id = ("v", 8);
                                               desc =
                                               (Env.Var (Syntax.Loc 8));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 8),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    8)));
                                                                    ((
                                                                    "c", 7),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    7)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]}; env = { Env.vars =
                                                 [(("v", 8),
                                                   (Env.Var (Syntax.Loc 8)));
                                                   (("c", 7),
                                                    (Env.Var (Syntax.Loc 7)));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                         ]); env = { Env.vars =
                                     [(("v", 8), (Env.Var (Syntax.Loc 8)));
                                       (("c", 7), (Env.Var (Syntax.Loc 7)));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("vk", 0), (Env.ExtFun 1));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyParamProduct (
                                               (Env.TyParamSecurity
                                                  "client_msg"),
                                               (Env.TyParamSecurity
                                                  "client_sig")
                                               ))
                                             ]));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("sign_key_alice", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TyParamSecurity "client_msg")
                                             ]
                                           )));
                                       (("client_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_msg", 0),
                                        (Env.SecurityTypeDef ("message", [])));
                                       (("attacker_ty", 0), Env.ProcTypeDef);
                                       (("bob_t", 0), Env.ProcTypeDef);
                                       (("alice_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("message", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []))
                                       ];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("verify", 0),
                                                     (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("recv", 0);
           fun_sig =
           (Typed.DesSMFunTyped ([("c", 9)],
              [(Env.FParamChannel [(Env.FParamTyParamPoly "'a")])],
              (Env.FParamPoly "'a")));
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [("v", 10)];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 9);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 9));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 10),
                                          (Env.Var (Syntax.Meta 10)));
                                          (("c", 9), (Env.Var (Syntax.Loc 9)));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "store";
                                      args =
                                      [{ desc = Typed.Ident {id = ("v", 10);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 10));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("v", 10),
                                            (Env.Var (Syntax.Meta 10)));
                                            (("c", 9),
                                             (Env.Var (Syntax.Loc 9)));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("vk", 0), (Env.ExtFun 1));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyParamProduct (
                                                    (Env.TyParamSecurity
                                                       "client_msg"),
                                                    (Env.TyParamSecurity
                                                       "client_sig")
                                                    ))
                                                  ]));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("sign_key_alice", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TyParamSecurity
                                                    "client_msg")
                                                  ]
                                                )));
                                            (("client_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_msg", 0),
                                             (Env.SecurityTypeDef ("message",
                                                [])));
                                            (("attacker_ty", 0),
                                             Env.ProcTypeDef);
                                            (("bob_t", 0), Env.ProcTypeDef);
                                            (("alice_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("message", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]}; env = { Env.vars =
                                                    [(("v", 10),
                                                      (Env.Var
                                                         (Syntax.Meta 10)));
                                                      (("c", 9),
                                                       (Env.Var
                                                          (Syntax.Loc 9)));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                            ];
                          cmd =
                          { desc = (Typed.Return
                                      { desc = Typed.Ident {id = ("v", 10);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 10));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 10),
                                          (Env.Var (Syntax.Meta 10)));
                                          (("c", 9), (Env.Var (Syntax.Loc 9)));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }); env = { Env.vars =
                                                      [(("v", 10),
                                                        (Env.Var
                                                           (Syntax.Meta 10)));
                                                        (("c", 9),
                                                         (Env.Var
                                                            (Syntax.Loc 9)));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("vk", 0),
                                                         (Env.ExtFun 1));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyParamProduct (
                                                                (Env.TyParamSecurity
                                                                   "client_msg"),
                                                                (Env.TyParamSecurity
                                                                   "client_sig")
                                                                ))
                                                              ]));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("sign_key_alice", 0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TyParamSecurity
                                                                "client_msg")
                                                              ]
                                                            )));
                                                        (("client_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_msg", 0),
                                                         (Env.SecurityTypeDef (
                                                            "message", 
                                                            [])));
                                                        (("attacker_ty", 0),
                                                         Env.ProcTypeDef);
                                                        (("bob_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("alice_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("message", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 9), (Env.Var (Syntax.Loc 9)));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("vk", 0), (Env.ExtFun 1));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyParamProduct (
                                               (Env.TyParamSecurity
                                                  "client_msg"),
                                               (Env.TyParamSecurity
                                                  "client_sig")
                                               ))
                                             ]));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("sign_key_alice", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TyParamSecurity "client_msg")
                                             ]
                                           )));
                                       (("client_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_msg", 0),
                                        (Env.SecurityTypeDef ("message", [])));
                                       (("attacker_ty", 0), Env.ProcTypeDef);
                                       (("bob_t", 0), Env.ProcTypeDef);
                                       (("alice_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("message", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []))
                                       ];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("send", 0),
                                                     (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("connect_rpc", 0);
           fun_sig =
           (Typed.DesSMFunTyped ([("c", 11)],
              [(Env.FParamChannel [(Env.FParamTyParamPoly "'a")])],
              (Env.FParamSecurity "conn_client")));
           cmd =
           { desc = (Typed.Sequence (
                       { desc = (Typed.Put
                                   [{ desc = Typed.Channel {
                                               channel =
                                               { desc = Typed.Ident {
                                                          id = ("c", 11);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 11));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                                               name = "req"; args = []}; env = 
                                     { Env.vars =
                                       [(("c", 11), (Env.Var (Syntax.Loc 11)));
                                         (("recv", 0), (Env.ExtSyscall 1));
                                         (("send", 0), (Env.ExtSyscall 2));
                                         (("verify", 0), (Env.ExtFun 3));
                                         (("true", 0), Env.ExtConst);
                                         (("snd", 0), (Env.ExtFun 1));
                                         (("fst", 0), (Env.ExtFun 1));
                                         (("sign", 0), (Env.ExtFun 2));
                                         (("vk", 0), (Env.ExtFun 1));
                                         (("udp_t", 0),
                                          (Env.ChanTypeDef
                                             [(Env.TyParamProduct (
                                                 (Env.TyParamSecurity
                                                    "client_msg"),
                                                 (Env.TyParamSecurity
                                                    "client_sig")
                                                 ))
                                               ]));
                                         (("conn_client", 0),
                                          (Env.SecurityTypeDef ("connection",
                                             [])));
                                         (("sign_key_alice", 0),
                                          (Env.SecurityTypeDef ("sigkey",
                                             [(Env.TyParamSecurity
                                                 "client_msg")
                                               ]
                                             )));
                                         (("client_sig", 0),
                                          (Env.SecurityTypeDef ("signature",
                                             [])));
                                         (("client_msg", 0),
                                          (Env.SecurityTypeDef ("message", 
                                             [])));
                                         (("attacker_ty", 0), Env.ProcTypeDef);
                                         (("bob_t", 0), Env.ProcTypeDef);
                                         (("alice_t", 0), Env.ProcTypeDef);
                                         (("readonly_t", 0),
                                          Env.FilesysTypeDef);
                                         (("verkey", 0),
                                          (Env.SimpleTypeDef ["'a"]));
                                         (("sigkey", 0),
                                          (Env.SimpleTypeDef ["'a"]));
                                         (("signature", 0),
                                          (Env.SimpleTypeDef []));
                                         (("message", 0),
                                          (Env.SimpleTypeDef []));
                                         (("connection", 0),
                                          (Env.SimpleTypeDef []));
                                         (("unit", 0), (Env.SimpleTypeDef []));
                                         (("bool", 0), (Env.SimpleTypeDef []));
                                         (("string", 0),
                                          (Env.SimpleTypeDef []))
                                         ];
                                       facts =
                                       ref ([("BobClose",
                                              (Env.Global, (Some 0)));
                                              ("IntegrityFail",
                                               (Env.Global, (Some 1)));
                                              ("IntegritySuccess",
                                               (Env.Global, (Some 1)));
                                              ("AliceClose",
                                               (Env.Global, (Some 0)));
                                              ("MsgSend",
                                               (Env.Global, (Some 1)));
                                              ("Out", (Env.Global, (Some 1)));
                                              ("In", (Env.Global, (Some 1)));
                                              ("exit",
                                               (Env.Channel, (Some 0)));
                                              ("Returned",
                                               (Env.Channel, (Some 1)));
                                              ("invoke",
                                               (Env.Channel, (Some 3)));
                                              ("conn",
                                               (Env.Channel, (Some 0)));
                                              ("chid",
                                               (Env.Structure, (Some 1)));
                                              ("ack", (Env.Channel, (Some 0)));
                                              ("req", (Env.Channel, (Some 0)));
                                              ("store",
                                               (Env.Channel, (Some 1)))
                                              ])
                                       } }
                                     ]); env = { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                       { desc = (Typed.Case
                                   [{ Typed.fresh = [];
                                      facts =
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 11);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   11));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 11),
                                                      (Env.Var
                                                         (Syntax.Loc 11)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 11),
                                            (Env.Var (Syntax.Loc 11)));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("vk", 0), (Env.ExtFun 1));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyParamProduct (
                                                    (Env.TyParamSecurity
                                                       "client_msg"),
                                                    (Env.TyParamSecurity
                                                       "client_sig")
                                                    ))
                                                  ]));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("sign_key_alice", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TyParamSecurity
                                                    "client_msg")
                                                  ]
                                                )));
                                            (("client_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_msg", 0),
                                             (Env.SecurityTypeDef ("message",
                                                [])));
                                            (("attacker_ty", 0),
                                             Env.ProcTypeDef);
                                            (("bob_t", 0), Env.ProcTypeDef);
                                            (("alice_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("message", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ];
                                      cmd =
                                      { desc = (Typed.New (("x", 12), None,
                                                  (Some ("chid",
                                                         [{ desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 11);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 11),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    11)));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                                           ])),
                                                  { desc = (Typed.Sequence (
                                                              { desc = (
                                                              Typed.Put
                                                                [{ desc = 
                                                                  Typed.Channel {
                                                                    channel =
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 11);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "x", 12),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    ((
                                                                    "c", 11),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    name =
                                                                    "conn";
                                                                    args = []}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "x", 12),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    ((
                                                                    "c", 11),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  ]); env = 
                                                              { Env.vars =
                                                                [(("x", 12),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                  (("c", 11),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("sign_key_alice",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                  (("client_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_msg",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                  (("attacker_ty",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("bob_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("alice_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("message",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } },
                                                              { desc = (
                                                              Typed.Return
                                                                { desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("x", 12);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "x", 12),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    (
                                                                    (
                                                                    "c", 11),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    (
                                                                    (
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }); env = 
                                                              { Env.vars =
                                                                [(("x", 12),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                  (("c", 11),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("sign_key_alice",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                  (("client_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_msg",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                  (("attacker_ty",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("bob_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("alice_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("message",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              )); env = 
                                                  { Env.vars =
                                                    [(("x", 12),
                                                      (Env.Var
                                                         (Syntax.Loc 12)));
                                                      (("c", 11),
                                                       (Env.Var
                                                          (Syntax.Loc 11)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  )); env = { Env.vars =
                                                              [(("c", 11),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    11)));
                                                                (("recv", 0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("send", 0),
                                                                 (Env.ExtSyscall
                                                                    2));
                                                                (("verify", 0),
                                                                 (Env.ExtFun
                                                                    3));
                                                                (("true", 0),
                                                                 Env.ExtConst);
                                                                (("snd", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("fst", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("sign", 0),
                                                                 (Env.ExtFun
                                                                    2));
                                                                (("vk", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("udp_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                (("conn_client",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                (("sign_key_alice",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                (("client_sig",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                (("client_msg",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                (("attacker_ty",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("bob_t", 0),
                                                                 Env.ProcTypeDef);
                                                                (("alice_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("readonly_t",
                                                                  0),
                                                                 Env.FilesysTypeDef);
                                                                (("verkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("sigkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("signature",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("message",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("connection",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("unit", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("bool", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("string", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []))
                                                                ];
                                                              facts =
                                                              ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } }
                                      }
                                     ]); env = { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                       )); env = { Env.vars =
                                   [(("c", 11), (Env.Var (Syntax.Loc 11)));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("vk", 0), (Env.ExtFun 1));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyParamProduct (
                                             (Env.TyParamSecurity
                                                "client_msg"),
                                             (Env.TyParamSecurity
                                                "client_sig")
                                             ))
                                           ]));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("sign_key_alice", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TyParamSecurity "client_msg")]
                                         )));
                                     (("client_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_msg", 0),
                                      (Env.SecurityTypeDef ("message", [])));
                                     (("attacker_ty", 0), Env.ProcTypeDef);
                                     (("bob_t", 0), Env.ProcTypeDef);
                                     (("alice_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("message", 0), (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("recv", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("invoke_rpc", 0);
           fun_sig =
           (Typed.DesSMFunTyped (
              [("cid", 13); ("f", 14); ("arg1", 15); ("arg2", 16)],
              [(Env.FParamSecurity "conn_client");
                (Env.FParamSimple ("string", [])); (Env.FParamPoly "'a");
                (Env.FParamPoly "'b")],
              (Env.FParamPoly "'c")));
           cmd =
           { desc = (Typed.Get ([("c", 17)],
                       { desc = Typed.Ident {id = ("cid", 13);
                                  desc = (Env.Var (Syntax.Loc 13));
                                  param = None}; env = { Env.vars =
                                                         [(("arg2", 16),
                                                           (Env.Var
                                                              (Syntax.Loc 16)));
                                                           (("arg1", 15),
                                                            (Env.Var
                                                               (Syntax.Loc 15)));
                                                           (("f", 14),
                                                            (Env.Var
                                                               (Syntax.Loc 14)));
                                                           (("cid", 13),
                                                            (Env.Var
                                                               (Syntax.Loc 13)));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("send", 0),
                                                            (Env.ExtSyscall 2));
                                                           (("verify", 0),
                                                            (Env.ExtFun 3));
                                                           (("true", 0),
                                                            Env.ExtConst);
                                                           (("snd", 0),
                                                            (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("vk", 0),
                                                            (Env.ExtFun 1));
                                                           (("udp_t", 0),
                                                            (Env.ChanTypeDef
                                                               [(Env.TyParamProduct (
                                                                   (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                   (Env.TyParamSecurity
                                                                    "client_sig")
                                                                   ))
                                                                 ]));
                                                           (("conn_client", 0),
                                                            (Env.SecurityTypeDef (
                                                               "connection",
                                                               [])));
                                                           (("sign_key_alice",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "sigkey",
                                                               [(Env.TyParamSecurity
                                                                   "client_msg")
                                                                 ]
                                                               )));
                                                           (("client_sig", 0),
                                                            (Env.SecurityTypeDef (
                                                               "signature",
                                                               [])));
                                                           (("client_msg", 0),
                                                            (Env.SecurityTypeDef (
                                                               "message", 
                                                               [])));
                                                           (("attacker_ty", 0),
                                                            Env.ProcTypeDef);
                                                           (("bob_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("alice_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("readonly_t", 0),
                                                            Env.FilesysTypeDef);
                                                           (("verkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("sigkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("signature", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("message", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("connection", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("unit", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("bool", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("string", 0),
                                                            (Env.SimpleTypeDef
                                                               []))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 17);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    17));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "invoke";
                                                           args =
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id = ("f", 14);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    14));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg1", 15);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    15));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg2", 16);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    16));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]}; env = 
                                                 { Env.vars =
                                                   [(("c", 17),
                                                     (Env.Var (Syntax.Loc 17)));
                                                     (("arg2", 16),
                                                      (Env.Var
                                                         (Syntax.Loc 16)));
                                                     (("arg1", 15),
                                                      (Env.Var
                                                         (Syntax.Loc 15)));
                                                     (("f", 14),
                                                      (Env.Var
                                                         (Syntax.Loc 14)));
                                                     (("cid", 13),
                                                      (Env.Var
                                                         (Syntax.Loc 13)));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
                                   { desc = (Typed.Case
                                               [{ Typed.fresh = [("v", 18)];
                                                  facts =
                                                  [{ desc = Typed.Channel {
                                                              channel =
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("c", 17);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    17));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 18),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                  (("c", 17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("arg2",
                                                                    16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("arg1",
                                                                    15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("f", 14),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("cid", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("sign_key_alice",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                  (("client_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_msg",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                  (("attacker_ty",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("bob_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("alice_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("message",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } };
                                                              name =
                                                              "Returned";
                                                              args =
                                                              [{ desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("v", 18);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "v", 18),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                    (
                                                                    (
                                                                    "c", 17),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                    (
                                                                    (
                                                                    "arg2",
                                                                    16),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                    (
                                                                    (
                                                                    "arg1",
                                                                    15),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                    (
                                                                    (
                                                                    "f", 14),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                    (
                                                                    (
                                                                    "cid", 13),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    (
                                                                    (
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ]}; env = 
                                                    { Env.vars =
                                                      [(("v", 18),
                                                        (Env.Var
                                                           (Syntax.Meta 18)));
                                                        (("c", 17),
                                                         (Env.Var
                                                            (Syntax.Loc 17)));
                                                        (("arg2", 16),
                                                         (Env.Var
                                                            (Syntax.Loc 16)));
                                                        (("arg1", 15),
                                                         (Env.Var
                                                            (Syntax.Loc 15)));
                                                        (("f", 14),
                                                         (Env.Var
                                                            (Syntax.Loc 14)));
                                                        (("cid", 13),
                                                         (Env.Var
                                                            (Syntax.Loc 13)));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("vk", 0),
                                                         (Env.ExtFun 1));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyParamProduct (
                                                                (Env.TyParamSecurity
                                                                   "client_msg"),
                                                                (Env.TyParamSecurity
                                                                   "client_sig")
                                                                ))
                                                              ]));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("sign_key_alice", 0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TyParamSecurity
                                                                "client_msg")
                                                              ]
                                                            )));
                                                        (("client_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_msg", 0),
                                                         (Env.SecurityTypeDef (
                                                            "message", 
                                                            [])));
                                                        (("attacker_ty", 0),
                                                         Env.ProcTypeDef);
                                                        (("bob_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("alice_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("message", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ];
                                                  cmd =
                                                  { desc = (Typed.Return
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("v", 18);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Meta
                                                                    18));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 18),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                  (("c", 17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("arg2",
                                                                    16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("arg1",
                                                                    15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("f", 14),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("cid", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("sign_key_alice",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                  (("client_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_msg",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                  (("attacker_ty",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("bob_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("alice_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("message",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }); env = 
                                                  { Env.vars =
                                                    [(("v", 18),
                                                      (Env.Var
                                                         (Syntax.Meta 18)));
                                                      (("c", 17),
                                                       (Env.Var
                                                          (Syntax.Loc 17)));
                                                      (("arg2", 16),
                                                       (Env.Var
                                                          (Syntax.Loc 16)));
                                                      (("arg1", 15),
                                                       (Env.Var
                                                          (Syntax.Loc 15)));
                                                      (("f", 14),
                                                       (Env.Var
                                                          (Syntax.Loc 14)));
                                                      (("cid", 13),
                                                       (Env.Var
                                                          (Syntax.Loc 13)));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ]); env = { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 17),
                                                 (Env.Var (Syntax.Loc 17)));
                                                 (("arg2", 16),
                                                  (Env.Var (Syntax.Loc 16)));
                                                 (("arg1", 15),
                                                  (Env.Var (Syntax.Loc 15)));
                                                 (("f", 14),
                                                  (Env.Var (Syntax.Loc 14)));
                                                 (("cid", 13),
                                                  (Env.Var (Syntax.Loc 13)));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("vk", 0), (Env.ExtFun 1));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyParamProduct (
                                                         (Env.TyParamSecurity
                                                            "client_msg"),
                                                         (Env.TyParamSecurity
                                                            "client_sig")
                                                         ))
                                                       ]));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("sign_key_alice", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TyParamSecurity
                                                         "client_msg")
                                                       ]
                                                     )));
                                                 (("client_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_msg", 0),
                                                  (Env.SecurityTypeDef (
                                                     "message", [])));
                                                 (("attacker_ty", 0),
                                                  Env.ProcTypeDef);
                                                 (("bob_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("alice_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("message", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("arg2", 16), (Env.Var (Syntax.Loc 16)));
                                     (("arg1", 15), (Env.Var (Syntax.Loc 15)));
                                     (("f", 14), (Env.Var (Syntax.Loc 14)));
                                     (("cid", 13), (Env.Var (Syntax.Loc 13)));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("vk", 0), (Env.ExtFun 1));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyParamProduct (
                                             (Env.TyParamSecurity
                                                "client_msg"),
                                             (Env.TyParamSecurity
                                                "client_sig")
                                             ))
                                           ]));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("sign_key_alice", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TyParamSecurity "client_msg")]
                                         )));
                                     (("client_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_msg", 0),
                                      (Env.SecurityTypeDef ("message", [])));
                                     (("attacker_ty", 0), Env.ProcTypeDef);
                                     (("bob_t", 0), Env.ProcTypeDef);
                                     (("alice_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("message", 0), (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("connect_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("close_rpc", 0);
           fun_sig =
           (Typed.DesSMFunTyped ([("cid", 19)],
              [(Env.FParamSecurity "conn_client")],
              (Env.FParamSimple ("unit", []))));
           cmd =
           { desc = (Typed.Get ([("c", 20)],
                       { desc = Typed.Ident {id = ("cid", 19);
                                  desc = (Env.Var (Syntax.Loc 19));
                                  param = None}; env = { Env.vars =
                                                         [(("cid", 19),
                                                           (Env.Var
                                                              (Syntax.Loc 19)));
                                                           (("invoke_rpc", 0),
                                                            (Env.ExtSyscall 4));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("send", 0),
                                                            (Env.ExtSyscall 2));
                                                           (("verify", 0),
                                                            (Env.ExtFun 3));
                                                           (("true", 0),
                                                            Env.ExtConst);
                                                           (("snd", 0),
                                                            (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("vk", 0),
                                                            (Env.ExtFun 1));
                                                           (("udp_t", 0),
                                                            (Env.ChanTypeDef
                                                               [(Env.TyParamProduct (
                                                                   (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                   (Env.TyParamSecurity
                                                                    "client_sig")
                                                                   ))
                                                                 ]));
                                                           (("conn_client", 0),
                                                            (Env.SecurityTypeDef (
                                                               "connection",
                                                               [])));
                                                           (("sign_key_alice",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "sigkey",
                                                               [(Env.TyParamSecurity
                                                                   "client_msg")
                                                                 ]
                                                               )));
                                                           (("client_sig", 0),
                                                            (Env.SecurityTypeDef (
                                                               "signature",
                                                               [])));
                                                           (("client_msg", 0),
                                                            (Env.SecurityTypeDef (
                                                               "message", 
                                                               [])));
                                                           (("attacker_ty", 0),
                                                            Env.ProcTypeDef);
                                                           (("bob_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("alice_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("readonly_t", 0),
                                                            Env.FilesysTypeDef);
                                                           (("verkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("sigkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("signature", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("message", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("connection", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("unit", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("bool", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("string", 0),
                                                            (Env.SimpleTypeDef
                                                               []))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Del (
                                               { desc = Typed.Ident {
                                                          id = ("cid", 19);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 19));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 20),
                                                   (Env.Var (Syntax.Loc 20)));
                                                   (("cid", 19),
                                                    (Env.Var (Syntax.Loc 19)));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               "chid")); env = { Env.vars =
                                                                 [(("c", 20),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    20)));
                                                                   ((
                                                                    "cid", 19),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    19)));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                   ((
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                   ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                   ((
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                   ((
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                   ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } },
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 20);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    20));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 20),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    20)));
                                                               (("cid", 19),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    19)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "exit";
                                                           args = []}; env = 
                                                 { Env.vars =
                                                   [(("c", 20),
                                                     (Env.Var (Syntax.Loc 20)));
                                                     (("cid", 19),
                                                      (Env.Var
                                                         (Syntax.Loc 19)));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 20),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    20)));
                                                               (("cid", 19),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    19)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 20),
                                                 (Env.Var (Syntax.Loc 20)));
                                                 (("cid", 19),
                                                  (Env.Var (Syntax.Loc 19)));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("vk", 0), (Env.ExtFun 1));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyParamProduct (
                                                         (Env.TyParamSecurity
                                                            "client_msg"),
                                                         (Env.TyParamSecurity
                                                            "client_sig")
                                                         ))
                                                       ]));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("sign_key_alice", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TyParamSecurity
                                                         "client_msg")
                                                       ]
                                                     )));
                                                 (("client_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_msg", 0),
                                                  (Env.SecurityTypeDef (
                                                     "message", [])));
                                                 (("attacker_ty", 0),
                                                  Env.ProcTypeDef);
                                                 (("bob_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("alice_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("message", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("cid", 19), (Env.Var (Syntax.Loc 19)));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("vk", 0), (Env.ExtFun 1));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyParamProduct (
                                             (Env.TyParamSecurity
                                                "client_msg"),
                                             (Env.TyParamSecurity
                                                "client_sig")
                                             ))
                                           ]));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("sign_key_alice", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TyParamSecurity "client_msg")]
                                         )));
                                     (("client_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_msg", 0),
                                      (Env.SecurityTypeDef ("message", [])));
                                     (("attacker_ty", 0), Env.ProcTypeDef);
                                     (("bob_t", 0), Env.ProcTypeDef);
                                     (("alice_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("message", 0), (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("invoke_rpc", 0),
                                                   (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("accept_rpc", 0);
           fun_sig =
           (Typed.DesSMFunTyped ([("c", 21)],
              [(Env.FParamChannel [(Env.FParamTyParamPoly "'a")])],
              (Env.FParamSimple ("unit", []))));
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 21);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 21));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("c", 21),
                                          (Env.Var (Syntax.Loc 21)));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "req"; args = []}; env = 
                            { Env.vars =
                              [(("c", 21), (Env.Var (Syntax.Loc 21)));
                                (("close_rpc", 0), (Env.ExtSyscall 1));
                                (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                (("connect_rpc", 0), (Env.ExtSyscall 1));
                                (("recv", 0), (Env.ExtSyscall 1));
                                (("send", 0), (Env.ExtSyscall 2));
                                (("verify", 0), (Env.ExtFun 3));
                                (("true", 0), Env.ExtConst);
                                (("snd", 0), (Env.ExtFun 1));
                                (("fst", 0), (Env.ExtFun 1));
                                (("sign", 0), (Env.ExtFun 2));
                                (("vk", 0), (Env.ExtFun 1));
                                (("udp_t", 0),
                                 (Env.ChanTypeDef
                                    [(Env.TyParamProduct (
                                        (Env.TyParamSecurity "client_msg"),
                                        (Env.TyParamSecurity "client_sig")))
                                      ]));
                                (("conn_client", 0),
                                 (Env.SecurityTypeDef ("connection", [])));
                                (("sign_key_alice", 0),
                                 (Env.SecurityTypeDef ("sigkey",
                                    [(Env.TyParamSecurity "client_msg")])));
                                (("client_sig", 0),
                                 (Env.SecurityTypeDef ("signature", [])));
                                (("client_msg", 0),
                                 (Env.SecurityTypeDef ("message", [])));
                                (("attacker_ty", 0), Env.ProcTypeDef);
                                (("bob_t", 0), Env.ProcTypeDef);
                                (("alice_t", 0), Env.ProcTypeDef);
                                (("readonly_t", 0), Env.FilesysTypeDef);
                                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("signature", 0), (Env.SimpleTypeDef []));
                                (("message", 0), (Env.SimpleTypeDef []));
                                (("connection", 0), (Env.SimpleTypeDef []));
                                (("unit", 0), (Env.SimpleTypeDef []));
                                (("bool", 0), (Env.SimpleTypeDef []));
                                (("string", 0), (Env.SimpleTypeDef []))];
                              facts =
                              ref ([("BobClose", (Env.Global, (Some 0)));
                                     ("IntegrityFail", (Env.Global, (Some 1)));
                                     ("IntegritySuccess",
                                      (Env.Global, (Some 1)));
                                     ("AliceClose", (Env.Global, (Some 0)));
                                     ("MsgSend", (Env.Global, (Some 1)));
                                     ("Out", (Env.Global, (Some 1)));
                                     ("In", (Env.Global, (Some 1)));
                                     ("exit", (Env.Channel, (Some 0)));
                                     ("Returned", (Env.Channel, (Some 1)));
                                     ("invoke", (Env.Channel, (Some 3)));
                                     ("conn", (Env.Channel, (Some 0)));
                                     ("chid", (Env.Structure, (Some 1)));
                                     ("ack", (Env.Channel, (Some 0)));
                                     ("req", (Env.Channel, (Some 0)));
                                     ("store", (Env.Channel, (Some 1)))])
                              } }
                            ];
                          cmd =
                          { desc = (Typed.Put
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 21);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   21));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 21),
                                                      (Env.Var
                                                         (Syntax.Loc 21)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 21),
                                            (Env.Var (Syntax.Loc 21)));
                                            (("close_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("invoke_rpc", 0),
                                             (Env.ExtSyscall 4));
                                            (("connect_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("vk", 0), (Env.ExtFun 1));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyParamProduct (
                                                    (Env.TyParamSecurity
                                                       "client_msg"),
                                                    (Env.TyParamSecurity
                                                       "client_sig")
                                                    ))
                                                  ]));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("sign_key_alice", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TyParamSecurity
                                                    "client_msg")
                                                  ]
                                                )));
                                            (("client_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_msg", 0),
                                             (Env.SecurityTypeDef ("message",
                                                [])));
                                            (("attacker_ty", 0),
                                             Env.ProcTypeDef);
                                            (("bob_t", 0), Env.ProcTypeDef);
                                            (("alice_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("message", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]); env = { Env.vars =
                                                    [(("c", 21),
                                                      (Env.Var
                                                         (Syntax.Loc 21)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 21), (Env.Var (Syntax.Loc 21)));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("vk", 0), (Env.ExtFun 1));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyParamProduct (
                                               (Env.TyParamSecurity
                                                  "client_msg"),
                                               (Env.TyParamSecurity
                                                  "client_sig")
                                               ))
                                             ]));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("sign_key_alice", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TyParamSecurity "client_msg")
                                             ]
                                           )));
                                       (("client_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_msg", 0),
                                        (Env.SecurityTypeDef ("message", [])));
                                       (("attacker_ty", 0), Env.ProcTypeDef);
                                       (("bob_t", 0), Env.ProcTypeDef);
                                       (("alice_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("message", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []))
                                       ];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("close_rpc", 0),
                                                     (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("gen_message", 0);
           fun_sig =
           (Typed.DesSMFunTyped ([], [], (Env.FParamSecurity "client_msg")));
           cmd =
           { desc = (Typed.New (("v", 22),
                       (Some (Env.TySecurity "client_msg")), None,
                       { desc = (Typed.Return
                                   { desc = Typed.Ident {id = ("v", 22);
                                              desc =
                                              (Env.Var (Syntax.Loc 22));
                                              param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 22),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    22)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }); env = 
                       { Env.vars =
                         [(("v", 22), (Env.Var (Syntax.Loc 22)));
                           (("accept_rpc", 0), (Env.ExtSyscall 1));
                           (("close_rpc", 0), (Env.ExtSyscall 1));
                           (("invoke_rpc", 0), (Env.ExtSyscall 4));
                           (("connect_rpc", 0), (Env.ExtSyscall 1));
                           (("recv", 0), (Env.ExtSyscall 1));
                           (("send", 0), (Env.ExtSyscall 2));
                           (("verify", 0), (Env.ExtFun 3));
                           (("true", 0), Env.ExtConst);
                           (("snd", 0), (Env.ExtFun 1));
                           (("fst", 0), (Env.ExtFun 1));
                           (("sign", 0), (Env.ExtFun 2));
                           (("vk", 0), (Env.ExtFun 1));
                           (("udp_t", 0),
                            (Env.ChanTypeDef
                               [(Env.TyParamProduct (
                                   (Env.TyParamSecurity "client_msg"),
                                   (Env.TyParamSecurity "client_sig")))
                                 ]));
                           (("conn_client", 0),
                            (Env.SecurityTypeDef ("connection", [])));
                           (("sign_key_alice", 0),
                            (Env.SecurityTypeDef ("sigkey",
                               [(Env.TyParamSecurity "client_msg")])));
                           (("client_sig", 0),
                            (Env.SecurityTypeDef ("signature", [])));
                           (("client_msg", 0),
                            (Env.SecurityTypeDef ("message", [])));
                           (("attacker_ty", 0), Env.ProcTypeDef);
                           (("bob_t", 0), Env.ProcTypeDef);
                           (("alice_t", 0), Env.ProcTypeDef);
                           (("readonly_t", 0), Env.FilesysTypeDef);
                           (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                           (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                           (("signature", 0), (Env.SimpleTypeDef []));
                           (("message", 0), (Env.SimpleTypeDef []));
                           (("connection", 0), (Env.SimpleTypeDef []));
                           (("unit", 0), (Env.SimpleTypeDef []));
                           (("bool", 0), (Env.SimpleTypeDef []));
                           (("string", 0), (Env.SimpleTypeDef []))];
                         facts =
                         ref ([("BobClose", (Env.Global, (Some 0)));
                                ("IntegrityFail", (Env.Global, (Some 1)));
                                ("IntegritySuccess", (Env.Global, (Some 1)));
                                ("AliceClose", (Env.Global, (Some 0)));
                                ("MsgSend", (Env.Global, (Some 1)));
                                ("Out", (Env.Global, (Some 1)));
                                ("In", (Env.Global, (Some 1)));
                                ("exit", (Env.Channel, (Some 0)));
                                ("Returned", (Env.Channel, (Some 1)));
                                ("invoke", (Env.Channel, (Some 3)));
                                ("conn", (Env.Channel, (Some 0)));
                                ("chid", (Env.Structure, (Some 1)));
                                ("ack", (Env.Channel, (Some 0)));
                                ("req", (Env.Channel, (Some 0)));
                                ("store", (Env.Channel, (Some 1)))])
                         } }
                       )); env = { Env.vars =
                                   [(("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("vk", 0), (Env.ExtFun 1));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyParamProduct (
                                             (Env.TyParamSecurity
                                                "client_msg"),
                                             (Env.TyParamSecurity
                                                "client_sig")
                                             ))
                                           ]));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("sign_key_alice", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TyParamSecurity "client_msg")]
                                         )));
                                     (("client_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_msg", 0),
                                      (Env.SecurityTypeDef ("message", [])));
                                     (("attacker_ty", 0), Env.ProcTypeDef);
                                     (("bob_t", 0), Env.ProcTypeDef);
                                     (("alice_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("message", 0), (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("accept_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("read", 0);
           fun_sig = (Typed.DesSMFunUntyped []);
           cmd =
           { desc = Typed.Skip; env = { Env.vars =
                                        [(("gen_message", 0),
                                          (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }}; env = { Env.vars =
                                                      [(("gen_message", 0),
                                                        (Env.ExtSyscall 0));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall 4));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("vk", 0),
                                                         (Env.ExtFun 1));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyParamProduct (
                                                                (Env.TyParamSecurity
                                                                   "client_msg"),
                                                                (Env.TyParamSecurity
                                                                   "client_sig")
                                                                ))
                                                              ]));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("sign_key_alice", 0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TyParamSecurity
                                                                "client_msg")
                                                              ]
                                                            )));
                                                        (("client_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_msg", 0),
                                                         (Env.SecurityTypeDef (
                                                            "message", 
                                                            [])));
                                                        (("attacker_ty", 0),
                                                         Env.ProcTypeDef);
                                                        (("bob_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("alice_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("message", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
{ desc = Typed.Syscall {id = ("provide", 0);
           fun_sig = (Typed.DesSMFunUntyped []);
           cmd =
           { desc = Typed.Skip; env = { Env.vars =
                                        [(("read", 0), (Env.ExtSyscall 0));
                                          (("gen_message", 0),
                                           (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }}; env = { Env.vars =
                                                      [(("read", 0),
                                                        (Env.ExtSyscall 0));
                                                        (("gen_message", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall 4));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("vk", 0),
                                                         (Env.ExtFun 1));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyParamProduct (
                                                                (Env.TyParamSecurity
                                                                   "client_msg"),
                                                                (Env.TyParamSecurity
                                                                   "client_sig")
                                                                ))
                                                              ]));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("sign_key_alice", 0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TyParamSecurity
                                                                "client_msg")
                                                              ]
                                                            )));
                                                        (("client_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_msg", 0),
                                                         (Env.SecurityTypeDef (
                                                            "message", 
                                                            [])));
                                                        (("attacker_ty", 0),
                                                         Env.ProcTypeDef);
                                                        (("bob_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("alice_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("message", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
{ desc = Typed.Attack {id = ("tamper_channel", 0); syscall = ("recv", 0);
           args = [("c", 23)];
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [("w", 25); ("j", 24)];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 23);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 23));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("j", 24),
                                          (Env.Var (Syntax.Meta 24)));
                                          (("w", 25),
                                           (Env.Var (Syntax.Meta 25)));
                                          (("c", 23),
                                           (Env.Var (Syntax.Loc 23)));
                                          (("provide", 0), (Env.ExtSyscall 0));
                                          (("read", 0), (Env.ExtSyscall 0));
                                          (("gen_message", 0),
                                           (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "store";
                                      args =
                                      [{ desc = Typed.Ident {id = ("j", 24);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 24));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("j", 24),
                                            (Env.Var (Syntax.Meta 24)));
                                            (("w", 25),
                                             (Env.Var (Syntax.Meta 25)));
                                            (("c", 23),
                                             (Env.Var (Syntax.Loc 23)));
                                            (("provide", 0),
                                             (Env.ExtSyscall 0));
                                            (("read", 0), (Env.ExtSyscall 0));
                                            (("gen_message", 0),
                                             (Env.ExtSyscall 0));
                                            (("accept_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("close_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("invoke_rpc", 0),
                                             (Env.ExtSyscall 4));
                                            (("connect_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("vk", 0), (Env.ExtFun 1));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyParamProduct (
                                                    (Env.TyParamSecurity
                                                       "client_msg"),
                                                    (Env.TyParamSecurity
                                                       "client_sig")
                                                    ))
                                                  ]));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("sign_key_alice", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TyParamSecurity
                                                    "client_msg")
                                                  ]
                                                )));
                                            (("client_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_msg", 0),
                                             (Env.SecurityTypeDef ("message",
                                                [])));
                                            (("attacker_ty", 0),
                                             Env.ProcTypeDef);
                                            (("bob_t", 0), Env.ProcTypeDef);
                                            (("alice_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("message", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]}; env = { Env.vars =
                                                    [(("j", 24),
                                                      (Env.Var
                                                         (Syntax.Meta 24)));
                                                      (("w", 25),
                                                       (Env.Var
                                                          (Syntax.Meta 25)));
                                                      (("c", 23),
                                                       (Env.Var
                                                          (Syntax.Loc 23)));
                                                      (("provide", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("read", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("gen_message", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                            { desc = (Typed.Global ("In",
                                        [{ desc = Typed.Ident {
                                                    id = ("w", 25);
                                                    desc =
                                                    (Env.Var (Syntax.Meta 25));
                                                    param = None}; env = 
                                          { Env.vars =
                                            [(("j", 24),
                                              (Env.Var (Syntax.Meta 24)));
                                              (("w", 25),
                                               (Env.Var (Syntax.Meta 25)));
                                              (("c", 23),
                                               (Env.Var (Syntax.Loc 23)));
                                              (("provide", 0),
                                               (Env.ExtSyscall 0));
                                              (("read", 0),
                                               (Env.ExtSyscall 0));
                                              (("gen_message", 0),
                                               (Env.ExtSyscall 0));
                                              (("accept_rpc", 0),
                                               (Env.ExtSyscall 1));
                                              (("close_rpc", 0),
                                               (Env.ExtSyscall 1));
                                              (("invoke_rpc", 0),
                                               (Env.ExtSyscall 4));
                                              (("connect_rpc", 0),
                                               (Env.ExtSyscall 1));
                                              (("recv", 0),
                                               (Env.ExtSyscall 1));
                                              (("send", 0),
                                               (Env.ExtSyscall 2));
                                              (("verify", 0), (Env.ExtFun 3));
                                              (("true", 0), Env.ExtConst);
                                              (("snd", 0), (Env.ExtFun 1));
                                              (("fst", 0), (Env.ExtFun 1));
                                              (("sign", 0), (Env.ExtFun 2));
                                              (("vk", 0), (Env.ExtFun 1));
                                              (("udp_t", 0),
                                               (Env.ChanTypeDef
                                                  [(Env.TyParamProduct (
                                                      (Env.TyParamSecurity
                                                         "client_msg"),
                                                      (Env.TyParamSecurity
                                                         "client_sig")
                                                      ))
                                                    ]));
                                              (("conn_client", 0),
                                               (Env.SecurityTypeDef (
                                                  "connection", [])));
                                              (("sign_key_alice", 0),
                                               (Env.SecurityTypeDef (
                                                  "sigkey",
                                                  [(Env.TyParamSecurity
                                                      "client_msg")
                                                    ]
                                                  )));
                                              (("client_sig", 0),
                                               (Env.SecurityTypeDef (
                                                  "signature", [])));
                                              (("client_msg", 0),
                                               (Env.SecurityTypeDef (
                                                  "message", [])));
                                              (("attacker_ty", 0),
                                               Env.ProcTypeDef);
                                              (("bob_t", 0), Env.ProcTypeDef);
                                              (("alice_t", 0),
                                               Env.ProcTypeDef);
                                              (("readonly_t", 0),
                                               Env.FilesysTypeDef);
                                              (("verkey", 0),
                                               (Env.SimpleTypeDef ["'a"]));
                                              (("sigkey", 0),
                                               (Env.SimpleTypeDef ["'a"]));
                                              (("signature", 0),
                                               (Env.SimpleTypeDef []));
                                              (("message", 0),
                                               (Env.SimpleTypeDef []));
                                              (("connection", 0),
                                               (Env.SimpleTypeDef []));
                                              (("unit", 0),
                                               (Env.SimpleTypeDef []));
                                              (("bool", 0),
                                               (Env.SimpleTypeDef []));
                                              (("string", 0),
                                               (Env.SimpleTypeDef []))
                                              ];
                                            facts =
                                            ref ([("BobClose",
                                                   (Env.Global, (Some 0)));
                                                   ("IntegrityFail",
                                                    (Env.Global, (Some 1)));
                                                   ("IntegritySuccess",
                                                    (Env.Global, (Some 1)));
                                                   ("AliceClose",
                                                    (Env.Global, (Some 0)));
                                                   ("MsgSend",
                                                    (Env.Global, (Some 1)));
                                                   ("Out",
                                                    (Env.Global, (Some 1)));
                                                   ("In",
                                                    (Env.Global, (Some 1)));
                                                   ("exit",
                                                    (Env.Channel, (Some 0)));
                                                   ("Returned",
                                                    (Env.Channel, (Some 1)));
                                                   ("invoke",
                                                    (Env.Channel, (Some 3)));
                                                   ("conn",
                                                    (Env.Channel, (Some 0)));
                                                   ("chid",
                                                    (Env.Structure, (Some 1)));
                                                   ("ack",
                                                    (Env.Channel, (Some 0)));
                                                   ("req",
                                                    (Env.Channel, (Some 0)));
                                                   ("store",
                                                    (Env.Channel, (Some 1)))
                                                   ])
                                            } }
                                          ]
                                        )); env = { Env.vars =
                                                    [(("j", 24),
                                                      (Env.Var
                                                         (Syntax.Meta 24)));
                                                      (("w", 25),
                                                       (Env.Var
                                                          (Syntax.Meta 25)));
                                                      (("c", 23),
                                                       (Env.Var
                                                          (Syntax.Loc 23)));
                                                      (("provide", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("read", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("gen_message", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("vk", 0),
                                                       (Env.ExtFun 1));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyParamProduct (
                                                              (Env.TyParamSecurity
                                                                 "client_msg"),
                                                              (Env.TyParamSecurity
                                                                 "client_sig")
                                                              ))
                                                            ]));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("sign_key_alice", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TyParamSecurity
                                                              "client_msg")
                                                            ]
                                                          )));
                                                      (("client_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_msg", 0),
                                                       (Env.SecurityTypeDef (
                                                          "message", 
                                                          [])));
                                                      (("attacker_ty", 0),
                                                       Env.ProcTypeDef);
                                                      (("bob_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("alice_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("message", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                            ];
                          cmd =
                          { desc = (Typed.Return
                                      { desc = Typed.Ident {id = ("w", 25);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 25));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("j", 24),
                                          (Env.Var (Syntax.Meta 24)));
                                          (("w", 25),
                                           (Env.Var (Syntax.Meta 25)));
                                          (("c", 23),
                                           (Env.Var (Syntax.Loc 23)));
                                          (("provide", 0), (Env.ExtSyscall 0));
                                          (("read", 0), (Env.ExtSyscall 0));
                                          (("gen_message", 0),
                                           (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }); env = { Env.vars =
                                                      [(("j", 24),
                                                        (Env.Var
                                                           (Syntax.Meta 24)));
                                                        (("w", 25),
                                                         (Env.Var
                                                            (Syntax.Meta 25)));
                                                        (("c", 23),
                                                         (Env.Var
                                                            (Syntax.Loc 23)));
                                                        (("provide", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("read", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("gen_message", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall 4));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("vk", 0),
                                                         (Env.ExtFun 1));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyParamProduct (
                                                                (Env.TyParamSecurity
                                                                   "client_msg"),
                                                                (Env.TyParamSecurity
                                                                   "client_sig")
                                                                ))
                                                              ]));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("sign_key_alice", 0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TyParamSecurity
                                                                "client_msg")
                                                              ]
                                                            )));
                                                        (("client_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_msg", 0),
                                                         (Env.SecurityTypeDef (
                                                            "message", 
                                                            [])));
                                                        (("attacker_ty", 0),
                                                         Env.ProcTypeDef);
                                                        (("bob_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("alice_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("message", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 23), (Env.Var (Syntax.Loc 23)));
                                       (("provide", 0), (Env.ExtSyscall 0));
                                       (("read", 0), (Env.ExtSyscall 0));
                                       (("gen_message", 0),
                                        (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("vk", 0), (Env.ExtFun 1));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyParamProduct (
                                               (Env.TyParamSecurity
                                                  "client_msg"),
                                               (Env.TyParamSecurity
                                                  "client_sig")
                                               ))
                                             ]));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("sign_key_alice", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TyParamSecurity "client_msg")
                                             ]
                                           )));
                                       (("client_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_msg", 0),
                                        (Env.SecurityTypeDef ("message", [])));
                                       (("attacker_ty", 0), Env.ProcTypeDef);
                                       (("bob_t", 0), Env.ProcTypeDef);
                                       (("alice_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("message", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []))
                                       ];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("provide", 0),
                                                     (Env.ExtSyscall 0));
                                                     (("read", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("gen_message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.AllowAttack {process_typs = [("alice_t", 0)];
           attacks = [("tamper_channel", 0)]}; env = { Env.vars =
                                                       [(("tamper_channel", 0),
                                                         Env.Attack);
                                                         (("provide", 0),
                                                          (Env.ExtSyscall 0));
                                                         (("read", 0),
                                                          (Env.ExtSyscall 0));
                                                         (("gen_message", 0),
                                                          (Env.ExtSyscall 0));
                                                         (("accept_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("close_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("invoke_rpc", 0),
                                                          (Env.ExtSyscall 4));
                                                         (("connect_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("recv", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("send", 0),
                                                          (Env.ExtSyscall 2));
                                                         (("verify", 0),
                                                          (Env.ExtFun 3));
                                                         (("true", 0),
                                                          Env.ExtConst);
                                                         (("snd", 0),
                                                          (Env.ExtFun 1));
                                                         (("fst", 0),
                                                          (Env.ExtFun 1));
                                                         (("sign", 0),
                                                          (Env.ExtFun 2));
                                                         (("vk", 0),
                                                          (Env.ExtFun 1));
                                                         (("udp_t", 0),
                                                          (Env.ChanTypeDef
                                                             [(Env.TyParamProduct (
                                                                 (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                 (Env.TyParamSecurity
                                                                    "client_sig")
                                                                 ))
                                                               ]));
                                                         (("conn_client", 0),
                                                          (Env.SecurityTypeDef (
                                                             "connection", 
                                                             [])));
                                                         (("sign_key_alice",
                                                           0),
                                                          (Env.SecurityTypeDef (
                                                             "sigkey",
                                                             [(Env.TyParamSecurity
                                                                 "client_msg")
                                                               ]
                                                             )));
                                                         (("client_sig", 0),
                                                          (Env.SecurityTypeDef (
                                                             "signature", 
                                                             [])));
                                                         (("client_msg", 0),
                                                          (Env.SecurityTypeDef (
                                                             "message", 
                                                             [])));
                                                         (("attacker_ty", 0),
                                                          Env.ProcTypeDef);
                                                         (("bob_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("alice_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("readonly_t", 0),
                                                          Env.FilesysTypeDef);
                                                         (("verkey", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("sigkey", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("signature", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("message", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("connection", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("unit", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("bool", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("string", 0),
                                                          (Env.SimpleTypeDef
                                                             []))
                                                         ];
                                                       facts =
                                                       ref ([("BobClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                              ("IntegrityFail",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("IntegritySuccess",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("AliceClose",
                                                               (Env.Global,
                                                                (Some 0)));
                                                              ("MsgSend",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("Out",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("In",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("exit",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("Returned",
                                                               (Env.Channel,
                                                                (Some 1)));
                                                              ("invoke",
                                                               (Env.Channel,
                                                                (Some 3)));
                                                              ("conn",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("chid",
                                                               (Env.Structure,
                                                                (Some 1)));
                                                              ("ack",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("req",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("store",
                                                               (Env.Channel,
                                                                (Some 1)))
                                                              ])
                                                       } }
{ desc = Typed.AllowAttack {process_typs = [("bob_t", 0)];
           attacks = [("tamper_channel", 0)]}; env = { Env.vars =
                                                       [(("tamper_channel", 0),
                                                         Env.Attack);
                                                         (("provide", 0),
                                                          (Env.ExtSyscall 0));
                                                         (("read", 0),
                                                          (Env.ExtSyscall 0));
                                                         (("gen_message", 0),
                                                          (Env.ExtSyscall 0));
                                                         (("accept_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("close_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("invoke_rpc", 0),
                                                          (Env.ExtSyscall 4));
                                                         (("connect_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("recv", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("send", 0),
                                                          (Env.ExtSyscall 2));
                                                         (("verify", 0),
                                                          (Env.ExtFun 3));
                                                         (("true", 0),
                                                          Env.ExtConst);
                                                         (("snd", 0),
                                                          (Env.ExtFun 1));
                                                         (("fst", 0),
                                                          (Env.ExtFun 1));
                                                         (("sign", 0),
                                                          (Env.ExtFun 2));
                                                         (("vk", 0),
                                                          (Env.ExtFun 1));
                                                         (("udp_t", 0),
                                                          (Env.ChanTypeDef
                                                             [(Env.TyParamProduct (
                                                                 (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                 (Env.TyParamSecurity
                                                                    "client_sig")
                                                                 ))
                                                               ]));
                                                         (("conn_client", 0),
                                                          (Env.SecurityTypeDef (
                                                             "connection", 
                                                             [])));
                                                         (("sign_key_alice",
                                                           0),
                                                          (Env.SecurityTypeDef (
                                                             "sigkey",
                                                             [(Env.TyParamSecurity
                                                                 "client_msg")
                                                               ]
                                                             )));
                                                         (("client_sig", 0),
                                                          (Env.SecurityTypeDef (
                                                             "signature", 
                                                             [])));
                                                         (("client_msg", 0),
                                                          (Env.SecurityTypeDef (
                                                             "message", 
                                                             [])));
                                                         (("attacker_ty", 0),
                                                          Env.ProcTypeDef);
                                                         (("bob_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("alice_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("readonly_t", 0),
                                                          Env.FilesysTypeDef);
                                                         (("verkey", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("sigkey", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("signature", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("message", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("connection", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("unit", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("bool", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("string", 0),
                                                          (Env.SimpleTypeDef
                                                             []))
                                                         ];
                                                       facts =
                                                       ref ([("BobClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                              ("IntegrityFail",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("IntegritySuccess",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("AliceClose",
                                                               (Env.Global,
                                                                (Some 0)));
                                                              ("MsgSend",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("Out",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("In",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("exit",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("Returned",
                                                               (Env.Channel,
                                                                (Some 1)));
                                                              ("invoke",
                                                               (Env.Channel,
                                                                (Some 3)));
                                                              ("conn",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("chid",
                                                               (Env.Structure,
                                                                (Some 1)));
                                                              ("ack",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("req",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("store",
                                                               (Env.Channel,
                                                                (Some 1)))
                                                              ])
                                                       } }
{ desc = Typed.Syscall {id = ("eaves_mem", 0);
           fun_sig = (Typed.DesSMFunUntyped [("v", 26)]);
           cmd =
           { desc = (Typed.Put
                       [{ desc = (Typed.Global ("Out",
                                    [{ desc = Typed.Ident {id = ("v", 26);
                                                desc =
                                                (Env.Var (Syntax.Loc 26));
                                                param = None}; env = 
                                      { Env.vars =
                                        [(("v", 26),
                                          (Env.Var (Syntax.Loc 26)));
                                          (("tamper_channel", 0), Env.Attack);
                                          (("provide", 0), (Env.ExtSyscall 0));
                                          (("read", 0), (Env.ExtSyscall 0));
                                          (("gen_message", 0),
                                           (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("vk", 0), (Env.ExtFun 1));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyParamProduct (
                                                  (Env.TyParamSecurity
                                                     "client_msg"),
                                                  (Env.TyParamSecurity
                                                     "client_sig")
                                                  ))
                                                ]));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TyParamSecurity
                                                  "client_msg")
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_msg", 0),
                                           (Env.SecurityTypeDef ("message",
                                              [])));
                                          (("attacker_ty", 0),
                                           Env.ProcTypeDef);
                                          (("bob_t", 0), Env.ProcTypeDef);
                                          (("alice_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }
                                      ]
                                    )); env = { Env.vars =
                                                [(("v", 26),
                                                  (Env.Var (Syntax.Loc 26)));
                                                  (("tamper_channel", 0),
                                                   Env.Attack);
                                                  (("provide", 0),
                                                   (Env.ExtSyscall 0));
                                                  (("read", 0),
                                                   (Env.ExtSyscall 0));
                                                  (("gen_message", 0),
                                                   (Env.ExtSyscall 0));
                                                  (("accept_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("close_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("invoke_rpc", 0),
                                                   (Env.ExtSyscall 4));
                                                  (("connect_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("recv", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("send", 0),
                                                   (Env.ExtSyscall 2));
                                                  (("verify", 0),
                                                   (Env.ExtFun 3));
                                                  (("true", 0), Env.ExtConst);
                                                  (("snd", 0), (Env.ExtFun 1));
                                                  (("fst", 0), (Env.ExtFun 1));
                                                  (("sign", 0),
                                                   (Env.ExtFun 2));
                                                  (("vk", 0), (Env.ExtFun 1));
                                                  (("udp_t", 0),
                                                   (Env.ChanTypeDef
                                                      [(Env.TyParamProduct (
                                                          (Env.TyParamSecurity
                                                             "client_msg"),
                                                          (Env.TyParamSecurity
                                                             "client_sig")
                                                          ))
                                                        ]));
                                                  (("conn_client", 0),
                                                   (Env.SecurityTypeDef (
                                                      "connection", [])));
                                                  (("sign_key_alice", 0),
                                                   (Env.SecurityTypeDef (
                                                      "sigkey",
                                                      [(Env.TyParamSecurity
                                                          "client_msg")
                                                        ]
                                                      )));
                                                  (("client_sig", 0),
                                                   (Env.SecurityTypeDef (
                                                      "signature", [])));
                                                  (("client_msg", 0),
                                                   (Env.SecurityTypeDef (
                                                      "message", [])));
                                                  (("attacker_ty", 0),
                                                   Env.ProcTypeDef);
                                                  (("bob_t", 0),
                                                   Env.ProcTypeDef);
                                                  (("alice_t", 0),
                                                   Env.ProcTypeDef);
                                                  (("readonly_t", 0),
                                                   Env.FilesysTypeDef);
                                                  (("verkey", 0),
                                                   (Env.SimpleTypeDef ["'a"]));
                                                  (("sigkey", 0),
                                                   (Env.SimpleTypeDef ["'a"]));
                                                  (("signature", 0),
                                                   (Env.SimpleTypeDef []));
                                                  (("message", 0),
                                                   (Env.SimpleTypeDef []));
                                                  (("connection", 0),
                                                   (Env.SimpleTypeDef []));
                                                  (("unit", 0),
                                                   (Env.SimpleTypeDef []));
                                                  (("bool", 0),
                                                   (Env.SimpleTypeDef []));
                                                  (("string", 0),
                                                   (Env.SimpleTypeDef []))
                                                  ];
                                                facts =
                                                ref ([("BobClose",
                                                       (Env.Global, (Some 0)));
                                                       ("IntegrityFail",
                                                        (Env.Global, (Some 1)));
                                                       ("IntegritySuccess",
                                                        (Env.Global, (Some 1)));
                                                       ("AliceClose",
                                                        (Env.Global, (Some 0)));
                                                       ("MsgSend",
                                                        (Env.Global, (Some 1)));
                                                       ("Out",
                                                        (Env.Global, (Some 1)));
                                                       ("In",
                                                        (Env.Global, (Some 1)));
                                                       ("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("Returned",
                                                        (Env.Channel,
                                                         (Some 1)));
                                                       ("invoke",
                                                        (Env.Channel,
                                                         (Some 3)));
                                                       ("conn",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("chid",
                                                        (Env.Structure,
                                                         (Some 1)));
                                                       ("ack",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("req",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("store",
                                                        (Env.Channel,
                                                         (Some 1)))
                                                       ])
                                                } }
                         ]); env = { Env.vars =
                                     [(("v", 26), (Env.Var (Syntax.Loc 26)));
                                       (("tamper_channel", 0), Env.Attack);
                                       (("provide", 0), (Env.ExtSyscall 0));
                                       (("read", 0), (Env.ExtSyscall 0));
                                       (("gen_message", 0),
                                        (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("vk", 0), (Env.ExtFun 1));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyParamProduct (
                                               (Env.TyParamSecurity
                                                  "client_msg"),
                                               (Env.TyParamSecurity
                                                  "client_sig")
                                               ))
                                             ]));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("sign_key_alice", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TyParamSecurity "client_msg")
                                             ]
                                           )));
                                       (("client_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_msg", 0),
                                        (Env.SecurityTypeDef ("message", [])));
                                       (("attacker_ty", 0), Env.ProcTypeDef);
                                       (("bob_t", 0), Env.ProcTypeDef);
                                       (("alice_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("message", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []))
                                       ];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("tamper_channel", 0),
                                                     Env.Attack);
                                                     (("provide", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("read", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("gen_message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Allow {process_typ = ("alice_t", 0); target_typs = [];
           syscalls = (Some [("eaves_mem", 0)])}; env = { Env.vars =
                                                          [(("eaves_mem", 0),
                                                            (Env.ExtSyscall 1));
                                                            (("tamper_channel",
                                                              0),
                                                             Env.Attack);
                                                            (("provide", 0),
                                                             (Env.ExtSyscall
                                                                0));
                                                            (("read", 0),
                                                             (Env.ExtSyscall
                                                                0));
                                                            (("gen_message",
                                                              0),
                                                             (Env.ExtSyscall
                                                                0));
                                                            (("accept_rpc", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("close_rpc", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("invoke_rpc", 0),
                                                             (Env.ExtSyscall
                                                                4));
                                                            (("connect_rpc",
                                                              0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("recv", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("send", 0),
                                                             (Env.ExtSyscall
                                                                2));
                                                            (("verify", 0),
                                                             (Env.ExtFun 3));
                                                            (("true", 0),
                                                             Env.ExtConst);
                                                            (("snd", 0),
                                                             (Env.ExtFun 1));
                                                            (("fst", 0),
                                                             (Env.ExtFun 1));
                                                            (("sign", 0),
                                                             (Env.ExtFun 2));
                                                            (("vk", 0),
                                                             (Env.ExtFun 1));
                                                            (("udp_t", 0),
                                                             (Env.ChanTypeDef
                                                                [(Env.TyParamProduct (
                                                                    (
                                                                    Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (
                                                                    Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))
                                                                  ]));
                                                            (("conn_client",
                                                              0),
                                                             (Env.SecurityTypeDef (
                                                                "connection",
                                                                [])));
                                                            (("sign_key_alice",
                                                              0),
                                                             (Env.SecurityTypeDef (
                                                                "sigkey",
                                                                [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                  ]
                                                                )));
                                                            (("client_sig", 0),
                                                             (Env.SecurityTypeDef (
                                                                "signature",
                                                                [])));
                                                            (("client_msg", 0),
                                                             (Env.SecurityTypeDef (
                                                                "message", 
                                                                [])));
                                                            (("attacker_ty",
                                                              0),
                                                             Env.ProcTypeDef);
                                                            (("bob_t", 0),
                                                             Env.ProcTypeDef);
                                                            (("alice_t", 0),
                                                             Env.ProcTypeDef);
                                                            (("readonly_t", 0),
                                                             Env.FilesysTypeDef);
                                                            (("verkey", 0),
                                                             (Env.SimpleTypeDef
                                                                ["'a"]));
                                                            (("sigkey", 0),
                                                             (Env.SimpleTypeDef
                                                                ["'a"]));
                                                            (("signature", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("message", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("connection", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("unit", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("bool", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("string", 0),
                                                             (Env.SimpleTypeDef
                                                                []))
                                                            ];
                                                          facts =
                                                          ref ([("BobClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                 ("IntegrityFail",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("IntegritySuccess",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("AliceClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                 ("MsgSend",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("Out",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("In",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("exit",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("Returned",
                                                                  (Env.Channel,
                                                                   (Some 1)));
                                                                 ("invoke",
                                                                  (Env.Channel,
                                                                   (Some 3)));
                                                                 ("conn",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("chid",
                                                                  (Env.Structure,
                                                                   (Some 1)));
                                                                 ("ack",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("req",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("store",
                                                                  (Env.Channel,
                                                                   (Some 1)))
                                                                 ])
                                                          } }
{ desc = Typed.Allow {process_typ = ("bob_t", 0); target_typs = [];
           syscalls = (Some [("eaves_mem", 0)])}; env = { Env.vars =
                                                          [(("eaves_mem", 0),
                                                            (Env.ExtSyscall 1));
                                                            (("tamper_channel",
                                                              0),
                                                             Env.Attack);
                                                            (("provide", 0),
                                                             (Env.ExtSyscall
                                                                0));
                                                            (("read", 0),
                                                             (Env.ExtSyscall
                                                                0));
                                                            (("gen_message",
                                                              0),
                                                             (Env.ExtSyscall
                                                                0));
                                                            (("accept_rpc", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("close_rpc", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("invoke_rpc", 0),
                                                             (Env.ExtSyscall
                                                                4));
                                                            (("connect_rpc",
                                                              0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("recv", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("send", 0),
                                                             (Env.ExtSyscall
                                                                2));
                                                            (("verify", 0),
                                                             (Env.ExtFun 3));
                                                            (("true", 0),
                                                             Env.ExtConst);
                                                            (("snd", 0),
                                                             (Env.ExtFun 1));
                                                            (("fst", 0),
                                                             (Env.ExtFun 1));
                                                            (("sign", 0),
                                                             (Env.ExtFun 2));
                                                            (("vk", 0),
                                                             (Env.ExtFun 1));
                                                            (("udp_t", 0),
                                                             (Env.ChanTypeDef
                                                                [(Env.TyParamProduct (
                                                                    (
                                                                    Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (
                                                                    Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))
                                                                  ]));
                                                            (("conn_client",
                                                              0),
                                                             (Env.SecurityTypeDef (
                                                                "connection",
                                                                [])));
                                                            (("sign_key_alice",
                                                              0),
                                                             (Env.SecurityTypeDef (
                                                                "sigkey",
                                                                [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                  ]
                                                                )));
                                                            (("client_sig", 0),
                                                             (Env.SecurityTypeDef (
                                                                "signature",
                                                                [])));
                                                            (("client_msg", 0),
                                                             (Env.SecurityTypeDef (
                                                                "message", 
                                                                [])));
                                                            (("attacker_ty",
                                                              0),
                                                             Env.ProcTypeDef);
                                                            (("bob_t", 0),
                                                             Env.ProcTypeDef);
                                                            (("alice_t", 0),
                                                             Env.ProcTypeDef);
                                                            (("readonly_t", 0),
                                                             Env.FilesysTypeDef);
                                                            (("verkey", 0),
                                                             (Env.SimpleTypeDef
                                                                ["'a"]));
                                                            (("sigkey", 0),
                                                             (Env.SimpleTypeDef
                                                                ["'a"]));
                                                            (("signature", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("message", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("connection", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("unit", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("bool", 0),
                                                             (Env.SimpleTypeDef
                                                                []));
                                                            (("string", 0),
                                                             (Env.SimpleTypeDef
                                                                []))
                                                            ];
                                                          facts =
                                                          ref ([("BobClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                 ("IntegrityFail",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("IntegritySuccess",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("AliceClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                 ("MsgSend",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("Out",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("In",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("exit",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("Returned",
                                                                  (Env.Channel,
                                                                   (Some 1)));
                                                                 ("invoke",
                                                                  (Env.Channel,
                                                                   (Some 3)));
                                                                 ("conn",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("chid",
                                                                  (Env.Structure,
                                                                   (Some 1)));
                                                                 ("ack",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("req",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("store",
                                                                  (Env.Channel,
                                                                   (Some 1)))
                                                                 ])
                                                          } }
{ desc = Typed.Allow {process_typ = ("alice_t", 0);
           target_typs = [("udp_t", 0)];
           syscalls = (Some [("send", 0); ("recv", 0)])}; env = { Env.vars =
                                                                  [((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "provide",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "read", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "gen_message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    (
                                                                    (
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
{ desc = Typed.Allow {process_typ = ("bob_t", 0);
           target_typs = [("udp_t", 0)];
           syscalls = (Some [("send", 0); ("recv", 0)])}; env = { Env.vars =
                                                                  [((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "provide",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "read", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "gen_message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    (
                                                                    (
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
{ desc = Typed.Allow {process_typ = ("alice_t", 0); target_typs = [];
           syscalls = (Some [("gen_message", 0)])}; env = { Env.vars =
                                                            [(("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("provide", 0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("read", 0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("gen_message",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("vk", 0),
                                                               (Env.ExtFun 1));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                              (("conn_client",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "connection",
                                                                  [])));
                                                              (("sign_key_alice",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "sigkey",
                                                                  [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                  )));
                                                              (("client_sig",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "signature",
                                                                  [])));
                                                              (("client_msg",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "message",
                                                                  [])));
                                                              (("attacker_ty",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("bob_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("alice_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("verkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("sigkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("signature",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("message", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("connection",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("unit", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("bool", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("string", 0),
                                                               (Env.SimpleTypeDef
                                                                  []))
                                                              ];
                                                            facts =
                                                            ref ([("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } }
{ desc = Typed.Allow {process_typ = ("bob_t", 0); target_typs = [];
           syscalls = (Some [("gen_message", 0)])}; env = { Env.vars =
                                                            [(("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("provide", 0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("read", 0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("gen_message",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("vk", 0),
                                                               (Env.ExtFun 1));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                              (("conn_client",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "connection",
                                                                  [])));
                                                              (("sign_key_alice",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "sigkey",
                                                                  [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                  )));
                                                              (("client_sig",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "signature",
                                                                  [])));
                                                              (("client_msg",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "message",
                                                                  [])));
                                                              (("attacker_ty",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("bob_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("alice_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("verkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("sigkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("signature",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("message", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("connection",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("unit", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("bool", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("string", 0),
                                                               (Env.SimpleTypeDef
                                                                  []))
                                                              ];
                                                            facts =
                                                            ref ([("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } }
{ desc = Typed.Allow {process_typ = ("alice_t", 0);
           target_typs = [("client_msg", 0)];
           syscalls = (Some [("gen_message", 0); ("send", 0); ("recv", 0)])}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("alice_t", 0);
           target_typs = [("client_sig", 0)]; syscalls = (Some [("send", 0)])}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("alice_t", 0);
           target_typs = [("client_sig", 0)]; syscalls = None}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("alice_t", 0);
           target_typs = [("sign_key_alice", 0)]; syscalls = None}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("bob_t", 0);
           target_typs = [("client_msg", 0)];
           syscalls = (Some [("gen_message", 0); ("send", 0); ("recv", 0)])}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("bob_t", 0);
           target_typs = [("client_sig", 0)]; syscalls = (Some [("send", 0)])}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("bob_t", 0);
           target_typs = [("client_sig", 0)]; syscalls = None}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("attacker_ty", 0);
           target_typs = [("client_msg", 0)];
           syscalls = (Some [("read", 0); ("provide", 0)])}; env = { Env.vars =
                                                                    [((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
{ desc = Typed.Allow {process_typ = ("attacker_ty", 0);
           target_typs = [("client_sig", 0)];
           syscalls = (Some [("read", 0); ("provide", 0)])}; env = { Env.vars =
                                                                    [((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
{ desc = Typed.Init {id = ("secret_key_alice", 0); desc = Typed.Fresh}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.ChannelDecl {id = ("udp", 0); param = None; typ = ("udp_t", 0)}; env = 
{ Env.vars =
  [(("secret_key_alice", 0),
    (Env.Const (false, (Some (Env.TySecurity "sign_key_alice")))));
    (("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("provide", 0), (Env.ExtSyscall 0)); (("read", 0), (Env.ExtSyscall 0));
    (("gen_message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
    (("udp_t", 0),
     (Env.ChanTypeDef
        [(Env.TyParamProduct ((Env.TyParamSecurity "client_msg"),
            (Env.TyParamSecurity "client_sig")))
          ]));
    (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
    (("sign_key_alice", 0),
     (Env.SecurityTypeDef ("sigkey", [(Env.TyParamSecurity "client_msg")])));
    (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
    (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
    (("attacker_ty", 0), Env.ProcTypeDef); (("bob_t", 0), Env.ProcTypeDef);
    (("alice_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
    (("signature", 0), (Env.SimpleTypeDef []));
    (("message", 0), (Env.SimpleTypeDef []));
    (("connection", 0), (Env.SimpleTypeDef []));
    (("unit", 0), (Env.SimpleTypeDef []));
    (("bool", 0), (Env.SimpleTypeDef []));
    (("string", 0), (Env.SimpleTypeDef []))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Process {id = ("alice", 0); param = None;
           args =
           [{ Typed.channel = ("ch_net", 27); param = None;
              typ = ("udp_t", 0) }
             ];
           typ = ("alice_t", 0); files = [];
           vars =
           [(("priv_key_alice", 28), None,
             { desc = Typed.Ident {id = ("secret_key_alice", 0);
                        desc =
                        (Env.Const (false,
                           (Some (Env.TySecurity "sign_key_alice"))));
                        param = None}; env = { Env.vars =
                                               [(("ch_net", 27),
                                                 (Env.ChannelDecl (false,
                                                    ("udp_t", 0))));
                                                 (("udp", 0),
                                                  (Env.ChannelDecl (false,
                                                     ("udp_t", 0))));
                                                 (("secret_key_alice", 0),
                                                  (Env.Const (false,
                                                     (Some (Env.TySecurity
                                                              "sign_key_alice"))
                                                     )));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("provide", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("read", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("gen_message", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("vk", 0), (Env.ExtFun 1));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyParamProduct (
                                                         (Env.TyParamSecurity
                                                            "client_msg"),
                                                         (Env.TyParamSecurity
                                                            "client_sig")
                                                         ))
                                                       ]));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("sign_key_alice", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TyParamSecurity
                                                         "client_msg")
                                                       ]
                                                     )));
                                                 (("client_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_msg", 0),
                                                  (Env.SecurityTypeDef (
                                                     "message", [])));
                                                 (("attacker_ty", 0),
                                                  Env.ProcTypeDef);
                                                 (("bob_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("alice_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("message", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } })
             ];
           funcs = [];
           main =
           { desc = (Typed.Let (("msg", 29),
                       { desc = (Typed.Apply (("gen_message", 0), [])); env = 
                       { Env.vars =
                         [(("priv_key_alice", 28), (Env.Var (Syntax.Loc 28)));
                           (("ch_net", 27),
                            (Env.ChannelDecl (false, ("udp_t", 0))));
                           (("udp", 0),
                            (Env.ChannelDecl (false, ("udp_t", 0))));
                           (("secret_key_alice", 0),
                            (Env.Const (false,
                               (Some (Env.TySecurity "sign_key_alice")))));
                           (("eaves_mem", 0), (Env.ExtSyscall 1));
                           (("tamper_channel", 0), Env.Attack);
                           (("provide", 0), (Env.ExtSyscall 0));
                           (("read", 0), (Env.ExtSyscall 0));
                           (("gen_message", 0), (Env.ExtSyscall 0));
                           (("accept_rpc", 0), (Env.ExtSyscall 1));
                           (("close_rpc", 0), (Env.ExtSyscall 1));
                           (("invoke_rpc", 0), (Env.ExtSyscall 4));
                           (("connect_rpc", 0), (Env.ExtSyscall 1));
                           (("recv", 0), (Env.ExtSyscall 1));
                           (("send", 0), (Env.ExtSyscall 2));
                           (("verify", 0), (Env.ExtFun 3));
                           (("true", 0), Env.ExtConst);
                           (("snd", 0), (Env.ExtFun 1));
                           (("fst", 0), (Env.ExtFun 1));
                           (("sign", 0), (Env.ExtFun 2));
                           (("vk", 0), (Env.ExtFun 1));
                           (("udp_t", 0),
                            (Env.ChanTypeDef
                               [(Env.TyParamProduct (
                                   (Env.TyParamSecurity "client_msg"),
                                   (Env.TyParamSecurity "client_sig")))
                                 ]));
                           (("conn_client", 0),
                            (Env.SecurityTypeDef ("connection", [])));
                           (("sign_key_alice", 0),
                            (Env.SecurityTypeDef ("sigkey",
                               [(Env.TyParamSecurity "client_msg")])));
                           (("client_sig", 0),
                            (Env.SecurityTypeDef ("signature", [])));
                           (("client_msg", 0),
                            (Env.SecurityTypeDef ("message", [])));
                           (("attacker_ty", 0), Env.ProcTypeDef);
                           (("bob_t", 0), Env.ProcTypeDef);
                           (("alice_t", 0), Env.ProcTypeDef);
                           (("readonly_t", 0), Env.FilesysTypeDef);
                           (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                           (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                           (("signature", 0), (Env.SimpleTypeDef []));
                           (("message", 0), (Env.SimpleTypeDef []));
                           (("connection", 0), (Env.SimpleTypeDef []));
                           (("unit", 0), (Env.SimpleTypeDef []));
                           (("bool", 0), (Env.SimpleTypeDef []));
                           (("string", 0), (Env.SimpleTypeDef []))];
                         facts =
                         ref ([("BobClose", (Env.Global, (Some 0)));
                                ("IntegrityFail", (Env.Global, (Some 1)));
                                ("IntegritySuccess", (Env.Global, (Some 1)));
                                ("AliceClose", (Env.Global, (Some 0)));
                                ("MsgSend", (Env.Global, (Some 1)));
                                ("Out", (Env.Global, (Some 1)));
                                ("In", (Env.Global, (Some 1)));
                                ("exit", (Env.Channel, (Some 0)));
                                ("Returned", (Env.Channel, (Some 1)));
                                ("invoke", (Env.Channel, (Some 3)));
                                ("conn", (Env.Channel, (Some 0)));
                                ("chid", (Env.Structure, (Some 1)));
                                ("ack", (Env.Channel, (Some 0)));
                                ("req", (Env.Channel, (Some 0)));
                                ("store", (Env.Channel, (Some 1)))])
                         } },
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Assign (None,
                                               { desc = (Typed.Apply (
                                                           ("eaves_mem", 0),
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("msg", 29);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    29));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("msg", 29),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    29)));
                                                                 (("priv_key_alice",
                                                                   28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("secret_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("provide",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("read", 0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("gen_message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]
                                                           )); env = 
                                               { Env.vars =
                                                 [(("msg", 29),
                                                   (Env.Var (Syntax.Loc 29)));
                                                   (("priv_key_alice", 28),
                                                    (Env.Var (Syntax.Loc 28)));
                                                   (("ch_net", 27),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("udp", 0),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("secret_key_alice", 0),
                                                    (Env.Const (false,
                                                       (Some (Env.TySecurity
                                                                "sign_key_alice"))
                                                       )));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("provide", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("read", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("gen_message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                                               )); env = { Env.vars =
                                                           [(("msg", 29),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   29)));
                                                             (("priv_key_alice",
                                                               28),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    28)));
                                                             (("ch_net", 27),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("secret_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false,
                                                                 (Some (
                                                                 Env.TySecurity
                                                                   "sign_key_alice"))
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("provide", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("read", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("gen_message",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("vk", 0),
                                                              (Env.ExtFun 1));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))
                                                                   ]));
                                                             (("conn_client",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "connection",
                                                                 [])));
                                                             (("sign_key_alice",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "sigkey",
                                                                 [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                   ]
                                                                 )));
                                                             (("client_sig",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "signature",
                                                                 [])));
                                                             (("client_msg",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "message",
                                                                 [])));
                                                             (("attacker_ty",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("bob_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("alice_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("verkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("sigkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("signature", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("message", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("connection",
                                                               0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("unit", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("bool", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("string", 0),
                                                              (Env.SimpleTypeDef
                                                                 []))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } },
                                   { desc = (Typed.Let (("sig", 30),
                                               { desc = (Typed.Apply (
                                                           ("sign", 0),
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("msg", 29);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    29));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("msg", 29),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    29)));
                                                                 (("priv_key_alice",
                                                                   28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("secret_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("provide",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("read", 0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("gen_message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("priv_key_alice",
                                                                28);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    28));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("msg", 29),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    29)));
                                                                 (("priv_key_alice",
                                                                   28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("secret_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("provide",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("read", 0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("gen_message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]
                                                           )); env = 
                                               { Env.vars =
                                                 [(("msg", 29),
                                                   (Env.Var (Syntax.Loc 29)));
                                                   (("priv_key_alice", 28),
                                                    (Env.Var (Syntax.Loc 28)));
                                                   (("ch_net", 27),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("udp", 0),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("secret_key_alice", 0),
                                                    (Env.Const (false,
                                                       (Some (Env.TySecurity
                                                                "sign_key_alice"))
                                                       )));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("provide", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("read", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("gen_message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               { desc = (Typed.Sequence (
                                                           { desc = (
                                                           Typed.Assign (
                                                             None,
                                                             { desc = (
                                                             Typed.Apply (
                                                               ("eaves_mem",
                                                                0),
                                                               [{ desc = 
                                                                 Typed.Ident {
                                                                   id =
                                                                   ("sig", 30);
                                                                   desc =
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    30));
                                                                   param =
                                                                   None}; env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 ]
                                                               )); env = 
                                                             { Env.vars =
                                                               [(("sig", 30),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    30)));
                                                                 (("msg", 29),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                 (("priv_key_alice",
                                                                   28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("secret_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("provide",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("read", 0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("gen_message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             )); env = 
                                                           { Env.vars =
                                                             [(("sig", 30),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    30)));
                                                               (("msg", 29),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    29)));
                                                               (("priv_key_alice",
                                                                 28),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    28)));
                                                               (("ch_net", 27),
                                                                (Env.ChannelDecl (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.ChannelDecl (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("secret_key_alice",
                                                                 0),
                                                                (Env.Const (
                                                                   false,
                                                                   (Some (
                                                                   Env.TySecurity
                                                                    "sign_key_alice"))
                                                                   )));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("provide", 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("read", 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("gen_message",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
                                                           { desc = (
                                                           Typed.Sequence (
                                                             { desc = (
                                                             Typed.Event
                                                               [{ desc = (
                                                                 Typed.Global (
                                                                   "MsgSend",
                                                                   [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg", 29);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 ]); env = 
                                                             { Env.vars =
                                                               [(("sig", 30),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    30)));
                                                                 (("msg", 29),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                 (("priv_key_alice",
                                                                   28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("secret_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("provide",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("read", 0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("gen_message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } },
                                                             { desc = (
                                                             Typed.Sequence (
                                                               { desc = (
                                                               Typed.Assign (
                                                                 None,
                                                                 { desc = (
                                                                 Typed.Apply (
                                                                   ("send", 0),
                                                                   [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "ch_net",
                                                                    27);
                                                                    desc =
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0)));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = (
                                                                    Typed.Tuple
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg", 29);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig", 30);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    30));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 )); env = 
                                                               { Env.vars =
                                                                 [(("sig", 30),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                   ((
                                                                    "msg", 29),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                   ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                   ((
                                                                    "ch_net",
                                                                    27),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "provide",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "read", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "gen_message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                   ((
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                   ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                   ((
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                   ((
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                   ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } },
                                                               { desc = (
                                                               Typed.Event
                                                                 [{ desc = (
                                                                   Typed.Global (
                                                                    "AliceClose",
                                                                    [])); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   ]); env = 
                                                               { Env.vars =
                                                                 [(("sig", 30),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                   ((
                                                                    "msg", 29),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                   ((
                                                                    "priv_key_alice",
                                                                    28),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                   ((
                                                                    "ch_net",
                                                                    27),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "provide",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "read", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "gen_message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                   ((
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                   ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                   ((
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                   ((
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                   ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               )); env = 
                                                             { Env.vars =
                                                               [(("sig", 30),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    30)));
                                                                 (("msg", 29),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                 (("priv_key_alice",
                                                                   28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("secret_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("provide",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("read", 0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("gen_message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             )); env = 
                                                           { Env.vars =
                                                             [(("sig", 30),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    30)));
                                                               (("msg", 29),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    29)));
                                                               (("priv_key_alice",
                                                                 28),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    28)));
                                                               (("ch_net", 27),
                                                                (Env.ChannelDecl (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.ChannelDecl (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("secret_key_alice",
                                                                 0),
                                                                (Env.Const (
                                                                   false,
                                                                   (Some (
                                                                   Env.TySecurity
                                                                    "sign_key_alice"))
                                                                   )));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("provide", 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("read", 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("gen_message",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("vk", 0),
                                                                (Env.ExtFun 1));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                                           )); env = 
                                               { Env.vars =
                                                 [(("sig", 30),
                                                   (Env.Var (Syntax.Loc 30)));
                                                   (("msg", 29),
                                                    (Env.Var (Syntax.Loc 29)));
                                                   (("priv_key_alice", 28),
                                                    (Env.Var (Syntax.Loc 28)));
                                                   (("ch_net", 27),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("udp", 0),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("secret_key_alice", 0),
                                                    (Env.Const (false,
                                                       (Some (Env.TySecurity
                                                                "sign_key_alice"))
                                                       )));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("provide", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("read", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("gen_message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                                               )); env = { Env.vars =
                                                           [(("msg", 29),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   29)));
                                                             (("priv_key_alice",
                                                               28),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    28)));
                                                             (("ch_net", 27),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("secret_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false,
                                                                 (Some (
                                                                 Env.TySecurity
                                                                   "sign_key_alice"))
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("provide", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("read", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("gen_message",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("vk", 0),
                                                              (Env.ExtFun 1));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))
                                                                   ]));
                                                             (("conn_client",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "connection",
                                                                 [])));
                                                             (("sign_key_alice",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "sigkey",
                                                                 [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                   ]
                                                                 )));
                                                             (("client_sig",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "signature",
                                                                 [])));
                                                             (("client_msg",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "message",
                                                                 [])));
                                                             (("attacker_ty",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("bob_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("alice_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("verkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("sigkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("signature", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("message", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("connection",
                                                               0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("unit", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("bool", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("string", 0),
                                                              (Env.SimpleTypeDef
                                                                 []))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } }
                                   )); env = { Env.vars =
                                               [(("msg", 29),
                                                 (Env.Var (Syntax.Loc 29)));
                                                 (("priv_key_alice", 28),
                                                  (Env.Var (Syntax.Loc 28)));
                                                 (("ch_net", 27),
                                                  (Env.ChannelDecl (false,
                                                     ("udp_t", 0))));
                                                 (("udp", 0),
                                                  (Env.ChannelDecl (false,
                                                     ("udp_t", 0))));
                                                 (("secret_key_alice", 0),
                                                  (Env.Const (false,
                                                     (Some (Env.TySecurity
                                                              "sign_key_alice"))
                                                     )));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("provide", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("read", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("gen_message", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("vk", 0), (Env.ExtFun 1));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyParamProduct (
                                                         (Env.TyParamSecurity
                                                            "client_msg"),
                                                         (Env.TyParamSecurity
                                                            "client_sig")
                                                         ))
                                                       ]));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("sign_key_alice", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TyParamSecurity
                                                         "client_msg")
                                                       ]
                                                     )));
                                                 (("client_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_msg", 0),
                                                  (Env.SecurityTypeDef (
                                                     "message", [])));
                                                 (("attacker_ty", 0),
                                                  Env.ProcTypeDef);
                                                 (("bob_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("alice_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("message", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("priv_key_alice", 28),
                                     (Env.Var (Syntax.Loc 28)));
                                     (("ch_net", 27),
                                      (Env.ChannelDecl (false, ("udp_t", 0))));
                                     (("udp", 0),
                                      (Env.ChannelDecl (false, ("udp_t", 0))));
                                     (("secret_key_alice", 0),
                                      (Env.Const (false,
                                         (Some (Env.TySecurity
                                                  "sign_key_alice"))
                                         )));
                                     (("eaves_mem", 0), (Env.ExtSyscall 1));
                                     (("tamper_channel", 0), Env.Attack);
                                     (("provide", 0), (Env.ExtSyscall 0));
                                     (("read", 0), (Env.ExtSyscall 0));
                                     (("gen_message", 0), (Env.ExtSyscall 0));
                                     (("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("vk", 0), (Env.ExtFun 1));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyParamProduct (
                                             (Env.TyParamSecurity
                                                "client_msg"),
                                             (Env.TyParamSecurity
                                                "client_sig")
                                             ))
                                           ]));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("sign_key_alice", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TyParamSecurity "client_msg")]
                                         )));
                                     (("client_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_msg", 0),
                                      (Env.SecurityTypeDef ("message", [])));
                                     (("attacker_ty", 0), Env.ProcTypeDef);
                                     (("bob_t", 0), Env.ProcTypeDef);
                                     (("alice_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("message", 0), (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("udp", 0),
                                                   (Env.ChannelDecl (false,
                                                      ("udp_t", 0))));
                                                   (("secret_key_alice", 0),
                                                    (Env.Const (false,
                                                       (Some (Env.TySecurity
                                                                "sign_key_alice"))
                                                       )));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("provide", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("read", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("gen_message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Process {id = ("bob", 0); param = None;
           args =
           [{ Typed.channel = ("ch_net", 31); param = None;
              typ = ("udp_t", 0) }
             ];
           typ = ("bob_t", 0); files = [];
           vars =
           [(("pub_key_alice", 32), None,
             { desc = (Typed.Apply (("vk", 0),
                         [{ desc = Typed.Ident {id = ("secret_key_alice", 0);
                                     desc =
                                     (Env.Const (false,
                                        (Some (Env.TySecurity
                                                 "sign_key_alice"))
                                        ));
                                     param = None}; env = { Env.vars =
                                                            [(("ch_net", 31),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                              (("alice", 0),
                                                               Env.Process);
                                                              (("udp", 0),
                                                               (Env.ChannelDecl (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("secret_key_alice",
                                                                0),
                                                               (Env.Const (
                                                                  false,
                                                                  (Some (
                                                                  Env.TySecurity
                                                                    "sign_key_alice"))
                                                                  )));
                                                              (("eaves_mem",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("provide", 0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("read", 0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("gen_message",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("vk", 0),
                                                               (Env.ExtFun 1));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                              (("conn_client",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "connection",
                                                                  [])));
                                                              (("sign_key_alice",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "sigkey",
                                                                  [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ]
                                                                  )));
                                                              (("client_sig",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "signature",
                                                                  [])));
                                                              (("client_msg",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "message",
                                                                  [])));
                                                              (("attacker_ty",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("bob_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("alice_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("verkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("sigkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("signature",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("message", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("connection",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("unit", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("bool", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("string", 0),
                                                               (Env.SimpleTypeDef
                                                                  []))
                                                              ];
                                                            facts =
                                                            ref ([("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } }
                           ]
                         )); env = { Env.vars =
                                     [(("ch_net", 31),
                                       (Env.ChannelDecl (false, ("udp_t", 0)
                                          )));
                                       (("alice", 0), Env.Process);
                                       (("udp", 0),
                                        (Env.ChannelDecl (false, ("udp_t", 0)
                                           )));
                                       (("secret_key_alice", 0),
                                        (Env.Const (false,
                                           (Some (Env.TySecurity
                                                    "sign_key_alice"))
                                           )));
                                       (("eaves_mem", 0), (Env.ExtSyscall 1));
                                       (("tamper_channel", 0), Env.Attack);
                                       (("provide", 0), (Env.ExtSyscall 0));
                                       (("read", 0), (Env.ExtSyscall 0));
                                       (("gen_message", 0),
                                        (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("vk", 0), (Env.ExtFun 1));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyParamProduct (
                                               (Env.TyParamSecurity
                                                  "client_msg"),
                                               (Env.TyParamSecurity
                                                  "client_sig")
                                               ))
                                             ]));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("sign_key_alice", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TyParamSecurity "client_msg")
                                             ]
                                           )));
                                       (("client_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_msg", 0),
                                        (Env.SecurityTypeDef ("message", [])));
                                       (("attacker_ty", 0), Env.ProcTypeDef);
                                       (("bob_t", 0), Env.ProcTypeDef);
                                       (("alice_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("message", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []))
                                       ];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } })
             ];
           funcs = [];
           main =
           { desc = (Typed.Let (("msg_with_sig", 33),
                       { desc = (Typed.Apply (("recv", 0),
                                   [{ desc = Typed.Ident {
                                               id = ("ch_net", 31);
                                               desc =
                                               (Env.ChannelDecl (false,
                                                  ("udp_t", 0)));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]
                                   )); env = { Env.vars =
                                               [(("pub_key_alice", 32),
                                                 (Env.Var (Syntax.Loc 32)));
                                                 (("ch_net", 31),
                                                  (Env.ChannelDecl (false,
                                                     ("udp_t", 0))));
                                                 (("alice", 0), Env.Process);
                                                 (("udp", 0),
                                                  (Env.ChannelDecl (false,
                                                     ("udp_t", 0))));
                                                 (("secret_key_alice", 0),
                                                  (Env.Const (false,
                                                     (Some (Env.TySecurity
                                                              "sign_key_alice"))
                                                     )));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("provide", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("read", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("gen_message", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("vk", 0), (Env.ExtFun 1));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyParamProduct (
                                                         (Env.TyParamSecurity
                                                            "client_msg"),
                                                         (Env.TyParamSecurity
                                                            "client_sig")
                                                         ))
                                                       ]));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("sign_key_alice", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TyParamSecurity
                                                         "client_msg")
                                                       ]
                                                     )));
                                                 (("client_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_msg", 0),
                                                  (Env.SecurityTypeDef (
                                                     "message", [])));
                                                 (("attacker_ty", 0),
                                                  Env.ProcTypeDef);
                                                 (("bob_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("alice_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("message", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } },
                       { desc = (Typed.Let (("res", 34),
                                   { desc = (Typed.Apply (("verify", 0),
                                               [{ desc = (Typed.Apply (
                                                            ("snd", 0),
                                                            [{ desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("msg_with_sig",
                                                                 33);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    33));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("msg_with_sig",
                                                                   33),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                  (("pub_key_alice",
                                                                    32),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                  (("ch_net",
                                                                    31),
                                                                   (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("alice",
                                                                    0),
                                                                   Env.Process);
                                                                  (("udp", 0),
                                                                   (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("secret_key_alice",
                                                                    0),
                                                                   (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("provide",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("read", 0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("gen_message",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("sign_key_alice",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                  (("client_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_msg",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                  (("attacker_ty",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("bob_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("alice_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("message",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              ]
                                                            )); env = 
                                                 { Env.vars =
                                                   [(("msg_with_sig", 33),
                                                     (Env.Var (Syntax.Loc 33)));
                                                     (("pub_key_alice", 32),
                                                      (Env.Var
                                                         (Syntax.Loc 32)));
                                                     (("ch_net", 31),
                                                      (Env.ChannelDecl (
                                                         false, ("udp_t", 0)
                                                         )));
                                                     (("alice", 0),
                                                      Env.Process);
                                                     (("udp", 0),
                                                      (Env.ChannelDecl (
                                                         false, ("udp_t", 0)
                                                         )));
                                                     (("secret_key_alice", 0),
                                                      (Env.Const (false,
                                                         (Some (Env.TySecurity
                                                                  "sign_key_alice"))
                                                         )));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("provide", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("read", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("gen_message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } };
                                                 { desc = (Typed.Apply (
                                                             ("fst", 0),
                                                             [{ desc = 
                                                               Typed.Ident {
                                                                 id =
                                                                 ("msg_with_sig",
                                                                  33);
                                                                 desc =
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    33));
                                                                 param = None}; env = 
                                                               { Env.vars =
                                                                 [(("msg_with_sig",
                                                                    33),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                   ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                   ((
                                                                    "ch_net",
                                                                    31),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "provide",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "read", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "gen_message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                   ((
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                   ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                   ((
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                   ((
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                   ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               ]
                                                             )); env = 
                                                 { Env.vars =
                                                   [(("msg_with_sig", 33),
                                                     (Env.Var (Syntax.Loc 33)));
                                                     (("pub_key_alice", 32),
                                                      (Env.Var
                                                         (Syntax.Loc 32)));
                                                     (("ch_net", 31),
                                                      (Env.ChannelDecl (
                                                         false, ("udp_t", 0)
                                                         )));
                                                     (("alice", 0),
                                                      Env.Process);
                                                     (("udp", 0),
                                                      (Env.ChannelDecl (
                                                         false, ("udp_t", 0)
                                                         )));
                                                     (("secret_key_alice", 0),
                                                      (Env.Const (false,
                                                         (Some (Env.TySecurity
                                                                  "sign_key_alice"))
                                                         )));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("provide", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("read", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("gen_message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } };
                                                 { desc = Typed.Ident {
                                                            id =
                                                            ("pub_key_alice",
                                                             32);
                                                            desc =
                                                            (Env.Var
                                                               (Syntax.Loc 32));
                                                            param = None}; env = 
                                                 { Env.vars =
                                                   [(("msg_with_sig", 33),
                                                     (Env.Var (Syntax.Loc 33)));
                                                     (("pub_key_alice", 32),
                                                      (Env.Var
                                                         (Syntax.Loc 32)));
                                                     (("ch_net", 31),
                                                      (Env.ChannelDecl (
                                                         false, ("udp_t", 0)
                                                         )));
                                                     (("alice", 0),
                                                      Env.Process);
                                                     (("udp", 0),
                                                      (Env.ChannelDecl (
                                                         false, ("udp_t", 0)
                                                         )));
                                                     (("secret_key_alice", 0),
                                                      (Env.Const (false,
                                                         (Some (Env.TySecurity
                                                                  "sign_key_alice"))
                                                         )));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("provide", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("read", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("gen_message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("vk", 0),
                                                      (Env.ExtFun 1));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyParamProduct (
                                                             (Env.TyParamSecurity
                                                                "client_msg"),
                                                             (Env.TyParamSecurity
                                                                "client_sig")
                                                             ))
                                                           ]));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("sign_key_alice", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TyParamSecurity
                                                             "client_msg")
                                                           ]
                                                         )));
                                                     (("client_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_msg", 0),
                                                      (Env.SecurityTypeDef (
                                                         "message", [])));
                                                     (("attacker_ty", 0),
                                                      Env.ProcTypeDef);
                                                     (("bob_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("alice_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("message", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]
                                               )); env = { Env.vars =
                                                           [(("msg_with_sig",
                                                              33),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   33)));
                                                             (("pub_key_alice",
                                                               32),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    32)));
                                                             (("ch_net", 31),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("alice", 0),
                                                              Env.Process);
                                                             (("udp", 0),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("secret_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false,
                                                                 (Some (
                                                                 Env.TySecurity
                                                                   "sign_key_alice"))
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("provide", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("read", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("gen_message",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("vk", 0),
                                                              (Env.ExtFun 1));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))
                                                                   ]));
                                                             (("conn_client",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "connection",
                                                                 [])));
                                                             (("sign_key_alice",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "sigkey",
                                                                 [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                   ]
                                                                 )));
                                                             (("client_sig",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "signature",
                                                                 [])));
                                                             (("client_msg",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "message",
                                                                 [])));
                                                             (("attacker_ty",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("bob_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("alice_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("verkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("sigkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("signature", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("message", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("connection",
                                                               0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("unit", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("bool", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("string", 0),
                                                              (Env.SimpleTypeDef
                                                                 []))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } },
                                   { desc = (Typed.Sequence (
                                               { desc = (Typed.Case
                                                           [{ Typed.fresh =
                                                              [];
                                                              facts =
                                                              [{ desc = (
                                                                Typed.Eq (
                                                                  { desc = 
                                                                  Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 34);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    34));
                                                                    param =
                                                                    None}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                  { desc = 
                                                                  Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    Env.ExtConst;
                                                                    param =
                                                                    None}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  )); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "res", 34),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    (
                                                                    (
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    (
                                                                    (
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    31),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "provide",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "read", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "gen_message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    (
                                                                    (
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ];
                                                              cmd =
                                                              { desc = (
                                                              Typed.Event
                                                                [{ desc = (
                                                                  Typed.Global (
                                                                    "IntegritySuccess",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("fst", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg_with_sig",
                                                                    33);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  ]); env = 
                                                              { Env.vars =
                                                                [(("res", 34),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                  (("msg_with_sig",
                                                                    33),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                  (("pub_key_alice",
                                                                    32),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                  (("ch_net",
                                                                    31),
                                                                   (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("alice",
                                                                    0),
                                                                   Env.Process);
                                                                  (("udp", 0),
                                                                   (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("secret_key_alice",
                                                                    0),
                                                                   (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("provide",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("read", 0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("gen_message",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("sign_key_alice",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                  (("client_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_msg",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                  (("attacker_ty",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("bob_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("alice_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("message",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              };
                                                             { Typed.fresh =
                                                               [];
                                                               facts =
                                                               [{ desc = (
                                                                 Typed.Neq (
                                                                   { desc = 
                                                                   Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 34);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    34));
                                                                    param =
                                                                    None}; env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                   { desc = 
                                                                   Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    Env.ExtConst;
                                                                    param =
                                                                    None}; env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 ];
                                                               cmd =
                                                               { desc = (
                                                               Typed.Event
                                                                 [{ desc = (
                                                                   Typed.Global (
                                                                    "IntegrityFail",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("fst", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg_with_sig",
                                                                    33);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "provide",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "read", 0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "gen_message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                    ((
                                                                    "client_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_msg",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                    ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   ]); env = 
                                                               { Env.vars =
                                                                 [(("res", 34),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                   ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                   ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                   ((
                                                                    "ch_net",
                                                                    31),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "secret_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "provide",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "read", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "gen_message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                   ((
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                   ((
                                                                    "sign_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                   ((
                                                                    "client_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                   ((
                                                                    "client_msg",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                   ((
                                                                    "attacker_ty",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "bob_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "alice_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               }
                                                             ]); env = 
                                               { Env.vars =
                                                 [(("res", 34),
                                                   (Env.Var (Syntax.Loc 34)));
                                                   (("msg_with_sig", 33),
                                                    (Env.Var (Syntax.Loc 33)));
                                                   (("pub_key_alice", 32),
                                                    (Env.Var (Syntax.Loc 32)));
                                                   (("ch_net", 31),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("alice", 0), Env.Process);
                                                   (("udp", 0),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("secret_key_alice", 0),
                                                    (Env.Const (false,
                                                       (Some (Env.TySecurity
                                                                "sign_key_alice"))
                                                       )));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("provide", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("read", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("gen_message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               { desc = (Typed.Event
                                                           [{ desc = (
                                                             Typed.Global (
                                                               "BobClose", 
                                                               [])); env = 
                                                             { Env.vars =
                                                               [(("res", 34),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    34)));
                                                                 (("msg_with_sig",
                                                                   33),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                 (("pub_key_alice",
                                                                   32),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                 (("ch_net",
                                                                   31),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("alice", 0),
                                                                  Env.Process);
                                                                 (("udp", 0),
                                                                  (Env.ChannelDecl (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("secret_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    (Some (
                                                                    Env.TySecurity
                                                                    "sign_key_alice"))
                                                                    )));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("provide",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("read", 0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("gen_message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))]));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("sign_key_alice",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                    ])));
                                                                 (("client_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_msg",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                 (("attacker_ty",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("bob_t", 0),
                                                                  Env.ProcTypeDef);
                                                                 (("alice_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("message",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]); env = 
                                               { Env.vars =
                                                 [(("res", 34),
                                                   (Env.Var (Syntax.Loc 34)));
                                                   (("msg_with_sig", 33),
                                                    (Env.Var (Syntax.Loc 33)));
                                                   (("pub_key_alice", 32),
                                                    (Env.Var (Syntax.Loc 32)));
                                                   (("ch_net", 31),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("alice", 0), Env.Process);
                                                   (("udp", 0),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("secret_key_alice", 0),
                                                    (Env.Const (false,
                                                       (Some (Env.TySecurity
                                                                "sign_key_alice"))
                                                       )));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("provide", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("read", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("gen_message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                                               )); env = { Env.vars =
                                                           [(("res", 34),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   34)));
                                                             (("msg_with_sig",
                                                               33),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    33)));
                                                             (("pub_key_alice",
                                                               32),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    32)));
                                                             (("ch_net", 31),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("alice", 0),
                                                              Env.Process);
                                                             (("udp", 0),
                                                              (Env.ChannelDecl (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("secret_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false,
                                                                 (Some (
                                                                 Env.TySecurity
                                                                   "sign_key_alice"))
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("provide", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("read", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("gen_message",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("vk", 0),
                                                              (Env.ExtFun 1));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 [(Env.TyParamProduct (
                                                                    (Env.TyParamSecurity
                                                                    "client_msg"),
                                                                    (Env.TyParamSecurity
                                                                    "client_sig")
                                                                    ))
                                                                   ]));
                                                             (("conn_client",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "connection",
                                                                 [])));
                                                             (("sign_key_alice",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "sigkey",
                                                                 [(Env.TyParamSecurity
                                                                    "client_msg")
                                                                   ]
                                                                 )));
                                                             (("client_sig",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "signature",
                                                                 [])));
                                                             (("client_msg",
                                                               0),
                                                              (Env.SecurityTypeDef (
                                                                 "message",
                                                                 [])));
                                                             (("attacker_ty",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("bob_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("alice_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("verkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("sigkey", 0),
                                                              (Env.SimpleTypeDef
                                                                 ["'a"]));
                                                             (("signature", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("message", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("connection",
                                                               0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("unit", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("bool", 0),
                                                              (Env.SimpleTypeDef
                                                                 []));
                                                             (("string", 0),
                                                              (Env.SimpleTypeDef
                                                                 []))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } }
                                   )); env = { Env.vars =
                                               [(("msg_with_sig", 33),
                                                 (Env.Var (Syntax.Loc 33)));
                                                 (("pub_key_alice", 32),
                                                  (Env.Var (Syntax.Loc 32)));
                                                 (("ch_net", 31),
                                                  (Env.ChannelDecl (false,
                                                     ("udp_t", 0))));
                                                 (("alice", 0), Env.Process);
                                                 (("udp", 0),
                                                  (Env.ChannelDecl (false,
                                                     ("udp_t", 0))));
                                                 (("secret_key_alice", 0),
                                                  (Env.Const (false,
                                                     (Some (Env.TySecurity
                                                              "sign_key_alice"))
                                                     )));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("provide", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("read", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("gen_message", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("vk", 0), (Env.ExtFun 1));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyParamProduct (
                                                         (Env.TyParamSecurity
                                                            "client_msg"),
                                                         (Env.TyParamSecurity
                                                            "client_sig")
                                                         ))
                                                       ]));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("sign_key_alice", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TyParamSecurity
                                                         "client_msg")
                                                       ]
                                                     )));
                                                 (("client_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_msg", 0),
                                                  (Env.SecurityTypeDef (
                                                     "message", [])));
                                                 (("attacker_ty", 0),
                                                  Env.ProcTypeDef);
                                                 (("bob_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("alice_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("message", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("pub_key_alice", 32),
                                     (Env.Var (Syntax.Loc 32)));
                                     (("ch_net", 31),
                                      (Env.ChannelDecl (false, ("udp_t", 0))));
                                     (("alice", 0), Env.Process);
                                     (("udp", 0),
                                      (Env.ChannelDecl (false, ("udp_t", 0))));
                                     (("secret_key_alice", 0),
                                      (Env.Const (false,
                                         (Some (Env.TySecurity
                                                  "sign_key_alice"))
                                         )));
                                     (("eaves_mem", 0), (Env.ExtSyscall 1));
                                     (("tamper_channel", 0), Env.Attack);
                                     (("provide", 0), (Env.ExtSyscall 0));
                                     (("read", 0), (Env.ExtSyscall 0));
                                     (("gen_message", 0), (Env.ExtSyscall 0));
                                     (("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("vk", 0), (Env.ExtFun 1));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyParamProduct (
                                             (Env.TyParamSecurity
                                                "client_msg"),
                                             (Env.TyParamSecurity
                                                "client_sig")
                                             ))
                                           ]));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("sign_key_alice", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TyParamSecurity "client_msg")]
                                         )));
                                     (("client_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_msg", 0),
                                      (Env.SecurityTypeDef ("message", [])));
                                     (("attacker_ty", 0), Env.ProcTypeDef);
                                     (("bob_t", 0), Env.ProcTypeDef);
                                     (("alice_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("message", 0), (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("alice", 0), Env.Process);
                                                   (("udp", 0),
                                                    (Env.ChannelDecl (false,
                                                       ("udp_t", 0))));
                                                   (("secret_key_alice", 0),
                                                    (Env.Const (false,
                                                       (Some (Env.TySecurity
                                                                "sign_key_alice"))
                                                       )));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("provide", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("read", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("gen_message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("vk", 0), (Env.ExtFun 1));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyParamProduct (
                                                           (Env.TyParamSecurity
                                                              "client_msg"),
                                                           (Env.TyParamSecurity
                                                              "client_sig")
                                                           ))
                                                         ]));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("sign_key_alice", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TyParamSecurity
                                                           "client_msg")
                                                         ]
                                                       )));
                                                   (("client_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_msg", 0),
                                                    (Env.SecurityTypeDef (
                                                       "message", [])));
                                                   (("attacker_ty", 0),
                                                    Env.ProcTypeDef);
                                                   (("bob_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("alice_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("message", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = (Typed.System (
            [(Typed.Unbounded
                { Typed.id = ("alice", 0); parameter = None;
                  args =
                  [{ Typed.channel = ("udp", 0); parameter = None;
                     typ = ("udp_t", 0) }
                    ]
                  });
              (Typed.Unbounded
                 { Typed.id = ("bob", 0); parameter = None;
                   args =
                   [{ Typed.channel = ("udp", 0); parameter = None;
                      typ = ("udp_t", 0) }
                     ]
                   })
              ],
            [(("Reachable", 0),
              { desc = (Typed.Plain
                          "exists-trace \"Ex #i #j . AliceClose () @ #i & BobClose() @ #j\""); env = 
              { Env.vars =
                [(("bob", 0), Env.Process); (("alice", 0), Env.Process);
                  (("udp", 0), (Env.ChannelDecl (false, ("udp_t", 0))));
                  (("secret_key_alice", 0),
                   (Env.Const (false,
                      (Some (Env.TySecurity "sign_key_alice")))));
                  (("eaves_mem", 0), (Env.ExtSyscall 1));
                  (("tamper_channel", 0), Env.Attack);
                  (("provide", 0), (Env.ExtSyscall 0));
                  (("read", 0), (Env.ExtSyscall 0));
                  (("gen_message", 0), (Env.ExtSyscall 0));
                  (("accept_rpc", 0), (Env.ExtSyscall 1));
                  (("close_rpc", 0), (Env.ExtSyscall 1));
                  (("invoke_rpc", 0), (Env.ExtSyscall 4));
                  (("connect_rpc", 0), (Env.ExtSyscall 1));
                  (("recv", 0), (Env.ExtSyscall 1));
                  (("send", 0), (Env.ExtSyscall 2));
                  (("verify", 0), (Env.ExtFun 3));
                  (("true", 0), Env.ExtConst); (("snd", 0), (Env.ExtFun 1));
                  (("fst", 0), (Env.ExtFun 1));
                  (("sign", 0), (Env.ExtFun 2)); (("vk", 0), (Env.ExtFun 1));
                  (("udp_t", 0),
                   (Env.ChanTypeDef
                      [(Env.TyParamProduct (
                          (Env.TyParamSecurity "client_msg"),
                          (Env.TyParamSecurity "client_sig")))
                        ]));
                  (("conn_client", 0),
                   (Env.SecurityTypeDef ("connection", [])));
                  (("sign_key_alice", 0),
                   (Env.SecurityTypeDef ("sigkey",
                      [(Env.TyParamSecurity "client_msg")])));
                  (("client_sig", 0), (Env.SecurityTypeDef ("signature", [])));
                  (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
                  (("attacker_ty", 0), Env.ProcTypeDef);
                  (("bob_t", 0), Env.ProcTypeDef);
                  (("alice_t", 0), Env.ProcTypeDef);
                  (("readonly_t", 0), Env.FilesysTypeDef);
                  (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                  (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                  (("signature", 0), (Env.SimpleTypeDef []));
                  (("message", 0), (Env.SimpleTypeDef []));
                  (("connection", 0), (Env.SimpleTypeDef []));
                  (("unit", 0), (Env.SimpleTypeDef []));
                  (("bool", 0), (Env.SimpleTypeDef []));
                  (("string", 0), (Env.SimpleTypeDef []))];
                facts =
                ref ([("BobClose", (Env.Global, (Some 0)));
                       ("IntegrityFail", (Env.Global, (Some 1)));
                       ("IntegritySuccess", (Env.Global, (Some 1)));
                       ("AliceClose", (Env.Global, (Some 0)));
                       ("MsgSend", (Env.Global, (Some 1)));
                       ("Out", (Env.Global, (Some 1)));
                       ("In", (Env.Global, (Some 1)));
                       ("exit", (Env.Channel, (Some 0)));
                       ("Returned", (Env.Channel, (Some 1)));
                       ("invoke", (Env.Channel, (Some 3)));
                       ("conn", (Env.Channel, (Some 0)));
                       ("chid", (Env.Structure, (Some 1)));
                       ("ack", (Env.Channel, (Some 0)));
                       ("req", (Env.Channel, (Some 0)));
                       ("store", (Env.Channel, (Some 1)))])
                } });
              (("Correspondence", 0),
               { desc = (Typed.Plain
                           "all-traces \"All msg #j  . IntegritySuccess(msg) @ #j ==> Ex #i . MsgSend (msg) @ i & i < j\""); env = 
               { Env.vars =
                 [(("Reachable", 0), Env.Process); (("bob", 0), Env.Process);
                   (("alice", 0), Env.Process);
                   (("udp", 0), (Env.ChannelDecl (false, ("udp_t", 0))));
                   (("secret_key_alice", 0),
                    (Env.Const (false,
                       (Some (Env.TySecurity "sign_key_alice")))));
                   (("eaves_mem", 0), (Env.ExtSyscall 1));
                   (("tamper_channel", 0), Env.Attack);
                   (("provide", 0), (Env.ExtSyscall 0));
                   (("read", 0), (Env.ExtSyscall 0));
                   (("gen_message", 0), (Env.ExtSyscall 0));
                   (("accept_rpc", 0), (Env.ExtSyscall 1));
                   (("close_rpc", 0), (Env.ExtSyscall 1));
                   (("invoke_rpc", 0), (Env.ExtSyscall 4));
                   (("connect_rpc", 0), (Env.ExtSyscall 1));
                   (("recv", 0), (Env.ExtSyscall 1));
                   (("send", 0), (Env.ExtSyscall 2));
                   (("verify", 0), (Env.ExtFun 3));
                   (("true", 0), Env.ExtConst); (("snd", 0), (Env.ExtFun 1));
                   (("fst", 0), (Env.ExtFun 1));
                   (("sign", 0), (Env.ExtFun 2));
                   (("vk", 0), (Env.ExtFun 1));
                   (("udp_t", 0),
                    (Env.ChanTypeDef
                       [(Env.TyParamProduct (
                           (Env.TyParamSecurity "client_msg"),
                           (Env.TyParamSecurity "client_sig")))
                         ]));
                   (("conn_client", 0),
                    (Env.SecurityTypeDef ("connection", [])));
                   (("sign_key_alice", 0),
                    (Env.SecurityTypeDef ("sigkey",
                       [(Env.TyParamSecurity "client_msg")])));
                   (("client_sig", 0),
                    (Env.SecurityTypeDef ("signature", [])));
                   (("client_msg", 0), (Env.SecurityTypeDef ("message", [])));
                   (("attacker_ty", 0), Env.ProcTypeDef);
                   (("bob_t", 0), Env.ProcTypeDef);
                   (("alice_t", 0), Env.ProcTypeDef);
                   (("readonly_t", 0), Env.FilesysTypeDef);
                   (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                   (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                   (("signature", 0), (Env.SimpleTypeDef []));
                   (("message", 0), (Env.SimpleTypeDef []));
                   (("connection", 0), (Env.SimpleTypeDef []));
                   (("unit", 0), (Env.SimpleTypeDef []));
                   (("bool", 0), (Env.SimpleTypeDef []));
                   (("string", 0), (Env.SimpleTypeDef []))];
                 facts =
                 ref ([("BobClose", (Env.Global, (Some 0)));
                        ("IntegrityFail", (Env.Global, (Some 1)));
                        ("IntegritySuccess", (Env.Global, (Some 1)));
                        ("AliceClose", (Env.Global, (Some 0)));
                        ("MsgSend", (Env.Global, (Some 1)));
                        ("Out", (Env.Global, (Some 1)));
                        ("In", (Env.Global, (Some 1)));
                        ("exit", (Env.Channel, (Some 0)));
                        ("Returned", (Env.Channel, (Some 1)));
                        ("invoke", (Env.Channel, (Some 3)));
                        ("conn", (Env.Channel, (Some 0)));
                        ("chid", (Env.Structure, (Some 1)));
                        ("ack", (Env.Channel, (Some 0)));
                        ("req", (Env.Channel, (Some 0)));
                        ("store", (Env.Channel, (Some 1)))])
                 } })
              ]
            )); env = { Env.vars =
                        [(("bob", 0), Env.Process);
                          (("alice", 0), Env.Process);
                          (("udp", 0),
                           (Env.ChannelDecl (false, ("udp_t", 0))));
                          (("secret_key_alice", 0),
                           (Env.Const (false,
                              (Some (Env.TySecurity "sign_key_alice")))));
                          (("eaves_mem", 0), (Env.ExtSyscall 1));
                          (("tamper_channel", 0), Env.Attack);
                          (("provide", 0), (Env.ExtSyscall 0));
                          (("read", 0), (Env.ExtSyscall 0));
                          (("gen_message", 0), (Env.ExtSyscall 0));
                          (("accept_rpc", 0), (Env.ExtSyscall 1));
                          (("close_rpc", 0), (Env.ExtSyscall 1));
                          (("invoke_rpc", 0), (Env.ExtSyscall 4));
                          (("connect_rpc", 0), (Env.ExtSyscall 1));
                          (("recv", 0), (Env.ExtSyscall 1));
                          (("send", 0), (Env.ExtSyscall 2));
                          (("verify", 0), (Env.ExtFun 3));
                          (("true", 0), Env.ExtConst);
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("vk", 0), (Env.ExtFun 1));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyParamProduct (
                                  (Env.TyParamSecurity "client_msg"),
                                  (Env.TyParamSecurity "client_sig")))
                                ]));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("sign_key_alice", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TyParamSecurity "client_msg")])));
                          (("client_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_msg", 0),
                           (Env.SecurityTypeDef ("message", [])));
                          (("attacker_ty", 0), Env.ProcTypeDef);
                          (("bob_t", 0), Env.ProcTypeDef);
                          (("alice_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("message", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
