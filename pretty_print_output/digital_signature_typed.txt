Running Typer.load on examples/digital_signature_typed.rab
Trying to convert examples/digital_signature_typed.rab to CST
typecheck sys : printing filtered_decls process names
alice
bob
Running typeof_cmd on process name alice
{ desc = (Cst_syntax.Apply (("eaves_mem", 0),
            [{ desc = Cst_syntax.Ident {id = ("msg", 29);
                        desc = (Cst_env.Var (Syntax.Loc 29)); param = None}; env = 
              { Cst_env.vars =
                [(("msg", 29), (Cst_env.Var (Syntax.Loc 29)));
                  (("priv_key_alice", 28), (Cst_env.Var (Syntax.Loc 28)));
                  (("ch_net", 27),
                   (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                  (("udp", 0), (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                  (("secret_key_alice", 0),
                   (Cst_env.Const (false,
                      ((Cst_env.TSimple ("sigkey",
                          [((Cst_env.TSimple ("message", [])),
                            (Cst_env.Public, Cst_env.Untrusted))]
                          )),
                       ((Cst_env.SNode { alice_t; }),
                        (Cst_env.INode { alice_t; })))
                      )));
                  (("eaves_mem", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Poly "'a"),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("tamper_channel", 0), Cst_env.Attack);
                  (("provide", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("unit", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("read", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("unit", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("gen_message", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("message", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("accept_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("close_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("connection", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("invoke_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("connection", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("string", [])),
                         (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'b"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'c"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("connect_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("connection", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("recv", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("send", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("verify", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("signature", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("message", [])),
                         (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("verkey",
                            [((Cst_env.CFP_Simple ("message", [])),
                              (Cst_env.Public, Cst_env.Untrusted))]
                            )),
                         (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("bool", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("true", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("bool", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("snd", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Product (
                           ((Cst_env.CFP_Poly "'a"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                           ((Cst_env.CFP_Poly "'b"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore))
                           )),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'b"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("fst", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Product (
                           ((Cst_env.CFP_Poly "'a"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                           ((Cst_env.CFP_Poly "'b"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore))
                           )),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("sign", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("message", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("sigkey",
                            [((Cst_env.CFP_Simple ("message", [])),
                              (Cst_env.Public, Cst_env.Untrusted))]
                            )),
                         ((Cst_env.SNode { alice_t; }),
                          (Cst_env.INode { alice_t; })));
                        ((Cst_env.CFP_Simple ("signature", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("vk", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("sigkey",
                           [((Cst_env.CFP_Simple ("message", [])),
                             (Cst_env.Public, Cst_env.Untrusted))]
                           )),
                        ((Cst_env.SNode { alice_t; }),
                         (Cst_env.INode { alice_t; })));
                        ((Cst_env.CFP_Simple ("verkey",
                            [((Cst_env.CFP_Simple ("message", [])),
                              (Cst_env.Public, Cst_env.Untrusted))]
                            )),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("udp_t", 0),
                   (Cst_env.ChanTypeDef
                      [((Cst_env.TProd (
                           ((Cst_env.TSimple ("message", [])),
                            (Cst_env.Public, Cst_env.Untrusted)),
                           ((Cst_env.TSimple ("signature", [])),
                            (Cst_env.Public, Cst_env.Untrusted))
                           )),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("conn_client", 0),
                   (Cst_env.SecurityTypeDef ("connection", [])));
                  (("sign_key_alice", 0),
                   (Cst_env.SecurityTypeDef ("sigkey",
                      [((Cst_env.TSimple ("message", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]
                      )));
                  (("client_sig", 0),
                   (Cst_env.SecurityTypeDef ("signature", [])));
                  (("client_msg", 0),
                   (Cst_env.SecurityTypeDef ("message", [])));
                  (("attacker_ty", 0), Cst_env.ProcTypeDef);
                  (("bob_t", 0), Cst_env.ProcTypeDef);
                  (("alice_t", 0), Cst_env.ProcTypeDef);
                  (("readonly_t", 0), Cst_env.FilesysTypeDef);
                  (("verkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                  (("sigkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                  (("signature", 0), (Cst_env.SimpleTypeDef []));
                  (("message", 0), (Cst_env.SimpleTypeDef []));
                  (("connection", 0), (Cst_env.SimpleTypeDef []));
                  (("unit", 0), (Cst_env.SimpleTypeDef []));
                  (("bool", 0), (Cst_env.SimpleTypeDef []));
                  (("string", 0), (Cst_env.SimpleTypeDef []))];
                facts =
                ref ([("BobClose", (Env.Global, (Some 0)));
                       ("IntegrityFail", (Env.Global, (Some 1)));
                       ("IntegritySuccess", (Env.Global, (Some 1)));
                       ("AliceClose", (Env.Global, (Some 0)));
                       ("MsgSend", (Env.Global, (Some 1)));
                       ("Out", (Env.Global, (Some 1)));
                       ("In", (Env.Global, (Some 1)));
                       ("exit", (Env.Channel, (Some 0)));
                       ("Returned", (Env.Channel, (Some 1)));
                       ("invoke", (Env.Channel, (Some 3)));
                       ("conn", (Env.Channel, (Some 0)));
                       ("chid", (Env.Structure, (Some 1)));
                       ("ack", (Env.Channel, (Some 0)));
                       ("req", (Env.Channel, (Some 0)));
                       ("store", (Env.Channel, (Some 1)))])
                } }
              ]
            )); env = { Cst_env.vars =
                        [(("msg", 29), (Cst_env.Var (Syntax.Loc 29)));
                          (("priv_key_alice", 28),
                           (Cst_env.Var (Syntax.Loc 28)));
                          (("ch_net", 27),
                           (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                          (("udp", 0),
                           (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                          (("secret_key_alice", 0),
                           (Cst_env.Const (false,
                              ((Cst_env.TSimple ("sigkey",
                                  [((Cst_env.TSimple ("message", [])),
                                    (Cst_env.Public, Cst_env.Untrusted))]
                                  )),
                               ((Cst_env.SNode { alice_t; }),
                                (Cst_env.INode { alice_t; })))
                              )));
                          (("eaves_mem", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Poly "'a"),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("tamper_channel", 0), Cst_env.Attack);
                          (("provide", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("unit", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("read", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("unit", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("gen_message", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("accept_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("close_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("connection", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("invoke_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("connection", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("string", [])),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'b"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'c"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("connect_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("connection", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("recv", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("send", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("verify", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("signature", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("message", [])),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("verkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("bool", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("true", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("bool", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("snd", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Product (
                                   ((Cst_env.CFP_Poly "'a"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                                   ((Cst_env.CFP_Poly "'b"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                   )),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'b"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("fst", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Product (
                                   ((Cst_env.CFP_Poly "'a"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                                   ((Cst_env.CFP_Poly "'b"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                   )),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("sign", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("sigkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 ((Cst_env.SNode { alice_t; }),
                                  (Cst_env.INode { alice_t; })));
                                ((Cst_env.CFP_Simple ("signature", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("vk", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("sigkey",
                                   [((Cst_env.CFP_Simple ("message", [])),
                                     (Cst_env.Public, Cst_env.Untrusted))]
                                   )),
                                ((Cst_env.SNode { alice_t; }),
                                 (Cst_env.INode { alice_t; })));
                                ((Cst_env.CFP_Simple ("verkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("udp_t", 0),
                           (Cst_env.ChanTypeDef
                              [((Cst_env.TProd (
                                   ((Cst_env.TSimple ("message", [])),
                                    (Cst_env.Public, Cst_env.Untrusted)),
                                   ((Cst_env.TSimple ("signature", [])),
                                    (Cst_env.Public, Cst_env.Untrusted))
                                   )),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("conn_client", 0),
                           (Cst_env.SecurityTypeDef ("connection", [])));
                          (("sign_key_alice", 0),
                           (Cst_env.SecurityTypeDef ("sigkey",
                              [((Cst_env.TSimple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]
                              )));
                          (("client_sig", 0),
                           (Cst_env.SecurityTypeDef ("signature", [])));
                          (("client_msg", 0),
                           (Cst_env.SecurityTypeDef ("message", [])));
                          (("attacker_ty", 0), Cst_env.ProcTypeDef);
                          (("bob_t", 0), Cst_env.ProcTypeDef);
                          (("alice_t", 0), Cst_env.ProcTypeDef);
                          (("readonly_t", 0), Cst_env.FilesysTypeDef);
                          (("verkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                          (("signature", 0), (Cst_env.SimpleTypeDef []));
                          (("message", 0), (Cst_env.SimpleTypeDef []));
                          (("connection", 0), (Cst_env.SimpleTypeDef []));
                          (("unit", 0), (Cst_env.SimpleTypeDef []));
                          (("bool", 0), (Cst_env.SimpleTypeDef []));
                          (("string", 0), (Cst_env.SimpleTypeDef []))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = (Cst_syntax.Apply (("eaves_mem", 0),
            [{ desc = Cst_syntax.Ident {id = ("sig", 30);
                        desc = (Cst_env.Var (Syntax.Loc 30)); param = None}; env = 
              { Cst_env.vars =
                [(("sig", 30), (Cst_env.Var (Syntax.Loc 30)));
                  (("msg", 29), (Cst_env.Var (Syntax.Loc 29)));
                  (("priv_key_alice", 28), (Cst_env.Var (Syntax.Loc 28)));
                  (("ch_net", 27),
                   (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                  (("udp", 0), (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                  (("secret_key_alice", 0),
                   (Cst_env.Const (false,
                      ((Cst_env.TSimple ("sigkey",
                          [((Cst_env.TSimple ("message", [])),
                            (Cst_env.Public, Cst_env.Untrusted))]
                          )),
                       ((Cst_env.SNode { alice_t; }),
                        (Cst_env.INode { alice_t; })))
                      )));
                  (("eaves_mem", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Poly "'a"),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("tamper_channel", 0), Cst_env.Attack);
                  (("provide", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("unit", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("read", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("unit", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("gen_message", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("message", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("accept_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("close_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("connection", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("invoke_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Simple ("connection", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("string", [])),
                         (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'b"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'c"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("connect_rpc", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("connection", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("recv", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("send", 0),
                   (Cst_env.ExtSyscall
                      [((Cst_env.CFP_Chan
                           [((Cst_env.CFP_Poly "'a"),
                             (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Simple ("unit", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("verify", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("signature", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("message", [])),
                         (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("verkey",
                            [((Cst_env.CFP_Simple ("message", [])),
                              (Cst_env.Public, Cst_env.Untrusted))]
                            )),
                         (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("bool", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("true", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("bool", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("snd", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Product (
                           ((Cst_env.CFP_Poly "'a"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                           ((Cst_env.CFP_Poly "'b"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore))
                           )),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'b"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("fst", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Product (
                           ((Cst_env.CFP_Poly "'a"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                           ((Cst_env.CFP_Poly "'b"),
                            (Cst_env.S_Ignore, Cst_env.I_Ignore))
                           )),
                        (Cst_env.S_Ignore, Cst_env.I_Ignore));
                        ((Cst_env.CFP_Poly "'a"),
                         (Cst_env.S_Ignore, Cst_env.I_Ignore))
                        ]));
                  (("sign", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("message", [])),
                        (Cst_env.Public, Cst_env.Untrusted));
                        ((Cst_env.CFP_Simple ("sigkey",
                            [((Cst_env.CFP_Simple ("message", [])),
                              (Cst_env.Public, Cst_env.Untrusted))]
                            )),
                         ((Cst_env.SNode { alice_t; }),
                          (Cst_env.INode { alice_t; })));
                        ((Cst_env.CFP_Simple ("signature", [])),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("vk", 0),
                   (Cst_env.ExtFun
                      [((Cst_env.CFP_Simple ("sigkey",
                           [((Cst_env.CFP_Simple ("message", [])),
                             (Cst_env.Public, Cst_env.Untrusted))]
                           )),
                        ((Cst_env.SNode { alice_t; }),
                         (Cst_env.INode { alice_t; })));
                        ((Cst_env.CFP_Simple ("verkey",
                            [((Cst_env.CFP_Simple ("message", [])),
                              (Cst_env.Public, Cst_env.Untrusted))]
                            )),
                         (Cst_env.Public, Cst_env.Untrusted))
                        ]));
                  (("udp_t", 0),
                   (Cst_env.ChanTypeDef
                      [((Cst_env.TProd (
                           ((Cst_env.TSimple ("message", [])),
                            (Cst_env.Public, Cst_env.Untrusted)),
                           ((Cst_env.TSimple ("signature", [])),
                            (Cst_env.Public, Cst_env.Untrusted))
                           )),
                        (Cst_env.Public, Cst_env.Untrusted))]));
                  (("conn_client", 0),
                   (Cst_env.SecurityTypeDef ("connection", [])));
                  (("sign_key_alice", 0),
                   (Cst_env.SecurityTypeDef ("sigkey",
                      [((Cst_env.TSimple ("message", [])),
                        (Cst_env.Public, Cst_env.Untrusted))]
                      )));
                  (("client_sig", 0),
                   (Cst_env.SecurityTypeDef ("signature", [])));
                  (("client_msg", 0),
                   (Cst_env.SecurityTypeDef ("message", [])));
                  (("attacker_ty", 0), Cst_env.ProcTypeDef);
                  (("bob_t", 0), Cst_env.ProcTypeDef);
                  (("alice_t", 0), Cst_env.ProcTypeDef);
                  (("readonly_t", 0), Cst_env.FilesysTypeDef);
                  (("verkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                  (("sigkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                  (("signature", 0), (Cst_env.SimpleTypeDef []));
                  (("message", 0), (Cst_env.SimpleTypeDef []));
                  (("connection", 0), (Cst_env.SimpleTypeDef []));
                  (("unit", 0), (Cst_env.SimpleTypeDef []));
                  (("bool", 0), (Cst_env.SimpleTypeDef []));
                  (("string", 0), (Cst_env.SimpleTypeDef []))];
                facts =
                ref ([("BobClose", (Env.Global, (Some 0)));
                       ("IntegrityFail", (Env.Global, (Some 1)));
                       ("IntegritySuccess", (Env.Global, (Some 1)));
                       ("AliceClose", (Env.Global, (Some 0)));
                       ("MsgSend", (Env.Global, (Some 1)));
                       ("Out", (Env.Global, (Some 1)));
                       ("In", (Env.Global, (Some 1)));
                       ("exit", (Env.Channel, (Some 0)));
                       ("Returned", (Env.Channel, (Some 1)));
                       ("invoke", (Env.Channel, (Some 3)));
                       ("conn", (Env.Channel, (Some 0)));
                       ("chid", (Env.Structure, (Some 1)));
                       ("ack", (Env.Channel, (Some 0)));
                       ("req", (Env.Channel, (Some 0)));
                       ("store", (Env.Channel, (Some 1)))])
                } }
              ]
            )); env = { Cst_env.vars =
                        [(("sig", 30), (Cst_env.Var (Syntax.Loc 30)));
                          (("msg", 29), (Cst_env.Var (Syntax.Loc 29)));
                          (("priv_key_alice", 28),
                           (Cst_env.Var (Syntax.Loc 28)));
                          (("ch_net", 27),
                           (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                          (("udp", 0),
                           (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                          (("secret_key_alice", 0),
                           (Cst_env.Const (false,
                              ((Cst_env.TSimple ("sigkey",
                                  [((Cst_env.TSimple ("message", [])),
                                    (Cst_env.Public, Cst_env.Untrusted))]
                                  )),
                               ((Cst_env.SNode { alice_t; }),
                                (Cst_env.INode { alice_t; })))
                              )));
                          (("eaves_mem", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Poly "'a"),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("tamper_channel", 0), Cst_env.Attack);
                          (("provide", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("unit", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("read", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("unit", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("gen_message", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("accept_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("close_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("connection", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("invoke_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("connection", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("string", [])),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'b"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'c"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("connect_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("connection", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("recv", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("send", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("verify", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("signature", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("message", [])),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("verkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("bool", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("true", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("bool", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("snd", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Product (
                                   ((Cst_env.CFP_Poly "'a"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                                   ((Cst_env.CFP_Poly "'b"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                   )),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'b"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("fst", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Product (
                                   ((Cst_env.CFP_Poly "'a"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                                   ((Cst_env.CFP_Poly "'b"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                   )),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("sign", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("sigkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 ((Cst_env.SNode { alice_t; }),
                                  (Cst_env.INode { alice_t; })));
                                ((Cst_env.CFP_Simple ("signature", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("vk", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("sigkey",
                                   [((Cst_env.CFP_Simple ("message", [])),
                                     (Cst_env.Public, Cst_env.Untrusted))]
                                   )),
                                ((Cst_env.SNode { alice_t; }),
                                 (Cst_env.INode { alice_t; })));
                                ((Cst_env.CFP_Simple ("verkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("udp_t", 0),
                           (Cst_env.ChanTypeDef
                              [((Cst_env.TProd (
                                   ((Cst_env.TSimple ("message", [])),
                                    (Cst_env.Public, Cst_env.Untrusted)),
                                   ((Cst_env.TSimple ("signature", [])),
                                    (Cst_env.Public, Cst_env.Untrusted))
                                   )),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("conn_client", 0),
                           (Cst_env.SecurityTypeDef ("connection", [])));
                          (("sign_key_alice", 0),
                           (Cst_env.SecurityTypeDef ("sigkey",
                              [((Cst_env.TSimple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]
                              )));
                          (("client_sig", 0),
                           (Cst_env.SecurityTypeDef ("signature", [])));
                          (("client_msg", 0),
                           (Cst_env.SecurityTypeDef ("message", [])));
                          (("attacker_ty", 0), Cst_env.ProcTypeDef);
                          (("bob_t", 0), Cst_env.ProcTypeDef);
                          (("alice_t", 0), Cst_env.ProcTypeDef);
                          (("readonly_t", 0), Cst_env.FilesysTypeDef);
                          (("verkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                          (("signature", 0), (Cst_env.SimpleTypeDef []));
                          (("message", 0), (Cst_env.SimpleTypeDef []));
                          (("connection", 0), (Cst_env.SimpleTypeDef []));
                          (("unit", 0), (Cst_env.SimpleTypeDef []));
                          (("bool", 0), (Cst_env.SimpleTypeDef []));
                          (("string", 0), (Cst_env.SimpleTypeDef []))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = (Cst_syntax.Apply (("send", 0),
            [{ desc = Cst_syntax.Ident {id = ("ch_net", 27);
                        desc = (Cst_env.ChannelDecl (false, ("udp_t", 0)));
                        param = None}; env = { Cst_env.vars =
                                               [(("sig", 30),
                                                 (Cst_env.Var (Syntax.Loc 30)));
                                                 (("msg", 29),
                                                  (Cst_env.Var
                                                     (Syntax.Loc 29)));
                                                 (("priv_key_alice", 28),
                                                  (Cst_env.Var
                                                     (Syntax.Loc 28)));
                                                 (("ch_net", 27),
                                                  (Cst_env.ChannelDecl (
                                                     false, ("udp_t", 0))));
                                                 (("udp", 0),
                                                  (Cst_env.ChannelDecl (
                                                     false, ("udp_t", 0))));
                                                 (("secret_key_alice", 0),
                                                  (Cst_env.Const (false,
                                                     ((Cst_env.TSimple (
                                                         "sigkey",
                                                         [((Cst_env.TSimple (
                                                              "message", 
                                                              [])),
                                                           (Cst_env.Public,
                                                            Cst_env.Untrusted))
                                                           ]
                                                         )),
                                                      ((Cst_env.SNode
                                                          { alice_t; }),
                                                       (Cst_env.INode
                                                          { alice_t; })))
                                                     )));
                                                 (("eaves_mem", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Poly "'a"),
                                                       (Cst_env.S_Ignore,
                                                        Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Simple (
                                                           "unit", [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("tamper_channel", 0),
                                                  Cst_env.Attack);
                                                 (("provide", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Simple (
                                                          "unit", [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted))
                                                       ]));
                                                 (("read", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Simple (
                                                          "unit", [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted))
                                                       ]));
                                                 (("gen_message", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Simple (
                                                          "message", 
                                                          [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted))
                                                       ]));
                                                 (("accept_rpc", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Chan
                                                          [((Cst_env.CFP_Poly
                                                               "'a"),
                                                            (Cst_env.S_Ignore,
                                                             Cst_env.I_Ignore))
                                                            ]),
                                                       (Cst_env.S_Ignore,
                                                        Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Simple (
                                                           "unit", [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("close_rpc", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Simple (
                                                          "connection", 
                                                          [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted));
                                                       ((Cst_env.CFP_Simple (
                                                           "unit", [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("invoke_rpc", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Simple (
                                                          "connection", 
                                                          [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted));
                                                       ((Cst_env.CFP_Simple (
                                                           "string", 
                                                           [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted));
                                                       ((Cst_env.CFP_Poly
                                                           "'a"),
                                                        (Cst_env.S_Ignore,
                                                         Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Poly
                                                           "'b"),
                                                        (Cst_env.S_Ignore,
                                                         Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Poly
                                                           "'c"),
                                                        (Cst_env.S_Ignore,
                                                         Cst_env.I_Ignore))
                                                       ]));
                                                 (("connect_rpc", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Chan
                                                          [((Cst_env.CFP_Poly
                                                               "'a"),
                                                            (Cst_env.S_Ignore,
                                                             Cst_env.I_Ignore))
                                                            ]),
                                                       (Cst_env.S_Ignore,
                                                        Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Simple (
                                                           "connection", 
                                                           [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("recv", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Chan
                                                          [((Cst_env.CFP_Poly
                                                               "'a"),
                                                            (Cst_env.S_Ignore,
                                                             Cst_env.I_Ignore))
                                                            ]),
                                                       (Cst_env.S_Ignore,
                                                        Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Poly
                                                           "'a"),
                                                        (Cst_env.S_Ignore,
                                                         Cst_env.I_Ignore))
                                                       ]));
                                                 (("send", 0),
                                                  (Cst_env.ExtSyscall
                                                     [((Cst_env.CFP_Chan
                                                          [((Cst_env.CFP_Poly
                                                               "'a"),
                                                            (Cst_env.S_Ignore,
                                                             Cst_env.I_Ignore))
                                                            ]),
                                                       (Cst_env.S_Ignore,
                                                        Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Poly
                                                           "'a"),
                                                        (Cst_env.S_Ignore,
                                                         Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Simple (
                                                           "unit", [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("verify", 0),
                                                  (Cst_env.ExtFun
                                                     [((Cst_env.CFP_Simple (
                                                          "signature", 
                                                          [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted));
                                                       ((Cst_env.CFP_Simple (
                                                           "message", 
                                                           [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted));
                                                       ((Cst_env.CFP_Simple (
                                                           "verkey",
                                                           [((Cst_env.CFP_Simple (
                                                                "message", 
                                                                [])),
                                                             (Cst_env.Public,
                                                              Cst_env.Untrusted))
                                                             ]
                                                           )),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted));
                                                       ((Cst_env.CFP_Simple (
                                                           "bool", [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("true", 0),
                                                  (Cst_env.ExtFun
                                                     [((Cst_env.CFP_Simple (
                                                          "bool", [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted))
                                                       ]));
                                                 (("snd", 0),
                                                  (Cst_env.ExtFun
                                                     [((Cst_env.CFP_Product (
                                                          ((Cst_env.CFP_Poly
                                                              "'a"),
                                                           (Cst_env.S_Ignore,
                                                            Cst_env.I_Ignore)),
                                                          ((Cst_env.CFP_Poly
                                                              "'b"),
                                                           (Cst_env.S_Ignore,
                                                            Cst_env.I_Ignore))
                                                          )),
                                                       (Cst_env.S_Ignore,
                                                        Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Poly
                                                           "'b"),
                                                        (Cst_env.S_Ignore,
                                                         Cst_env.I_Ignore))
                                                       ]));
                                                 (("fst", 0),
                                                  (Cst_env.ExtFun
                                                     [((Cst_env.CFP_Product (
                                                          ((Cst_env.CFP_Poly
                                                              "'a"),
                                                           (Cst_env.S_Ignore,
                                                            Cst_env.I_Ignore)),
                                                          ((Cst_env.CFP_Poly
                                                              "'b"),
                                                           (Cst_env.S_Ignore,
                                                            Cst_env.I_Ignore))
                                                          )),
                                                       (Cst_env.S_Ignore,
                                                        Cst_env.I_Ignore));
                                                       ((Cst_env.CFP_Poly
                                                           "'a"),
                                                        (Cst_env.S_Ignore,
                                                         Cst_env.I_Ignore))
                                                       ]));
                                                 (("sign", 0),
                                                  (Cst_env.ExtFun
                                                     [((Cst_env.CFP_Simple (
                                                          "message", 
                                                          [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted));
                                                       ((Cst_env.CFP_Simple (
                                                           "sigkey",
                                                           [((Cst_env.CFP_Simple (
                                                                "message", 
                                                                [])),
                                                             (Cst_env.Public,
                                                              Cst_env.Untrusted))
                                                             ]
                                                           )),
                                                        ((Cst_env.SNode
                                                            { alice_t; }),
                                                         (Cst_env.INode
                                                            { alice_t; })));
                                                       ((Cst_env.CFP_Simple (
                                                           "signature", 
                                                           [])),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("vk", 0),
                                                  (Cst_env.ExtFun
                                                     [((Cst_env.CFP_Simple (
                                                          "sigkey",
                                                          [((Cst_env.CFP_Simple (
                                                               "message", 
                                                               [])),
                                                            (Cst_env.Public,
                                                             Cst_env.Untrusted))
                                                            ]
                                                          )),
                                                       ((Cst_env.SNode
                                                           { alice_t; }),
                                                        (Cst_env.INode
                                                           { alice_t; })));
                                                       ((Cst_env.CFP_Simple (
                                                           "verkey",
                                                           [((Cst_env.CFP_Simple (
                                                                "message", 
                                                                [])),
                                                             (Cst_env.Public,
                                                              Cst_env.Untrusted))
                                                             ]
                                                           )),
                                                        (Cst_env.Public,
                                                         Cst_env.Untrusted))
                                                       ]));
                                                 (("udp_t", 0),
                                                  (Cst_env.ChanTypeDef
                                                     [((Cst_env.TProd (
                                                          ((Cst_env.TSimple (
                                                              "message", 
                                                              [])),
                                                           (Cst_env.Public,
                                                            Cst_env.Untrusted)),
                                                          ((Cst_env.TSimple (
                                                              "signature", 
                                                              [])),
                                                           (Cst_env.Public,
                                                            Cst_env.Untrusted))
                                                          )),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted))
                                                       ]));
                                                 (("conn_client", 0),
                                                  (Cst_env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("sign_key_alice", 0),
                                                  (Cst_env.SecurityTypeDef (
                                                     "sigkey",
                                                     [((Cst_env.TSimple (
                                                          "message", 
                                                          [])),
                                                       (Cst_env.Public,
                                                        Cst_env.Untrusted))
                                                       ]
                                                     )));
                                                 (("client_sig", 0),
                                                  (Cst_env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_msg", 0),
                                                  (Cst_env.SecurityTypeDef (
                                                     "message", [])));
                                                 (("attacker_ty", 0),
                                                  Cst_env.ProcTypeDef);
                                                 (("bob_t", 0),
                                                  Cst_env.ProcTypeDef);
                                                 (("alice_t", 0),
                                                  Cst_env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Cst_env.FilesysTypeDef);
                                                 (("verkey", 0),
                                                  (Cst_env.SimpleTypeDef
                                                     ["'a"]));
                                                 (("sigkey", 0),
                                                  (Cst_env.SimpleTypeDef
                                                     ["'a"]));
                                                 (("signature", 0),
                                                  (Cst_env.SimpleTypeDef []));
                                                 (("message", 0),
                                                  (Cst_env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Cst_env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Cst_env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Cst_env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Cst_env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } };
              { desc = (Cst_syntax.Tuple
                          [{ desc = Cst_syntax.Ident {id = ("msg", 29);
                                      desc = (Cst_env.Var (Syntax.Loc 29));
                                      param = None}; env = { Cst_env.vars =
                                                             [(("sig", 30),
                                                               (Cst_env.Var
                                                                  (Syntax.Loc
                                                                    30)));
                                                               (("msg", 29),
                                                                (Cst_env.Var
                                                                   (Syntax.Loc
                                                                    29)));
                                                               (("priv_key_alice",
                                                                 28),
                                                                (Cst_env.Var
                                                                   (Syntax.Loc
                                                                    28)));
                                                               (("ch_net", 27),
                                                                (Cst_env.ChannelDecl (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Cst_env.ChannelDecl (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("secret_key_alice",
                                                                 0),
                                                                (Cst_env.Const (
                                                                   false,
                                                                   ((
                                                                    Cst_env.TSimple (
                                                                    "sigkey",
                                                                    [((
                                                                    Cst_env.TSimple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    (
                                                                    (
                                                                    Cst_env.SNode
                                                                    { alice_t; }),
                                                                    (
                                                                    Cst_env.INode
                                                                    { alice_t; })))
                                                                   )));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("tamper_channel",
                                                                 0),
                                                                Cst_env.Attack);
                                                               (("provide", 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("read", 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("gen_message",
                                                                 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("close_rpc",
                                                                 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "connection",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "connection",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "string",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'c"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "connection",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("recv", 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                               (("send", 0),
                                                                (Cst_env.ExtSyscall
                                                                   [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("verify", 0),
                                                                (Cst_env.ExtFun
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "signature",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "verkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "bool",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("true", 0),
                                                                (Cst_env.ExtFun
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "bool",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("snd", 0),
                                                                (Cst_env.ExtFun
                                                                   [((
                                                                    Cst_env.CFP_Product (
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore)),
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    )),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                               (("fst", 0),
                                                                (Cst_env.ExtFun
                                                                   [((
                                                                    Cst_env.CFP_Product (
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore)),
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    )),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                               (("sign", 0),
                                                                (Cst_env.ExtFun
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "sigkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    ((
                                                                    Cst_env.SNode
                                                                    { alice_t; }),
                                                                    (Cst_env.INode
                                                                    { alice_t; })));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "signature",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("vk", 0),
                                                                (Cst_env.ExtFun
                                                                   [((
                                                                    Cst_env.CFP_Simple (
                                                                    "sigkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    ((
                                                                    Cst_env.SNode
                                                                    { alice_t; }),
                                                                    (Cst_env.INode
                                                                    { alice_t; })));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "verkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("udp_t", 0),
                                                                (Cst_env.ChanTypeDef
                                                                   [((
                                                                    Cst_env.TProd (
                                                                    ((
                                                                    Cst_env.TSimple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted)),
                                                                    ((
                                                                    Cst_env.TSimple (
                                                                    "signature",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    )),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                               (("conn_client",
                                                                 0),
                                                                (Cst_env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("sign_key_alice",
                                                                 0),
                                                                (Cst_env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [((
                                                                    Cst_env.TSimple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]
                                                                   )));
                                                               (("client_sig",
                                                                 0),
                                                                (Cst_env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_msg",
                                                                 0),
                                                                (Cst_env.SecurityTypeDef (
                                                                   "message",
                                                                   [])));
                                                               (("attacker_ty",
                                                                 0),
                                                                Cst_env.ProcTypeDef);
                                                               (("bob_t", 0),
                                                                Cst_env.ProcTypeDef);
                                                               (("alice_t", 0),
                                                                Cst_env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Cst_env.FilesysTypeDef);
                                                               (("verkey", 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("signature",
                                                                 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   []));
                                                               (("message", 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Cst_env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                            { desc = Cst_syntax.Ident {id = ("sig", 30);
                                       desc = (Cst_env.Var (Syntax.Loc 30));
                                       param = None}; env = { Cst_env.vars =
                                                              [(("sig", 30),
                                                                (Cst_env.Var
                                                                   (Syntax.Loc
                                                                    30)));
                                                                (("msg", 29),
                                                                 (Cst_env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    29)));
                                                                (("priv_key_alice",
                                                                  28),
                                                                 (Cst_env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    28)));
                                                                (("ch_net",
                                                                  27),
                                                                 (Cst_env.ChannelDecl (
                                                                    false,
                                                                    (
                                                                    "udp_t",
                                                                    0))));
                                                                (("udp", 0),
                                                                 (Cst_env.ChannelDecl (
                                                                    false,
                                                                    (
                                                                    "udp_t",
                                                                    0))));
                                                                (("secret_key_alice",
                                                                  0),
                                                                 (Cst_env.Const (
                                                                    false,
                                                                    (
                                                                    (
                                                                    Cst_env.TSimple (
                                                                    "sigkey",
                                                                    [((
                                                                    Cst_env.TSimple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    (
                                                                    (
                                                                    Cst_env.SNode
                                                                    { alice_t; }),
                                                                    (
                                                                    Cst_env.INode
                                                                    { alice_t; })))
                                                                    )));
                                                                (("eaves_mem",
                                                                  0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("tamper_channel",
                                                                  0),
                                                                 Cst_env.Attack);
                                                                (("provide",
                                                                  0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("read", 0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("gen_message",
                                                                  0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("accept_rpc",
                                                                  0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("close_rpc",
                                                                  0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "connection",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("invoke_rpc",
                                                                  0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "connection",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "string",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'c"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                                (("connect_rpc",
                                                                  0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "connection",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("recv", 0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                                (("send", 0),
                                                                 (Cst_env.ExtSyscall
                                                                    [((
                                                                    Cst_env.CFP_Chan
                                                                    [((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "unit",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("verify", 0),
                                                                 (Cst_env.ExtFun
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "signature",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "verkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "bool",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("true", 0),
                                                                 (Cst_env.ExtFun
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "bool",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("snd", 0),
                                                                 (Cst_env.ExtFun
                                                                    [((
                                                                    Cst_env.CFP_Product (
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore)),
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    )),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                                (("fst", 0),
                                                                 (Cst_env.ExtFun
                                                                    [((
                                                                    Cst_env.CFP_Product (
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore)),
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'b"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    )),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore));
                                                                    ((
                                                                    Cst_env.CFP_Poly
                                                                    "'a"),
                                                                    (Cst_env.S_Ignore,
                                                                    Cst_env.I_Ignore))
                                                                    ]));
                                                                (("sign", 0),
                                                                 (Cst_env.ExtFun
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "sigkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    ((
                                                                    Cst_env.SNode
                                                                    { alice_t; }),
                                                                    (Cst_env.INode
                                                                    { alice_t; })));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "signature",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("vk", 0),
                                                                 (Cst_env.ExtFun
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "sigkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    ((
                                                                    Cst_env.SNode
                                                                    { alice_t; }),
                                                                    (Cst_env.INode
                                                                    { alice_t; })));
                                                                    ((
                                                                    Cst_env.CFP_Simple (
                                                                    "verkey",
                                                                    [((
                                                                    Cst_env.CFP_Simple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("udp_t", 0),
                                                                 (Cst_env.ChanTypeDef
                                                                    [((
                                                                    Cst_env.TProd (
                                                                    ((
                                                                    Cst_env.TSimple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted)),
                                                                    ((
                                                                    Cst_env.TSimple (
                                                                    "signature",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    )),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ]));
                                                                (("conn_client",
                                                                  0),
                                                                 (Cst_env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                (("sign_key_alice",
                                                                  0),
                                                                 (Cst_env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [((
                                                                    Cst_env.TSimple (
                                                                    "message",
                                                                    [])),
                                                                    (Cst_env.Public,
                                                                    Cst_env.Untrusted))
                                                                    ])));
                                                                (("client_sig",
                                                                  0),
                                                                 (Cst_env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                (("client_msg",
                                                                  0),
                                                                 (Cst_env.SecurityTypeDef (
                                                                    "message",
                                                                    [])));
                                                                (("attacker_ty",
                                                                  0),
                                                                 Cst_env.ProcTypeDef);
                                                                (("bob_t", 0),
                                                                 Cst_env.ProcTypeDef);
                                                                (("alice_t",
                                                                  0),
                                                                 Cst_env.ProcTypeDef);
                                                                (("readonly_t",
                                                                  0),
                                                                 Cst_env.FilesysTypeDef);
                                                                (("verkey", 0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("sigkey", 0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("signature",
                                                                  0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    []));
                                                                (("message",
                                                                  0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    []));
                                                                (("connection",
                                                                  0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    []));
                                                                (("unit", 0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    []));
                                                                (("bool", 0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    []));
                                                                (("string", 0),
                                                                 (Cst_env.SimpleTypeDef
                                                                    []))
                                                                ];
                                                              facts =
                                                              ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } }
                            ]); env = { Cst_env.vars =
                                        [(("sig", 30),
                                          (Cst_env.Var (Syntax.Loc 30)));
                                          (("msg", 29),
                                           (Cst_env.Var (Syntax.Loc 29)));
                                          (("priv_key_alice", 28),
                                           (Cst_env.Var (Syntax.Loc 28)));
                                          (("ch_net", 27),
                                           (Cst_env.ChannelDecl (false,
                                              ("udp_t", 0))));
                                          (("udp", 0),
                                           (Cst_env.ChannelDecl (false,
                                              ("udp_t", 0))));
                                          (("secret_key_alice", 0),
                                           (Cst_env.Const (false,
                                              ((Cst_env.TSimple ("sigkey",
                                                  [((Cst_env.TSimple (
                                                       "message", [])),
                                                    (Cst_env.Public,
                                                     Cst_env.Untrusted))
                                                    ]
                                                  )),
                                               ((Cst_env.SNode { alice_t; }),
                                                (Cst_env.INode { alice_t; })))
                                              )));
                                          (("eaves_mem", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Poly "'a"),
                                                (Cst_env.S_Ignore,
                                                 Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Simple ("unit",
                                                    [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("tamper_channel", 0),
                                           Cst_env.Attack);
                                          (("provide", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Simple ("unit",
                                                   [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted))
                                                ]));
                                          (("read", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Simple ("unit",
                                                   [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted))
                                                ]));
                                          (("gen_message", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Simple (
                                                   "message", [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted))
                                                ]));
                                          (("accept_rpc", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Chan
                                                   [((Cst_env.CFP_Poly "'a"),
                                                     (Cst_env.S_Ignore,
                                                      Cst_env.I_Ignore))
                                                     ]),
                                                (Cst_env.S_Ignore,
                                                 Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Simple ("unit",
                                                    [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("close_rpc", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Simple (
                                                   "connection", [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted));
                                                ((Cst_env.CFP_Simple ("unit",
                                                    [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("invoke_rpc", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Simple (
                                                   "connection", [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted));
                                                ((Cst_env.CFP_Simple (
                                                    "string", [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted));
                                                ((Cst_env.CFP_Poly "'a"),
                                                 (Cst_env.S_Ignore,
                                                  Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Poly "'b"),
                                                 (Cst_env.S_Ignore,
                                                  Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Poly "'c"),
                                                 (Cst_env.S_Ignore,
                                                  Cst_env.I_Ignore))
                                                ]));
                                          (("connect_rpc", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Chan
                                                   [((Cst_env.CFP_Poly "'a"),
                                                     (Cst_env.S_Ignore,
                                                      Cst_env.I_Ignore))
                                                     ]),
                                                (Cst_env.S_Ignore,
                                                 Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Simple (
                                                    "connection", [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("recv", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Chan
                                                   [((Cst_env.CFP_Poly "'a"),
                                                     (Cst_env.S_Ignore,
                                                      Cst_env.I_Ignore))
                                                     ]),
                                                (Cst_env.S_Ignore,
                                                 Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Poly "'a"),
                                                 (Cst_env.S_Ignore,
                                                  Cst_env.I_Ignore))
                                                ]));
                                          (("send", 0),
                                           (Cst_env.ExtSyscall
                                              [((Cst_env.CFP_Chan
                                                   [((Cst_env.CFP_Poly "'a"),
                                                     (Cst_env.S_Ignore,
                                                      Cst_env.I_Ignore))
                                                     ]),
                                                (Cst_env.S_Ignore,
                                                 Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Poly "'a"),
                                                 (Cst_env.S_Ignore,
                                                  Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Simple ("unit",
                                                    [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("verify", 0),
                                           (Cst_env.ExtFun
                                              [((Cst_env.CFP_Simple (
                                                   "signature", [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted));
                                                ((Cst_env.CFP_Simple (
                                                    "message", [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted));
                                                ((Cst_env.CFP_Simple (
                                                    "verkey",
                                                    [((Cst_env.CFP_Simple (
                                                         "message", [])),
                                                      (Cst_env.Public,
                                                       Cst_env.Untrusted))
                                                      ]
                                                    )),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted));
                                                ((Cst_env.CFP_Simple ("bool",
                                                    [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("true", 0),
                                           (Cst_env.ExtFun
                                              [((Cst_env.CFP_Simple ("bool",
                                                   [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted))
                                                ]));
                                          (("snd", 0),
                                           (Cst_env.ExtFun
                                              [((Cst_env.CFP_Product (
                                                   ((Cst_env.CFP_Poly "'a"),
                                                    (Cst_env.S_Ignore,
                                                     Cst_env.I_Ignore)),
                                                   ((Cst_env.CFP_Poly "'b"),
                                                    (Cst_env.S_Ignore,
                                                     Cst_env.I_Ignore))
                                                   )),
                                                (Cst_env.S_Ignore,
                                                 Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Poly "'b"),
                                                 (Cst_env.S_Ignore,
                                                  Cst_env.I_Ignore))
                                                ]));
                                          (("fst", 0),
                                           (Cst_env.ExtFun
                                              [((Cst_env.CFP_Product (
                                                   ((Cst_env.CFP_Poly "'a"),
                                                    (Cst_env.S_Ignore,
                                                     Cst_env.I_Ignore)),
                                                   ((Cst_env.CFP_Poly "'b"),
                                                    (Cst_env.S_Ignore,
                                                     Cst_env.I_Ignore))
                                                   )),
                                                (Cst_env.S_Ignore,
                                                 Cst_env.I_Ignore));
                                                ((Cst_env.CFP_Poly "'a"),
                                                 (Cst_env.S_Ignore,
                                                  Cst_env.I_Ignore))
                                                ]));
                                          (("sign", 0),
                                           (Cst_env.ExtFun
                                              [((Cst_env.CFP_Simple (
                                                   "message", [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted));
                                                ((Cst_env.CFP_Simple (
                                                    "sigkey",
                                                    [((Cst_env.CFP_Simple (
                                                         "message", [])),
                                                      (Cst_env.Public,
                                                       Cst_env.Untrusted))
                                                      ]
                                                    )),
                                                 ((Cst_env.SNode { alice_t; }),
                                                  (Cst_env.INode { alice_t; })));
                                                ((Cst_env.CFP_Simple (
                                                    "signature", [])),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("vk", 0),
                                           (Cst_env.ExtFun
                                              [((Cst_env.CFP_Simple (
                                                   "sigkey",
                                                   [((Cst_env.CFP_Simple (
                                                        "message", [])),
                                                     (Cst_env.Public,
                                                      Cst_env.Untrusted))
                                                     ]
                                                   )),
                                                ((Cst_env.SNode { alice_t; }),
                                                 (Cst_env.INode { alice_t; })));
                                                ((Cst_env.CFP_Simple (
                                                    "verkey",
                                                    [((Cst_env.CFP_Simple (
                                                         "message", [])),
                                                      (Cst_env.Public,
                                                       Cst_env.Untrusted))
                                                      ]
                                                    )),
                                                 (Cst_env.Public,
                                                  Cst_env.Untrusted))
                                                ]));
                                          (("udp_t", 0),
                                           (Cst_env.ChanTypeDef
                                              [((Cst_env.TProd (
                                                   ((Cst_env.TSimple (
                                                       "message", [])),
                                                    (Cst_env.Public,
                                                     Cst_env.Untrusted)),
                                                   ((Cst_env.TSimple (
                                                       "signature", [])),
                                                    (Cst_env.Public,
                                                     Cst_env.Untrusted))
                                                   )),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted))
                                                ]));
                                          (("conn_client", 0),
                                           (Cst_env.SecurityTypeDef (
                                              "connection", [])));
                                          (("sign_key_alice", 0),
                                           (Cst_env.SecurityTypeDef (
                                              "sigkey",
                                              [((Cst_env.TSimple ("message",
                                                   [])),
                                                (Cst_env.Public,
                                                 Cst_env.Untrusted))
                                                ]
                                              )));
                                          (("client_sig", 0),
                                           (Cst_env.SecurityTypeDef (
                                              "signature", [])));
                                          (("client_msg", 0),
                                           (Cst_env.SecurityTypeDef (
                                              "message", [])));
                                          (("attacker_ty", 0),
                                           Cst_env.ProcTypeDef);
                                          (("bob_t", 0), Cst_env.ProcTypeDef);
                                          (("alice_t", 0),
                                           Cst_env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Cst_env.FilesysTypeDef);
                                          (("verkey", 0),
                                           (Cst_env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Cst_env.SimpleTypeDef ["'a"]));
                                          (("signature", 0),
                                           (Cst_env.SimpleTypeDef []));
                                          (("message", 0),
                                           (Cst_env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Cst_env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Cst_env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Cst_env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Cst_env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }
              ]
            )); env = { Cst_env.vars =
                        [(("sig", 30), (Cst_env.Var (Syntax.Loc 30)));
                          (("msg", 29), (Cst_env.Var (Syntax.Loc 29)));
                          (("priv_key_alice", 28),
                           (Cst_env.Var (Syntax.Loc 28)));
                          (("ch_net", 27),
                           (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                          (("udp", 0),
                           (Cst_env.ChannelDecl (false, ("udp_t", 0))));
                          (("secret_key_alice", 0),
                           (Cst_env.Const (false,
                              ((Cst_env.TSimple ("sigkey",
                                  [((Cst_env.TSimple ("message", [])),
                                    (Cst_env.Public, Cst_env.Untrusted))]
                                  )),
                               ((Cst_env.SNode { alice_t; }),
                                (Cst_env.INode { alice_t; })))
                              )));
                          (("eaves_mem", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Poly "'a"),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("tamper_channel", 0), Cst_env.Attack);
                          (("provide", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("unit", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("read", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("unit", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("gen_message", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("accept_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("close_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("connection", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("invoke_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Simple ("connection", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("string", [])),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'b"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'c"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("connect_rpc", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("connection", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("recv", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("send", 0),
                           (Cst_env.ExtSyscall
                              [((Cst_env.CFP_Chan
                                   [((Cst_env.CFP_Poly "'a"),
                                     (Cst_env.S_Ignore, Cst_env.I_Ignore))]),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Simple ("unit", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("verify", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("signature", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("message", [])),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("verkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("bool", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("true", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("bool", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("snd", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Product (
                                   ((Cst_env.CFP_Poly "'a"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                                   ((Cst_env.CFP_Poly "'b"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                   )),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'b"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("fst", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Product (
                                   ((Cst_env.CFP_Poly "'a"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore)),
                                   ((Cst_env.CFP_Poly "'b"),
                                    (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                   )),
                                (Cst_env.S_Ignore, Cst_env.I_Ignore));
                                ((Cst_env.CFP_Poly "'a"),
                                 (Cst_env.S_Ignore, Cst_env.I_Ignore))
                                ]));
                          (("sign", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted));
                                ((Cst_env.CFP_Simple ("sigkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 ((Cst_env.SNode { alice_t; }),
                                  (Cst_env.INode { alice_t; })));
                                ((Cst_env.CFP_Simple ("signature", [])),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("vk", 0),
                           (Cst_env.ExtFun
                              [((Cst_env.CFP_Simple ("sigkey",
                                   [((Cst_env.CFP_Simple ("message", [])),
                                     (Cst_env.Public, Cst_env.Untrusted))]
                                   )),
                                ((Cst_env.SNode { alice_t; }),
                                 (Cst_env.INode { alice_t; })));
                                ((Cst_env.CFP_Simple ("verkey",
                                    [((Cst_env.CFP_Simple ("message", [])),
                                      (Cst_env.Public, Cst_env.Untrusted))]
                                    )),
                                 (Cst_env.Public, Cst_env.Untrusted))
                                ]));
                          (("udp_t", 0),
                           (Cst_env.ChanTypeDef
                              [((Cst_env.TProd (
                                   ((Cst_env.TSimple ("message", [])),
                                    (Cst_env.Public, Cst_env.Untrusted)),
                                   ((Cst_env.TSimple ("signature", [])),
                                    (Cst_env.Public, Cst_env.Untrusted))
                                   )),
                                (Cst_env.Public, Cst_env.Untrusted))]));
                          (("conn_client", 0),
                           (Cst_env.SecurityTypeDef ("connection", [])));
                          (("sign_key_alice", 0),
                           (Cst_env.SecurityTypeDef ("sigkey",
                              [((Cst_env.TSimple ("message", [])),
                                (Cst_env.Public, Cst_env.Untrusted))]
                              )));
                          (("client_sig", 0),
                           (Cst_env.SecurityTypeDef ("signature", [])));
                          (("client_msg", 0),
                           (Cst_env.SecurityTypeDef ("message", [])));
                          (("attacker_ty", 0), Cst_env.ProcTypeDef);
                          (("bob_t", 0), Cst_env.ProcTypeDef);
                          (("alice_t", 0), Cst_env.ProcTypeDef);
                          (("readonly_t", 0), Cst_env.FilesysTypeDef);
                          (("verkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Cst_env.SimpleTypeDef ["'a"]));
                          (("signature", 0), (Cst_env.SimpleTypeDef []));
                          (("message", 0), (Cst_env.SimpleTypeDef []));
                          (("connection", 0), (Cst_env.SimpleTypeDef []));
                          (("unit", 0), (Cst_env.SimpleTypeDef []));
                          (("bool", 0), (Cst_env.SimpleTypeDef []));
                          (("string", 0), (Cst_env.SimpleTypeDef []))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
Running typeof_cmd on process name bob
Loading complete..
