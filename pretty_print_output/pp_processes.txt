{ desc = Typed.Process {id = ("client", 0); param = None;
           args =
           [{ Typed.channel = ("ch_net", 35); param = None;
              typ = ("udp_t", 0) };
             { Typed.channel = ("ch_rpc", 36); param = None;
               typ = ("rpc_t", 0) }
             ];
           typ = ("client_t", 0); files = [];
           vars =
           [(("dev_path", 37),
             { desc = (Typed.String "/dev/camera"); env = { Env.vars =
                                                            [(("ch_rpc", 36),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                              (("ch_net", 35),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("rpc", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("rpc_t", 0)
                                                                  )));
                                                              (("udp", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("init_data",
                                                                0),
                                                               (Env.Const
                                                                  false));
                                                              (("sym_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("priv_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("eaves_mem",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("rpc_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("client_ta_t",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("client_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("server_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("fclose", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fread", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fopen", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("h", 0),
                                                               (Env.ExtFun 1));
                                                              (("get_picture",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("dec", 0),
                                                               (Env.ExtFun 2));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("enc", 0),
                                                               (Env.ExtFun 2));
                                                              (("pk", 0),
                                                               (Env.ExtFun 1))
                                                              ];
                                                            facts =
                                                            ref ([("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } });
             (("privkey_path", 38),
              { desc = (Typed.String "/secret/priv"); env = { Env.vars =
                                                              [(("dev_path",
                                                                 37),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    37)));
                                                                (("ch_rpc",
                                                                  36),
                                                                 (Env.Channel (
                                                                    false,
                                                                    (
                                                                    "rpc_t",
                                                                    0))));
                                                                (("ch_net",
                                                                  35),
                                                                 (Env.Channel (
                                                                    false,
                                                                    (
                                                                    "udp_t",
                                                                    0))));
                                                                (("rpc", 0),
                                                                 (Env.Channel (
                                                                    false,
                                                                    (
                                                                    "rpc_t",
                                                                    0))));
                                                                (("udp", 0),
                                                                 (Env.Channel (
                                                                    false,
                                                                    (
                                                                    "udp_t",
                                                                    0))));
                                                                (("init_data",
                                                                  0),
                                                                 (Env.Const
                                                                    false));
                                                                (("sym_k", 0),
                                                                 (Env.Const
                                                                    false));
                                                                (("priv_k", 0),
                                                                 (Env.Const
                                                                    false));
                                                                (("eaves_mem",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("tamper_channel",
                                                                  0),
                                                                 Env.Attack);
                                                                (("rpc_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    []));
                                                                (("udp_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    []));
                                                                (("client_ta_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("client_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("server_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("readonly_t",
                                                                  0),
                                                                 Env.FilesysTypeDef);
                                                                (("fclose", 0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("fread", 0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("fopen", 0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("h", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("get_picture",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    0));
                                                                (("accept_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("close_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("invoke_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    4));
                                                                (("connect_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("recv", 0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("send", 0),
                                                                 (Env.ExtSyscall
                                                                    2));
                                                                (("verify", 0),
                                                                 (Env.ExtFun
                                                                    3));
                                                                (("true", 0),
                                                                 Env.ExtConst);
                                                                (("snd", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("fst", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("dec", 0),
                                                                 (Env.ExtFun
                                                                    2));
                                                                (("sign", 0),
                                                                 (Env.ExtFun
                                                                    2));
                                                                (("enc", 0),
                                                                 (Env.ExtFun
                                                                    2));
                                                                (("pk", 0),
                                                                 (Env.ExtFun
                                                                    1))
                                                                ];
                                                              facts =
                                                              ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } });
             (("invoke_func", 39),
              { desc = (Typed.String "sign_image"); env = { Env.vars =
                                                            [(("privkey_path",
                                                               38),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    38)));
                                                              (("dev_path",
                                                                37),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    37)));
                                                              (("ch_rpc", 36),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("rpc_t", 0)
                                                                  )));
                                                              (("ch_net", 35),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("rpc", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("rpc_t", 0)
                                                                  )));
                                                              (("udp", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("init_data",
                                                                0),
                                                               (Env.Const
                                                                  false));
                                                              (("sym_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("priv_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("eaves_mem",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("rpc_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("client_ta_t",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("client_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("server_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("fclose", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fread", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fopen", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("h", 0),
                                                               (Env.ExtFun 1));
                                                              (("get_picture",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("dec", 0),
                                                               (Env.ExtFun 2));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("enc", 0),
                                                               (Env.ExtFun 2));
                                                              (("pk", 0),
                                                               (Env.ExtFun 1))
                                                              ];
                                                            facts =
                                                            ref ([("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } })
             ];
           funcs = [];
           main =
           { desc = (Typed.Let (("conn", 40),
                       { desc = (Typed.Apply (("connect_rpc", 0),
                                   [{ desc = Typed.Ident {
                                               id = ("ch_rpc", 36);
                                               desc =
                                               (Env.Channel (false,
                                                  ("rpc_t", 0)));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]
                                   )); env = { Env.vars =
                                               [(("invoke_func", 39),
                                                 (Env.Var (Syntax.Loc 39)));
                                                 (("privkey_path", 38),
                                                  (Env.Var (Syntax.Loc 38)));
                                                 (("dev_path", 37),
                                                  (Env.Var (Syntax.Loc 37)));
                                                 (("ch_rpc", 36),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("ch_net", 35),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("rpc", 0),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("init_data", 0),
                                                  (Env.Const false));
                                                 (("sym_k", 0),
                                                  (Env.Const false));
                                                 (("priv_k", 0),
                                                  (Env.Const false));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("fclose", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fread", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fopen", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("h", 0), (Env.ExtFun 1));
                                                 (("get_picture", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("dec", 0), (Env.ExtFun 2));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("enc", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("ClientTAClose",
                                                       (Env.Global, (Some 0)));
                                                      ("InValidName",
                                                       (Env.Plain, (Some 1)));
                                                      ("ClientClose",
                                                       (Env.Global, (Some 0)));
                                                      ("ImgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("Fd",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } },
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.While (
                                               [{ Typed.fresh = [];
                                                  facts = [];
                                                  cmd =
                                                  { desc = (Typed.Let (
                                                              ("image", 41),
                                                              { desc = (
                                                              Typed.Apply (
                                                                ("get_picture",
                                                                 0),
                                                                [])); env = 
                                                              { Env.vars =
                                                                [(("conn", 40),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                  (("invoke_func",
                                                                    39),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                  (("privkey_path",
                                                                    38),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                  (("dev_path",
                                                                    37),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                  (("ch_rpc",
                                                                    36),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("ch_net",
                                                                    35),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("rpc", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("init_data",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("sym_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("priv_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("fclose",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fread",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fopen",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("h", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("get_picture",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("dec", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("enc", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } },
                                                              { desc = (
                                                              Typed.Sequence (
                                                                { desc = (
                                                                Typed.Assign (
                                                                  None,
                                                                  { desc = (
                                                                  Typed.Apply (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "image",
                                                                    41);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    41));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  )); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "image",
                                                                    41),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    (
                                                                    (
                                                                    "conn",
                                                                    40),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    (
                                                                    (
                                                                    "invoke_func",
                                                                    39),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    (
                                                                    (
                                                                    "privkey_path",
                                                                    38),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    (
                                                                    (
                                                                    "dev_path",
                                                                    37),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    (
                                                                    (
                                                                    "ch_rpc",
                                                                    36),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    35),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } },
                                                                { desc = (
                                                                Typed.Let (
                                                                  ("sig", 42),
                                                                  { desc = (
                                                                  Typed.Apply (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "conn",
                                                                    40);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    40));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "invoke_func",
                                                                    39);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    39));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "image",
                                                                    41);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    41));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "privkey_path",
                                                                    38);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    38));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                  { desc = (
                                                                  Typed.Sequence (
                                                                    { desc = (
                                                                    Typed.Assign (
                                                                    None,
                                                                    { desc = (
                                                                    Typed.Apply (
                                                                    ("eaves_mem",
                                                                    0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig", 42);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    42));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = (
                                                                    Typed.Sequence (
                                                                    { desc = (
                                                                    Typed.Event
                                                                    [{ desc = (
                                                                    Typed.Global (
                                                                    "ImgSend",
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "image",
                                                                    41);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    41));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = (
                                                                    Typed.Assign (
                                                                    None,
                                                                    { desc = (
                                                                    Typed.Apply (
                                                                    ("send",
                                                                    0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "ch_net",
                                                                    35);
                                                                    desc =
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0)));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = (
                                                                    Typed.Tuple
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig", 42);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    42));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "image",
                                                                    41);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    41));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "sig", 42),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    42)));
                                                                    ((
                                                                    "image",
                                                                    41),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    ((
                                                                    "conn",
                                                                    40),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    ((
                                                                    "dev_path",
                                                                    37),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "ch_net",
                                                                    35),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  )); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "image",
                                                                    41),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                    (
                                                                    (
                                                                    "conn",
                                                                    40),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                    (
                                                                    (
                                                                    "invoke_func",
                                                                    39),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                    (
                                                                    (
                                                                    "privkey_path",
                                                                    38),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                    (
                                                                    (
                                                                    "dev_path",
                                                                    37),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                    (
                                                                    (
                                                                    "ch_rpc",
                                                                    36),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    35),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                )); env = 
                                                              { Env.vars =
                                                                [(("image",
                                                                   41),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    41)));
                                                                  (("conn",
                                                                    40),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                  (("invoke_func",
                                                                    39),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                  (("privkey_path",
                                                                    38),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                  (("dev_path",
                                                                    37),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                  (("ch_rpc",
                                                                    36),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("ch_net",
                                                                    35),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("rpc", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("init_data",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("sym_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("priv_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("fclose",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fread",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fopen",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("h", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("get_picture",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("dec", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("enc", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              )); env = 
                                                  { Env.vars =
                                                    [(("conn", 40),
                                                      (Env.Var
                                                         (Syntax.Loc 40)));
                                                      (("invoke_func", 39),
                                                       (Env.Var
                                                          (Syntax.Loc 39)));
                                                      (("privkey_path", 38),
                                                       (Env.Var
                                                          (Syntax.Loc 38)));
                                                      (("dev_path", 37),
                                                       (Env.Var
                                                          (Syntax.Loc 37)));
                                                      (("ch_rpc", 36),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("ch_net", 35),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("rpc", 0),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("udp", 0),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("init_data", 0),
                                                       (Env.Const false));
                                                      (("sym_k", 0),
                                                       (Env.Const false));
                                                      (("priv_k", 0),
                                                       (Env.Const false));
                                                      (("eaves_mem", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("tamper_channel", 0),
                                                       Env.Attack);
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("fclose", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fread", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fopen", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("h", 0),
                                                       (Env.ExtFun 1));
                                                      (("get_picture", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("dec", 0),
                                                       (Env.ExtFun 2));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("enc", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ClientTAClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("InValidName",
                                                            (Env.Plain,
                                                             (Some 1)));
                                                           ("ClientClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("ImgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Fd",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ],
                                               [{ Typed.fresh = [];
                                                  facts = [];
                                                  cmd =
                                                  { desc = Typed.Skip; env = 
                                                  { Env.vars =
                                                    [(("conn", 40),
                                                      (Env.Var
                                                         (Syntax.Loc 40)));
                                                      (("invoke_func", 39),
                                                       (Env.Var
                                                          (Syntax.Loc 39)));
                                                      (("privkey_path", 38),
                                                       (Env.Var
                                                          (Syntax.Loc 38)));
                                                      (("dev_path", 37),
                                                       (Env.Var
                                                          (Syntax.Loc 37)));
                                                      (("ch_rpc", 36),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("ch_net", 35),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("rpc", 0),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("udp", 0),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("init_data", 0),
                                                       (Env.Const false));
                                                      (("sym_k", 0),
                                                       (Env.Const false));
                                                      (("priv_k", 0),
                                                       (Env.Const false));
                                                      (("eaves_mem", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("tamper_channel", 0),
                                                       Env.Attack);
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("fclose", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fread", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fopen", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("h", 0),
                                                       (Env.ExtFun 1));
                                                      (("get_picture", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("dec", 0),
                                                       (Env.ExtFun 2));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("enc", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ClientTAClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("InValidName",
                                                            (Env.Plain,
                                                             (Some 1)));
                                                           ("ClientClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("ImgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Fd",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ]
                                               )); env = { Env.vars =
                                                           [(("conn", 40),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   40)));
                                                             (("invoke_func",
                                                               39),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    39)));
                                                             (("privkey_path",
                                                               38),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    38)));
                                                             (("dev_path", 37),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    37)));
                                                             (("ch_rpc", 36),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("ch_net", 35),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("rpc", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("init_data", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("sym_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("priv_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("rpc_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_ta_t",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("server_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("fclose", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fread", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fopen", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("h", 0),
                                                              (Env.ExtFun 1));
                                                             (("get_picture",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("dec", 0),
                                                              (Env.ExtFun 2));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("enc", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } },
                                   { desc = (Typed.Sequence (
                                               { desc = (Typed.Assign (None,
                                                           { desc = (
                                                           Typed.Apply (
                                                             ("close_rpc", 0),
                                                             [{ desc = 
                                                               Typed.Ident {
                                                                 id =
                                                                 ("conn", 40);
                                                                 desc =
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    40));
                                                                 param = None}; env = 
                                                               { Env.vars =
                                                                 [(("conn",
                                                                    40),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    40)));
                                                                   ((
                                                                    "invoke_func",
                                                                    39),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                   ((
                                                                    "privkey_path",
                                                                    38),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                   ((
                                                                    "dev_path",
                                                                    37),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                   ((
                                                                    "ch_rpc",
                                                                    36),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "ch_net",
                                                                    35),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               ]
                                                             )); env = 
                                                           { Env.vars =
                                                             [(("conn", 40),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    40)));
                                                               (("invoke_func",
                                                                 39),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    39)));
                                                               (("privkey_path",
                                                                 38),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    38)));
                                                               (("dev_path",
                                                                 37),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    37)));
                                                               (("ch_rpc", 36),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("ch_net", 35),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("rpc", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("init_data",
                                                                 0),
                                                                (Env.Const
                                                                   false));
                                                               (("sym_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("priv_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("fclose", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fread", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fopen", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("h", 0),
                                                                (Env.ExtFun 1));
                                                               (("get_picture",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("dec", 0),
                                                                (Env.ExtFun 2));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("enc", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                                           )); env = 
                                               { Env.vars =
                                                 [(("conn", 40),
                                                   (Env.Var (Syntax.Loc 40)));
                                                   (("invoke_func", 39),
                                                    (Env.Var (Syntax.Loc 39)));
                                                   (("privkey_path", 38),
                                                    (Env.Var (Syntax.Loc 38)));
                                                   (("dev_path", 37),
                                                    (Env.Var (Syntax.Loc 37)));
                                                   (("ch_rpc", 36),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("ch_net", 35),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("rpc", 0),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("init_data", 0),
                                                    (Env.Const false));
                                                   (("sym_k", 0),
                                                    (Env.Const false));
                                                   (("priv_k", 0),
                                                    (Env.Const false));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("fclose", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fread", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fopen", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("h", 0), (Env.ExtFun 1));
                                                   (("get_picture", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("dec", 0),
                                                    (Env.ExtFun 2));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("enc", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ClientTAClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("InValidName",
                                                         (Env.Plain, (Some 1)));
                                                        ("ClientClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("ImgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Fd",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               { desc = (Typed.Event
                                                           [{ desc = (
                                                             Typed.Global (
                                                               "ClientClose",
                                                               [])); env = 
                                                             { Env.vars =
                                                               [(("conn", 40),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    40)));
                                                                 (("invoke_func",
                                                                   39),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    39)));
                                                                 (("privkey_path",
                                                                   38),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    38)));
                                                                 (("dev_path",
                                                                   37),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    37)));
                                                                 (("ch_rpc",
                                                                   36),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                 (("ch_net",
                                                                   35),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("rpc", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("init_data",
                                                                   0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("sym_k", 0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("priv_k",
                                                                   0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("rpc_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_ta_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("server_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("fclose",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("fread", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("fopen", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("h", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("get_picture",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("dec", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("enc", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]); env = 
                                               { Env.vars =
                                                 [(("conn", 40),
                                                   (Env.Var (Syntax.Loc 40)));
                                                   (("invoke_func", 39),
                                                    (Env.Var (Syntax.Loc 39)));
                                                   (("privkey_path", 38),
                                                    (Env.Var (Syntax.Loc 38)));
                                                   (("dev_path", 37),
                                                    (Env.Var (Syntax.Loc 37)));
                                                   (("ch_rpc", 36),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("ch_net", 35),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("rpc", 0),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("init_data", 0),
                                                    (Env.Const false));
                                                   (("sym_k", 0),
                                                    (Env.Const false));
                                                   (("priv_k", 0),
                                                    (Env.Const false));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("fclose", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fread", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fopen", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("h", 0), (Env.ExtFun 1));
                                                   (("get_picture", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("dec", 0),
                                                    (Env.ExtFun 2));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("enc", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ClientTAClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("InValidName",
                                                         (Env.Plain, (Some 1)));
                                                        ("ClientClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("ImgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Fd",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                                               )); env = { Env.vars =
                                                           [(("conn", 40),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   40)));
                                                             (("invoke_func",
                                                               39),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    39)));
                                                             (("privkey_path",
                                                               38),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    38)));
                                                             (("dev_path", 37),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    37)));
                                                             (("ch_rpc", 36),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("ch_net", 35),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("rpc", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("init_data", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("sym_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("priv_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("rpc_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_ta_t",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("server_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("fclose", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fread", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fopen", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("h", 0),
                                                              (Env.ExtFun 1));
                                                             (("get_picture",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("dec", 0),
                                                              (Env.ExtFun 2));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("enc", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } }
                                   )); env = { Env.vars =
                                               [(("conn", 40),
                                                 (Env.Var (Syntax.Loc 40)));
                                                 (("invoke_func", 39),
                                                  (Env.Var (Syntax.Loc 39)));
                                                 (("privkey_path", 38),
                                                  (Env.Var (Syntax.Loc 38)));
                                                 (("dev_path", 37),
                                                  (Env.Var (Syntax.Loc 37)));
                                                 (("ch_rpc", 36),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("ch_net", 35),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("rpc", 0),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("init_data", 0),
                                                  (Env.Const false));
                                                 (("sym_k", 0),
                                                  (Env.Const false));
                                                 (("priv_k", 0),
                                                  (Env.Const false));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("fclose", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fread", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fopen", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("h", 0), (Env.ExtFun 1));
                                                 (("get_picture", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("dec", 0), (Env.ExtFun 2));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("enc", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("ClientTAClose",
                                                       (Env.Global, (Some 0)));
                                                      ("InValidName",
                                                       (Env.Plain, (Some 1)));
                                                      ("ClientClose",
                                                       (Env.Global, (Some 0)));
                                                      ("ImgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("Fd",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("invoke_func", 39),
                                     (Env.Var (Syntax.Loc 39)));
                                     (("privkey_path", 38),
                                      (Env.Var (Syntax.Loc 38)));
                                     (("dev_path", 37),
                                      (Env.Var (Syntax.Loc 37)));
                                     (("ch_rpc", 36),
                                      (Env.Channel (false, ("rpc_t", 0))));
                                     (("ch_net", 35),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("rpc", 0),
                                      (Env.Channel (false, ("rpc_t", 0))));
                                     (("udp", 0),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("init_data", 0), (Env.Const false));
                                     (("sym_k", 0), (Env.Const false));
                                     (("priv_k", 0), (Env.Const false));
                                     (("eaves_mem", 0), (Env.ExtSyscall 1));
                                     (("tamper_channel", 0), Env.Attack);
                                     (("rpc_t", 0), (Env.ChanTypeDef []));
                                     (("udp_t", 0), (Env.ChanTypeDef []));
                                     (("client_ta_t", 0), Env.ProcTypeDef);
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("server_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("fclose", 0), (Env.ExtSyscall 1));
                                     (("fread", 0), (Env.ExtSyscall 1));
                                     (("fopen", 0), (Env.ExtSyscall 1));
                                     (("h", 0), (Env.ExtFun 1));
                                     (("get_picture", 0), (Env.ExtSyscall 0));
                                     (("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("dec", 0), (Env.ExtFun 2));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("enc", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("False", (Env.Global, (Some 0)));
                                          ("ImgRecvInvalid",
                                           (Env.Global, (Some 1)));
                                          ("ImgRecvValid",
                                           (Env.Global, (Some 1)));
                                          ("ClientTAClose",
                                           (Env.Global, (Some 0)));
                                          ("InValidName",
                                           (Env.Plain, (Some 1)));
                                          ("ClientClose",
                                           (Env.Global, (Some 0)));
                                          ("ImgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("Fd", (Env.Structure, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("rpc", 0),
                                                   (Env.Channel (false,
                                                      ("rpc_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("init_data", 0),
                                                    (Env.Const false));
                                                   (("sym_k", 0),
                                                    (Env.Const false));
                                                   (("priv_k", 0),
                                                    (Env.Const false));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("fclose", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fread", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fopen", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("h", 0), (Env.ExtFun 1));
                                                   (("get_picture", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("dec", 0),
                                                    (Env.ExtFun 2));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("enc", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ClientTAClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("InValidName",
                                                         (Env.Plain, (Some 1)));
                                                        ("ClientClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("ImgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Fd",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Process {id = ("client_ta", 0); param = None;
           args =
           [{ Typed.channel = ("ch_rpc", 43); param = None;
              typ = ("rpc_t", 0) }
             ];
           typ = ("client_ta_t", 0);
           files =
           [({ desc = (Typed.String "/secret/priv"); env = { Env.vars =
                                                             [(("ch_rpc", 43),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("rpc_t", 0)
                                                                  )));
                                                               (("client", 0),
                                                                Env.Process);
                                                               (("rpc", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("init_data",
                                                                 0),
                                                                (Env.Const
                                                                   false));
                                                               (("sym_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("priv_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("fclose", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fread", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fopen", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("h", 0),
                                                                (Env.ExtFun 1));
                                                               (("get_picture",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("dec", 0),
                                                                (Env.ExtFun 2));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("enc", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
             ("readonly_t", 0),
             { desc = (Typed.Apply (("enc", 0),
                         [{ desc = Typed.Ident {id = ("priv_k", 0);
                                     desc = (Env.Const false); param = None}; env = 
                           { Env.vars =
                             [(("ch_rpc", 43),
                               (Env.Channel (false, ("rpc_t", 0))));
                               (("client", 0), Env.Process);
                               (("rpc", 0),
                                (Env.Channel (false, ("rpc_t", 0))));
                               (("udp", 0),
                                (Env.Channel (false, ("udp_t", 0))));
                               (("init_data", 0), (Env.Const false));
                               (("sym_k", 0), (Env.Const false));
                               (("priv_k", 0), (Env.Const false));
                               (("eaves_mem", 0), (Env.ExtSyscall 1));
                               (("tamper_channel", 0), Env.Attack);
                               (("rpc_t", 0), (Env.ChanTypeDef []));
                               (("udp_t", 0), (Env.ChanTypeDef []));
                               (("client_ta_t", 0), Env.ProcTypeDef);
                               (("client_t", 0), Env.ProcTypeDef);
                               (("server_t", 0), Env.ProcTypeDef);
                               (("readonly_t", 0), Env.FilesysTypeDef);
                               (("fclose", 0), (Env.ExtSyscall 1));
                               (("fread", 0), (Env.ExtSyscall 1));
                               (("fopen", 0), (Env.ExtSyscall 1));
                               (("h", 0), (Env.ExtFun 1));
                               (("get_picture", 0), (Env.ExtSyscall 0));
                               (("accept_rpc", 0), (Env.ExtSyscall 1));
                               (("close_rpc", 0), (Env.ExtSyscall 1));
                               (("invoke_rpc", 0), (Env.ExtSyscall 4));
                               (("connect_rpc", 0), (Env.ExtSyscall 1));
                               (("recv", 0), (Env.ExtSyscall 1));
                               (("send", 0), (Env.ExtSyscall 2));
                               (("verify", 0), (Env.ExtFun 3));
                               (("true", 0), Env.ExtConst);
                               (("snd", 0), (Env.ExtFun 1));
                               (("fst", 0), (Env.ExtFun 1));
                               (("dec", 0), (Env.ExtFun 2));
                               (("sign", 0), (Env.ExtFun 2));
                               (("enc", 0), (Env.ExtFun 2));
                               (("pk", 0), (Env.ExtFun 1))];
                             facts =
                             ref ([("False", (Env.Global, (Some 0)));
                                    ("ImgRecvInvalid", (Env.Global, (Some 1)));
                                    ("ImgRecvValid", (Env.Global, (Some 1)));
                                    ("ClientTAClose", (Env.Global, (Some 0)));
                                    ("InValidName", (Env.Plain, (Some 1)));
                                    ("ClientClose", (Env.Global, (Some 0)));
                                    ("ImgSend", (Env.Global, (Some 1)));
                                    ("Out", (Env.Global, (Some 1)));
                                    ("In", (Env.Global, (Some 1)));
                                    ("Fd", (Env.Structure, (Some 1)));
                                    ("exit", (Env.Channel, (Some 0)));
                                    ("Returned", (Env.Channel, (Some 1)));
                                    ("invoke", (Env.Channel, (Some 3)));
                                    ("conn", (Env.Channel, (Some 0)));
                                    ("chid", (Env.Structure, (Some 1)));
                                    ("ack", (Env.Channel, (Some 0)));
                                    ("req", (Env.Channel, (Some 0)));
                                    ("store", (Env.Channel, (Some 1)))])
                             } };
                           { desc = Typed.Ident {id = ("sym_k", 0);
                                      desc = (Env.Const false); param = None}; env = 
                           { Env.vars =
                             [(("ch_rpc", 43),
                               (Env.Channel (false, ("rpc_t", 0))));
                               (("client", 0), Env.Process);
                               (("rpc", 0),
                                (Env.Channel (false, ("rpc_t", 0))));
                               (("udp", 0),
                                (Env.Channel (false, ("udp_t", 0))));
                               (("init_data", 0), (Env.Const false));
                               (("sym_k", 0), (Env.Const false));
                               (("priv_k", 0), (Env.Const false));
                               (("eaves_mem", 0), (Env.ExtSyscall 1));
                               (("tamper_channel", 0), Env.Attack);
                               (("rpc_t", 0), (Env.ChanTypeDef []));
                               (("udp_t", 0), (Env.ChanTypeDef []));
                               (("client_ta_t", 0), Env.ProcTypeDef);
                               (("client_t", 0), Env.ProcTypeDef);
                               (("server_t", 0), Env.ProcTypeDef);
                               (("readonly_t", 0), Env.FilesysTypeDef);
                               (("fclose", 0), (Env.ExtSyscall 1));
                               (("fread", 0), (Env.ExtSyscall 1));
                               (("fopen", 0), (Env.ExtSyscall 1));
                               (("h", 0), (Env.ExtFun 1));
                               (("get_picture", 0), (Env.ExtSyscall 0));
                               (("accept_rpc", 0), (Env.ExtSyscall 1));
                               (("close_rpc", 0), (Env.ExtSyscall 1));
                               (("invoke_rpc", 0), (Env.ExtSyscall 4));
                               (("connect_rpc", 0), (Env.ExtSyscall 1));
                               (("recv", 0), (Env.ExtSyscall 1));
                               (("send", 0), (Env.ExtSyscall 2));
                               (("verify", 0), (Env.ExtFun 3));
                               (("true", 0), Env.ExtConst);
                               (("snd", 0), (Env.ExtFun 1));
                               (("fst", 0), (Env.ExtFun 1));
                               (("dec", 0), (Env.ExtFun 2));
                               (("sign", 0), (Env.ExtFun 2));
                               (("enc", 0), (Env.ExtFun 2));
                               (("pk", 0), (Env.ExtFun 1))];
                             facts =
                             ref ([("False", (Env.Global, (Some 0)));
                                    ("ImgRecvInvalid", (Env.Global, (Some 1)));
                                    ("ImgRecvValid", (Env.Global, (Some 1)));
                                    ("ClientTAClose", (Env.Global, (Some 0)));
                                    ("InValidName", (Env.Plain, (Some 1)));
                                    ("ClientClose", (Env.Global, (Some 0)));
                                    ("ImgSend", (Env.Global, (Some 1)));
                                    ("Out", (Env.Global, (Some 1)));
                                    ("In", (Env.Global, (Some 1)));
                                    ("Fd", (Env.Structure, (Some 1)));
                                    ("exit", (Env.Channel, (Some 0)));
                                    ("Returned", (Env.Channel, (Some 1)));
                                    ("invoke", (Env.Channel, (Some 3)));
                                    ("conn", (Env.Channel, (Some 0)));
                                    ("chid", (Env.Structure, (Some 1)));
                                    ("ack", (Env.Channel, (Some 0)));
                                    ("req", (Env.Channel, (Some 0)));
                                    ("store", (Env.Channel, (Some 1)))])
                             } }
                           ]
                         )); env = { Env.vars =
                                     [(("ch_rpc", 43),
                                       (Env.Channel (false, ("rpc_t", 0))));
                                       (("client", 0), Env.Process);
                                       (("rpc", 0),
                                        (Env.Channel (false, ("rpc_t", 0))));
                                       (("udp", 0),
                                        (Env.Channel (false, ("udp_t", 0))));
                                       (("init_data", 0), (Env.Const false));
                                       (("sym_k", 0), (Env.Const false));
                                       (("priv_k", 0), (Env.Const false));
                                       (("eaves_mem", 0), (Env.ExtSyscall 1));
                                       (("tamper_channel", 0), Env.Attack);
                                       (("rpc_t", 0), (Env.ChanTypeDef []));
                                       (("udp_t", 0), (Env.ChanTypeDef []));
                                       (("client_ta_t", 0), Env.ProcTypeDef);
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("server_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("fclose", 0), (Env.ExtSyscall 1));
                                       (("fread", 0), (Env.ExtSyscall 1));
                                       (("fopen", 0), (Env.ExtSyscall 1));
                                       (("h", 0), (Env.ExtFun 1));
                                       (("get_picture", 0),
                                        (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("dec", 0), (Env.ExtFun 2));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("enc", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("False", (Env.Global, (Some 0)));
                                            ("ImgRecvInvalid",
                                             (Env.Global, (Some 1)));
                                            ("ImgRecvValid",
                                             (Env.Global, (Some 1)));
                                            ("ClientTAClose",
                                             (Env.Global, (Some 0)));
                                            ("InValidName",
                                             (Env.Plain, (Some 1)));
                                            ("ClientClose",
                                             (Env.Global, (Some 0)));
                                            ("ImgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("Fd", (Env.Structure, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } })
             ];
           vars =
           [(("fek", 44),
             { desc = Typed.Ident {id = ("sym_k", 0);
                        desc = (Env.Const false); param = None}; env = 
             { Env.vars =
               [(("ch_rpc", 43), (Env.Channel (false, ("rpc_t", 0))));
                 (("client", 0), Env.Process);
                 (("rpc", 0), (Env.Channel (false, ("rpc_t", 0))));
                 (("udp", 0), (Env.Channel (false, ("udp_t", 0))));
                 (("init_data", 0), (Env.Const false));
                 (("sym_k", 0), (Env.Const false));
                 (("priv_k", 0), (Env.Const false));
                 (("eaves_mem", 0), (Env.ExtSyscall 1));
                 (("tamper_channel", 0), Env.Attack);
                 (("rpc_t", 0), (Env.ChanTypeDef []));
                 (("udp_t", 0), (Env.ChanTypeDef []));
                 (("client_ta_t", 0), Env.ProcTypeDef);
                 (("client_t", 0), Env.ProcTypeDef);
                 (("server_t", 0), Env.ProcTypeDef);
                 (("readonly_t", 0), Env.FilesysTypeDef);
                 (("fclose", 0), (Env.ExtSyscall 1));
                 (("fread", 0), (Env.ExtSyscall 1));
                 (("fopen", 0), (Env.ExtSyscall 1));
                 (("h", 0), (Env.ExtFun 1));
                 (("get_picture", 0), (Env.ExtSyscall 0));
                 (("accept_rpc", 0), (Env.ExtSyscall 1));
                 (("close_rpc", 0), (Env.ExtSyscall 1));
                 (("invoke_rpc", 0), (Env.ExtSyscall 4));
                 (("connect_rpc", 0), (Env.ExtSyscall 1));
                 (("recv", 0), (Env.ExtSyscall 1));
                 (("send", 0), (Env.ExtSyscall 2));
                 (("verify", 0), (Env.ExtFun 3));
                 (("true", 0), Env.ExtConst); (("snd", 0), (Env.ExtFun 1));
                 (("fst", 0), (Env.ExtFun 1)); (("dec", 0), (Env.ExtFun 2));
                 (("sign", 0), (Env.ExtFun 2)); (("enc", 0), (Env.ExtFun 2));
                 (("pk", 0), (Env.ExtFun 1))];
               facts =
               ref ([("False", (Env.Global, (Some 0)));
                      ("ImgRecvInvalid", (Env.Global, (Some 1)));
                      ("ImgRecvValid", (Env.Global, (Some 1)));
                      ("ClientTAClose", (Env.Global, (Some 0)));
                      ("InValidName", (Env.Plain, (Some 1)));
                      ("ClientClose", (Env.Global, (Some 0)));
                      ("ImgSend", (Env.Global, (Some 1)));
                      ("Out", (Env.Global, (Some 1)));
                      ("In", (Env.Global, (Some 1)));
                      ("Fd", (Env.Structure, (Some 1)));
                      ("exit", (Env.Channel, (Some 0)));
                      ("Returned", (Env.Channel, (Some 1)));
                      ("invoke", (Env.Channel, (Some 3)));
                      ("conn", (Env.Channel, (Some 0)));
                      ("chid", (Env.Structure, (Some 1)));
                      ("ack", (Env.Channel, (Some 0)));
                      ("req", (Env.Channel, (Some 0)));
                      ("store", (Env.Channel, (Some 1)))])
               } })
             ];
           funcs =
           [(("sign_image", 51), [("image", 45); ("privkey_path", 46)],
             { desc = (Typed.Let (("privkey_fd", 47),
                         { desc = (Typed.Apply (("fopen", 0),
                                     [{ desc = Typed.Ident {
                                                 id = ("privkey_path", 46);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 46));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("privkey_path", 46),
                                           (Env.Var (Syntax.Loc 46)));
                                           (("image", 45),
                                            (Env.Var (Syntax.Loc 45)));
                                           (("fek", 44),
                                            (Env.Var (Syntax.Loc 44)));
                                           (("ch_rpc", 43),
                                            (Env.Channel (false, ("rpc_t", 0)
                                               )));
                                           (("client", 0), Env.Process);
                                           (("rpc", 0),
                                            (Env.Channel (false, ("rpc_t", 0)
                                               )));
                                           (("udp", 0),
                                            (Env.Channel (false, ("udp_t", 0)
                                               )));
                                           (("init_data", 0),
                                            (Env.Const false));
                                           (("sym_k", 0), (Env.Const false));
                                           (("priv_k", 0), (Env.Const false));
                                           (("eaves_mem", 0),
                                            (Env.ExtSyscall 1));
                                           (("tamper_channel", 0), Env.Attack);
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef []));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef []));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("fclose", 0), (Env.ExtSyscall 1));
                                           (("fread", 0), (Env.ExtSyscall 1));
                                           (("fopen", 0), (Env.ExtSyscall 1));
                                           (("h", 0), (Env.ExtFun 1));
                                           (("get_picture", 0),
                                            (Env.ExtSyscall 0));
                                           (("accept_rpc", 0),
                                            (Env.ExtSyscall 1));
                                           (("close_rpc", 0),
                                            (Env.ExtSyscall 1));
                                           (("invoke_rpc", 0),
                                            (Env.ExtSyscall 4));
                                           (("connect_rpc", 0),
                                            (Env.ExtSyscall 1));
                                           (("recv", 0), (Env.ExtSyscall 1));
                                           (("send", 0), (Env.ExtSyscall 2));
                                           (("verify", 0), (Env.ExtFun 3));
                                           (("true", 0), Env.ExtConst);
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("dec", 0), (Env.ExtFun 2));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("enc", 0), (Env.ExtFun 2));
                                           (("pk", 0), (Env.ExtFun 1))];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("ClientTAClose",
                                                 (Env.Global, (Some 0)));
                                                ("InValidName",
                                                 (Env.Plain, (Some 1)));
                                                ("ClientClose",
                                                 (Env.Global, (Some 0)));
                                                ("ImgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("Fd",
                                                 (Env.Structure, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]
                                     )); env = { Env.vars =
                                                 [(("privkey_path", 46),
                                                   (Env.Var (Syntax.Loc 46)));
                                                   (("image", 45),
                                                    (Env.Var (Syntax.Loc 45)));
                                                   (("fek", 44),
                                                    (Env.Var (Syntax.Loc 44)));
                                                   (("ch_rpc", 43),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("client", 0),
                                                    Env.Process);
                                                   (("rpc", 0),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("init_data", 0),
                                                    (Env.Const false));
                                                   (("sym_k", 0),
                                                    (Env.Const false));
                                                   (("priv_k", 0),
                                                    (Env.Const false));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("fclose", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fread", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fopen", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("h", 0), (Env.ExtFun 1));
                                                   (("get_picture", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("dec", 0),
                                                    (Env.ExtFun 2));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("enc", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ClientTAClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("InValidName",
                                                         (Env.Plain, (Some 1)));
                                                        ("ClientClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("ImgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Fd",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                         { desc = (Typed.Let (("privkey", 48),
                                     { desc = (Typed.Apply (("fread", 0),
                                                 [{ desc = Typed.Ident {
                                                             id =
                                                             ("privkey_fd",
                                                              47);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   47));
                                                             param = None}; env = 
                                                   { Env.vars =
                                                     [(("privkey_fd", 47),
                                                       (Env.Var
                                                          (Syntax.Loc 47)));
                                                       (("privkey_path", 46),
                                                        (Env.Var
                                                           (Syntax.Loc 46)));
                                                       (("image", 45),
                                                        (Env.Var
                                                           (Syntax.Loc 45)));
                                                       (("fek", 44),
                                                        (Env.Var
                                                           (Syntax.Loc 44)));
                                                       (("ch_rpc", 43),
                                                        (Env.Channel (false,
                                                           ("rpc_t", 0))));
                                                       (("client", 0),
                                                        Env.Process);
                                                       (("rpc", 0),
                                                        (Env.Channel (false,
                                                           ("rpc_t", 0))));
                                                       (("udp", 0),
                                                        (Env.Channel (false,
                                                           ("udp_t", 0))));
                                                       (("init_data", 0),
                                                        (Env.Const false));
                                                       (("sym_k", 0),
                                                        (Env.Const false));
                                                       (("priv_k", 0),
                                                        (Env.Const false));
                                                       (("eaves_mem", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("tamper_channel", 0),
                                                        Env.Attack);
                                                       (("rpc_t", 0),
                                                        (Env.ChanTypeDef []));
                                                       (("udp_t", 0),
                                                        (Env.ChanTypeDef []));
                                                       (("client_ta_t", 0),
                                                        Env.ProcTypeDef);
                                                       (("client_t", 0),
                                                        Env.ProcTypeDef);
                                                       (("server_t", 0),
                                                        Env.ProcTypeDef);
                                                       (("readonly_t", 0),
                                                        Env.FilesysTypeDef);
                                                       (("fclose", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("fread", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("fopen", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("h", 0),
                                                        (Env.ExtFun 1));
                                                       (("get_picture", 0),
                                                        (Env.ExtSyscall 0));
                                                       (("accept_rpc", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("close_rpc", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("invoke_rpc", 0),
                                                        (Env.ExtSyscall 4));
                                                       (("connect_rpc", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("recv", 0),
                                                        (Env.ExtSyscall 1));
                                                       (("send", 0),
                                                        (Env.ExtSyscall 2));
                                                       (("verify", 0),
                                                        (Env.ExtFun 3));
                                                       (("true", 0),
                                                        Env.ExtConst);
                                                       (("snd", 0),
                                                        (Env.ExtFun 1));
                                                       (("fst", 0),
                                                        (Env.ExtFun 1));
                                                       (("dec", 0),
                                                        (Env.ExtFun 2));
                                                       (("sign", 0),
                                                        (Env.ExtFun 2));
                                                       (("enc", 0),
                                                        (Env.ExtFun 2));
                                                       (("pk", 0),
                                                        (Env.ExtFun 1))
                                                       ];
                                                     facts =
                                                     ref ([("False",
                                                            (Env.Global,
                                                             (Some 0)));
                                                            ("ImgRecvInvalid",
                                                             (Env.Global,
                                                              (Some 1)));
                                                            ("ImgRecvValid",
                                                             (Env.Global,
                                                              (Some 1)));
                                                            ("ClientTAClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                            ("InValidName",
                                                             (Env.Plain,
                                                              (Some 1)));
                                                            ("ClientClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                            ("ImgSend",
                                                             (Env.Global,
                                                              (Some 1)));
                                                            ("Out",
                                                             (Env.Global,
                                                              (Some 1)));
                                                            ("In",
                                                             (Env.Global,
                                                              (Some 1)));
                                                            ("Fd",
                                                             (Env.Structure,
                                                              (Some 1)));
                                                            ("exit",
                                                             (Env.Channel,
                                                              (Some 0)));
                                                            ("Returned",
                                                             (Env.Channel,
                                                              (Some 1)));
                                                            ("invoke",
                                                             (Env.Channel,
                                                              (Some 3)));
                                                            ("conn",
                                                             (Env.Channel,
                                                              (Some 0)));
                                                            ("chid",
                                                             (Env.Structure,
                                                              (Some 1)));
                                                            ("ack",
                                                             (Env.Channel,
                                                              (Some 0)));
                                                            ("req",
                                                             (Env.Channel,
                                                              (Some 0)));
                                                            ("store",
                                                             (Env.Channel,
                                                              (Some 1)))
                                                            ])
                                                     } }
                                                   ]
                                                 )); env = { Env.vars =
                                                             [(("privkey_fd",
                                                                47),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    47)));
                                                               (("privkey_path",
                                                                 46),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    46)));
                                                               (("image", 45),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    45)));
                                                               (("fek", 44),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    44)));
                                                               (("ch_rpc", 43),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("client", 0),
                                                                Env.Process);
                                                               (("rpc", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("init_data",
                                                                 0),
                                                                (Env.Const
                                                                   false));
                                                               (("sym_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("priv_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("fclose", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fread", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fopen", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("h", 0),
                                                                (Env.ExtFun 1));
                                                               (("get_picture",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("dec", 0),
                                                                (Env.ExtFun 2));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("enc", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
                                     { desc = (Typed.Let (("privkey0", 49),
                                                 { desc = (Typed.Apply (
                                                             ("dec", 0),
                                                             [{ desc = 
                                                               Typed.Ident {
                                                                 id =
                                                                 ("privkey",
                                                                  48);
                                                                 desc =
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    48));
                                                                 param = None}; env = 
                                                               { Env.vars =
                                                                 [(("privkey",
                                                                    48),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                   ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                   ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                   ((
                                                                    "image",
                                                                    45),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                   ((
                                                                    "fek", 44),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                   ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } };
                                                               { desc = 
                                                               Typed.Ident {
                                                                 id =
                                                                 ("fek", 44);
                                                                 desc =
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    44));
                                                                 param = None}; env = 
                                                               { Env.vars =
                                                                 [(("privkey",
                                                                    48),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                   ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                   ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                   ((
                                                                    "image",
                                                                    45),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                   ((
                                                                    "fek", 44),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                   ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               ]
                                                             )); env = 
                                                 { Env.vars =
                                                   [(("privkey", 48),
                                                     (Env.Var (Syntax.Loc 48)));
                                                     (("privkey_fd", 47),
                                                      (Env.Var
                                                         (Syntax.Loc 47)));
                                                     (("privkey_path", 46),
                                                      (Env.Var
                                                         (Syntax.Loc 46)));
                                                     (("image", 45),
                                                      (Env.Var
                                                         (Syntax.Loc 45)));
                                                     (("fek", 44),
                                                      (Env.Var
                                                         (Syntax.Loc 44)));
                                                     (("ch_rpc", 43),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("client", 0),
                                                      Env.Process);
                                                     (("rpc", 0),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("init_data", 0),
                                                      (Env.Const false));
                                                     (("sym_k", 0),
                                                      (Env.Const false));
                                                     (("priv_k", 0),
                                                      (Env.Const false));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("fclose", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fread", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fopen", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("h", 0),
                                                      (Env.ExtFun 1));
                                                     (("get_picture", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("dec", 0),
                                                      (Env.ExtFun 2));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("enc", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ClientTAClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("InValidName",
                                                           (Env.Plain,
                                                            (Some 1)));
                                                          ("ClientClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("ImgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Fd",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } },
                                                 { desc = (Typed.Let (
                                                             ("sig", 50),
                                                             { desc = (
                                                             Typed.Apply (
                                                               ("sign", 0),
                                                               [{ desc = 
                                                                 Typed.Ident {
                                                                   id =
                                                                   ("image",
                                                                    45);
                                                                   desc =
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    45));
                                                                   param =
                                                                   None}; env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "privkey0",
                                                                    49),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                    ((
                                                                    "privkey",
                                                                    48),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                    ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                    ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                    ((
                                                                    "image",
                                                                    45),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } };
                                                                 { desc = 
                                                                 Typed.Ident {
                                                                   id =
                                                                   ("privkey0",
                                                                    49);
                                                                   desc =
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    49));
                                                                   param =
                                                                   None}; env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "privkey0",
                                                                    49),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                    ((
                                                                    "privkey",
                                                                    48),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                    ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                    ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                    ((
                                                                    "image",
                                                                    45),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 ]
                                                               )); env = 
                                                             { Env.vars =
                                                               [(("privkey0",
                                                                  49),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    49)));
                                                                 (("privkey",
                                                                   48),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                 (("privkey_fd",
                                                                   47),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                 (("privkey_path",
                                                                   46),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                 (("image",
                                                                   45),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                 (("fek", 44),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                 (("ch_rpc",
                                                                   43),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                 (("client",
                                                                   0),
                                                                  Env.Process);
                                                                 (("rpc", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("init_data",
                                                                   0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("sym_k", 0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("priv_k",
                                                                   0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("rpc_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_ta_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("server_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("fclose",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("fread", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("fopen", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("h", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("get_picture",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("dec", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("enc", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } },
                                                             { desc = (
                                                             Typed.Sequence (
                                                               { desc = (
                                                               Typed.Assign (
                                                                 None,
                                                                 { desc = (
                                                                 Typed.Apply (
                                                                   ("fclose",
                                                                    0),
                                                                   [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "privkey_fd",
                                                                    47);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    47));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 50),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    50)));
                                                                    ((
                                                                    "privkey0",
                                                                    49),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                    ((
                                                                    "privkey",
                                                                    48),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                    ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                    ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                    ((
                                                                    "image",
                                                                    45),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 50),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    50)));
                                                                    ((
                                                                    "privkey0",
                                                                    49),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                    ((
                                                                    "privkey",
                                                                    48),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                    ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                    ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                    ((
                                                                    "image",
                                                                    45),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 )); env = 
                                                               { Env.vars =
                                                                 [(("sig", 50),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    50)));
                                                                   ((
                                                                    "privkey0",
                                                                    49),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                   ((
                                                                    "privkey",
                                                                    48),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                   ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                   ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                   ((
                                                                    "image",
                                                                    45),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                   ((
                                                                    "fek", 44),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                   ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } },
                                                               { desc = (
                                                               Typed.Return
                                                                 { desc = 
                                                                 Typed.Ident {
                                                                   id =
                                                                   ("sig", 50);
                                                                   desc =
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    50));
                                                                   param =
                                                                   None}; env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 50),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    50)));
                                                                    ((
                                                                    "privkey0",
                                                                    49),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                    ((
                                                                    "privkey",
                                                                    48),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                    ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                    ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                    ((
                                                                    "image",
                                                                    45),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }); env = 
                                                               { Env.vars =
                                                                 [(("sig", 50),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    50)));
                                                                   ((
                                                                    "privkey0",
                                                                    49),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                   ((
                                                                    "privkey",
                                                                    48),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                   ((
                                                                    "privkey_fd",
                                                                    47),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                   ((
                                                                    "privkey_path",
                                                                    46),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                   ((
                                                                    "image",
                                                                    45),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                   ((
                                                                    "fek", 44),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                   ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               )); env = 
                                                             { Env.vars =
                                                               [(("sig", 50),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    50)));
                                                                 (("privkey0",
                                                                   49),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    49)));
                                                                 (("privkey",
                                                                   48),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    48)));
                                                                 (("privkey_fd",
                                                                   47),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    47)));
                                                                 (("privkey_path",
                                                                   46),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    46)));
                                                                 (("image",
                                                                   45),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    45)));
                                                                 (("fek", 44),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                 (("ch_rpc",
                                                                   43),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                 (("client",
                                                                   0),
                                                                  Env.Process);
                                                                 (("rpc", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("init_data",
                                                                   0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("sym_k", 0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("priv_k",
                                                                   0),
                                                                  (Env.Const
                                                                    false));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("rpc_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_ta_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("server_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("fclose",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("fread", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("fopen", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("h", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("get_picture",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("dec", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("enc", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             )); env = 
                                                 { Env.vars =
                                                   [(("privkey0", 49),
                                                     (Env.Var (Syntax.Loc 49)));
                                                     (("privkey", 48),
                                                      (Env.Var
                                                         (Syntax.Loc 48)));
                                                     (("privkey_fd", 47),
                                                      (Env.Var
                                                         (Syntax.Loc 47)));
                                                     (("privkey_path", 46),
                                                      (Env.Var
                                                         (Syntax.Loc 46)));
                                                     (("image", 45),
                                                      (Env.Var
                                                         (Syntax.Loc 45)));
                                                     (("fek", 44),
                                                      (Env.Var
                                                         (Syntax.Loc 44)));
                                                     (("ch_rpc", 43),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("client", 0),
                                                      Env.Process);
                                                     (("rpc", 0),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("init_data", 0),
                                                      (Env.Const false));
                                                     (("sym_k", 0),
                                                      (Env.Const false));
                                                     (("priv_k", 0),
                                                      (Env.Const false));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("fclose", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fread", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fopen", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("h", 0),
                                                      (Env.ExtFun 1));
                                                     (("get_picture", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("dec", 0),
                                                      (Env.ExtFun 2));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("enc", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ClientTAClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("InValidName",
                                                           (Env.Plain,
                                                            (Some 1)));
                                                          ("ClientClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("ImgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Fd",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 )); env = { Env.vars =
                                                             [(("privkey", 48),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    48)));
                                                               (("privkey_fd",
                                                                 47),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    47)));
                                                               (("privkey_path",
                                                                 46),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    46)));
                                                               (("image", 45),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    45)));
                                                               (("fek", 44),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    44)));
                                                               (("ch_rpc", 43),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("client", 0),
                                                                Env.Process);
                                                               (("rpc", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("init_data",
                                                                 0),
                                                                (Env.Const
                                                                   false));
                                                               (("sym_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("priv_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("fclose", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fread", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fopen", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("h", 0),
                                                                (Env.ExtFun 1));
                                                               (("get_picture",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("dec", 0),
                                                                (Env.ExtFun 2));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("enc", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                     )); env = { Env.vars =
                                                 [(("privkey_fd", 47),
                                                   (Env.Var (Syntax.Loc 47)));
                                                   (("privkey_path", 46),
                                                    (Env.Var (Syntax.Loc 46)));
                                                   (("image", 45),
                                                    (Env.Var (Syntax.Loc 45)));
                                                   (("fek", 44),
                                                    (Env.Var (Syntax.Loc 44)));
                                                   (("ch_rpc", 43),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("client", 0),
                                                    Env.Process);
                                                   (("rpc", 0),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("init_data", 0),
                                                    (Env.Const false));
                                                   (("sym_k", 0),
                                                    (Env.Const false));
                                                   (("priv_k", 0),
                                                    (Env.Const false));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("fclose", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fread", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fopen", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("h", 0), (Env.ExtFun 1));
                                                   (("get_picture", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("dec", 0),
                                                    (Env.ExtFun 2));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("enc", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ClientTAClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("InValidName",
                                                         (Env.Plain, (Some 1)));
                                                        ("ClientClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("ImgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Fd",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                         )); env = { Env.vars =
                                     [(("privkey_path", 46),
                                       (Env.Var (Syntax.Loc 46)));
                                       (("image", 45),
                                        (Env.Var (Syntax.Loc 45)));
                                       (("fek", 44),
                                        (Env.Var (Syntax.Loc 44)));
                                       (("ch_rpc", 43),
                                        (Env.Channel (false, ("rpc_t", 0))));
                                       (("client", 0), Env.Process);
                                       (("rpc", 0),
                                        (Env.Channel (false, ("rpc_t", 0))));
                                       (("udp", 0),
                                        (Env.Channel (false, ("udp_t", 0))));
                                       (("init_data", 0), (Env.Const false));
                                       (("sym_k", 0), (Env.Const false));
                                       (("priv_k", 0), (Env.Const false));
                                       (("eaves_mem", 0), (Env.ExtSyscall 1));
                                       (("tamper_channel", 0), Env.Attack);
                                       (("rpc_t", 0), (Env.ChanTypeDef []));
                                       (("udp_t", 0), (Env.ChanTypeDef []));
                                       (("client_ta_t", 0), Env.ProcTypeDef);
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("server_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("fclose", 0), (Env.ExtSyscall 1));
                                       (("fread", 0), (Env.ExtSyscall 1));
                                       (("fopen", 0), (Env.ExtSyscall 1));
                                       (("h", 0), (Env.ExtFun 1));
                                       (("get_picture", 0),
                                        (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("dec", 0), (Env.ExtFun 2));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("enc", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("False", (Env.Global, (Some 0)));
                                            ("ImgRecvInvalid",
                                             (Env.Global, (Some 1)));
                                            ("ImgRecvValid",
                                             (Env.Global, (Some 1)));
                                            ("ClientTAClose",
                                             (Env.Global, (Some 0)));
                                            ("InValidName",
                                             (Env.Plain, (Some 1)));
                                            ("ClientClose",
                                             (Env.Global, (Some 0)));
                                            ("ImgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("Fd", (Env.Structure, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } })
             ];
           main =
           { desc = (Typed.Sequence (
                       { desc = (Typed.Assign (None,
                                   { desc = (Typed.Apply (("accept_rpc", 0),
                                               [{ desc = Typed.Ident {
                                                           id =
                                                           ("ch_rpc", 43);
                                                           desc =
                                                           (Env.Channel (
                                                              false,
                                                              ("rpc_t", 0)));
                                                           param = None}; env = 
                                                 { Env.vars =
                                                   [(("sign_image", 51),
                                                     (Env.Function 2));
                                                     (("fek", 44),
                                                      (Env.Var
                                                         (Syntax.Loc 44)));
                                                     (("ch_rpc", 43),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("client", 0),
                                                      Env.Process);
                                                     (("rpc", 0),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("init_data", 0),
                                                      (Env.Const false));
                                                     (("sym_k", 0),
                                                      (Env.Const false));
                                                     (("priv_k", 0),
                                                      (Env.Const false));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("fclose", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fread", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fopen", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("h", 0),
                                                      (Env.ExtFun 1));
                                                     (("get_picture", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("dec", 0),
                                                      (Env.ExtFun 2));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("enc", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ClientTAClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("InValidName",
                                                           (Env.Plain,
                                                            (Some 1)));
                                                          ("ClientClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("ImgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Fd",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]
                                               )); env = { Env.vars =
                                                           [(("sign_image",
                                                              51),
                                                             (Env.Function 2));
                                                             (("fek", 44),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    44)));
                                                             (("ch_rpc", 43),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("client", 0),
                                                              Env.Process);
                                                             (("rpc", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("init_data", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("sym_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("priv_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("rpc_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_ta_t",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("server_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("fclose", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fread", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fopen", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("h", 0),
                                                              (Env.ExtFun 1));
                                                             (("get_picture",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("dec", 0),
                                                              (Env.ExtFun 2));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("enc", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } }
                                   )); env = { Env.vars =
                                               [(("sign_image", 51),
                                                 (Env.Function 2));
                                                 (("fek", 44),
                                                  (Env.Var (Syntax.Loc 44)));
                                                 (("ch_rpc", 43),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("client", 0), Env.Process);
                                                 (("rpc", 0),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("init_data", 0),
                                                  (Env.Const false));
                                                 (("sym_k", 0),
                                                  (Env.Const false));
                                                 (("priv_k", 0),
                                                  (Env.Const false));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("fclose", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fread", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fopen", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("h", 0), (Env.ExtFun 1));
                                                 (("get_picture", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("dec", 0), (Env.ExtFun 2));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("enc", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("ClientTAClose",
                                                       (Env.Global, (Some 0)));
                                                      ("InValidName",
                                                       (Env.Plain, (Some 1)));
                                                      ("ClientClose",
                                                       (Env.Global, (Some 0)));
                                                      ("ImgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("Fd",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } },
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.While (
                                               [{ Typed.fresh =
                                                  [("priv_path", 54);
                                                    ("image", 53);
                                                    ("fname", 52)];
                                                  facts =
                                                  [{ desc = Typed.Channel {
                                                              channel =
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("ch_rpc", 43);
                                                                desc =
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   ));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("fname",
                                                                   52),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                  (("image",
                                                                    53),
                                                                   (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                  (("priv_path",
                                                                    54),
                                                                   (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                  (("sign_image",
                                                                    51),
                                                                   (Env.Function
                                                                    2));
                                                                  (("fek", 44),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                  (("ch_rpc",
                                                                    43),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("client",
                                                                    0),
                                                                   Env.Process);
                                                                  (("rpc", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("init_data",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("sym_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("priv_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("fclose",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fread",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fopen",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("h", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("get_picture",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("dec", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("enc", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } };
                                                              name = "invoke";
                                                              args =
                                                              [{ desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("fname",
                                                                   52);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    52));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "fname",
                                                                    52),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    53),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    (
                                                                    (
                                                                    "priv_path",
                                                                    54),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    (
                                                                    (
                                                                    "sign_image",
                                                                    51),
                                                                    (
                                                                    Env.Function
                                                                    2));
                                                                    (
                                                                    (
                                                                    "fek", 44),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    (
                                                                    (
                                                                    "ch_rpc",
                                                                    43),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } };
                                                                { desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("image",
                                                                   53);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    53));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "fname",
                                                                    52),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    53),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    (
                                                                    (
                                                                    "priv_path",
                                                                    54),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    (
                                                                    (
                                                                    "sign_image",
                                                                    51),
                                                                    (
                                                                    Env.Function
                                                                    2));
                                                                    (
                                                                    (
                                                                    "fek", 44),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    (
                                                                    (
                                                                    "ch_rpc",
                                                                    43),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } };
                                                                { desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("priv_path",
                                                                   54);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    54));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "fname",
                                                                    52),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    53),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    (
                                                                    (
                                                                    "priv_path",
                                                                    54),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    (
                                                                    (
                                                                    "sign_image",
                                                                    51),
                                                                    (
                                                                    Env.Function
                                                                    2));
                                                                    (
                                                                    (
                                                                    "fek", 44),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    (
                                                                    (
                                                                    "ch_rpc",
                                                                    43),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ]}; env = 
                                                    { Env.vars =
                                                      [(("fname", 52),
                                                        (Env.Var
                                                           (Syntax.Meta 52)));
                                                        (("image", 53),
                                                         (Env.Var
                                                            (Syntax.Meta 53)));
                                                        (("priv_path", 54),
                                                         (Env.Var
                                                            (Syntax.Meta 54)));
                                                        (("sign_image", 51),
                                                         (Env.Function 2));
                                                        (("fek", 44),
                                                         (Env.Var
                                                            (Syntax.Loc 44)));
                                                        (("ch_rpc", 43),
                                                         (Env.Channel (false,
                                                            ("rpc_t", 0))));
                                                        (("client", 0),
                                                         Env.Process);
                                                        (("rpc", 0),
                                                         (Env.Channel (false,
                                                            ("rpc_t", 0))));
                                                        (("udp", 0),
                                                         (Env.Channel (false,
                                                            ("udp_t", 0))));
                                                        (("init_data", 0),
                                                         (Env.Const false));
                                                        (("sym_k", 0),
                                                         (Env.Const false));
                                                        (("priv_k", 0),
                                                         (Env.Const false));
                                                        (("eaves_mem", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("tamper_channel", 0),
                                                         Env.Attack);
                                                        (("rpc_t", 0),
                                                         (Env.ChanTypeDef []));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef []));
                                                        (("client_ta_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("client_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("server_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("fclose", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("fread", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("fopen", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("h", 0),
                                                         (Env.ExtFun 1));
                                                        (("get_picture", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall 4));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("dec", 0),
                                                         (Env.ExtFun 2));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("enc", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("False",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("ImgRecvInvalid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ImgRecvValid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ClientTAClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("InValidName",
                                                              (Env.Plain,
                                                               (Some 1)));
                                                             ("ClientClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("ImgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Fd",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ];
                                                  cmd =
                                                  { desc = (Typed.Case
                                                              [{ Typed.fresh =
                                                                 [];
                                                                 facts =
                                                                 [{ desc = (
                                                                   Typed.Eq (
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "fname",
                                                                    52);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    52));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = (
                                                                    Typed.String
                                                                    "sign_image"); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   ];
                                                                 cmd =
                                                                 { desc = (
                                                                 Typed.Let (
                                                                   ("signed",
                                                                    55),
                                                                   { desc = (
                                                                   Typed.Apply (
                                                                    ("sign_image",
                                                                    51),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "image",
                                                                    53);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    53));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "priv_path",
                                                                    54);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    54));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                   { desc = (
                                                                   Typed.Put
                                                                    [{ desc = 
                                                                    Typed.Channel {
                                                                    channel =
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "ch_rpc",
                                                                    43);
                                                                    desc =
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0)));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "signed",
                                                                    55),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    55)));
                                                                    ((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    name =
                                                                    "Returned";
                                                                    args =
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "signed",
                                                                    55);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    55));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "signed",
                                                                    55),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    55)));
                                                                    ((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "signed",
                                                                    55),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    55)));
                                                                    ((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "signed",
                                                                    55),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    55)));
                                                                    ((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 };
                                                                { Typed.fresh =
                                                                  [];
                                                                  facts =
                                                                  [{ desc = (
                                                                    Typed.Neq (
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "fname",
                                                                    52);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    52));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = (
                                                                    Typed.String
                                                                    "sign_image"); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }];
                                                                  cmd =
                                                                  { desc = (
                                                                  Typed.Event
                                                                    [{ desc = (
                                                                    Typed.Plain (
                                                                    "InValidName",
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "fname",
                                                                    52);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    52));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "fname",
                                                                    52),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    52)));
                                                                    ((
                                                                    "image",
                                                                    53),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    53)));
                                                                    ((
                                                                    "priv_path",
                                                                    54),
                                                                    (Env.Var
                                                                    (Syntax.Meta
                                                                    54)));
                                                                    ((
                                                                    "sign_image",
                                                                    51),
                                                                    (Env.Function
                                                                    2));
                                                                    ((
                                                                    "fek", 44),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                    ((
                                                                    "ch_rpc",
                                                                    43),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  }
                                                                ]); env = 
                                                  { Env.vars =
                                                    [(("fname", 52),
                                                      (Env.Var
                                                         (Syntax.Meta 52)));
                                                      (("image", 53),
                                                       (Env.Var
                                                          (Syntax.Meta 53)));
                                                      (("priv_path", 54),
                                                       (Env.Var
                                                          (Syntax.Meta 54)));
                                                      (("sign_image", 51),
                                                       (Env.Function 2));
                                                      (("fek", 44),
                                                       (Env.Var
                                                          (Syntax.Loc 44)));
                                                      (("ch_rpc", 43),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("client", 0),
                                                       Env.Process);
                                                      (("rpc", 0),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("udp", 0),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("init_data", 0),
                                                       (Env.Const false));
                                                      (("sym_k", 0),
                                                       (Env.Const false));
                                                      (("priv_k", 0),
                                                       (Env.Const false));
                                                      (("eaves_mem", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("tamper_channel", 0),
                                                       Env.Attack);
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("fclose", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fread", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fopen", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("h", 0),
                                                       (Env.ExtFun 1));
                                                      (("get_picture", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("dec", 0),
                                                       (Env.ExtFun 2));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("enc", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ClientTAClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("InValidName",
                                                            (Env.Plain,
                                                             (Some 1)));
                                                           ("ClientClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("ImgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Fd",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ],
                                               [{ Typed.fresh = [];
                                                  facts =
                                                  [{ desc = Typed.Channel {
                                                              channel =
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("ch_rpc", 43);
                                                                desc =
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   ));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("sign_image",
                                                                   51),
                                                                  (Env.Function
                                                                    2));
                                                                  (("fek", 44),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    44)));
                                                                  (("ch_rpc",
                                                                    43),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("client",
                                                                    0),
                                                                   Env.Process);
                                                                  (("rpc", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("init_data",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("sym_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("priv_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("fclose",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fread",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fopen",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("h", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("get_picture",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("dec", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("enc", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } };
                                                              name = "exit";
                                                              args = []}; env = 
                                                    { Env.vars =
                                                      [(("sign_image", 51),
                                                        (Env.Function 2));
                                                        (("fek", 44),
                                                         (Env.Var
                                                            (Syntax.Loc 44)));
                                                        (("ch_rpc", 43),
                                                         (Env.Channel (false,
                                                            ("rpc_t", 0))));
                                                        (("client", 0),
                                                         Env.Process);
                                                        (("rpc", 0),
                                                         (Env.Channel (false,
                                                            ("rpc_t", 0))));
                                                        (("udp", 0),
                                                         (Env.Channel (false,
                                                            ("udp_t", 0))));
                                                        (("init_data", 0),
                                                         (Env.Const false));
                                                        (("sym_k", 0),
                                                         (Env.Const false));
                                                        (("priv_k", 0),
                                                         (Env.Const false));
                                                        (("eaves_mem", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("tamper_channel", 0),
                                                         Env.Attack);
                                                        (("rpc_t", 0),
                                                         (Env.ChanTypeDef []));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef []));
                                                        (("client_ta_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("client_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("server_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("fclose", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("fread", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("fopen", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("h", 0),
                                                         (Env.ExtFun 1));
                                                        (("get_picture", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall 4));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("dec", 0),
                                                         (Env.ExtFun 2));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("enc", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("False",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("ImgRecvInvalid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ImgRecvValid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ClientTAClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("InValidName",
                                                              (Env.Plain,
                                                               (Some 1)));
                                                             ("ClientClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("ImgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Fd",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ];
                                                  cmd =
                                                  { desc = Typed.Skip; env = 
                                                  { Env.vars =
                                                    [(("sign_image", 51),
                                                      (Env.Function 2));
                                                      (("fek", 44),
                                                       (Env.Var
                                                          (Syntax.Loc 44)));
                                                      (("ch_rpc", 43),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("client", 0),
                                                       Env.Process);
                                                      (("rpc", 0),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("udp", 0),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("init_data", 0),
                                                       (Env.Const false));
                                                      (("sym_k", 0),
                                                       (Env.Const false));
                                                      (("priv_k", 0),
                                                       (Env.Const false));
                                                      (("eaves_mem", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("tamper_channel", 0),
                                                       Env.Attack);
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("fclose", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fread", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fopen", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("h", 0),
                                                       (Env.ExtFun 1));
                                                      (("get_picture", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("dec", 0),
                                                       (Env.ExtFun 2));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("enc", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ClientTAClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("InValidName",
                                                            (Env.Plain,
                                                             (Some 1)));
                                                           ("ClientClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("ImgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Fd",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ]
                                               )); env = { Env.vars =
                                                           [(("sign_image",
                                                              51),
                                                             (Env.Function 2));
                                                             (("fek", 44),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    44)));
                                                             (("ch_rpc", 43),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("client", 0),
                                                              Env.Process);
                                                             (("rpc", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("init_data", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("sym_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("priv_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("rpc_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_ta_t",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("server_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("fclose", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fread", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fopen", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("h", 0),
                                                              (Env.ExtFun 1));
                                                             (("get_picture",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("dec", 0),
                                                              (Env.ExtFun 2));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("enc", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } },
                                   { desc = (Typed.Event
                                               [{ desc = (Typed.Global (
                                                            "ClientTAClose",
                                                            [])); env = 
                                                 { Env.vars =
                                                   [(("sign_image", 51),
                                                     (Env.Function 2));
                                                     (("fek", 44),
                                                      (Env.Var
                                                         (Syntax.Loc 44)));
                                                     (("ch_rpc", 43),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("client", 0),
                                                      Env.Process);
                                                     (("rpc", 0),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("init_data", 0),
                                                      (Env.Const false));
                                                     (("sym_k", 0),
                                                      (Env.Const false));
                                                     (("priv_k", 0),
                                                      (Env.Const false));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("fclose", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fread", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fopen", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("h", 0),
                                                      (Env.ExtFun 1));
                                                     (("get_picture", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("dec", 0),
                                                      (Env.ExtFun 2));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("enc", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ClientTAClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("InValidName",
                                                           (Env.Plain,
                                                            (Some 1)));
                                                          ("ClientClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("ImgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Fd",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("sign_image",
                                                                51),
                                                               (Env.Function
                                                                  2));
                                                               (("fek", 44),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    44)));
                                                               (("ch_rpc", 43),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("client", 0),
                                                                Env.Process);
                                                               (("rpc", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("rpc_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("init_data",
                                                                 0),
                                                                (Env.Const
                                                                   false));
                                                               (("sym_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("priv_k", 0),
                                                                (Env.Const
                                                                   false));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("fclose", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fread", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("fopen", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("h", 0),
                                                                (Env.ExtFun 1));
                                                               (("get_picture",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("dec", 0),
                                                                (Env.ExtFun 2));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("enc", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("sign_image", 51),
                                                 (Env.Function 2));
                                                 (("fek", 44),
                                                  (Env.Var (Syntax.Loc 44)));
                                                 (("ch_rpc", 43),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("client", 0), Env.Process);
                                                 (("rpc", 0),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("init_data", 0),
                                                  (Env.Const false));
                                                 (("sym_k", 0),
                                                  (Env.Const false));
                                                 (("priv_k", 0),
                                                  (Env.Const false));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("fclose", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fread", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fopen", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("h", 0), (Env.ExtFun 1));
                                                 (("get_picture", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("dec", 0), (Env.ExtFun 2));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("enc", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("ClientTAClose",
                                                       (Env.Global, (Some 0)));
                                                      ("InValidName",
                                                       (Env.Plain, (Some 1)));
                                                      ("ClientClose",
                                                       (Env.Global, (Some 0)));
                                                      ("ImgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("Fd",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("sign_image", 51), (Env.Function 2));
                                     (("fek", 44), (Env.Var (Syntax.Loc 44)));
                                     (("ch_rpc", 43),
                                      (Env.Channel (false, ("rpc_t", 0))));
                                     (("client", 0), Env.Process);
                                     (("rpc", 0),
                                      (Env.Channel (false, ("rpc_t", 0))));
                                     (("udp", 0),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("init_data", 0), (Env.Const false));
                                     (("sym_k", 0), (Env.Const false));
                                     (("priv_k", 0), (Env.Const false));
                                     (("eaves_mem", 0), (Env.ExtSyscall 1));
                                     (("tamper_channel", 0), Env.Attack);
                                     (("rpc_t", 0), (Env.ChanTypeDef []));
                                     (("udp_t", 0), (Env.ChanTypeDef []));
                                     (("client_ta_t", 0), Env.ProcTypeDef);
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("server_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("fclose", 0), (Env.ExtSyscall 1));
                                     (("fread", 0), (Env.ExtSyscall 1));
                                     (("fopen", 0), (Env.ExtSyscall 1));
                                     (("h", 0), (Env.ExtFun 1));
                                     (("get_picture", 0), (Env.ExtSyscall 0));
                                     (("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("dec", 0), (Env.ExtFun 2));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("enc", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("False", (Env.Global, (Some 0)));
                                          ("ImgRecvInvalid",
                                           (Env.Global, (Some 1)));
                                          ("ImgRecvValid",
                                           (Env.Global, (Some 1)));
                                          ("ClientTAClose",
                                           (Env.Global, (Some 0)));
                                          ("InValidName",
                                           (Env.Plain, (Some 1)));
                                          ("ClientClose",
                                           (Env.Global, (Some 0)));
                                          ("ImgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("Fd", (Env.Structure, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("client", 0), Env.Process);
                                                   (("rpc", 0),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("init_data", 0),
                                                    (Env.Const false));
                                                   (("sym_k", 0),
                                                    (Env.Const false));
                                                   (("priv_k", 0),
                                                    (Env.Const false));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("fclose", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fread", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fopen", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("h", 0), (Env.ExtFun 1));
                                                   (("get_picture", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("dec", 0),
                                                    (Env.ExtFun 2));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("enc", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ClientTAClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("InValidName",
                                                         (Env.Plain, (Some 1)));
                                                        ("ClientClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("ImgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Fd",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Process {id = ("server", 0); param = None;
           args =
           [{ Typed.channel = ("ch_net", 56); param = None;
              typ = ("udp_t", 0) }
             ];
           typ = ("server_t", 0);
           files =
           [({ desc = (Typed.String "/secret/pub"); env = { Env.vars =
                                                            [(("ch_net", 56),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                              (("client_ta",
                                                                0),
                                                               Env.Process);
                                                              (("client", 0),
                                                               Env.Process);
                                                              (("rpc", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("rpc_t", 0)
                                                                  )));
                                                              (("udp", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("init_data",
                                                                0),
                                                               (Env.Const
                                                                  false));
                                                              (("sym_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("priv_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("eaves_mem",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("rpc_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("client_ta_t",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("client_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("server_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("fclose", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fread", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fopen", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("h", 0),
                                                               (Env.ExtFun 1));
                                                              (("get_picture",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("dec", 0),
                                                               (Env.ExtFun 2));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("enc", 0),
                                                               (Env.ExtFun 2));
                                                              (("pk", 0),
                                                               (Env.ExtFun 1))
                                                              ];
                                                            facts =
                                                            ref ([("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } },
             ("readonly_t", 0),
             { desc = (Typed.Apply (("pk", 0),
                         [{ desc = Typed.Ident {id = ("priv_k", 0);
                                     desc = (Env.Const false); param = None}; env = 
                           { Env.vars =
                             [(("ch_net", 56),
                               (Env.Channel (false, ("udp_t", 0))));
                               (("client_ta", 0), Env.Process);
                               (("client", 0), Env.Process);
                               (("rpc", 0),
                                (Env.Channel (false, ("rpc_t", 0))));
                               (("udp", 0),
                                (Env.Channel (false, ("udp_t", 0))));
                               (("init_data", 0), (Env.Const false));
                               (("sym_k", 0), (Env.Const false));
                               (("priv_k", 0), (Env.Const false));
                               (("eaves_mem", 0), (Env.ExtSyscall 1));
                               (("tamper_channel", 0), Env.Attack);
                               (("rpc_t", 0), (Env.ChanTypeDef []));
                               (("udp_t", 0), (Env.ChanTypeDef []));
                               (("client_ta_t", 0), Env.ProcTypeDef);
                               (("client_t", 0), Env.ProcTypeDef);
                               (("server_t", 0), Env.ProcTypeDef);
                               (("readonly_t", 0), Env.FilesysTypeDef);
                               (("fclose", 0), (Env.ExtSyscall 1));
                               (("fread", 0), (Env.ExtSyscall 1));
                               (("fopen", 0), (Env.ExtSyscall 1));
                               (("h", 0), (Env.ExtFun 1));
                               (("get_picture", 0), (Env.ExtSyscall 0));
                               (("accept_rpc", 0), (Env.ExtSyscall 1));
                               (("close_rpc", 0), (Env.ExtSyscall 1));
                               (("invoke_rpc", 0), (Env.ExtSyscall 4));
                               (("connect_rpc", 0), (Env.ExtSyscall 1));
                               (("recv", 0), (Env.ExtSyscall 1));
                               (("send", 0), (Env.ExtSyscall 2));
                               (("verify", 0), (Env.ExtFun 3));
                               (("true", 0), Env.ExtConst);
                               (("snd", 0), (Env.ExtFun 1));
                               (("fst", 0), (Env.ExtFun 1));
                               (("dec", 0), (Env.ExtFun 2));
                               (("sign", 0), (Env.ExtFun 2));
                               (("enc", 0), (Env.ExtFun 2));
                               (("pk", 0), (Env.ExtFun 1))];
                             facts =
                             ref ([("False", (Env.Global, (Some 0)));
                                    ("ImgRecvInvalid", (Env.Global, (Some 1)));
                                    ("ImgRecvValid", (Env.Global, (Some 1)));
                                    ("ClientTAClose", (Env.Global, (Some 0)));
                                    ("InValidName", (Env.Plain, (Some 1)));
                                    ("ClientClose", (Env.Global, (Some 0)));
                                    ("ImgSend", (Env.Global, (Some 1)));
                                    ("Out", (Env.Global, (Some 1)));
                                    ("In", (Env.Global, (Some 1)));
                                    ("Fd", (Env.Structure, (Some 1)));
                                    ("exit", (Env.Channel, (Some 0)));
                                    ("Returned", (Env.Channel, (Some 1)));
                                    ("invoke", (Env.Channel, (Some 3)));
                                    ("conn", (Env.Channel, (Some 0)));
                                    ("chid", (Env.Structure, (Some 1)));
                                    ("ack", (Env.Channel, (Some 0)));
                                    ("req", (Env.Channel, (Some 0)));
                                    ("store", (Env.Channel, (Some 1)))])
                             } }
                           ]
                         )); env = { Env.vars =
                                     [(("ch_net", 56),
                                       (Env.Channel (false, ("udp_t", 0))));
                                       (("client_ta", 0), Env.Process);
                                       (("client", 0), Env.Process);
                                       (("rpc", 0),
                                        (Env.Channel (false, ("rpc_t", 0))));
                                       (("udp", 0),
                                        (Env.Channel (false, ("udp_t", 0))));
                                       (("init_data", 0), (Env.Const false));
                                       (("sym_k", 0), (Env.Const false));
                                       (("priv_k", 0), (Env.Const false));
                                       (("eaves_mem", 0), (Env.ExtSyscall 1));
                                       (("tamper_channel", 0), Env.Attack);
                                       (("rpc_t", 0), (Env.ChanTypeDef []));
                                       (("udp_t", 0), (Env.ChanTypeDef []));
                                       (("client_ta_t", 0), Env.ProcTypeDef);
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("server_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("fclose", 0), (Env.ExtSyscall 1));
                                       (("fread", 0), (Env.ExtSyscall 1));
                                       (("fopen", 0), (Env.ExtSyscall 1));
                                       (("h", 0), (Env.ExtFun 1));
                                       (("get_picture", 0),
                                        (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("dec", 0), (Env.ExtFun 2));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("enc", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("False", (Env.Global, (Some 0)));
                                            ("ImgRecvInvalid",
                                             (Env.Global, (Some 1)));
                                            ("ImgRecvValid",
                                             (Env.Global, (Some 1)));
                                            ("ClientTAClose",
                                             (Env.Global, (Some 0)));
                                            ("InValidName",
                                             (Env.Plain, (Some 1)));
                                            ("ClientClose",
                                             (Env.Global, (Some 0)));
                                            ("ImgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("Fd", (Env.Structure, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } })
             ];
           vars =
           [(("pubkey_path", 57),
             { desc = (Typed.String "/secret/pub"); env = { Env.vars =
                                                            [(("ch_net", 56),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                              (("client_ta",
                                                                0),
                                                               Env.Process);
                                                              (("client", 0),
                                                               Env.Process);
                                                              (("rpc", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("rpc_t", 0)
                                                                  )));
                                                              (("udp", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("init_data",
                                                                0),
                                                               (Env.Const
                                                                  false));
                                                              (("sym_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("priv_k", 0),
                                                               (Env.Const
                                                                  false));
                                                              (("eaves_mem",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("rpc_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("client_ta_t",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("client_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("server_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("fclose", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fread", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("fopen", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("h", 0),
                                                               (Env.ExtFun 1));
                                                              (("get_picture",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("dec", 0),
                                                               (Env.ExtFun 2));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("enc", 0),
                                                               (Env.ExtFun 2));
                                                              (("pk", 0),
                                                               (Env.ExtFun 1))
                                                              ];
                                                            facts =
                                                            ref ([("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                   ("ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } })
             ];
           funcs = [];
           main =
           { desc = (Typed.Let (("pubkey_fd", 58),
                       { desc = (Typed.Apply (("fopen", 0),
                                   [{ desc = Typed.Ident {
                                               id = ("pubkey_path", 57);
                                               desc =
                                               (Env.Var (Syntax.Loc 57));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]
                                   )); env = { Env.vars =
                                               [(("pubkey_path", 57),
                                                 (Env.Var (Syntax.Loc 57)));
                                                 (("ch_net", 56),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("client_ta", 0),
                                                  Env.Process);
                                                 (("client", 0), Env.Process);
                                                 (("rpc", 0),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("init_data", 0),
                                                  (Env.Const false));
                                                 (("sym_k", 0),
                                                  (Env.Const false));
                                                 (("priv_k", 0),
                                                  (Env.Const false));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("fclose", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fread", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fopen", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("h", 0), (Env.ExtFun 1));
                                                 (("get_picture", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("dec", 0), (Env.ExtFun 2));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("enc", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("ClientTAClose",
                                                       (Env.Global, (Some 0)));
                                                      ("InValidName",
                                                       (Env.Plain, (Some 1)));
                                                      ("ClientClose",
                                                       (Env.Global, (Some 0)));
                                                      ("ImgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("Fd",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } },
                       { desc = (Typed.Let (("pubkey", 59),
                                   { desc = (Typed.Apply (("fread", 0),
                                               [{ desc = Typed.Ident {
                                                           id =
                                                           ("pubkey_fd", 58);
                                                           desc =
                                                           (Env.Var
                                                              (Syntax.Loc 58));
                                                           param = None}; env = 
                                                 { Env.vars =
                                                   [(("pubkey_fd", 58),
                                                     (Env.Var (Syntax.Loc 58)));
                                                     (("pubkey_path", 57),
                                                      (Env.Var
                                                         (Syntax.Loc 57)));
                                                     (("ch_net", 56),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("client_ta", 0),
                                                      Env.Process);
                                                     (("client", 0),
                                                      Env.Process);
                                                     (("rpc", 0),
                                                      (Env.Channel (false,
                                                         ("rpc_t", 0))));
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("init_data", 0),
                                                      (Env.Const false));
                                                     (("sym_k", 0),
                                                      (Env.Const false));
                                                     (("priv_k", 0),
                                                      (Env.Const false));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("fclose", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fread", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("fopen", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("h", 0),
                                                      (Env.ExtFun 1));
                                                     (("get_picture", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("dec", 0),
                                                      (Env.ExtFun 2));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("enc", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ClientTAClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("InValidName",
                                                           (Env.Plain,
                                                            (Some 1)));
                                                          ("ClientClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("ImgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Fd",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]
                                               )); env = { Env.vars =
                                                           [(("pubkey_fd", 58),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   58)));
                                                             (("pubkey_path",
                                                               57),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    57)));
                                                             (("ch_net", 56),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("client_ta", 0),
                                                              Env.Process);
                                                             (("client", 0),
                                                              Env.Process);
                                                             (("rpc", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("init_data", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("sym_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("priv_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("rpc_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_ta_t",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("server_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("fclose", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fread", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fopen", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("h", 0),
                                                              (Env.ExtFun 1));
                                                             (("get_picture",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("dec", 0),
                                                              (Env.ExtFun 2));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("enc", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } },
                                   { desc = (Typed.While (
                                               [{ Typed.fresh = [];
                                                  facts = [];
                                                  cmd =
                                                  { desc = (Typed.Let (
                                                              ("p", 60),
                                                              { desc = (
                                                              Typed.Apply (
                                                                ("recv", 0),
                                                                [{ desc = 
                                                                  Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "ch_net",
                                                                    56);
                                                                    desc =
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0)));
                                                                    param =
                                                                    None}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  ]
                                                                )); env = 
                                                              { Env.vars =
                                                                [(("pubkey",
                                                                   59),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                  (("pubkey_fd",
                                                                    58),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                  (("pubkey_path",
                                                                    57),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                  (("ch_net",
                                                                    56),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("client_ta",
                                                                    0),
                                                                   Env.Process);
                                                                  (("client",
                                                                    0),
                                                                   Env.Process);
                                                                  (("rpc", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("init_data",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("sym_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("priv_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("fclose",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fread",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fopen",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("h", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("get_picture",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("dec", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("enc", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } },
                                                              { desc = (
                                                              Typed.Let (
                                                                ("res", 61),
                                                                { desc = (
                                                                Typed.Apply (
                                                                  ("verify",
                                                                   0),
                                                                  [{ desc = (
                                                                    Typed.Apply (
                                                                    ("fst", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "p", 60);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    60));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = (
                                                                    Typed.Apply (
                                                                    ("snd", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "p", 60);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    60));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "pubkey",
                                                                    59);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    59));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                  )); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "p", 60),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    (
                                                                    (
                                                                    "pubkey",
                                                                    59),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    (
                                                                    (
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    (
                                                                    (
                                                                    "pubkey_path",
                                                                    57),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    56),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } },
                                                                { desc = (
                                                                Typed.Case
                                                                  [{ Typed.fresh =
                                                                    [];
                                                                    facts =
                                                                    [{ desc = (
                                                                    Typed.Eq (
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 61);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    61));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    Env.ExtConst;
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }];
                                                                    cmd =
                                                                    { desc = (
                                                                    Typed.Event
                                                                    [{ desc = (
                                                                    Typed.Global (
                                                                    "ImgRecvValid",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("snd", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "p", 60);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    60));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } } };
                                                                    { Typed.fresh =
                                                                    [];
                                                                    facts =
                                                                    [{ desc = (
                                                                    Typed.Neq (
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 61);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    61));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    Env.ExtConst;
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }];
                                                                    cmd =
                                                                    { desc = (
                                                                    Typed.Event
                                                                    [{ desc = (
                                                                    Typed.Global (
                                                                    "ImgRecvInvalid",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("snd", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "p", 60);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    60));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 61),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    ((
                                                                    "p", 60),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    ((
                                                                    "pubkey",
                                                                    59),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    ((
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    ((
                                                                    "pubkey_path",
                                                                    57),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    ((
                                                                    "ch_net",
                                                                    56),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "rpc", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "init_data",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "sym_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "priv_k",
                                                                    0),
                                                                    (Env.Const
                                                                    false));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "fclose",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fread",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "fopen",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "h", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "get_picture",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "dec", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "enc", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ClientTAClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("InValidName",
                                                                    (Env.Plain,
                                                                    (Some 1)));
                                                                    ("ClientClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Fd",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } } }]); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "res", 61),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    61)));
                                                                    (
                                                                    (
                                                                    "p", 60),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                    (
                                                                    (
                                                                    "pubkey",
                                                                    59),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                    (
                                                                    (
                                                                    "pubkey_fd",
                                                                    58),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                    (
                                                                    (
                                                                    "pubkey_path",
                                                                    57),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    56),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "client_ta",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "client",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "rpc", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "init_data",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "sym_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "priv_k",
                                                                    0),
                                                                    (
                                                                    Env.Const
                                                                    false));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "fclose",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fread",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fopen",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "h", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "get_picture",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "dec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "enc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientTAClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "InValidName",
                                                                    (
                                                                    Env.Plain,
                                                                    (Some 1)));
                                                                    (
                                                                    "ClientClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Fd",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                )); env = 
                                                              { Env.vars =
                                                                [(("p", 60),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    60)));
                                                                  (("pubkey",
                                                                    59),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    59)));
                                                                  (("pubkey_fd",
                                                                    58),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    58)));
                                                                  (("pubkey_path",
                                                                    57),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    57)));
                                                                  (("ch_net",
                                                                    56),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("client_ta",
                                                                    0),
                                                                   Env.Process);
                                                                  (("client",
                                                                    0),
                                                                   Env.Process);
                                                                  (("rpc", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("rpc_t",
                                                                    0))));
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("init_data",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("sym_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("priv_k",
                                                                    0),
                                                                   (Env.Const
                                                                    false));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("fclose",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fread",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("fopen",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("h", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("get_picture",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("dec", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("enc", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              )); env = 
                                                  { Env.vars =
                                                    [(("pubkey", 59),
                                                      (Env.Var
                                                         (Syntax.Loc 59)));
                                                      (("pubkey_fd", 58),
                                                       (Env.Var
                                                          (Syntax.Loc 58)));
                                                      (("pubkey_path", 57),
                                                       (Env.Var
                                                          (Syntax.Loc 57)));
                                                      (("ch_net", 56),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("client_ta", 0),
                                                       Env.Process);
                                                      (("client", 0),
                                                       Env.Process);
                                                      (("rpc", 0),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("udp", 0),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("init_data", 0),
                                                       (Env.Const false));
                                                      (("sym_k", 0),
                                                       (Env.Const false));
                                                      (("priv_k", 0),
                                                       (Env.Const false));
                                                      (("eaves_mem", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("tamper_channel", 0),
                                                       Env.Attack);
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("fclose", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fread", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fopen", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("h", 0),
                                                       (Env.ExtFun 1));
                                                      (("get_picture", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("dec", 0),
                                                       (Env.ExtFun 2));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("enc", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ClientTAClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("InValidName",
                                                            (Env.Plain,
                                                             (Some 1)));
                                                           ("ClientClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("ImgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Fd",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ],
                                               [{ Typed.fresh = [];
                                                  facts =
                                                  [{ desc = (Typed.Global (
                                                               "False", 
                                                               [])); env = 
                                                    { Env.vars =
                                                      [(("pubkey", 59),
                                                        (Env.Var
                                                           (Syntax.Loc 59)));
                                                        (("pubkey_fd", 58),
                                                         (Env.Var
                                                            (Syntax.Loc 58)));
                                                        (("pubkey_path", 57),
                                                         (Env.Var
                                                            (Syntax.Loc 57)));
                                                        (("ch_net", 56),
                                                         (Env.Channel (false,
                                                            ("udp_t", 0))));
                                                        (("client_ta", 0),
                                                         Env.Process);
                                                        (("client", 0),
                                                         Env.Process);
                                                        (("rpc", 0),
                                                         (Env.Channel (false,
                                                            ("rpc_t", 0))));
                                                        (("udp", 0),
                                                         (Env.Channel (false,
                                                            ("udp_t", 0))));
                                                        (("init_data", 0),
                                                         (Env.Const false));
                                                        (("sym_k", 0),
                                                         (Env.Const false));
                                                        (("priv_k", 0),
                                                         (Env.Const false));
                                                        (("eaves_mem", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("tamper_channel", 0),
                                                         Env.Attack);
                                                        (("rpc_t", 0),
                                                         (Env.ChanTypeDef []));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef []));
                                                        (("client_ta_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("client_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("server_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("fclose", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("fread", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("fopen", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("h", 0),
                                                         (Env.ExtFun 1));
                                                        (("get_picture", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall 4));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("dec", 0),
                                                         (Env.ExtFun 2));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("enc", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("False",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("ImgRecvInvalid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ImgRecvValid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ClientTAClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("InValidName",
                                                              (Env.Plain,
                                                               (Some 1)));
                                                             ("ClientClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("ImgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Fd",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ];
                                                  cmd =
                                                  { desc = Typed.Skip; env = 
                                                  { Env.vars =
                                                    [(("pubkey", 59),
                                                      (Env.Var
                                                         (Syntax.Loc 59)));
                                                      (("pubkey_fd", 58),
                                                       (Env.Var
                                                          (Syntax.Loc 58)));
                                                      (("pubkey_path", 57),
                                                       (Env.Var
                                                          (Syntax.Loc 57)));
                                                      (("ch_net", 56),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("client_ta", 0),
                                                       Env.Process);
                                                      (("client", 0),
                                                       Env.Process);
                                                      (("rpc", 0),
                                                       (Env.Channel (false,
                                                          ("rpc_t", 0))));
                                                      (("udp", 0),
                                                       (Env.Channel (false,
                                                          ("udp_t", 0))));
                                                      (("init_data", 0),
                                                       (Env.Const false));
                                                      (("sym_k", 0),
                                                       (Env.Const false));
                                                      (("priv_k", 0),
                                                       (Env.Const false));
                                                      (("eaves_mem", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("tamper_channel", 0),
                                                       Env.Attack);
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("fclose", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fread", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("fopen", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("h", 0),
                                                       (Env.ExtFun 1));
                                                      (("get_picture", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("dec", 0),
                                                       (Env.ExtFun 2));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("enc", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ClientTAClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("InValidName",
                                                            (Env.Plain,
                                                             (Some 1)));
                                                           ("ClientClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("ImgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Fd",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ]
                                               )); env = { Env.vars =
                                                           [(("pubkey", 59),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   59)));
                                                             (("pubkey_fd",
                                                               58),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    58)));
                                                             (("pubkey_path",
                                                               57),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    57)));
                                                             (("ch_net", 56),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("client_ta", 0),
                                                              Env.Process);
                                                             (("client", 0),
                                                              Env.Process);
                                                             (("rpc", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("rpc_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("init_data", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("sym_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("priv_k", 0),
                                                              (Env.Const
                                                                 false));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("rpc_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_ta_t",
                                                               0),
                                                              Env.ProcTypeDef);
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("server_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("fclose", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fread", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("fopen", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("h", 0),
                                                              (Env.ExtFun 1));
                                                             (("get_picture",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("dec", 0),
                                                              (Env.ExtFun 2));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("enc", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ClientTAClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("InValidName",
                                                                   (Env.Plain,
                                                                    (Some 1)));
                                                                  ("ClientClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("ImgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Fd",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } }
                                   )); env = { Env.vars =
                                               [(("pubkey_fd", 58),
                                                 (Env.Var (Syntax.Loc 58)));
                                                 (("pubkey_path", 57),
                                                  (Env.Var (Syntax.Loc 57)));
                                                 (("ch_net", 56),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("client_ta", 0),
                                                  Env.Process);
                                                 (("client", 0), Env.Process);
                                                 (("rpc", 0),
                                                  (Env.Channel (false,
                                                     ("rpc_t", 0))));
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("init_data", 0),
                                                  (Env.Const false));
                                                 (("sym_k", 0),
                                                  (Env.Const false));
                                                 (("priv_k", 0),
                                                  (Env.Const false));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("fclose", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fread", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("fopen", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("h", 0), (Env.ExtFun 1));
                                                 (("get_picture", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("dec", 0), (Env.ExtFun 2));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("enc", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("ClientTAClose",
                                                       (Env.Global, (Some 0)));
                                                      ("InValidName",
                                                       (Env.Plain, (Some 1)));
                                                      ("ClientClose",
                                                       (Env.Global, (Some 0)));
                                                      ("ImgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("Fd",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("pubkey_path", 57),
                                     (Env.Var (Syntax.Loc 57)));
                                     (("ch_net", 56),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("client_ta", 0), Env.Process);
                                     (("client", 0), Env.Process);
                                     (("rpc", 0),
                                      (Env.Channel (false, ("rpc_t", 0))));
                                     (("udp", 0),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("init_data", 0), (Env.Const false));
                                     (("sym_k", 0), (Env.Const false));
                                     (("priv_k", 0), (Env.Const false));
                                     (("eaves_mem", 0), (Env.ExtSyscall 1));
                                     (("tamper_channel", 0), Env.Attack);
                                     (("rpc_t", 0), (Env.ChanTypeDef []));
                                     (("udp_t", 0), (Env.ChanTypeDef []));
                                     (("client_ta_t", 0), Env.ProcTypeDef);
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("server_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("fclose", 0), (Env.ExtSyscall 1));
                                     (("fread", 0), (Env.ExtSyscall 1));
                                     (("fopen", 0), (Env.ExtSyscall 1));
                                     (("h", 0), (Env.ExtFun 1));
                                     (("get_picture", 0), (Env.ExtSyscall 0));
                                     (("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("dec", 0), (Env.ExtFun 2));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("enc", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("False", (Env.Global, (Some 0)));
                                          ("ImgRecvInvalid",
                                           (Env.Global, (Some 1)));
                                          ("ImgRecvValid",
                                           (Env.Global, (Some 1)));
                                          ("ClientTAClose",
                                           (Env.Global, (Some 0)));
                                          ("InValidName",
                                           (Env.Plain, (Some 1)));
                                          ("ClientClose",
                                           (Env.Global, (Some 0)));
                                          ("ImgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("Fd", (Env.Structure, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("client_ta", 0),
                                                   Env.Process);
                                                   (("client", 0),
                                                    Env.Process);
                                                   (("rpc", 0),
                                                    (Env.Channel (false,
                                                       ("rpc_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("init_data", 0),
                                                    (Env.Const false));
                                                   (("sym_k", 0),
                                                    (Env.Const false));
                                                   (("priv_k", 0),
                                                    (Env.Const false));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("fclose", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fread", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("fopen", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("h", 0), (Env.ExtFun 1));
                                                   (("get_picture", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("dec", 0),
                                                    (Env.ExtFun 2));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("enc", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ClientTAClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("InValidName",
                                                         (Env.Plain, (Some 1)));
                                                        ("ClientClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("ImgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Fd",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
Loading complete..
