Running Typer.load on examples/camserver_typed.rab
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("sdec", 0),
                        [{ desc = (Typed.Apply (("senc", 0),
                                     [{ desc = Typed.Ident {id = ("x", 1);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 1));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("y", 2),
                                           (Env.Var (Syntax.Meta 2)));
                                           (("x", 1),
                                            (Env.Var (Syntax.Meta 1)));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("y", 2);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 2));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("y", 2),
                                           (Env.Var (Syntax.Meta 2)));
                                           (("x", 1),
                                            (Env.Var (Syntax.Meta 1)));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]
                                     )); env = { Env.vars =
                                                 [(("y", 2),
                                                   (Env.Var (Syntax.Meta 2)));
                                                   (("x", 1),
                                                    (Env.Var (Syntax.Meta 1)));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                          { desc = Typed.Ident {id = ("y", 2);
                                     desc = (Env.Var (Syntax.Meta 2));
                                     param = None}; env = { Env.vars =
                                                            [(("y", 2),
                                                              (Env.Var
                                                                 (Syntax.Meta
                                                                    2)));
                                                              (("x", 1),
                                                               (Env.Var
                                                                  (Syntax.Meta
                                                                    1)));
                                                              (("sdec", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                              (("senc", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                              (("vk", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                              (("rpc_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (
                                                                    Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                              (("ver_key_server",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  )));
                                                              (("conn_client",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "connection",
                                                                  [])));
                                                              (("symkey_client_ta",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  )));
                                                              (("sigkey_client_ta",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  )));
                                                              (("client_ta_sig",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "signature",
                                                                  [])));
                                                              (("client_img",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "image", 
                                                                  [])));
                                                              (("client_ta_t",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("client_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("server_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("cipher", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("hash", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("verkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("sigkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("symkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("list", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("filedescr",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("image", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("signature",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("connection",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("string", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("bool", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("unit", 0),
                                                               (Env.SimpleTypeDef
                                                                  []))
                                                              ];
                                                            facts =
                                                            ref ([("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } }
                          ]
                        )); env = { Env.vars =
                                    [(("y", 2), (Env.Var (Syntax.Meta 2)));
                                      (("x", 1), (Env.Var (Syntax.Meta 1)));
                                      (("sdec", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("senc", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSimple ("cipher",
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ))
                                               ])));
                                      (("vk", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "ver_key_server", "verkey",
                                                  [(Env.TySimple ("image", 
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("rpc_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TyProduct (
                                                 (Env.TySimple ("string", 
                                                    [])),
                                                 (Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                 )),
                                              (Env.TySimple ("string", []))));
                                            (Env.TySecurity ("client_ta_sig",
                                               "signature", []))
                                            ]));
                                      (("udp_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TySimple ("image", [])),
                                              (Env.TySimple ("signature", 
                                                 []))
                                              ))
                                            ]));
                                      (("ver_key_server", 0),
                                       (Env.SecurityTypeDef ("verkey",
                                          [(Env.TySimple ("image", []))])));
                                      (("conn_client", 0),
                                       (Env.SecurityTypeDef ("connection", 
                                          [])));
                                      (("symkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("symkey",
                                          [(Env.TySimple ("cipher",
                                              [(Env.TySecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                                ]
                                              ))
                                            ]
                                          )));
                                      (("sigkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          )));
                                      (("client_ta_sig", 0),
                                       (Env.SecurityTypeDef ("signature", 
                                          [])));
                                      (("client_img", 0),
                                       (Env.SecurityTypeDef ("image", [])));
                                      (("client_ta_t", 0), Env.ProcTypeDef);
                                      (("client_t", 0), Env.ProcTypeDef);
                                      (("server_t", 0), Env.ProcTypeDef);
                                      (("readonly_t", 0), Env.FilesysTypeDef);
                                      (("cipher", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("hash", 0), (Env.SimpleTypeDef []));
                                      (("verkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("sigkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("symkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("list", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("filedescr", 0),
                                       (Env.SimpleTypeDef []));
                                      (("image", 0), (Env.SimpleTypeDef []));
                                      (("signature", 0),
                                       (Env.SimpleTypeDef []));
                                      (("connection", 0),
                                       (Env.SimpleTypeDef []));
                                      (("string", 0), (Env.SimpleTypeDef []));
                                      (("bool", 0), (Env.SimpleTypeDef []));
                                      (("unit", 0), (Env.SimpleTypeDef []))];
                                    facts =
                                    ref ([("False", (Env.Global, (Some 0)));
                                           ("ImgRecvInvalid",
                                            (Env.Global, (Some 1)));
                                           ("ImgRecvValid",
                                            (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("x", 1);
                       desc = (Env.Var (Syntax.Meta 1)); param = None}; env = 
            { Env.vars =
              [(("y", 2), (Env.Var (Syntax.Meta 2)));
                (("x", 1), (Env.Var (Syntax.Meta 1)));
                (("sdec", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSimple ("cipher",
                           [(Env.FParamSecurity ("sigkey_client_ta",
                               "sigkey",
                               [(Env.TySecurity ("client_img", "image", []))]
                               ))
                             ]
                           ));
                         (Env.FParamSecurity ("symkey_client_ta", "symkey",
                            [(Env.TySimple ("cipher",
                                [(Env.TySecurity ("sigkey_client_ta",
                                    "sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    ))
                                  ]
                                ))
                              ]
                            ));
                         (Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]))
                         ])));
                (("senc", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                           [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("symkey_client_ta", "symkey",
                            [(Env.TySimple ("cipher",
                                [(Env.TySecurity ("sigkey_client_ta",
                                    "sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    ))
                                  ]
                                ))
                              ]
                            ));
                         (Env.FParamSimple ("cipher",
                            [(Env.FParamSecurity ("sigkey_client_ta",
                                "sigkey",
                                [(Env.TySecurity ("client_img", "image", []))
                                  ]
                                ))
                              ]
                            ))
                         ])));
                (("vk", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                           [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("ver_key_server", "verkey",
                            [(Env.TySimple ("image", []))]))
                         ])));
                (("rpc_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyProduct (
                        (Env.TyProduct ((Env.TySimple ("string", [])),
                           (Env.TySecurity ("client_img", "image", [])))),
                        (Env.TySimple ("string", []))));
                      (Env.TySecurity ("client_ta_sig", "signature", []))]));
                (("udp_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyProduct ((Env.TySimple ("image", [])),
                        (Env.TySimple ("signature", []))))
                      ]));
                (("ver_key_server", 0),
                 (Env.SecurityTypeDef ("verkey",
                    [(Env.TySimple ("image", []))])));
                (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
                (("symkey_client_ta", 0),
                 (Env.SecurityTypeDef ("symkey",
                    [(Env.TySimple ("cipher",
                        [(Env.TySecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]))
                          ]
                        ))
                      ]
                    )));
                (("sigkey_client_ta", 0),
                 (Env.SecurityTypeDef ("sigkey",
                    [(Env.TySecurity ("client_img", "image", []))])));
                (("client_ta_sig", 0),
                 (Env.SecurityTypeDef ("signature", [])));
                (("client_img", 0), (Env.SecurityTypeDef ("image", [])));
                (("client_ta_t", 0), Env.ProcTypeDef);
                (("client_t", 0), Env.ProcTypeDef);
                (("server_t", 0), Env.ProcTypeDef);
                (("readonly_t", 0), Env.FilesysTypeDef);
                (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                (("hash", 0), (Env.SimpleTypeDef []));
                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("list", 0), (Env.SimpleTypeDef ["'a"]));
                (("filedescr", 0), (Env.SimpleTypeDef []));
                (("image", 0), (Env.SimpleTypeDef []));
                (("signature", 0), (Env.SimpleTypeDef []));
                (("connection", 0), (Env.SimpleTypeDef []));
                (("string", 0), (Env.SimpleTypeDef []));
                (("bool", 0), (Env.SimpleTypeDef []));
                (("unit", 0), (Env.SimpleTypeDef []))];
              facts =
              ref ([("False", (Env.Global, (Some 0)));
                     ("ImgRecvInvalid", (Env.Global, (Some 1)));
                     ("ImgRecvValid", (Env.Global, (Some 1)));
                     ("exit", (Env.Channel, (Some 0)));
                     ("Returned", (Env.Channel, (Some 1)));
                     ("invoke", (Env.Channel, (Some 3)));
                     ("conn", (Env.Channel, (Some 0)));
                     ("chid", (Env.Structure, (Some 1)));
                     ("ack", (Env.Channel, (Some 0)));
                     ("req", (Env.Channel, (Some 0)));
                     ("store", (Env.Channel, (Some 1)))])
              } }
            )); env = { Env.vars =
                        [(("y", 2), (Env.Var (Syntax.Meta 2)));
                          (("x", 1), (Env.Var (Syntax.Meta 1)));
                          (("sdec", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSimple ("cipher",
                                     [(Env.FParamSecurity (
                                         "sigkey_client_ta", "sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         ))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                   ])));
                          (("senc", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSimple ("cipher",
                                      [(Env.FParamSecurity (
                                          "sigkey_client_ta", "sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          ))
                                        ]
                                      ))
                                   ])));
                          (("vk", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("ver_key_server",
                                      "verkey",
                                      [(Env.TySimple ("image", []))]))
                                   ])));
                          (("rpc_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct (
                                  (Env.TyProduct (
                                     (Env.TySimple ("string", [])),
                                     (Env.TySecurity ("client_img", "image",
                                        []))
                                     )),
                                  (Env.TySimple ("string", []))));
                                (Env.TySecurity ("client_ta_sig",
                                   "signature", []))
                                ]));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct ((Env.TySimple ("image", [])),
                                  (Env.TySimple ("signature", []))))
                                ]));
                          (("ver_key_server", 0),
                           (Env.SecurityTypeDef ("verkey",
                              [(Env.TySimple ("image", []))])));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("symkey_client_ta", 0),
                           (Env.SecurityTypeDef ("symkey",
                              [(Env.TySimple ("cipher",
                                  [(Env.TySecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                    ]
                                  ))
                                ]
                              )));
                          (("sigkey_client_ta", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TySecurity ("client_img", "image", []))]
                              )));
                          (("client_ta_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_img", 0),
                           (Env.SecurityTypeDef ("image", [])));
                          (("client_ta_t", 0), Env.ProcTypeDef);
                          (("client_t", 0), Env.ProcTypeDef);
                          (("server_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                          (("hash", 0), (Env.SimpleTypeDef []));
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("list", 0), (Env.SimpleTypeDef ["'a"]));
                          (("filedescr", 0), (Env.SimpleTypeDef []));
                          (("image", 0), (Env.SimpleTypeDef []));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("False", (Env.Global, (Some 0)));
                               ("ImgRecvInvalid", (Env.Global, (Some 1)));
                               ("ImgRecvValid", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("fst", 0),
                        [{ desc = (Typed.Tuple
                                     [{ desc = Typed.Ident {id = ("x", 3);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 3));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("y", 4),
                                           (Env.Var (Syntax.Meta 4)));
                                           (("x", 3),
                                            (Env.Var (Syntax.Meta 3)));
                                           (("snd", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'b")])));
                                           (("fst", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'a")])));
                                           (("sign", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "client_img", "image",
                                                      []));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "client_ta_sig",
                                                       "signature", []))
                                                    ])));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("y", 4);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 4));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("y", 4),
                                           (Env.Var (Syntax.Meta 4)));
                                           (("x", 3),
                                            (Env.Var (Syntax.Meta 3)));
                                           (("snd", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'b")])));
                                           (("fst", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'a")])));
                                           (("sign", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "client_img", "image",
                                                      []));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "client_ta_sig",
                                                       "signature", []))
                                                    ])));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]); env = { Env.vars =
                                                   [(("y", 4),
                                                     (Env.Var (Syntax.Meta 4)));
                                                     (("x", 3),
                                                      (Env.Var
                                                         (Syntax.Meta 3)));
                                                     (("snd", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ])));
                                                     (("fst", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ])));
                                                     (("sign", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "client_img",
                                                                "image", 
                                                                []));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ])));
                                                     (("sdec", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("senc", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("vk", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "string",
                                                                   [])),
                                                                (Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                )),
                                                             (Env.TySimple (
                                                                "string", 
                                                                []))
                                                             ));
                                                           (Env.TySecurity (
                                                              "client_ta_sig",
                                                              "signature", 
                                                              []))
                                                           ]));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TySimple (
                                                                "image", 
                                                                [])),
                                                             (Env.TySimple (
                                                                "signature",
                                                                []))
                                                             ))
                                                           ]));
                                                     (("ver_key_server", 0),
                                                      (Env.SecurityTypeDef (
                                                         "verkey",
                                                         [(Env.TySimple (
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("symkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "symkey",
                                                         [(Env.TySimple (
                                                             "cipher",
                                                             [(Env.TySecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                           ]
                                                         )));
                                                     (("sigkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("client_ta_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_img", 0),
                                                      (Env.SecurityTypeDef (
                                                         "image", [])));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("cipher", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("hash", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("symkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("list", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("filedescr", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("image", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                          ]
                        )); env = { Env.vars =
                                    [(("y", 4), (Env.Var (Syntax.Meta 4)));
                                      (("x", 3), (Env.Var (Syntax.Meta 3)));
                                      (("snd", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamProduct (
                                                 (Env.FParamPoly "'a"),
                                                 (Env.FParamPoly "'b")));
                                               (Env.FParamPoly "'b")])));
                                      (("fst", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamProduct (
                                                 (Env.FParamPoly "'a"),
                                                 (Env.FParamPoly "'b")));
                                               (Env.FParamPoly "'a")])));
                                      (("sign", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "client_img", "image", 
                                                 []));
                                               (Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                               (Env.FParamSecurity (
                                                  "client_ta_sig",
                                                  "signature", []))
                                               ])));
                                      (("sdec", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("senc", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSimple ("cipher",
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ))
                                               ])));
                                      (("vk", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "ver_key_server", "verkey",
                                                  [(Env.TySimple ("image", 
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("rpc_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TyProduct (
                                                 (Env.TySimple ("string", 
                                                    [])),
                                                 (Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                 )),
                                              (Env.TySimple ("string", []))));
                                            (Env.TySecurity ("client_ta_sig",
                                               "signature", []))
                                            ]));
                                      (("udp_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TySimple ("image", [])),
                                              (Env.TySimple ("signature", 
                                                 []))
                                              ))
                                            ]));
                                      (("ver_key_server", 0),
                                       (Env.SecurityTypeDef ("verkey",
                                          [(Env.TySimple ("image", []))])));
                                      (("conn_client", 0),
                                       (Env.SecurityTypeDef ("connection", 
                                          [])));
                                      (("symkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("symkey",
                                          [(Env.TySimple ("cipher",
                                              [(Env.TySecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                                ]
                                              ))
                                            ]
                                          )));
                                      (("sigkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          )));
                                      (("client_ta_sig", 0),
                                       (Env.SecurityTypeDef ("signature", 
                                          [])));
                                      (("client_img", 0),
                                       (Env.SecurityTypeDef ("image", [])));
                                      (("client_ta_t", 0), Env.ProcTypeDef);
                                      (("client_t", 0), Env.ProcTypeDef);
                                      (("server_t", 0), Env.ProcTypeDef);
                                      (("readonly_t", 0), Env.FilesysTypeDef);
                                      (("cipher", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("hash", 0), (Env.SimpleTypeDef []));
                                      (("verkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("sigkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("symkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("list", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("filedescr", 0),
                                       (Env.SimpleTypeDef []));
                                      (("image", 0), (Env.SimpleTypeDef []));
                                      (("signature", 0),
                                       (Env.SimpleTypeDef []));
                                      (("connection", 0),
                                       (Env.SimpleTypeDef []));
                                      (("string", 0), (Env.SimpleTypeDef []));
                                      (("bool", 0), (Env.SimpleTypeDef []));
                                      (("unit", 0), (Env.SimpleTypeDef []))];
                                    facts =
                                    ref ([("False", (Env.Global, (Some 0)));
                                           ("ImgRecvInvalid",
                                            (Env.Global, (Some 1)));
                                           ("ImgRecvValid",
                                            (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("x", 3);
                       desc = (Env.Var (Syntax.Meta 3)); param = None}; env = 
            { Env.vars =
              [(("y", 4), (Env.Var (Syntax.Meta 4)));
                (("x", 3), (Env.Var (Syntax.Meta 3)));
                (("snd", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamProduct ((Env.FParamPoly "'a"),
                           (Env.FParamPoly "'b")));
                         (Env.FParamPoly "'b")])));
                (("fst", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamProduct ((Env.FParamPoly "'a"),
                           (Env.FParamPoly "'b")));
                         (Env.FParamPoly "'a")])));
                (("sign", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("client_img", "image", []));
                         (Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("client_ta_sig", "signature",
                            []))
                         ])));
                (("sdec", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSimple ("cipher",
                           [(Env.FParamSecurity ("sigkey_client_ta",
                               "sigkey",
                               [(Env.TySecurity ("client_img", "image", []))]
                               ))
                             ]
                           ));
                         (Env.FParamSecurity ("symkey_client_ta", "symkey",
                            [(Env.TySimple ("cipher",
                                [(Env.TySecurity ("sigkey_client_ta",
                                    "sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    ))
                                  ]
                                ))
                              ]
                            ));
                         (Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]))
                         ])));
                (("senc", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                           [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("symkey_client_ta", "symkey",
                            [(Env.TySimple ("cipher",
                                [(Env.TySecurity ("sigkey_client_ta",
                                    "sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    ))
                                  ]
                                ))
                              ]
                            ));
                         (Env.FParamSimple ("cipher",
                            [(Env.FParamSecurity ("sigkey_client_ta",
                                "sigkey",
                                [(Env.TySecurity ("client_img", "image", []))
                                  ]
                                ))
                              ]
                            ))
                         ])));
                (("vk", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                           [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("ver_key_server", "verkey",
                            [(Env.TySimple ("image", []))]))
                         ])));
                (("rpc_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyProduct (
                        (Env.TyProduct ((Env.TySimple ("string", [])),
                           (Env.TySecurity ("client_img", "image", [])))),
                        (Env.TySimple ("string", []))));
                      (Env.TySecurity ("client_ta_sig", "signature", []))]));
                (("udp_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyProduct ((Env.TySimple ("image", [])),
                        (Env.TySimple ("signature", []))))
                      ]));
                (("ver_key_server", 0),
                 (Env.SecurityTypeDef ("verkey",
                    [(Env.TySimple ("image", []))])));
                (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
                (("symkey_client_ta", 0),
                 (Env.SecurityTypeDef ("symkey",
                    [(Env.TySimple ("cipher",
                        [(Env.TySecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]))
                          ]
                        ))
                      ]
                    )));
                (("sigkey_client_ta", 0),
                 (Env.SecurityTypeDef ("sigkey",
                    [(Env.TySecurity ("client_img", "image", []))])));
                (("client_ta_sig", 0),
                 (Env.SecurityTypeDef ("signature", [])));
                (("client_img", 0), (Env.SecurityTypeDef ("image", [])));
                (("client_ta_t", 0), Env.ProcTypeDef);
                (("client_t", 0), Env.ProcTypeDef);
                (("server_t", 0), Env.ProcTypeDef);
                (("readonly_t", 0), Env.FilesysTypeDef);
                (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                (("hash", 0), (Env.SimpleTypeDef []));
                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("list", 0), (Env.SimpleTypeDef ["'a"]));
                (("filedescr", 0), (Env.SimpleTypeDef []));
                (("image", 0), (Env.SimpleTypeDef []));
                (("signature", 0), (Env.SimpleTypeDef []));
                (("connection", 0), (Env.SimpleTypeDef []));
                (("string", 0), (Env.SimpleTypeDef []));
                (("bool", 0), (Env.SimpleTypeDef []));
                (("unit", 0), (Env.SimpleTypeDef []))];
              facts =
              ref ([("False", (Env.Global, (Some 0)));
                     ("ImgRecvInvalid", (Env.Global, (Some 1)));
                     ("ImgRecvValid", (Env.Global, (Some 1)));
                     ("exit", (Env.Channel, (Some 0)));
                     ("Returned", (Env.Channel, (Some 1)));
                     ("invoke", (Env.Channel, (Some 3)));
                     ("conn", (Env.Channel, (Some 0)));
                     ("chid", (Env.Structure, (Some 1)));
                     ("ack", (Env.Channel, (Some 0)));
                     ("req", (Env.Channel, (Some 0)));
                     ("store", (Env.Channel, (Some 1)))])
              } }
            )); env = { Env.vars =
                        [(("y", 4), (Env.Var (Syntax.Meta 4)));
                          (("x", 3), (Env.Var (Syntax.Meta 3)));
                          (("snd", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamProduct ((Env.FParamPoly "'a"),
                                     (Env.FParamPoly "'b")));
                                   (Env.FParamPoly "'b")])));
                          (("fst", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamProduct ((Env.FParamPoly "'a"),
                                     (Env.FParamPoly "'b")));
                                   (Env.FParamPoly "'a")])));
                          (("sign", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("client_img", "image",
                                     []));
                                   (Env.FParamSecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ));
                                   (Env.FParamSecurity ("client_ta_sig",
                                      "signature", []))
                                   ])));
                          (("sdec", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSimple ("cipher",
                                     [(Env.FParamSecurity (
                                         "sigkey_client_ta", "sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         ))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                   ])));
                          (("senc", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSimple ("cipher",
                                      [(Env.FParamSecurity (
                                          "sigkey_client_ta", "sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          ))
                                        ]
                                      ))
                                   ])));
                          (("vk", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("ver_key_server",
                                      "verkey",
                                      [(Env.TySimple ("image", []))]))
                                   ])));
                          (("rpc_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct (
                                  (Env.TyProduct (
                                     (Env.TySimple ("string", [])),
                                     (Env.TySecurity ("client_img", "image",
                                        []))
                                     )),
                                  (Env.TySimple ("string", []))));
                                (Env.TySecurity ("client_ta_sig",
                                   "signature", []))
                                ]));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct ((Env.TySimple ("image", [])),
                                  (Env.TySimple ("signature", []))))
                                ]));
                          (("ver_key_server", 0),
                           (Env.SecurityTypeDef ("verkey",
                              [(Env.TySimple ("image", []))])));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("symkey_client_ta", 0),
                           (Env.SecurityTypeDef ("symkey",
                              [(Env.TySimple ("cipher",
                                  [(Env.TySecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                    ]
                                  ))
                                ]
                              )));
                          (("sigkey_client_ta", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TySecurity ("client_img", "image", []))]
                              )));
                          (("client_ta_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_img", 0),
                           (Env.SecurityTypeDef ("image", [])));
                          (("client_ta_t", 0), Env.ProcTypeDef);
                          (("client_t", 0), Env.ProcTypeDef);
                          (("server_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                          (("hash", 0), (Env.SimpleTypeDef []));
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("list", 0), (Env.SimpleTypeDef ["'a"]));
                          (("filedescr", 0), (Env.SimpleTypeDef []));
                          (("image", 0), (Env.SimpleTypeDef []));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("False", (Env.Global, (Some 0)));
                               ("ImgRecvInvalid", (Env.Global, (Some 1)));
                               ("ImgRecvValid", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("snd", 0),
                        [{ desc = (Typed.Tuple
                                     [{ desc = Typed.Ident {id = ("x", 5);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 5));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("y", 6),
                                           (Env.Var (Syntax.Meta 6)));
                                           (("x", 5),
                                            (Env.Var (Syntax.Meta 5)));
                                           (("snd", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'b")])));
                                           (("fst", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'a")])));
                                           (("sign", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "client_img", "image",
                                                      []));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "client_ta_sig",
                                                       "signature", []))
                                                    ])));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("y", 6);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 6));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("y", 6),
                                           (Env.Var (Syntax.Meta 6)));
                                           (("x", 5),
                                            (Env.Var (Syntax.Meta 5)));
                                           (("snd", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'b")])));
                                           (("fst", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'a")])));
                                           (("sign", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "client_img", "image",
                                                      []));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "client_ta_sig",
                                                       "signature", []))
                                                    ])));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]); env = { Env.vars =
                                                   [(("y", 6),
                                                     (Env.Var (Syntax.Meta 6)));
                                                     (("x", 5),
                                                      (Env.Var
                                                         (Syntax.Meta 5)));
                                                     (("snd", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ])));
                                                     (("fst", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ])));
                                                     (("sign", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "client_img",
                                                                "image", 
                                                                []));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ])));
                                                     (("sdec", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("senc", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("vk", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "string",
                                                                   [])),
                                                                (Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                )),
                                                             (Env.TySimple (
                                                                "string", 
                                                                []))
                                                             ));
                                                           (Env.TySecurity (
                                                              "client_ta_sig",
                                                              "signature", 
                                                              []))
                                                           ]));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TySimple (
                                                                "image", 
                                                                [])),
                                                             (Env.TySimple (
                                                                "signature",
                                                                []))
                                                             ))
                                                           ]));
                                                     (("ver_key_server", 0),
                                                      (Env.SecurityTypeDef (
                                                         "verkey",
                                                         [(Env.TySimple (
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("symkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "symkey",
                                                         [(Env.TySimple (
                                                             "cipher",
                                                             [(Env.TySecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                           ]
                                                         )));
                                                     (("sigkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("client_ta_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_img", 0),
                                                      (Env.SecurityTypeDef (
                                                         "image", [])));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("cipher", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("hash", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("symkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("list", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("filedescr", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("image", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                          ]
                        )); env = { Env.vars =
                                    [(("y", 6), (Env.Var (Syntax.Meta 6)));
                                      (("x", 5), (Env.Var (Syntax.Meta 5)));
                                      (("snd", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamProduct (
                                                 (Env.FParamPoly "'a"),
                                                 (Env.FParamPoly "'b")));
                                               (Env.FParamPoly "'b")])));
                                      (("fst", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamProduct (
                                                 (Env.FParamPoly "'a"),
                                                 (Env.FParamPoly "'b")));
                                               (Env.FParamPoly "'a")])));
                                      (("sign", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "client_img", "image", 
                                                 []));
                                               (Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                               (Env.FParamSecurity (
                                                  "client_ta_sig",
                                                  "signature", []))
                                               ])));
                                      (("sdec", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("senc", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSimple ("cipher",
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ))
                                               ])));
                                      (("vk", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "ver_key_server", "verkey",
                                                  [(Env.TySimple ("image", 
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("rpc_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TyProduct (
                                                 (Env.TySimple ("string", 
                                                    [])),
                                                 (Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                 )),
                                              (Env.TySimple ("string", []))));
                                            (Env.TySecurity ("client_ta_sig",
                                               "signature", []))
                                            ]));
                                      (("udp_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TySimple ("image", [])),
                                              (Env.TySimple ("signature", 
                                                 []))
                                              ))
                                            ]));
                                      (("ver_key_server", 0),
                                       (Env.SecurityTypeDef ("verkey",
                                          [(Env.TySimple ("image", []))])));
                                      (("conn_client", 0),
                                       (Env.SecurityTypeDef ("connection", 
                                          [])));
                                      (("symkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("symkey",
                                          [(Env.TySimple ("cipher",
                                              [(Env.TySecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                                ]
                                              ))
                                            ]
                                          )));
                                      (("sigkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          )));
                                      (("client_ta_sig", 0),
                                       (Env.SecurityTypeDef ("signature", 
                                          [])));
                                      (("client_img", 0),
                                       (Env.SecurityTypeDef ("image", [])));
                                      (("client_ta_t", 0), Env.ProcTypeDef);
                                      (("client_t", 0), Env.ProcTypeDef);
                                      (("server_t", 0), Env.ProcTypeDef);
                                      (("readonly_t", 0), Env.FilesysTypeDef);
                                      (("cipher", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("hash", 0), (Env.SimpleTypeDef []));
                                      (("verkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("sigkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("symkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("list", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("filedescr", 0),
                                       (Env.SimpleTypeDef []));
                                      (("image", 0), (Env.SimpleTypeDef []));
                                      (("signature", 0),
                                       (Env.SimpleTypeDef []));
                                      (("connection", 0),
                                       (Env.SimpleTypeDef []));
                                      (("string", 0), (Env.SimpleTypeDef []));
                                      (("bool", 0), (Env.SimpleTypeDef []));
                                      (("unit", 0), (Env.SimpleTypeDef []))];
                                    facts =
                                    ref ([("False", (Env.Global, (Some 0)));
                                           ("ImgRecvInvalid",
                                            (Env.Global, (Some 1)));
                                           ("ImgRecvValid",
                                            (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("y", 6);
                       desc = (Env.Var (Syntax.Meta 6)); param = None}; env = 
            { Env.vars =
              [(("y", 6), (Env.Var (Syntax.Meta 6)));
                (("x", 5), (Env.Var (Syntax.Meta 5)));
                (("snd", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamProduct ((Env.FParamPoly "'a"),
                           (Env.FParamPoly "'b")));
                         (Env.FParamPoly "'b")])));
                (("fst", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamProduct ((Env.FParamPoly "'a"),
                           (Env.FParamPoly "'b")));
                         (Env.FParamPoly "'a")])));
                (("sign", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("client_img", "image", []));
                         (Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("client_ta_sig", "signature",
                            []))
                         ])));
                (("sdec", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSimple ("cipher",
                           [(Env.FParamSecurity ("sigkey_client_ta",
                               "sigkey",
                               [(Env.TySecurity ("client_img", "image", []))]
                               ))
                             ]
                           ));
                         (Env.FParamSecurity ("symkey_client_ta", "symkey",
                            [(Env.TySimple ("cipher",
                                [(Env.TySecurity ("sigkey_client_ta",
                                    "sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    ))
                                  ]
                                ))
                              ]
                            ));
                         (Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]))
                         ])));
                (("senc", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                           [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("symkey_client_ta", "symkey",
                            [(Env.TySimple ("cipher",
                                [(Env.TySecurity ("sigkey_client_ta",
                                    "sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    ))
                                  ]
                                ))
                              ]
                            ));
                         (Env.FParamSimple ("cipher",
                            [(Env.FParamSecurity ("sigkey_client_ta",
                                "sigkey",
                                [(Env.TySecurity ("client_img", "image", []))
                                  ]
                                ))
                              ]
                            ))
                         ])));
                (("vk", 0),
                 (Env.ExtFun
                    (Env.DesugaredTypeSig
                       [(Env.FParamSecurity ("sigkey_client_ta", "sigkey",
                           [(Env.TySecurity ("client_img", "image", []))]));
                         (Env.FParamSecurity ("ver_key_server", "verkey",
                            [(Env.TySimple ("image", []))]))
                         ])));
                (("rpc_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyProduct (
                        (Env.TyProduct ((Env.TySimple ("string", [])),
                           (Env.TySecurity ("client_img", "image", [])))),
                        (Env.TySimple ("string", []))));
                      (Env.TySecurity ("client_ta_sig", "signature", []))]));
                (("udp_t", 0),
                 (Env.ChanTypeDef
                    [(Env.TyProduct ((Env.TySimple ("image", [])),
                        (Env.TySimple ("signature", []))))
                      ]));
                (("ver_key_server", 0),
                 (Env.SecurityTypeDef ("verkey",
                    [(Env.TySimple ("image", []))])));
                (("conn_client", 0), (Env.SecurityTypeDef ("connection", [])));
                (("symkey_client_ta", 0),
                 (Env.SecurityTypeDef ("symkey",
                    [(Env.TySimple ("cipher",
                        [(Env.TySecurity ("sigkey_client_ta", "sigkey",
                            [(Env.TySecurity ("client_img", "image", []))]))
                          ]
                        ))
                      ]
                    )));
                (("sigkey_client_ta", 0),
                 (Env.SecurityTypeDef ("sigkey",
                    [(Env.TySecurity ("client_img", "image", []))])));
                (("client_ta_sig", 0),
                 (Env.SecurityTypeDef ("signature", [])));
                (("client_img", 0), (Env.SecurityTypeDef ("image", [])));
                (("client_ta_t", 0), Env.ProcTypeDef);
                (("client_t", 0), Env.ProcTypeDef);
                (("server_t", 0), Env.ProcTypeDef);
                (("readonly_t", 0), Env.FilesysTypeDef);
                (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                (("hash", 0), (Env.SimpleTypeDef []));
                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                (("list", 0), (Env.SimpleTypeDef ["'a"]));
                (("filedescr", 0), (Env.SimpleTypeDef []));
                (("image", 0), (Env.SimpleTypeDef []));
                (("signature", 0), (Env.SimpleTypeDef []));
                (("connection", 0), (Env.SimpleTypeDef []));
                (("string", 0), (Env.SimpleTypeDef []));
                (("bool", 0), (Env.SimpleTypeDef []));
                (("unit", 0), (Env.SimpleTypeDef []))];
              facts =
              ref ([("False", (Env.Global, (Some 0)));
                     ("ImgRecvInvalid", (Env.Global, (Some 1)));
                     ("ImgRecvValid", (Env.Global, (Some 1)));
                     ("exit", (Env.Channel, (Some 0)));
                     ("Returned", (Env.Channel, (Some 1)));
                     ("invoke", (Env.Channel, (Some 3)));
                     ("conn", (Env.Channel, (Some 0)));
                     ("chid", (Env.Structure, (Some 1)));
                     ("ack", (Env.Channel, (Some 0)));
                     ("req", (Env.Channel, (Some 0)));
                     ("store", (Env.Channel, (Some 1)))])
              } }
            )); env = { Env.vars =
                        [(("y", 6), (Env.Var (Syntax.Meta 6)));
                          (("x", 5), (Env.Var (Syntax.Meta 5)));
                          (("snd", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamProduct ((Env.FParamPoly "'a"),
                                     (Env.FParamPoly "'b")));
                                   (Env.FParamPoly "'b")])));
                          (("fst", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamProduct ((Env.FParamPoly "'a"),
                                     (Env.FParamPoly "'b")));
                                   (Env.FParamPoly "'a")])));
                          (("sign", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("client_img", "image",
                                     []));
                                   (Env.FParamSecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ));
                                   (Env.FParamSecurity ("client_ta_sig",
                                      "signature", []))
                                   ])));
                          (("sdec", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSimple ("cipher",
                                     [(Env.FParamSecurity (
                                         "sigkey_client_ta", "sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         ))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                   ])));
                          (("senc", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSimple ("cipher",
                                      [(Env.FParamSecurity (
                                          "sigkey_client_ta", "sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          ))
                                        ]
                                      ))
                                   ])));
                          (("vk", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("ver_key_server",
                                      "verkey",
                                      [(Env.TySimple ("image", []))]))
                                   ])));
                          (("rpc_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct (
                                  (Env.TyProduct (
                                     (Env.TySimple ("string", [])),
                                     (Env.TySecurity ("client_img", "image",
                                        []))
                                     )),
                                  (Env.TySimple ("string", []))));
                                (Env.TySecurity ("client_ta_sig",
                                   "signature", []))
                                ]));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct ((Env.TySimple ("image", [])),
                                  (Env.TySimple ("signature", []))))
                                ]));
                          (("ver_key_server", 0),
                           (Env.SecurityTypeDef ("verkey",
                              [(Env.TySimple ("image", []))])));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("symkey_client_ta", 0),
                           (Env.SecurityTypeDef ("symkey",
                              [(Env.TySimple ("cipher",
                                  [(Env.TySecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                    ]
                                  ))
                                ]
                              )));
                          (("sigkey_client_ta", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TySecurity ("client_img", "image", []))]
                              )));
                          (("client_ta_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_img", 0),
                           (Env.SecurityTypeDef ("image", [])));
                          (("client_ta_t", 0), Env.ProcTypeDef);
                          (("client_t", 0), Env.ProcTypeDef);
                          (("server_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                          (("hash", 0), (Env.SimpleTypeDef []));
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("list", 0), (Env.SimpleTypeDef ["'a"]));
                          (("filedescr", 0), (Env.SimpleTypeDef []));
                          (("image", 0), (Env.SimpleTypeDef []));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("False", (Env.Global, (Some 0)));
                               ("ImgRecvInvalid", (Env.Global, (Some 1)));
                               ("ImgRecvValid", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("verify", 0),
                        [{ desc = (Typed.Apply (("sign", 0),
                                     [{ desc = Typed.Ident {id = ("d", 7);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 7));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("k", 8),
                                           (Env.Var (Syntax.Meta 8)));
                                           (("d", 7),
                                            (Env.Var (Syntax.Meta 7)));
                                           (("verify", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "signature", []));
                                                    (Env.FParamSimple (
                                                       "image", []));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "bool", []))
                                                    ])));
                                           (("true", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple ("bool",
                                                      []))
                                                    ])));
                                           (("snd", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'b")])));
                                           (("fst", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'a")])));
                                           (("sign", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "client_img", "image",
                                                      []));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "client_ta_sig",
                                                       "signature", []))
                                                    ])));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("k", 8);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 8));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("k", 8),
                                           (Env.Var (Syntax.Meta 8)));
                                           (("d", 7),
                                            (Env.Var (Syntax.Meta 7)));
                                           (("verify", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "signature", []));
                                                    (Env.FParamSimple (
                                                       "image", []));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "bool", []))
                                                    ])));
                                           (("true", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple ("bool",
                                                      []))
                                                    ])));
                                           (("snd", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'b")])));
                                           (("fst", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamProduct (
                                                      (Env.FParamPoly "'a"),
                                                      (Env.FParamPoly "'b")));
                                                    (Env.FParamPoly "'a")])));
                                           (("sign", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "client_img", "image",
                                                      []));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "client_ta_sig",
                                                       "signature", []))
                                                    ])));
                                           (("sdec", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("senc", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "symkey_client_ta",
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                    (Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                    ])));
                                           (("vk", 0),
                                            (Env.ExtFun
                                               (Env.DesugaredTypeSig
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                    (Env.FParamSecurity (
                                                       "ver_key_server",
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       ))
                                                    ])));
                                           (("rpc_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TyProduct (
                                                      (Env.TySimple (
                                                         "string", [])),
                                                      (Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                      )),
                                                   (Env.TySimple ("string",
                                                      []))
                                                   ));
                                                 (Env.TySecurity (
                                                    "client_ta_sig",
                                                    "signature", []))
                                                 ]));
                                           (("udp_t", 0),
                                            (Env.ChanTypeDef
                                               [(Env.TyProduct (
                                                   (Env.TySimple ("image", 
                                                      [])),
                                                   (Env.TySimple (
                                                      "signature", []))
                                                   ))
                                                 ]));
                                           (("ver_key_server", 0),
                                            (Env.SecurityTypeDef ("verkey",
                                               [(Env.TySimple ("image", []))]
                                               )));
                                           (("conn_client", 0),
                                            (Env.SecurityTypeDef (
                                               "connection", [])));
                                           (("symkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("symkey",
                                               [(Env.TySimple ("cipher",
                                                   [(Env.TySecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                 ]
                                               )));
                                           (("sigkey_client_ta", 0),
                                            (Env.SecurityTypeDef ("sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               )));
                                           (("client_ta_sig", 0),
                                            (Env.SecurityTypeDef (
                                               "signature", [])));
                                           (("client_img", 0),
                                            (Env.SecurityTypeDef ("image", 
                                               [])));
                                           (("client_ta_t", 0),
                                            Env.ProcTypeDef);
                                           (("client_t", 0), Env.ProcTypeDef);
                                           (("server_t", 0), Env.ProcTypeDef);
                                           (("readonly_t", 0),
                                            Env.FilesysTypeDef);
                                           (("cipher", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("hash", 0),
                                            (Env.SimpleTypeDef []));
                                           (("verkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("sigkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("symkey", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("list", 0),
                                            (Env.SimpleTypeDef ["'a"]));
                                           (("filedescr", 0),
                                            (Env.SimpleTypeDef []));
                                           (("image", 0),
                                            (Env.SimpleTypeDef []));
                                           (("signature", 0),
                                            (Env.SimpleTypeDef []));
                                           (("connection", 0),
                                            (Env.SimpleTypeDef []));
                                           (("string", 0),
                                            (Env.SimpleTypeDef []));
                                           (("bool", 0),
                                            (Env.SimpleTypeDef []));
                                           (("unit", 0),
                                            (Env.SimpleTypeDef []))
                                           ];
                                         facts =
                                         ref ([("False",
                                                (Env.Global, (Some 0)));
                                                ("ImgRecvInvalid",
                                                 (Env.Global, (Some 1)));
                                                ("ImgRecvValid",
                                                 (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]
                                     )); env = { Env.vars =
                                                 [(("k", 8),
                                                   (Env.Var (Syntax.Meta 8)));
                                                   (("d", 7),
                                                    (Env.Var (Syntax.Meta 7)));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                          { desc = Typed.Ident {id = ("d", 7);
                                     desc = (Env.Var (Syntax.Meta 7));
                                     param = None}; env = { Env.vars =
                                                            [(("k", 8),
                                                              (Env.Var
                                                                 (Syntax.Meta
                                                                    8)));
                                                              (("d", 7),
                                                               (Env.Var
                                                                  (Syntax.Meta
                                                                    7)));
                                                              (("verify", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                              (("true", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                              (("snd", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                              (("fst", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                              (("sign", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                              (("sdec", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                              (("senc", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                              (("vk", 0),
                                                               (Env.ExtFun
                                                                  (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                              (("rpc_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (
                                                                    Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                              (("ver_key_server",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  )));
                                                              (("conn_client",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "connection",
                                                                  [])));
                                                              (("symkey_client_ta",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  )));
                                                              (("sigkey_client_ta",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  )));
                                                              (("client_ta_sig",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "signature",
                                                                  [])));
                                                              (("client_img",
                                                                0),
                                                               (Env.SecurityTypeDef (
                                                                  "image", 
                                                                  [])));
                                                              (("client_ta_t",
                                                                0),
                                                               Env.ProcTypeDef);
                                                              (("client_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("server_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("cipher", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("hash", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("verkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("sigkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("symkey", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("list", 0),
                                                               (Env.SimpleTypeDef
                                                                  ["'a"]));
                                                              (("filedescr",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("image", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("signature",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("connection",
                                                                0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("string", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("bool", 0),
                                                               (Env.SimpleTypeDef
                                                                  []));
                                                              (("unit", 0),
                                                               (Env.SimpleTypeDef
                                                                  []))
                                                              ];
                                                            facts =
                                                            ref ([("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } };
                          { desc = (Typed.Apply (("vk", 0),
                                      [{ desc = Typed.Ident {id = ("k", 8);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 8));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("k", 8),
                                            (Env.Var (Syntax.Meta 8)));
                                            (("d", 7),
                                             (Env.Var (Syntax.Meta 7)));
                                            (("verify", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "signature", []));
                                                     (Env.FParamSimple (
                                                        "image", []));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "bool", []))
                                                     ])));
                                            (("true", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "bool", []))
                                                     ])));
                                            (("snd", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'b")])));
                                            (("fst", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'a")])));
                                            (("sign", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "client_img", "image",
                                                       []));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "client_ta_sig",
                                                        "signature", 
                                                        []))
                                                     ])));
                                            (("sdec", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("senc", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "cipher",
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ))
                                                          ]
                                                        ))
                                                     ])));
                                            (("vk", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("rpc_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TyProduct (
                                                       (Env.TySimple (
                                                          "string", [])),
                                                       (Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                       )),
                                                    (Env.TySimple ("string",
                                                       []))
                                                    ));
                                                  (Env.TySecurity (
                                                     "client_ta_sig",
                                                     "signature", []))
                                                  ]));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TySimple ("image",
                                                       [])),
                                                    (Env.TySimple (
                                                       "signature", []))
                                                    ))
                                                  ]));
                                            (("ver_key_server", 0),
                                             (Env.SecurityTypeDef ("verkey",
                                                [(Env.TySimple ("image", []))
                                                  ]
                                                )));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("symkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("symkey",
                                                [(Env.TySimple ("cipher",
                                                    [(Env.TySecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                      ]
                                                    ))
                                                  ]
                                                )));
                                            (("sigkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                )));
                                            (("client_ta_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_img", 0),
                                             (Env.SecurityTypeDef ("image",
                                                [])));
                                            (("client_ta_t", 0),
                                             Env.ProcTypeDef);
                                            (("client_t", 0), Env.ProcTypeDef);
                                            (("server_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("cipher", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("hash", 0),
                                             (Env.SimpleTypeDef []));
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("symkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("list", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("filedescr", 0),
                                             (Env.SimpleTypeDef []));
                                            (("image", 0),
                                             (Env.SimpleTypeDef []));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("False",
                                                 (Env.Global, (Some 0)));
                                                 ("ImgRecvInvalid",
                                                  (Env.Global, (Some 1)));
                                                 ("ImgRecvValid",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]
                                      )); env = { Env.vars =
                                                  [(("k", 8),
                                                    (Env.Var (Syntax.Meta 8)));
                                                    (("d", 7),
                                                     (Env.Var (Syntax.Meta 7)));
                                                    (("verify", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSimple (
                                                               "signature",
                                                               []));
                                                             (Env.FParamSimple (
                                                                "image", 
                                                                []));
                                                             (Env.FParamSecurity (
                                                                "ver_key_server",
                                                                "verkey",
                                                                [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                             (Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                             ])));
                                                    (("true", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                             ])));
                                                    (("snd", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamProduct (
                                                               (Env.FParamPoly
                                                                  "'a"),
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ));
                                                             (Env.FParamPoly
                                                                "'b")
                                                             ])));
                                                    (("fst", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamProduct (
                                                               (Env.FParamPoly
                                                                  "'a"),
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ));
                                                             (Env.FParamPoly
                                                                "'a")
                                                             ])));
                                                    (("sign", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSecurity (
                                                               "client_img",
                                                               "image", 
                                                               []));
                                                             (Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                             (Env.FParamSecurity (
                                                                "client_ta_sig",
                                                                "signature",
                                                                []))
                                                             ])));
                                                    (("sdec", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ));
                                                             (Env.FParamSecurity (
                                                                "symkey_client_ta",
                                                                "symkey",
                                                                [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                  ]
                                                                ));
                                                             (Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                             ])));
                                                    (("senc", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                             (Env.FParamSecurity (
                                                                "symkey_client_ta",
                                                                "symkey",
                                                                [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                  ]
                                                                ));
                                                             (Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ))
                                                             ])));
                                                    (("vk", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                             (Env.FParamSecurity (
                                                                "ver_key_server",
                                                                "verkey",
                                                                [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                             ])));
                                                    (("rpc_t", 0),
                                                     (Env.ChanTypeDef
                                                        [(Env.TyProduct (
                                                            (Env.TyProduct (
                                                               (Env.TySimple (
                                                                  "string",
                                                                  [])),
                                                               (Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                               )),
                                                            (Env.TySimple (
                                                               "string", 
                                                               []))
                                                            ));
                                                          (Env.TySecurity (
                                                             "client_ta_sig",
                                                             "signature", 
                                                             []))
                                                          ]));
                                                    (("udp_t", 0),
                                                     (Env.ChanTypeDef
                                                        [(Env.TyProduct (
                                                            (Env.TySimple (
                                                               "image", 
                                                               [])),
                                                            (Env.TySimple (
                                                               "signature",
                                                               []))
                                                            ))
                                                          ]));
                                                    (("ver_key_server", 0),
                                                     (Env.SecurityTypeDef (
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        )));
                                                    (("conn_client", 0),
                                                     (Env.SecurityTypeDef (
                                                        "connection", 
                                                        [])));
                                                    (("symkey_client_ta", 0),
                                                     (Env.SecurityTypeDef (
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        )));
                                                    (("sigkey_client_ta", 0),
                                                     (Env.SecurityTypeDef (
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        )));
                                                    (("client_ta_sig", 0),
                                                     (Env.SecurityTypeDef (
                                                        "signature", 
                                                        [])));
                                                    (("client_img", 0),
                                                     (Env.SecurityTypeDef (
                                                        "image", [])));
                                                    (("client_ta_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("client_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("server_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("readonly_t", 0),
                                                     Env.FilesysTypeDef);
                                                    (("cipher", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("hash", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("verkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("sigkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("symkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("list", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("filedescr", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("image", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("signature", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("connection", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("string", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("bool", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("unit", 0),
                                                     (Env.SimpleTypeDef []))
                                                    ];
                                                  facts =
                                                  ref ([("False",
                                                         (Env.Global,
                                                          (Some 0)));
                                                         ("ImgRecvInvalid",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("ImgRecvValid",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("Returned",
                                                          (Env.Channel,
                                                           (Some 1)));
                                                         ("invoke",
                                                          (Env.Channel,
                                                           (Some 3)));
                                                         ("conn",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("chid",
                                                          (Env.Structure,
                                                           (Some 1)));
                                                         ("ack",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("req",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("store",
                                                          (Env.Channel,
                                                           (Some 1)))
                                                         ])
                                                  } }
                          ]
                        )); env = { Env.vars =
                                    [(("k", 8), (Env.Var (Syntax.Meta 8)));
                                      (("d", 7), (Env.Var (Syntax.Meta 7)));
                                      (("verify", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSimple ("signature",
                                                 []));
                                               (Env.FParamSimple ("image", 
                                                  []));
                                               (Env.FParamSecurity (
                                                  "ver_key_server", "verkey",
                                                  [(Env.TySimple ("image", 
                                                      []))
                                                    ]
                                                  ));
                                               (Env.FParamSimple ("bool", 
                                                  []))
                                               ])));
                                      (("true", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSimple ("bool", []))
                                               ])));
                                      (("snd", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamProduct (
                                                 (Env.FParamPoly "'a"),
                                                 (Env.FParamPoly "'b")));
                                               (Env.FParamPoly "'b")])));
                                      (("fst", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamProduct (
                                                 (Env.FParamPoly "'a"),
                                                 (Env.FParamPoly "'b")));
                                               (Env.FParamPoly "'a")])));
                                      (("sign", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "client_img", "image", 
                                                 []));
                                               (Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                               (Env.FParamSecurity (
                                                  "client_ta_sig",
                                                  "signature", []))
                                               ])));
                                      (("sdec", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("senc", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "symkey_client_ta",
                                                  "symkey",
                                                  [(Env.TySimple ("cipher",
                                                      [(Env.TySecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                               (Env.FParamSimple ("cipher",
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ))
                                               ])));
                                      (("vk", 0),
                                       (Env.ExtFun
                                          (Env.DesugaredTypeSig
                                             [(Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                               (Env.FParamSecurity (
                                                  "ver_key_server", "verkey",
                                                  [(Env.TySimple ("image", 
                                                      []))
                                                    ]
                                                  ))
                                               ])));
                                      (("rpc_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TyProduct (
                                                 (Env.TySimple ("string", 
                                                    [])),
                                                 (Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                 )),
                                              (Env.TySimple ("string", []))));
                                            (Env.TySecurity ("client_ta_sig",
                                               "signature", []))
                                            ]));
                                      (("udp_t", 0),
                                       (Env.ChanTypeDef
                                          [(Env.TyProduct (
                                              (Env.TySimple ("image", [])),
                                              (Env.TySimple ("signature", 
                                                 []))
                                              ))
                                            ]));
                                      (("ver_key_server", 0),
                                       (Env.SecurityTypeDef ("verkey",
                                          [(Env.TySimple ("image", []))])));
                                      (("conn_client", 0),
                                       (Env.SecurityTypeDef ("connection", 
                                          [])));
                                      (("symkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("symkey",
                                          [(Env.TySimple ("cipher",
                                              [(Env.TySecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ))
                                                ]
                                              ))
                                            ]
                                          )));
                                      (("sigkey_client_ta", 0),
                                       (Env.SecurityTypeDef ("sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          )));
                                      (("client_ta_sig", 0),
                                       (Env.SecurityTypeDef ("signature", 
                                          [])));
                                      (("client_img", 0),
                                       (Env.SecurityTypeDef ("image", [])));
                                      (("client_ta_t", 0), Env.ProcTypeDef);
                                      (("client_t", 0), Env.ProcTypeDef);
                                      (("server_t", 0), Env.ProcTypeDef);
                                      (("readonly_t", 0), Env.FilesysTypeDef);
                                      (("cipher", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("hash", 0), (Env.SimpleTypeDef []));
                                      (("verkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("sigkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("symkey", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("list", 0),
                                       (Env.SimpleTypeDef ["'a"]));
                                      (("filedescr", 0),
                                       (Env.SimpleTypeDef []));
                                      (("image", 0), (Env.SimpleTypeDef []));
                                      (("signature", 0),
                                       (Env.SimpleTypeDef []));
                                      (("connection", 0),
                                       (Env.SimpleTypeDef []));
                                      (("string", 0), (Env.SimpleTypeDef []));
                                      (("bool", 0), (Env.SimpleTypeDef []));
                                      (("unit", 0), (Env.SimpleTypeDef []))];
                                    facts =
                                    ref ([("False", (Env.Global, (Some 0)));
                                           ("ImgRecvInvalid",
                                            (Env.Global, (Some 1)));
                                           ("ImgRecvValid",
                                            (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("true", 0);
                       desc =
                       (Env.ExtFun
                          (Env.DesugaredTypeSig
                             [(Env.FParamSimple ("bool", []))]));
                       param = None}; env = { Env.vars =
                                              [(("k", 8),
                                                (Env.Var (Syntax.Meta 8)));
                                                (("d", 7),
                                                 (Env.Var (Syntax.Meta 7)));
                                                (("verify", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamSimple (
                                                           "signature", 
                                                           []));
                                                         (Env.FParamSimple (
                                                            "image", 
                                                            []));
                                                         (Env.FParamSecurity (
                                                            "ver_key_server",
                                                            "verkey",
                                                            [(Env.TySimple (
                                                                "image", 
                                                                []))
                                                              ]
                                                            ));
                                                         (Env.FParamSimple (
                                                            "bool", []))
                                                         ])));
                                                (("true", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamSimple (
                                                           "bool", []))
                                                         ])));
                                                (("snd", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamProduct (
                                                           (Env.FParamPoly
                                                              "'a"),
                                                           (Env.FParamPoly
                                                              "'b")
                                                           ));
                                                         (Env.FParamPoly "'b")
                                                         ])));
                                                (("fst", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamProduct (
                                                           (Env.FParamPoly
                                                              "'a"),
                                                           (Env.FParamPoly
                                                              "'b")
                                                           ));
                                                         (Env.FParamPoly "'a")
                                                         ])));
                                                (("sign", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamSecurity (
                                                           "client_img",
                                                           "image", []));
                                                         (Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ));
                                                         (Env.FParamSecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ])));
                                                (("sdec", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamSimple (
                                                           "cipher",
                                                           [(Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ));
                                                         (Env.FParamSecurity (
                                                            "symkey_client_ta",
                                                            "symkey",
                                                            [(Env.TySimple (
                                                                "cipher",
                                                                [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ))
                                                              ]
                                                            ));
                                                         (Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ))
                                                         ])));
                                                (("senc", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ));
                                                         (Env.FParamSecurity (
                                                            "symkey_client_ta",
                                                            "symkey",
                                                            [(Env.TySimple (
                                                                "cipher",
                                                                [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ))
                                                              ]
                                                            ));
                                                         (Env.FParamSimple (
                                                            "cipher",
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                         ])));
                                                (("vk", 0),
                                                 (Env.ExtFun
                                                    (Env.DesugaredTypeSig
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ));
                                                         (Env.FParamSecurity (
                                                            "ver_key_server",
                                                            "verkey",
                                                            [(Env.TySimple (
                                                                "image", 
                                                                []))
                                                              ]
                                                            ))
                                                         ])));
                                                (("rpc_t", 0),
                                                 (Env.ChanTypeDef
                                                    [(Env.TyProduct (
                                                        (Env.TyProduct (
                                                           (Env.TySimple (
                                                              "string", 
                                                              [])),
                                                           (Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                           )),
                                                        (Env.TySimple (
                                                           "string", 
                                                           []))
                                                        ));
                                                      (Env.TySecurity (
                                                         "client_ta_sig",
                                                         "signature", 
                                                         []))
                                                      ]));
                                                (("udp_t", 0),
                                                 (Env.ChanTypeDef
                                                    [(Env.TyProduct (
                                                        (Env.TySimple (
                                                           "image", [])),
                                                        (Env.TySimple (
                                                           "signature", 
                                                           []))
                                                        ))
                                                      ]));
                                                (("ver_key_server", 0),
                                                 (Env.SecurityTypeDef (
                                                    "verkey",
                                                    [(Env.TySimple ("image",
                                                        []))
                                                      ]
                                                    )));
                                                (("conn_client", 0),
                                                 (Env.SecurityTypeDef (
                                                    "connection", [])));
                                                (("symkey_client_ta", 0),
                                                 (Env.SecurityTypeDef (
                                                    "symkey",
                                                    [(Env.TySimple ("cipher",
                                                        [(Env.TySecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ))
                                                          ]
                                                        ))
                                                      ]
                                                    )));
                                                (("sigkey_client_ta", 0),
                                                 (Env.SecurityTypeDef (
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    )));
                                                (("client_ta_sig", 0),
                                                 (Env.SecurityTypeDef (
                                                    "signature", [])));
                                                (("client_img", 0),
                                                 (Env.SecurityTypeDef (
                                                    "image", [])));
                                                (("client_ta_t", 0),
                                                 Env.ProcTypeDef);
                                                (("client_t", 0),
                                                 Env.ProcTypeDef);
                                                (("server_t", 0),
                                                 Env.ProcTypeDef);
                                                (("readonly_t", 0),
                                                 Env.FilesysTypeDef);
                                                (("cipher", 0),
                                                 (Env.SimpleTypeDef ["'a"]));
                                                (("hash", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("verkey", 0),
                                                 (Env.SimpleTypeDef ["'a"]));
                                                (("sigkey", 0),
                                                 (Env.SimpleTypeDef ["'a"]));
                                                (("symkey", 0),
                                                 (Env.SimpleTypeDef ["'a"]));
                                                (("list", 0),
                                                 (Env.SimpleTypeDef ["'a"]));
                                                (("filedescr", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("image", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("signature", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("connection", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("string", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("bool", 0),
                                                 (Env.SimpleTypeDef []));
                                                (("unit", 0),
                                                 (Env.SimpleTypeDef []))
                                                ];
                                              facts =
                                              ref ([("False",
                                                     (Env.Global, (Some 0)));
                                                     ("ImgRecvInvalid",
                                                      (Env.Global, (Some 1)));
                                                     ("ImgRecvValid",
                                                      (Env.Global, (Some 1)));
                                                     ("exit",
                                                      (Env.Channel, (Some 0)));
                                                     ("Returned",
                                                      (Env.Channel, (Some 1)));
                                                     ("invoke",
                                                      (Env.Channel, (Some 3)));
                                                     ("conn",
                                                      (Env.Channel, (Some 0)));
                                                     ("chid",
                                                      (Env.Structure,
                                                       (Some 1)));
                                                     ("ack",
                                                      (Env.Channel, (Some 0)));
                                                     ("req",
                                                      (Env.Channel, (Some 0)));
                                                     ("store",
                                                      (Env.Channel, (Some 1)))
                                                     ])
                                              } }
            )); env = { Env.vars =
                        [(("k", 8), (Env.Var (Syntax.Meta 8)));
                          (("d", 7), (Env.Var (Syntax.Meta 7)));
                          (("verify", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSimple ("signature", []));
                                   (Env.FParamSimple ("image", []));
                                   (Env.FParamSecurity ("ver_key_server",
                                      "verkey",
                                      [(Env.TySimple ("image", []))]));
                                   (Env.FParamSimple ("bool", []))])));
                          (("true", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSimple ("bool", []))])));
                          (("snd", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamProduct ((Env.FParamPoly "'a"),
                                     (Env.FParamPoly "'b")));
                                   (Env.FParamPoly "'b")])));
                          (("fst", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamProduct ((Env.FParamPoly "'a"),
                                     (Env.FParamPoly "'b")));
                                   (Env.FParamPoly "'a")])));
                          (("sign", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("client_img", "image",
                                     []));
                                   (Env.FParamSecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ));
                                   (Env.FParamSecurity ("client_ta_sig",
                                      "signature", []))
                                   ])));
                          (("sdec", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSimple ("cipher",
                                     [(Env.FParamSecurity (
                                         "sigkey_client_ta", "sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         ))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                   ])));
                          (("senc", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("symkey_client_ta",
                                      "symkey",
                                      [(Env.TySimple ("cipher",
                                          [(Env.TySecurity (
                                              "sigkey_client_ta", "sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              ))
                                            ]
                                          ))
                                        ]
                                      ));
                                   (Env.FParamSimple ("cipher",
                                      [(Env.FParamSecurity (
                                          "sigkey_client_ta", "sigkey",
                                          [(Env.TySecurity ("client_img",
                                              "image", []))
                                            ]
                                          ))
                                        ]
                                      ))
                                   ])));
                          (("vk", 0),
                           (Env.ExtFun
                              (Env.DesugaredTypeSig
                                 [(Env.FParamSecurity ("sigkey_client_ta",
                                     "sigkey",
                                     [(Env.TySecurity ("client_img", "image",
                                         []))
                                       ]
                                     ));
                                   (Env.FParamSecurity ("ver_key_server",
                                      "verkey",
                                      [(Env.TySimple ("image", []))]))
                                   ])));
                          (("rpc_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct (
                                  (Env.TyProduct (
                                     (Env.TySimple ("string", [])),
                                     (Env.TySecurity ("client_img", "image",
                                        []))
                                     )),
                                  (Env.TySimple ("string", []))));
                                (Env.TySecurity ("client_ta_sig",
                                   "signature", []))
                                ]));
                          (("udp_t", 0),
                           (Env.ChanTypeDef
                              [(Env.TyProduct ((Env.TySimple ("image", [])),
                                  (Env.TySimple ("signature", []))))
                                ]));
                          (("ver_key_server", 0),
                           (Env.SecurityTypeDef ("verkey",
                              [(Env.TySimple ("image", []))])));
                          (("conn_client", 0),
                           (Env.SecurityTypeDef ("connection", [])));
                          (("symkey_client_ta", 0),
                           (Env.SecurityTypeDef ("symkey",
                              [(Env.TySimple ("cipher",
                                  [(Env.TySecurity ("sigkey_client_ta",
                                      "sigkey",
                                      [(Env.TySecurity ("client_img",
                                          "image", []))
                                        ]
                                      ))
                                    ]
                                  ))
                                ]
                              )));
                          (("sigkey_client_ta", 0),
                           (Env.SecurityTypeDef ("sigkey",
                              [(Env.TySecurity ("client_img", "image", []))]
                              )));
                          (("client_ta_sig", 0),
                           (Env.SecurityTypeDef ("signature", [])));
                          (("client_img", 0),
                           (Env.SecurityTypeDef ("image", [])));
                          (("client_ta_t", 0), Env.ProcTypeDef);
                          (("client_t", 0), Env.ProcTypeDef);
                          (("server_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                          (("hash", 0), (Env.SimpleTypeDef []));
                          (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                          (("list", 0), (Env.SimpleTypeDef ["'a"]));
                          (("filedescr", 0), (Env.SimpleTypeDef []));
                          (("image", 0), (Env.SimpleTypeDef []));
                          (("signature", 0), (Env.SimpleTypeDef []));
                          (("connection", 0), (Env.SimpleTypeDef []));
                          (("string", 0), (Env.SimpleTypeDef []));
                          (("bool", 0), (Env.SimpleTypeDef []));
                          (("unit", 0), (Env.SimpleTypeDef []))];
                        facts =
                        ref ([("False", (Env.Global, (Some 0)));
                               ("ImgRecvInvalid", (Env.Global, (Some 1)));
                               ("ImgRecvValid", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = Typed.Syscall {id = ("send", 0);
           fun_sig =
           (Env.DesSMFunTyped ([("c", 9); ("v", 10)],
              [(Env.FParamChannel [(Env.FParamPoly "'a")]);
                (Env.FParamPoly "'a"); (Env.FParamSimple ("unit", []))]
              ));
           cmd =
           { desc = (Typed.Put
                       [{ desc = Typed.Channel {
                                   channel =
                                   { desc = Typed.Ident {id = ("c", 9);
                                              desc = (Env.Var (Syntax.Loc 9));
                                              param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 10),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    10)));
                                                                    ((
                                                                    "c", 9),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    9)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                   name = "store";
                                   args =
                                   [{ desc = Typed.Ident {id = ("v", 10);
                                               desc =
                                               (Env.Var (Syntax.Loc 10));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 10),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    10)));
                                                                    ((
                                                                    "c", 9),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    9)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]}; env = { Env.vars =
                                                 [(("v", 10),
                                                   (Env.Var (Syntax.Loc 10)));
                                                   (("c", 9),
                                                    (Env.Var (Syntax.Loc 9)));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                         ]); env = { Env.vars =
                                     [(("v", 10), (Env.Var (Syntax.Loc 10)));
                                       (("c", 9), (Env.Var (Syntax.Loc 9)));
                                       (("verify", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple (
                                                  "signature", []));
                                                (Env.FParamSimple ("image",
                                                   []));
                                                (Env.FParamSecurity (
                                                   "ver_key_server",
                                                   "verkey",
                                                   [(Env.TySimple ("image",
                                                       []))
                                                     ]
                                                   ));
                                                (Env.FParamSimple ("bool", 
                                                   []))
                                                ])));
                                       (("true", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple ("bool", 
                                                  []))
                                                ])));
                                       (("snd", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamProduct (
                                                  (Env.FParamPoly "'a"),
                                                  (Env.FParamPoly "'b")));
                                                (Env.FParamPoly "'b")])));
                                       (("fst", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamProduct (
                                                  (Env.FParamPoly "'a"),
                                                  (Env.FParamPoly "'b")));
                                                (Env.FParamPoly "'a")])));
                                       (("sign", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "client_img", "image", 
                                                  []));
                                                (Env.FParamSecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ));
                                                (Env.FParamSecurity (
                                                   "client_ta_sig",
                                                   "signature", []))
                                                ])));
                                       (("sdec", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple ("cipher",
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "symkey_client_ta",
                                                   "symkey",
                                                   [(Env.TySimple ("cipher",
                                                       [(Env.TySecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                     ]
                                                   ));
                                                (Env.FParamSecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ))
                                                ])));
                                       (("senc", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "symkey_client_ta",
                                                   "symkey",
                                                   [(Env.TySimple ("cipher",
                                                       [(Env.TySecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                     ]
                                                   ));
                                                (Env.FParamSimple ("cipher",
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                ])));
                                       (("vk", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "ver_key_server",
                                                   "verkey",
                                                   [(Env.TySimple ("image",
                                                       []))
                                                     ]
                                                   ))
                                                ])));
                                       (("rpc_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyProduct (
                                               (Env.TyProduct (
                                                  (Env.TySimple ("string", 
                                                     [])),
                                                  (Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                  )),
                                               (Env.TySimple ("string", []))
                                               ));
                                             (Env.TySecurity (
                                                "client_ta_sig", "signature",
                                                []))
                                             ]));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyProduct (
                                               (Env.TySimple ("image", [])),
                                               (Env.TySimple ("signature", 
                                                  []))
                                               ))
                                             ]));
                                       (("ver_key_server", 0),
                                        (Env.SecurityTypeDef ("verkey",
                                           [(Env.TySimple ("image", []))])));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("symkey_client_ta", 0),
                                        (Env.SecurityTypeDef ("symkey",
                                           [(Env.TySimple ("cipher",
                                               [(Env.TySecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ))
                                                 ]
                                               ))
                                             ]
                                           )));
                                       (("sigkey_client_ta", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TySecurity ("client_img",
                                               "image", []))
                                             ]
                                           )));
                                       (("client_ta_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_img", 0),
                                        (Env.SecurityTypeDef ("image", [])));
                                       (("client_ta_t", 0), Env.ProcTypeDef);
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("server_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("cipher", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("hash", 0), (Env.SimpleTypeDef []));
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("symkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("list", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("filedescr", 0),
                                        (Env.SimpleTypeDef []));
                                       (("image", 0), (Env.SimpleTypeDef []));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []))];
                                     facts =
                                     ref ([("False", (Env.Global, (Some 0)));
                                            ("ImgRecvInvalid",
                                             (Env.Global, (Some 1)));
                                            ("ImgRecvValid",
                                             (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("verify", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSimple (
                                                               "signature",
                                                               []));
                                                             (Env.FParamSimple (
                                                                "image", 
                                                                []));
                                                             (Env.FParamSecurity (
                                                                "ver_key_server",
                                                                "verkey",
                                                                [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                             (Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                             ])));
                                                     (("true", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                              ])));
                                                     (("snd", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ])));
                                                     (("fst", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ])));
                                                     (("sign", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "client_img",
                                                                "image", 
                                                                []));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ])));
                                                     (("sdec", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("senc", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("vk", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "string",
                                                                   [])),
                                                                (Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                )),
                                                             (Env.TySimple (
                                                                "string", 
                                                                []))
                                                             ));
                                                           (Env.TySecurity (
                                                              "client_ta_sig",
                                                              "signature", 
                                                              []))
                                                           ]));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TySimple (
                                                                "image", 
                                                                [])),
                                                             (Env.TySimple (
                                                                "signature",
                                                                []))
                                                             ))
                                                           ]));
                                                     (("ver_key_server", 0),
                                                      (Env.SecurityTypeDef (
                                                         "verkey",
                                                         [(Env.TySimple (
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("symkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "symkey",
                                                         [(Env.TySimple (
                                                             "cipher",
                                                             [(Env.TySecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                           ]
                                                         )));
                                                     (("sigkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("client_ta_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_img", 0),
                                                      (Env.SecurityTypeDef (
                                                         "image", [])));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("cipher", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("hash", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("symkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("list", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("filedescr", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("image", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("recv", 0);
           fun_sig =
           (Env.DesSMFunTyped ([("c", 11)],
              [(Env.FParamChannel [(Env.FParamPoly "'a")]);
                (Env.FParamPoly "'a")]
              ));
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [("v", 12)];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 11);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 11));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 12),
                                          (Env.Var (Syntax.Meta 12)));
                                          (("c", 11),
                                           (Env.Var (Syntax.Loc 11)));
                                          (("send", 0),
                                           (Env.ExtSyscall
                                              (Env.DesSMFunTyped (
                                                 [("c", 9); ("v", 10)],
                                                 [(Env.FParamChannel
                                                     [(Env.FParamPoly "'a")]);
                                                   (Env.FParamPoly "'a");
                                                   (Env.FParamSimple ("unit",
                                                      []))
                                                   ]
                                                 ))));
                                          (("verify", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple (
                                                     "signature", []));
                                                   (Env.FParamSimple (
                                                      "image", []));
                                                   (Env.FParamSecurity (
                                                      "ver_key_server",
                                                      "verkey",
                                                      [(Env.TySimple (
                                                          "image", []))
                                                        ]
                                                      ));
                                                   (Env.FParamSimple ("bool",
                                                      []))
                                                   ])));
                                          (("true", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple ("bool",
                                                     []))
                                                   ])));
                                          (("snd", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamProduct (
                                                     (Env.FParamPoly "'a"),
                                                     (Env.FParamPoly "'b")));
                                                   (Env.FParamPoly "'b")])));
                                          (("fst", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamProduct (
                                                     (Env.FParamPoly "'a"),
                                                     (Env.FParamPoly "'b")));
                                                   (Env.FParamPoly "'a")])));
                                          (("sign", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "client_img", "image",
                                                     []));
                                                   (Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                   (Env.FParamSecurity (
                                                      "client_ta_sig",
                                                      "signature", []))
                                                   ])));
                                          (("sdec", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple (
                                                     "cipher",
                                                     [(Env.FParamSecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "symkey_client_ta",
                                                      "symkey",
                                                      [(Env.TySimple (
                                                          "cipher",
                                                          [(Env.TySecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                   (Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                   ])));
                                          (("senc", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "symkey_client_ta",
                                                      "symkey",
                                                      [(Env.TySimple (
                                                          "cipher",
                                                          [(Env.TySecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                   (Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                   ])));
                                          (("vk", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "ver_key_server",
                                                      "verkey",
                                                      [(Env.TySimple (
                                                          "image", []))
                                                        ]
                                                      ))
                                                   ])));
                                          (("rpc_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyProduct (
                                                  (Env.TyProduct (
                                                     (Env.TySimple ("string",
                                                        [])),
                                                     (Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                     )),
                                                  (Env.TySimple ("string", 
                                                     []))
                                                  ));
                                                (Env.TySecurity (
                                                   "client_ta_sig",
                                                   "signature", []))
                                                ]));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyProduct (
                                                  (Env.TySimple ("image", 
                                                     [])),
                                                  (Env.TySimple ("signature",
                                                     []))
                                                  ))
                                                ]));
                                          (("ver_key_server", 0),
                                           (Env.SecurityTypeDef ("verkey",
                                              [(Env.TySimple ("image", []))]
                                              )));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("symkey_client_ta", 0),
                                           (Env.SecurityTypeDef ("symkey",
                                              [(Env.TySimple ("cipher",
                                                  [(Env.TySecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ))
                                                ]
                                              )));
                                          (("sigkey_client_ta", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              )));
                                          (("client_ta_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_img", 0),
                                           (Env.SecurityTypeDef ("image", 
                                              [])));
                                          (("client_ta_t", 0),
                                           Env.ProcTypeDef);
                                          (("client_t", 0), Env.ProcTypeDef);
                                          (("server_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("cipher", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("hash", 0),
                                           (Env.SimpleTypeDef []));
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("symkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("list", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("filedescr", 0),
                                           (Env.SimpleTypeDef []));
                                          (("image", 0),
                                           (Env.SimpleTypeDef []));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("False",
                                               (Env.Global, (Some 0)));
                                               ("ImgRecvInvalid",
                                                (Env.Global, (Some 1)));
                                               ("ImgRecvValid",
                                                (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "store";
                                      args =
                                      [{ desc = Typed.Ident {id = ("v", 12);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 12));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("v", 12),
                                            (Env.Var (Syntax.Meta 12)));
                                            (("c", 11),
                                             (Env.Var (Syntax.Loc 11)));
                                            (("send", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("c", 9); ("v", 10)],
                                                   [(Env.FParamChannel
                                                       [(Env.FParamPoly "'a")
                                                         ]);
                                                     (Env.FParamPoly "'a");
                                                     (Env.FParamSimple (
                                                        "unit", []))
                                                     ]
                                                   ))));
                                            (("verify", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "signature", []));
                                                     (Env.FParamSimple (
                                                        "image", []));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "bool", []))
                                                     ])));
                                            (("true", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "bool", []))
                                                     ])));
                                            (("snd", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'b")])));
                                            (("fst", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'a")])));
                                            (("sign", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "client_img", "image",
                                                       []));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "client_ta_sig",
                                                        "signature", 
                                                        []))
                                                     ])));
                                            (("sdec", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("senc", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "cipher",
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ))
                                                          ]
                                                        ))
                                                     ])));
                                            (("vk", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("rpc_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TyProduct (
                                                       (Env.TySimple (
                                                          "string", [])),
                                                       (Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                       )),
                                                    (Env.TySimple ("string",
                                                       []))
                                                    ));
                                                  (Env.TySecurity (
                                                     "client_ta_sig",
                                                     "signature", []))
                                                  ]));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TySimple ("image",
                                                       [])),
                                                    (Env.TySimple (
                                                       "signature", []))
                                                    ))
                                                  ]));
                                            (("ver_key_server", 0),
                                             (Env.SecurityTypeDef ("verkey",
                                                [(Env.TySimple ("image", []))
                                                  ]
                                                )));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("symkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("symkey",
                                                [(Env.TySimple ("cipher",
                                                    [(Env.TySecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                      ]
                                                    ))
                                                  ]
                                                )));
                                            (("sigkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                )));
                                            (("client_ta_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_img", 0),
                                             (Env.SecurityTypeDef ("image",
                                                [])));
                                            (("client_ta_t", 0),
                                             Env.ProcTypeDef);
                                            (("client_t", 0), Env.ProcTypeDef);
                                            (("server_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("cipher", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("hash", 0),
                                             (Env.SimpleTypeDef []));
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("symkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("list", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("filedescr", 0),
                                             (Env.SimpleTypeDef []));
                                            (("image", 0),
                                             (Env.SimpleTypeDef []));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("False",
                                                 (Env.Global, (Some 0)));
                                                 ("ImgRecvInvalid",
                                                  (Env.Global, (Some 1)));
                                                 ("ImgRecvValid",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]}; env = { Env.vars =
                                                    [(("v", 12),
                                                      (Env.Var
                                                         (Syntax.Meta 12)));
                                                      (("c", 11),
                                                       (Env.Var
                                                          (Syntax.Loc 11)));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                            ];
                          cmd =
                          { desc = (Typed.Return
                                      { desc = Typed.Ident {id = ("v", 12);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 12));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 12),
                                          (Env.Var (Syntax.Meta 12)));
                                          (("c", 11),
                                           (Env.Var (Syntax.Loc 11)));
                                          (("send", 0),
                                           (Env.ExtSyscall
                                              (Env.DesSMFunTyped (
                                                 [("c", 9); ("v", 10)],
                                                 [(Env.FParamChannel
                                                     [(Env.FParamPoly "'a")]);
                                                   (Env.FParamPoly "'a");
                                                   (Env.FParamSimple ("unit",
                                                      []))
                                                   ]
                                                 ))));
                                          (("verify", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple (
                                                     "signature", []));
                                                   (Env.FParamSimple (
                                                      "image", []));
                                                   (Env.FParamSecurity (
                                                      "ver_key_server",
                                                      "verkey",
                                                      [(Env.TySimple (
                                                          "image", []))
                                                        ]
                                                      ));
                                                   (Env.FParamSimple ("bool",
                                                      []))
                                                   ])));
                                          (("true", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple ("bool",
                                                     []))
                                                   ])));
                                          (("snd", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamProduct (
                                                     (Env.FParamPoly "'a"),
                                                     (Env.FParamPoly "'b")));
                                                   (Env.FParamPoly "'b")])));
                                          (("fst", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamProduct (
                                                     (Env.FParamPoly "'a"),
                                                     (Env.FParamPoly "'b")));
                                                   (Env.FParamPoly "'a")])));
                                          (("sign", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "client_img", "image",
                                                     []));
                                                   (Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                   (Env.FParamSecurity (
                                                      "client_ta_sig",
                                                      "signature", []))
                                                   ])));
                                          (("sdec", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple (
                                                     "cipher",
                                                     [(Env.FParamSecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "symkey_client_ta",
                                                      "symkey",
                                                      [(Env.TySimple (
                                                          "cipher",
                                                          [(Env.TySecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                   (Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                   ])));
                                          (("senc", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "symkey_client_ta",
                                                      "symkey",
                                                      [(Env.TySimple (
                                                          "cipher",
                                                          [(Env.TySecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                   (Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                   ])));
                                          (("vk", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "ver_key_server",
                                                      "verkey",
                                                      [(Env.TySimple (
                                                          "image", []))
                                                        ]
                                                      ))
                                                   ])));
                                          (("rpc_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyProduct (
                                                  (Env.TyProduct (
                                                     (Env.TySimple ("string",
                                                        [])),
                                                     (Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                     )),
                                                  (Env.TySimple ("string", 
                                                     []))
                                                  ));
                                                (Env.TySecurity (
                                                   "client_ta_sig",
                                                   "signature", []))
                                                ]));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyProduct (
                                                  (Env.TySimple ("image", 
                                                     [])),
                                                  (Env.TySimple ("signature",
                                                     []))
                                                  ))
                                                ]));
                                          (("ver_key_server", 0),
                                           (Env.SecurityTypeDef ("verkey",
                                              [(Env.TySimple ("image", []))]
                                              )));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("symkey_client_ta", 0),
                                           (Env.SecurityTypeDef ("symkey",
                                              [(Env.TySimple ("cipher",
                                                  [(Env.TySecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ))
                                                ]
                                              )));
                                          (("sigkey_client_ta", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              )));
                                          (("client_ta_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_img", 0),
                                           (Env.SecurityTypeDef ("image", 
                                              [])));
                                          (("client_ta_t", 0),
                                           Env.ProcTypeDef);
                                          (("client_t", 0), Env.ProcTypeDef);
                                          (("server_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("cipher", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("hash", 0),
                                           (Env.SimpleTypeDef []));
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("symkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("list", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("filedescr", 0),
                                           (Env.SimpleTypeDef []));
                                          (("image", 0),
                                           (Env.SimpleTypeDef []));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("False",
                                               (Env.Global, (Some 0)));
                                               ("ImgRecvInvalid",
                                                (Env.Global, (Some 1)));
                                               ("ImgRecvValid",
                                                (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }); env = { Env.vars =
                                                      [(("v", 12),
                                                        (Env.Var
                                                           (Syntax.Meta 12)));
                                                        (("c", 11),
                                                         (Env.Var
                                                            (Syntax.Loc 11)));
                                                        (("send", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 9);
                                                                 ("v", 10)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamPoly
                                                                    "'a");
                                                                 (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                 ]
                                                               ))));
                                                        (("verify", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "signature",
                                                                   []));
                                                                 (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                 (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                 (Env.FParamSimple (
                                                                    "bool",
                                                                    []))
                                                                 ])));
                                                        (("true", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "bool", 
                                                                   []))
                                                                 ])));
                                                        (("snd", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamProduct (
                                                                   (Env.FParamPoly
                                                                    "'a"),
                                                                   (Env.FParamPoly
                                                                    "'b")
                                                                   ));
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ])));
                                                        (("fst", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamProduct (
                                                                   (Env.FParamPoly
                                                                    "'a"),
                                                                   (Env.FParamPoly
                                                                    "'b")
                                                                   ));
                                                                 (Env.FParamPoly
                                                                    "'a")
                                                                 ])));
                                                        (("sign", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []));
                                                                 (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                 (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))
                                                                 ])));
                                                        (("sdec", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "cipher",
                                                                   [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                 (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                 ])));
                                                        (("senc", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                 (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                 ])));
                                                        (("vk", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))
                                                                 ])));
                                                        (("rpc_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyProduct (
                                                                (Env.TyProduct (
                                                                   (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                   (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   )),
                                                                (Env.TySimple (
                                                                   "string",
                                                                   []))
                                                                ));
                                                              (Env.TySecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ]));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "image",
                                                                   [])),
                                                                (Env.TySimple (
                                                                   "signature",
                                                                   []))
                                                                ))
                                                              ]));
                                                        (("ver_key_server", 0),
                                                         (Env.SecurityTypeDef (
                                                            "verkey",
                                                            [(Env.TySimple (
                                                                "image", 
                                                                []))
                                                              ]
                                                            )));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("symkey_client_ta",
                                                          0),
                                                         (Env.SecurityTypeDef (
                                                            "symkey",
                                                            [(Env.TySimple (
                                                                "cipher",
                                                                [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ))
                                                              ]
                                                            )));
                                                        (("sigkey_client_ta",
                                                          0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            )));
                                                        (("client_ta_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_img", 0),
                                                         (Env.SecurityTypeDef (
                                                            "image", 
                                                            [])));
                                                        (("client_ta_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("client_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("server_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("cipher", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("hash", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("symkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("list", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("filedescr", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("image", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("False",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("ImgRecvInvalid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ImgRecvValid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 11), (Env.Var (Syntax.Loc 11)));
                                       (("send", 0),
                                        (Env.ExtSyscall
                                           (Env.DesSMFunTyped (
                                              [("c", 9); ("v", 10)],
                                              [(Env.FParamChannel
                                                  [(Env.FParamPoly "'a")]);
                                                (Env.FParamPoly "'a");
                                                (Env.FParamSimple ("unit", 
                                                   []))
                                                ]
                                              ))));
                                       (("verify", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple (
                                                  "signature", []));
                                                (Env.FParamSimple ("image",
                                                   []));
                                                (Env.FParamSecurity (
                                                   "ver_key_server",
                                                   "verkey",
                                                   [(Env.TySimple ("image",
                                                       []))
                                                     ]
                                                   ));
                                                (Env.FParamSimple ("bool", 
                                                   []))
                                                ])));
                                       (("true", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple ("bool", 
                                                  []))
                                                ])));
                                       (("snd", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamProduct (
                                                  (Env.FParamPoly "'a"),
                                                  (Env.FParamPoly "'b")));
                                                (Env.FParamPoly "'b")])));
                                       (("fst", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamProduct (
                                                  (Env.FParamPoly "'a"),
                                                  (Env.FParamPoly "'b")));
                                                (Env.FParamPoly "'a")])));
                                       (("sign", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "client_img", "image", 
                                                  []));
                                                (Env.FParamSecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ));
                                                (Env.FParamSecurity (
                                                   "client_ta_sig",
                                                   "signature", []))
                                                ])));
                                       (("sdec", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple ("cipher",
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "symkey_client_ta",
                                                   "symkey",
                                                   [(Env.TySimple ("cipher",
                                                       [(Env.TySecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                     ]
                                                   ));
                                                (Env.FParamSecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ))
                                                ])));
                                       (("senc", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "symkey_client_ta",
                                                   "symkey",
                                                   [(Env.TySimple ("cipher",
                                                       [(Env.TySecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                     ]
                                                   ));
                                                (Env.FParamSimple ("cipher",
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                ])));
                                       (("vk", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "ver_key_server",
                                                   "verkey",
                                                   [(Env.TySimple ("image",
                                                       []))
                                                     ]
                                                   ))
                                                ])));
                                       (("rpc_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyProduct (
                                               (Env.TyProduct (
                                                  (Env.TySimple ("string", 
                                                     [])),
                                                  (Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                  )),
                                               (Env.TySimple ("string", []))
                                               ));
                                             (Env.TySecurity (
                                                "client_ta_sig", "signature",
                                                []))
                                             ]));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyProduct (
                                               (Env.TySimple ("image", [])),
                                               (Env.TySimple ("signature", 
                                                  []))
                                               ))
                                             ]));
                                       (("ver_key_server", 0),
                                        (Env.SecurityTypeDef ("verkey",
                                           [(Env.TySimple ("image", []))])));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("symkey_client_ta", 0),
                                        (Env.SecurityTypeDef ("symkey",
                                           [(Env.TySimple ("cipher",
                                               [(Env.TySecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ))
                                                 ]
                                               ))
                                             ]
                                           )));
                                       (("sigkey_client_ta", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TySecurity ("client_img",
                                               "image", []))
                                             ]
                                           )));
                                       (("client_ta_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_img", 0),
                                        (Env.SecurityTypeDef ("image", [])));
                                       (("client_ta_t", 0), Env.ProcTypeDef);
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("server_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("cipher", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("hash", 0), (Env.SimpleTypeDef []));
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("symkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("list", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("filedescr", 0),
                                        (Env.SimpleTypeDef []));
                                       (("image", 0), (Env.SimpleTypeDef []));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []))];
                                     facts =
                                     ref ([("False", (Env.Global, (Some 0)));
                                            ("ImgRecvInvalid",
                                             (Env.Global, (Some 1)));
                                            ("ImgRecvValid",
                                             (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("send", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("c", 9);
                                                             ("v", 10)],
                                                           [(Env.FParamChannel
                                                               [(Env.FParamPoly
                                                                   "'a")
                                                                 ]);
                                                             (Env.FParamPoly
                                                                "'a");
                                                             (Env.FParamSimple (
                                                                "unit", 
                                                                []))
                                                             ]
                                                           ))));
                                                     (("verify", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "signature",
                                                                []));
                                                              (Env.FParamSimple (
                                                                 "image", 
                                                                 []));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                              ])));
                                                     (("true", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                              ])));
                                                     (("snd", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ])));
                                                     (("fst", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ])));
                                                     (("sign", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "client_img",
                                                                "image", 
                                                                []));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ])));
                                                     (("sdec", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("senc", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("vk", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "string",
                                                                   [])),
                                                                (Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                )),
                                                             (Env.TySimple (
                                                                "string", 
                                                                []))
                                                             ));
                                                           (Env.TySecurity (
                                                              "client_ta_sig",
                                                              "signature", 
                                                              []))
                                                           ]));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TySimple (
                                                                "image", 
                                                                [])),
                                                             (Env.TySimple (
                                                                "signature",
                                                                []))
                                                             ))
                                                           ]));
                                                     (("ver_key_server", 0),
                                                      (Env.SecurityTypeDef (
                                                         "verkey",
                                                         [(Env.TySimple (
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("symkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "symkey",
                                                         [(Env.TySimple (
                                                             "cipher",
                                                             [(Env.TySecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                           ]
                                                         )));
                                                     (("sigkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("client_ta_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_img", 0),
                                                      (Env.SecurityTypeDef (
                                                         "image", [])));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("cipher", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("hash", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("symkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("list", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("filedescr", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("image", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("connect_rpc", 0);
           fun_sig =
           (Env.DesSMFunTyped ([("c", 13)],
              [(Env.FParamChannel [(Env.FParamPoly "'a")]);
                (Env.FParamSecurity ("conn_client", "connection", []))]
              ));
           cmd =
           { desc = (Typed.Sequence (
                       { desc = (Typed.Put
                                   [{ desc = Typed.Channel {
                                               channel =
                                               { desc = Typed.Ident {
                                                          id = ("c", 13);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 13));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 13),
                                                   (Env.Var (Syntax.Loc 13)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 11)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ]
                                                          ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                                               name = "req"; args = []}; env = 
                                     { Env.vars =
                                       [(("c", 13), (Env.Var (Syntax.Loc 13)));
                                         (("recv", 0),
                                          (Env.ExtSyscall
                                             (Env.DesSMFunTyped ([("c", 11)],
                                                [(Env.FParamChannel
                                                    [(Env.FParamPoly "'a")]);
                                                  (Env.FParamPoly "'a")]
                                                ))));
                                         (("send", 0),
                                          (Env.ExtSyscall
                                             (Env.DesSMFunTyped (
                                                [("c", 9); ("v", 10)],
                                                [(Env.FParamChannel
                                                    [(Env.FParamPoly "'a")]);
                                                  (Env.FParamPoly "'a");
                                                  (Env.FParamSimple ("unit",
                                                     []))
                                                  ]
                                                ))));
                                         (("verify", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamSimple (
                                                    "signature", []));
                                                  (Env.FParamSimple ("image",
                                                     []));
                                                  (Env.FParamSecurity (
                                                     "ver_key_server",
                                                     "verkey",
                                                     [(Env.TySimple ("image",
                                                         []))
                                                       ]
                                                     ));
                                                  (Env.FParamSimple ("bool",
                                                     []))
                                                  ])));
                                         (("true", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamSimple ("bool",
                                                    []))
                                                  ])));
                                         (("snd", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamProduct (
                                                    (Env.FParamPoly "'a"),
                                                    (Env.FParamPoly "'b")));
                                                  (Env.FParamPoly "'b")])));
                                         (("fst", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamProduct (
                                                    (Env.FParamPoly "'a"),
                                                    (Env.FParamPoly "'b")));
                                                  (Env.FParamPoly "'a")])));
                                         (("sign", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamSecurity (
                                                    "client_img", "image", 
                                                    []));
                                                  (Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ));
                                                  (Env.FParamSecurity (
                                                     "client_ta_sig",
                                                     "signature", []))
                                                  ])));
                                         (("sdec", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamSimple ("cipher",
                                                    [(Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                      ]
                                                    ));
                                                  (Env.FParamSecurity (
                                                     "symkey_client_ta",
                                                     "symkey",
                                                     [(Env.TySimple (
                                                         "cipher",
                                                         [(Env.TySecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                           ]
                                                         ))
                                                       ]
                                                     ));
                                                  (Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                  ])));
                                         (("senc", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamSecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ));
                                                  (Env.FParamSecurity (
                                                     "symkey_client_ta",
                                                     "symkey",
                                                     [(Env.TySimple (
                                                         "cipher",
                                                         [(Env.TySecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                           ]
                                                         ))
                                                       ]
                                                     ));
                                                  (Env.FParamSimple (
                                                     "cipher",
                                                     [(Env.FParamSecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                  ])));
                                         (("vk", 0),
                                          (Env.ExtFun
                                             (Env.DesugaredTypeSig
                                                [(Env.FParamSecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ));
                                                  (Env.FParamSecurity (
                                                     "ver_key_server",
                                                     "verkey",
                                                     [(Env.TySimple ("image",
                                                         []))
                                                       ]
                                                     ))
                                                  ])));
                                         (("rpc_t", 0),
                                          (Env.ChanTypeDef
                                             [(Env.TyProduct (
                                                 (Env.TyProduct (
                                                    (Env.TySimple ("string",
                                                       [])),
                                                    (Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                    )),
                                                 (Env.TySimple ("string", 
                                                    []))
                                                 ));
                                               (Env.TySecurity (
                                                  "client_ta_sig",
                                                  "signature", []))
                                               ]));
                                         (("udp_t", 0),
                                          (Env.ChanTypeDef
                                             [(Env.TyProduct (
                                                 (Env.TySimple ("image", [])),
                                                 (Env.TySimple ("signature",
                                                    []))
                                                 ))
                                               ]));
                                         (("ver_key_server", 0),
                                          (Env.SecurityTypeDef ("verkey",
                                             [(Env.TySimple ("image", []))])));
                                         (("conn_client", 0),
                                          (Env.SecurityTypeDef ("connection",
                                             [])));
                                         (("symkey_client_ta", 0),
                                          (Env.SecurityTypeDef ("symkey",
                                             [(Env.TySimple ("cipher",
                                                 [(Env.TySecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ))
                                               ]
                                             )));
                                         (("sigkey_client_ta", 0),
                                          (Env.SecurityTypeDef ("sigkey",
                                             [(Env.TySecurity ("client_img",
                                                 "image", []))
                                               ]
                                             )));
                                         (("client_ta_sig", 0),
                                          (Env.SecurityTypeDef ("signature",
                                             [])));
                                         (("client_img", 0),
                                          (Env.SecurityTypeDef ("image", [])));
                                         (("client_ta_t", 0), Env.ProcTypeDef);
                                         (("client_t", 0), Env.ProcTypeDef);
                                         (("server_t", 0), Env.ProcTypeDef);
                                         (("readonly_t", 0),
                                          Env.FilesysTypeDef);
                                         (("cipher", 0),
                                          (Env.SimpleTypeDef ["'a"]));
                                         (("hash", 0), (Env.SimpleTypeDef []));
                                         (("verkey", 0),
                                          (Env.SimpleTypeDef ["'a"]));
                                         (("sigkey", 0),
                                          (Env.SimpleTypeDef ["'a"]));
                                         (("symkey", 0),
                                          (Env.SimpleTypeDef ["'a"]));
                                         (("list", 0),
                                          (Env.SimpleTypeDef ["'a"]));
                                         (("filedescr", 0),
                                          (Env.SimpleTypeDef []));
                                         (("image", 0),
                                          (Env.SimpleTypeDef []));
                                         (("signature", 0),
                                          (Env.SimpleTypeDef []));
                                         (("connection", 0),
                                          (Env.SimpleTypeDef []));
                                         (("string", 0),
                                          (Env.SimpleTypeDef []));
                                         (("bool", 0), (Env.SimpleTypeDef []));
                                         (("unit", 0), (Env.SimpleTypeDef []))
                                         ];
                                       facts =
                                       ref ([("False", (Env.Global, (Some 0)));
                                              ("ImgRecvInvalid",
                                               (Env.Global, (Some 1)));
                                              ("ImgRecvValid",
                                               (Env.Global, (Some 1)));
                                              ("exit",
                                               (Env.Channel, (Some 0)));
                                              ("Returned",
                                               (Env.Channel, (Some 1)));
                                              ("invoke",
                                               (Env.Channel, (Some 3)));
                                              ("conn",
                                               (Env.Channel, (Some 0)));
                                              ("chid",
                                               (Env.Structure, (Some 1)));
                                              ("ack", (Env.Channel, (Some 0)));
                                              ("req", (Env.Channel, (Some 0)));
                                              ("store",
                                               (Env.Channel, (Some 1)))
                                              ])
                                       } }
                                     ]); env = { Env.vars =
                                                 [(("c", 13),
                                                   (Env.Var (Syntax.Loc 13)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 11)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ]
                                                          ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                       { desc = (Typed.Case
                                   [{ Typed.fresh = [];
                                      facts =
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 13);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   13));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 13),
                                                      (Env.Var
                                                         (Syntax.Loc 13)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 11)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ]
                                                             ))));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 13),
                                            (Env.Var (Syntax.Loc 13)));
                                            (("recv", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("c", 11)],
                                                   [(Env.FParamChannel
                                                       [(Env.FParamPoly "'a")
                                                         ]);
                                                     (Env.FParamPoly "'a")]
                                                   ))));
                                            (("send", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("c", 9); ("v", 10)],
                                                   [(Env.FParamChannel
                                                       [(Env.FParamPoly "'a")
                                                         ]);
                                                     (Env.FParamPoly "'a");
                                                     (Env.FParamSimple (
                                                        "unit", []))
                                                     ]
                                                   ))));
                                            (("verify", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "signature", []));
                                                     (Env.FParamSimple (
                                                        "image", []));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "bool", []))
                                                     ])));
                                            (("true", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "bool", []))
                                                     ])));
                                            (("snd", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'b")])));
                                            (("fst", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'a")])));
                                            (("sign", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "client_img", "image",
                                                       []));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "client_ta_sig",
                                                        "signature", 
                                                        []))
                                                     ])));
                                            (("sdec", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("senc", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "cipher",
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ))
                                                          ]
                                                        ))
                                                     ])));
                                            (("vk", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("rpc_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TyProduct (
                                                       (Env.TySimple (
                                                          "string", [])),
                                                       (Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                       )),
                                                    (Env.TySimple ("string",
                                                       []))
                                                    ));
                                                  (Env.TySecurity (
                                                     "client_ta_sig",
                                                     "signature", []))
                                                  ]));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TySimple ("image",
                                                       [])),
                                                    (Env.TySimple (
                                                       "signature", []))
                                                    ))
                                                  ]));
                                            (("ver_key_server", 0),
                                             (Env.SecurityTypeDef ("verkey",
                                                [(Env.TySimple ("image", []))
                                                  ]
                                                )));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("symkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("symkey",
                                                [(Env.TySimple ("cipher",
                                                    [(Env.TySecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                      ]
                                                    ))
                                                  ]
                                                )));
                                            (("sigkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                )));
                                            (("client_ta_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_img", 0),
                                             (Env.SecurityTypeDef ("image",
                                                [])));
                                            (("client_ta_t", 0),
                                             Env.ProcTypeDef);
                                            (("client_t", 0), Env.ProcTypeDef);
                                            (("server_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("cipher", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("hash", 0),
                                             (Env.SimpleTypeDef []));
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("symkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("list", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("filedescr", 0),
                                             (Env.SimpleTypeDef []));
                                            (("image", 0),
                                             (Env.SimpleTypeDef []));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("False",
                                                 (Env.Global, (Some 0)));
                                                 ("ImgRecvInvalid",
                                                  (Env.Global, (Some 1)));
                                                 ("ImgRecvValid",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ];
                                      cmd =
                                      { desc = (Typed.New (("x", 14), None,
                                                  (Some ("chid",
                                                         [{ desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 13);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    13));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 13),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    13)));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                               (("verify", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("true", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("snd", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                               (("fst", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                               (("sign", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                               (("sdec", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                               (("senc", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                               (("vk", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                               (("ver_key_server",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "verkey",
                                                                   [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("symkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "symkey",
                                                                   [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                   )));
                                                               (("sigkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("client_ta_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_img",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "image",
                                                                   [])));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("cipher", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("hash", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("symkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("list", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("filedescr",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("image", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                                           ])),
                                                  { desc = (Typed.Sequence (
                                                              { desc = (
                                                              Typed.Put
                                                                [{ desc = 
                                                                  Typed.Channel {
                                                                    channel =
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 13);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    13));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "x", 14),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                    ((
                                                                    "c", 13),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    name =
                                                                    "conn";
                                                                    args = []}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "x", 14),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                    ((
                                                                    "c", 13),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  ]); env = 
                                                              { Env.vars =
                                                                [(("x", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("c", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("true", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                  (("sdec", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                  (("senc", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                  (("ver_key_server",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("symkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("sigkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                  (("client_ta_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_img",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("cipher",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("hash", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("symkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("list", 0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("filedescr",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("image",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } },
                                                              { desc = (
                                                              Typed.Return
                                                                { desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("x", 14);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "x", 14),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                    (
                                                                    (
                                                                    "c", 13),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "sdec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "senc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    (
                                                                    (
                                                                    "ver_key_server",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_img",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "cipher",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "hash", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "symkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "list", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "filedescr",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }); env = 
                                                              { Env.vars =
                                                                [(("x", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("c", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("true", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                  (("sdec", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                  (("senc", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                  (("ver_key_server",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("symkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("sigkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                  (("client_ta_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_img",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("cipher",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("hash", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("symkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("list", 0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("filedescr",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("image",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              )); env = 
                                                  { Env.vars =
                                                    [(("x", 14),
                                                      (Env.Var
                                                         (Syntax.Loc 14)));
                                                      (("c", 13),
                                                       (Env.Var
                                                          (Syntax.Loc 13)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 11)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ]
                                                             ))));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  )); env = { Env.vars =
                                                              [(("c", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                                (("recv", 0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                (("send", 0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                (("verify", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                (("true", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                (("snd", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                (("fst", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                (("sign", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                (("sdec", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                (("senc", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                (("vk", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                (("rpc_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                (("udp_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                (("ver_key_server",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                (("conn_client",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                (("symkey_client_ta",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                (("sigkey_client_ta",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                (("client_ta_sig",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                (("client_img",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                (("client_ta_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("client_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("server_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("readonly_t",
                                                                  0),
                                                                 Env.FilesysTypeDef);
                                                                (("cipher", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("hash", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("verkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("sigkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("symkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("list", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("filedescr",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("image", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("signature",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("connection",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("string", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("bool", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("unit", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []))
                                                                ];
                                                              facts =
                                                              ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } }
                                      }
                                     ]); env = { Env.vars =
                                                 [(("c", 13),
                                                   (Env.Var (Syntax.Loc 13)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 11)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ]
                                                          ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                       )); env = { Env.vars =
                                   [(("c", 13), (Env.Var (Syntax.Loc 13)));
                                     (("recv", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 11)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a")]
                                            ))));
                                     (("send", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped (
                                            [("c", 9); ("v", 10)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a");
                                              (Env.FParamSimple ("unit", []))
                                              ]
                                            ))));
                                     (("verify", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("signature",
                                                []));
                                              (Env.FParamSimple ("image", 
                                                 []));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("bool", []))
                                              ])));
                                     (("true", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("bool", []))])));
                                     (("snd", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'b")])));
                                     (("fst", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'a")])));
                                     (("sign", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "client_img", "image", 
                                                []));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "client_ta_sig",
                                                 "signature", []))
                                              ])));
                                     (("sdec", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("cipher",
                                                [(Env.FParamSecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("senc", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ))
                                              ])));
                                     (("vk", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("rpc_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TyProduct (
                                                (Env.TySimple ("string", [])),
                                                (Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                )),
                                             (Env.TySimple ("string", []))));
                                           (Env.TySecurity ("client_ta_sig",
                                              "signature", []))
                                           ]));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TySimple ("image", [])),
                                             (Env.TySimple ("signature", []))
                                             ))
                                           ]));
                                     (("ver_key_server", 0),
                                      (Env.SecurityTypeDef ("verkey",
                                         [(Env.TySimple ("image", []))])));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("symkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("symkey",
                                         [(Env.TySimple ("cipher",
                                             [(Env.TySecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                               ]
                                             ))
                                           ]
                                         )));
                                     (("sigkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         )));
                                     (("client_ta_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_img", 0),
                                      (Env.SecurityTypeDef ("image", [])));
                                     (("client_ta_t", 0), Env.ProcTypeDef);
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("server_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("cipher", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("hash", 0), (Env.SimpleTypeDef []));
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("symkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("list", 0), (Env.SimpleTypeDef ["'a"]));
                                     (("filedescr", 0),
                                      (Env.SimpleTypeDef []));
                                     (("image", 0), (Env.SimpleTypeDef []));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("False", (Env.Global, (Some 0)));
                                          ("ImgRecvInvalid",
                                           (Env.Global, (Some 1)));
                                          ("ImgRecvValid",
                                           (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("recv", 0),
                                                   (Env.ExtSyscall
                                                      (Env.DesSMFunTyped (
                                                         [("c", 11)],
                                                         [(Env.FParamChannel
                                                             [(Env.FParamPoly
                                                                 "'a")
                                                               ]);
                                                           (Env.FParamPoly
                                                              "'a")
                                                           ]
                                                         ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("invoke_rpc", 0);
           fun_sig =
           (Env.DesSMFunTyped (
              [("cid", 15); ("f", 16); ("arg1", 17); ("arg2", 18)],
              [(Env.FParamSecurity ("conn_client", "connection", []));
                (Env.FParamSimple ("string", [])); (Env.FParamPoly "'a");
                (Env.FParamPoly "'b"); (Env.FParamPoly "'c")]
              ));
           cmd =
           { desc = (Typed.Get ([("c", 19)],
                       { desc = Typed.Ident {id = ("cid", 15);
                                  desc = (Env.Var (Syntax.Loc 15));
                                  param = None}; env = { Env.vars =
                                                         [(("arg2", 18),
                                                           (Env.Var
                                                              (Syntax.Loc 18)));
                                                           (("arg1", 17),
                                                            (Env.Var
                                                               (Syntax.Loc 17)));
                                                           (("f", 16),
                                                            (Env.Var
                                                               (Syntax.Loc 16)));
                                                           (("cid", 15),
                                                            (Env.Var
                                                               (Syntax.Loc 15)));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall
                                                               (Env.DesSMFunTyped (
                                                                  [("c", 13)],
                                                                  [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]
                                                                  ))));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall
                                                               (Env.DesSMFunTyped (
                                                                  [("c", 11)],
                                                                  [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a")]
                                                                  ))));
                                                           (("send", 0),
                                                            (Env.ExtSyscall
                                                               (Env.DesSMFunTyped (
                                                                  [("c", 9);
                                                                    (
                                                                    "v", 10)],
                                                                  [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a");
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "unit",
                                                                    []))]
                                                                  ))));
                                                           (("verify", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                           (("true", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                           (("snd", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'b")])));
                                                           (("fst", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a")])));
                                                           (("sign", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                           (("sdec", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                           (("senc", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                           (("vk", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                           (("rpc_t", 0),
                                                            (Env.ChanTypeDef
                                                               [(Env.TyProduct (
                                                                   (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                   (Env.TySimple (
                                                                    "string",
                                                                    []))
                                                                   ));
                                                                 (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))
                                                                 ]));
                                                           (("udp_t", 0),
                                                            (Env.ChanTypeDef
                                                               [(Env.TyProduct (
                                                                   (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                   (Env.TySimple (
                                                                    "signature",
                                                                    []))
                                                                   ))
                                                                 ]));
                                                           (("ver_key_server",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               )));
                                                           (("conn_client", 0),
                                                            (Env.SecurityTypeDef (
                                                               "connection",
                                                               [])));
                                                           (("symkey_client_ta",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               )));
                                                           (("sigkey_client_ta",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               )));
                                                           (("client_ta_sig",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "signature",
                                                               [])));
                                                           (("client_img", 0),
                                                            (Env.SecurityTypeDef (
                                                               "image", 
                                                               [])));
                                                           (("client_ta_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("client_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("server_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("readonly_t", 0),
                                                            Env.FilesysTypeDef);
                                                           (("cipher", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("hash", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("verkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("sigkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("symkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("list", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("filedescr", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("image", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("signature", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("connection", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("string", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("bool", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("unit", 0),
                                                            (Env.SimpleTypeDef
                                                               []))
                                                           ];
                                                         facts =
                                                         ref ([("False",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("ImgRecvInvalid",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("ImgRecvValid",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 19);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    19));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 19),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    19)));
                                                               (("arg2", 18),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    18)));
                                                               (("arg1", 17),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    17)));
                                                               (("f", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("cid", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                               (("verify", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("true", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("snd", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                               (("fst", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                               (("sign", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                               (("sdec", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                               (("senc", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                               (("vk", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                               (("ver_key_server",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "verkey",
                                                                   [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("symkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "symkey",
                                                                   [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                   )));
                                                               (("sigkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("client_ta_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_img",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "image",
                                                                   [])));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("cipher", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("hash", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("symkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("list", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("filedescr",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("image", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "invoke";
                                                           args =
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id = ("f", 16);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    16));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 19),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    19)));
                                                                 (("arg2", 18),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    18)));
                                                                 (("arg1", 17),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                 (("f", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("cid", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                 (("true", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                 (("sdec", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                 (("senc", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                 (("rpc_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                 (("ver_key_server",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("symkey_client_ta",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                 (("sigkey_client_ta",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                 (("client_ta_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_img",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                 (("client_ta_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("server_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("cipher",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("hash", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("symkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("list", 0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("filedescr",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("image", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg1", 17);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 19),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    19)));
                                                                 (("arg2", 18),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    18)));
                                                                 (("arg1", 17),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                 (("f", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("cid", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                 (("true", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                 (("sdec", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                 (("senc", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                 (("rpc_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                 (("ver_key_server",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("symkey_client_ta",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                 (("sigkey_client_ta",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                 (("client_ta_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_img",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                 (("client_ta_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("server_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("cipher",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("hash", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("symkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("list", 0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("filedescr",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("image", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg2", 18);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    18));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 19),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    19)));
                                                                 (("arg2", 18),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    18)));
                                                                 (("arg1", 17),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                 (("f", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("cid", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                 (("true", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                 (("sdec", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                 (("senc", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                 (("vk", 0),
                                                                  (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                 (("rpc_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                 (("ver_key_server",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                 (("conn_client",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                 (("symkey_client_ta",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                 (("sigkey_client_ta",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                 (("client_ta_sig",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                 (("client_img",
                                                                   0),
                                                                  (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                 (("client_ta_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("server_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("cipher",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("hash", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("verkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("sigkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("symkey",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("list", 0),
                                                                  (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                 (("filedescr",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("image", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("signature",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("connection",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("string",
                                                                   0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("bool", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []));
                                                                 (("unit", 0),
                                                                  (Env.SimpleTypeDef
                                                                    []))
                                                                 ];
                                                               facts =
                                                               ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]}; env = 
                                                 { Env.vars =
                                                   [(("c", 19),
                                                     (Env.Var (Syntax.Loc 19)));
                                                     (("arg2", 18),
                                                      (Env.Var
                                                         (Syntax.Loc 18)));
                                                     (("arg1", 17),
                                                      (Env.Var
                                                         (Syntax.Loc 17)));
                                                     (("f", 16),
                                                      (Env.Var
                                                         (Syntax.Loc 16)));
                                                     (("cid", 15),
                                                      (Env.Var
                                                         (Syntax.Loc 15)));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 13)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []))
                                                              ]
                                                            ))));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 11)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ]
                                                            ))));
                                                     (("send", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 9);
                                                              ("v", 10)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamPoly
                                                                 "'a");
                                                              (Env.FParamSimple (
                                                                 "unit", 
                                                                 []))
                                                              ]
                                                            ))));
                                                     (("verify", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "signature",
                                                                []));
                                                              (Env.FParamSimple (
                                                                 "image", 
                                                                 []));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                              ])));
                                                     (("true", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                              ])));
                                                     (("snd", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ])));
                                                     (("fst", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ])));
                                                     (("sign", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "client_img",
                                                                "image", 
                                                                []));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ])));
                                                     (("sdec", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("senc", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("vk", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "string",
                                                                   [])),
                                                                (Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                )),
                                                             (Env.TySimple (
                                                                "string", 
                                                                []))
                                                             ));
                                                           (Env.TySecurity (
                                                              "client_ta_sig",
                                                              "signature", 
                                                              []))
                                                           ]));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TySimple (
                                                                "image", 
                                                                [])),
                                                             (Env.TySimple (
                                                                "signature",
                                                                []))
                                                             ))
                                                           ]));
                                                     (("ver_key_server", 0),
                                                      (Env.SecurityTypeDef (
                                                         "verkey",
                                                         [(Env.TySimple (
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("symkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "symkey",
                                                         [(Env.TySimple (
                                                             "cipher",
                                                             [(Env.TySecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                           ]
                                                         )));
                                                     (("sigkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("client_ta_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_img", 0),
                                                      (Env.SecurityTypeDef (
                                                         "image", [])));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("cipher", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("hash", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("symkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("list", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("filedescr", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("image", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 19),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    19)));
                                                               (("arg2", 18),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    18)));
                                                               (("arg1", 17),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    17)));
                                                               (("f", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("cid", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                               (("verify", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("true", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("snd", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                               (("fst", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                               (("sign", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                               (("sdec", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                               (("senc", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                               (("vk", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                               (("ver_key_server",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "verkey",
                                                                   [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("symkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "symkey",
                                                                   [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                   )));
                                                               (("sigkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("client_ta_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_img",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "image",
                                                                   [])));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("cipher", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("hash", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("symkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("list", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("filedescr",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("image", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
                                   { desc = (Typed.Case
                                               [{ Typed.fresh = [("v", 20)];
                                                  facts =
                                                  [{ desc = Typed.Channel {
                                                              channel =
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("c", 19);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    19));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 20),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    20)));
                                                                  (("c", 19),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    19)));
                                                                  (("arg2",
                                                                    18),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    18)));
                                                                  (("arg1",
                                                                    17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("f", 16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("cid", 15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("true", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                  (("sdec", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                  (("senc", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                  (("ver_key_server",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("symkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("sigkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                  (("client_ta_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_img",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("cipher",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("hash", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("symkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("list", 0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("filedescr",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("image",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } };
                                                              name =
                                                              "Returned";
                                                              args =
                                                              [{ desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("v", 20);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    20));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "v", 20),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    20)));
                                                                    (
                                                                    (
                                                                    "c", 19),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    19)));
                                                                    (
                                                                    (
                                                                    "arg2",
                                                                    18),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    18)));
                                                                    (
                                                                    (
                                                                    "arg1",
                                                                    17),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                    (
                                                                    (
                                                                    "f", 16),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                    (
                                                                    (
                                                                    "cid", 15),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "sdec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "senc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    (
                                                                    (
                                                                    "ver_key_server",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_img",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "cipher",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "hash", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "symkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "list", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "filedescr",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ]}; env = 
                                                    { Env.vars =
                                                      [(("v", 20),
                                                        (Env.Var
                                                           (Syntax.Meta 20)));
                                                        (("c", 19),
                                                         (Env.Var
                                                            (Syntax.Loc 19)));
                                                        (("arg2", 18),
                                                         (Env.Var
                                                            (Syntax.Loc 18)));
                                                        (("arg1", 17),
                                                         (Env.Var
                                                            (Syntax.Loc 17)));
                                                        (("f", 16),
                                                         (Env.Var
                                                            (Syntax.Loc 16)));
                                                        (("cid", 15),
                                                         (Env.Var
                                                            (Syntax.Loc 15)));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 13)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))
                                                                 ]
                                                               ))));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 11)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamPoly
                                                                    "'a")
                                                                 ]
                                                               ))));
                                                        (("send", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 9);
                                                                 ("v", 10)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamPoly
                                                                    "'a");
                                                                 (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                 ]
                                                               ))));
                                                        (("verify", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "signature",
                                                                   []));
                                                                 (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                 (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                 (Env.FParamSimple (
                                                                    "bool",
                                                                    []))
                                                                 ])));
                                                        (("true", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "bool", 
                                                                   []))
                                                                 ])));
                                                        (("snd", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamProduct (
                                                                   (Env.FParamPoly
                                                                    "'a"),
                                                                   (Env.FParamPoly
                                                                    "'b")
                                                                   ));
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ])));
                                                        (("fst", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamProduct (
                                                                   (Env.FParamPoly
                                                                    "'a"),
                                                                   (Env.FParamPoly
                                                                    "'b")
                                                                   ));
                                                                 (Env.FParamPoly
                                                                    "'a")
                                                                 ])));
                                                        (("sign", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []));
                                                                 (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                 (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))
                                                                 ])));
                                                        (("sdec", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "cipher",
                                                                   [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                 (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                 ])));
                                                        (("senc", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                 (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                 ])));
                                                        (("vk", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))
                                                                 ])));
                                                        (("rpc_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyProduct (
                                                                (Env.TyProduct (
                                                                   (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                   (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   )),
                                                                (Env.TySimple (
                                                                   "string",
                                                                   []))
                                                                ));
                                                              (Env.TySecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ]));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "image",
                                                                   [])),
                                                                (Env.TySimple (
                                                                   "signature",
                                                                   []))
                                                                ))
                                                              ]));
                                                        (("ver_key_server", 0),
                                                         (Env.SecurityTypeDef (
                                                            "verkey",
                                                            [(Env.TySimple (
                                                                "image", 
                                                                []))
                                                              ]
                                                            )));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("symkey_client_ta",
                                                          0),
                                                         (Env.SecurityTypeDef (
                                                            "symkey",
                                                            [(Env.TySimple (
                                                                "cipher",
                                                                [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ))
                                                              ]
                                                            )));
                                                        (("sigkey_client_ta",
                                                          0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            )));
                                                        (("client_ta_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_img", 0),
                                                         (Env.SecurityTypeDef (
                                                            "image", 
                                                            [])));
                                                        (("client_ta_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("client_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("server_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("cipher", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("hash", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("symkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("list", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("filedescr", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("image", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("False",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("ImgRecvInvalid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ImgRecvValid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ];
                                                  cmd =
                                                  { desc = (Typed.Return
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("v", 20);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Meta
                                                                    20));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 20),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    20)));
                                                                  (("c", 19),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    19)));
                                                                  (("arg2",
                                                                    18),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    18)));
                                                                  (("arg1",
                                                                    17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("f", 16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("cid", 15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("true", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                  (("sdec", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                  (("senc", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("vk", 0),
                                                                   (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                  (("rpc_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                  (("ver_key_server",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                  (("conn_client",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                  (("symkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                  (("sigkey_client_ta",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                  (("client_ta_sig",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                  (("client_img",
                                                                    0),
                                                                   (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                  (("client_ta_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("server_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("cipher",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("hash", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("verkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("sigkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("symkey",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("list", 0),
                                                                   (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                  (("filedescr",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("image",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("signature",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("connection",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("string",
                                                                    0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("bool", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []));
                                                                  (("unit", 0),
                                                                   (Env.SimpleTypeDef
                                                                    []))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("False",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("ImgRecvInvalid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("ImgRecvValid",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }); env = 
                                                  { Env.vars =
                                                    [(("v", 20),
                                                      (Env.Var
                                                         (Syntax.Meta 20)));
                                                      (("c", 19),
                                                       (Env.Var
                                                          (Syntax.Loc 19)));
                                                      (("arg2", 18),
                                                       (Env.Var
                                                          (Syntax.Loc 18)));
                                                      (("arg1", 17),
                                                       (Env.Var
                                                          (Syntax.Loc 17)));
                                                      (("f", 16),
                                                       (Env.Var
                                                          (Syntax.Loc 16)));
                                                      (("cid", 15),
                                                       (Env.Var
                                                          (Syntax.Loc 15)));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 13)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamSecurity (
                                                                  "conn_client",
                                                                  "connection",
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 11)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ]
                                                             ))));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ]); env = { Env.vars =
                                                             [(("c", 19),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    19)));
                                                               (("arg2", 18),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    18)));
                                                               (("arg1", 17),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    17)));
                                                               (("f", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("cid", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                               (("verify", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("true", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("snd", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                               (("fst", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                               (("sign", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                               (("sdec", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                               (("senc", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                               (("vk", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                               (("ver_key_server",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "verkey",
                                                                   [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("symkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "symkey",
                                                                   [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                   )));
                                                               (("sigkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("client_ta_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_img",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "image",
                                                                   [])));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("cipher", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("hash", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("symkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("list", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("filedescr",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("image", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 19),
                                                 (Env.Var (Syntax.Loc 19)));
                                                 (("arg2", 18),
                                                  (Env.Var (Syntax.Loc 18)));
                                                 (("arg1", 17),
                                                  (Env.Var (Syntax.Loc 17)));
                                                 (("f", 16),
                                                  (Env.Var (Syntax.Loc 16)));
                                                 (("cid", 15),
                                                  (Env.Var (Syntax.Loc 15)));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall
                                                     (Env.DesSMFunTyped (
                                                        [("c", 13)],
                                                        [(Env.FParamChannel
                                                            [(Env.FParamPoly
                                                                "'a")
                                                              ]);
                                                          (Env.FParamSecurity (
                                                             "conn_client",
                                                             "connection", 
                                                             []))
                                                          ]
                                                        ))));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall
                                                     (Env.DesSMFunTyped (
                                                        [("c", 11)],
                                                        [(Env.FParamChannel
                                                            [(Env.FParamPoly
                                                                "'a")
                                                              ]);
                                                          (Env.FParamPoly
                                                             "'a")
                                                          ]
                                                        ))));
                                                 (("send", 0),
                                                  (Env.ExtSyscall
                                                     (Env.DesSMFunTyped (
                                                        [("c", 9); ("v", 10)],
                                                        [(Env.FParamChannel
                                                            [(Env.FParamPoly
                                                                "'a")
                                                              ]);
                                                          (Env.FParamPoly
                                                             "'a");
                                                          (Env.FParamSimple (
                                                             "unit", 
                                                             []))
                                                          ]
                                                        ))));
                                                 (("verify", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSimple (
                                                            "signature", 
                                                            []));
                                                          (Env.FParamSimple (
                                                             "image", 
                                                             []));
                                                          (Env.FParamSecurity (
                                                             "ver_key_server",
                                                             "verkey",
                                                             [(Env.TySimple (
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ));
                                                          (Env.FParamSimple (
                                                             "bool", 
                                                             []))
                                                          ])));
                                                 (("true", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSimple (
                                                            "bool", []))
                                                          ])));
                                                 (("snd", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamProduct (
                                                            (Env.FParamPoly
                                                               "'a"),
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ));
                                                          (Env.FParamPoly
                                                             "'b")
                                                          ])));
                                                 (("fst", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamProduct (
                                                            (Env.FParamPoly
                                                               "'a"),
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ));
                                                          (Env.FParamPoly
                                                             "'a")
                                                          ])));
                                                 (("sign", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSecurity (
                                                            "client_img",
                                                            "image", 
                                                            []));
                                                          (Env.FParamSecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ));
                                                          (Env.FParamSecurity (
                                                             "client_ta_sig",
                                                             "signature", 
                                                             []))
                                                          ])));
                                                 (("sdec", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSimple (
                                                            "cipher",
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ));
                                                          (Env.FParamSecurity (
                                                             "symkey_client_ta",
                                                             "symkey",
                                                             [(Env.TySimple (
                                                                 "cipher",
                                                                 [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ));
                                                          (Env.FParamSecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                          ])));
                                                 (("senc", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ));
                                                          (Env.FParamSecurity (
                                                             "symkey_client_ta",
                                                             "symkey",
                                                             [(Env.TySimple (
                                                                 "cipher",
                                                                 [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ));
                                                          (Env.FParamSimple (
                                                             "cipher",
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                          ])));
                                                 (("vk", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ));
                                                          (Env.FParamSecurity (
                                                             "ver_key_server",
                                                             "verkey",
                                                             [(Env.TySimple (
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                          ])));
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyProduct (
                                                         (Env.TyProduct (
                                                            (Env.TySimple (
                                                               "string", 
                                                               [])),
                                                            (Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                            )),
                                                         (Env.TySimple (
                                                            "string", 
                                                            []))
                                                         ));
                                                       (Env.TySecurity (
                                                          "client_ta_sig",
                                                          "signature", 
                                                          []))
                                                       ]));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyProduct (
                                                         (Env.TySimple (
                                                            "image", 
                                                            [])),
                                                         (Env.TySimple (
                                                            "signature", 
                                                            []))
                                                         ))
                                                       ]));
                                                 (("ver_key_server", 0),
                                                  (Env.SecurityTypeDef (
                                                     "verkey",
                                                     [(Env.TySimple ("image",
                                                         []))
                                                       ]
                                                     )));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("symkey_client_ta", 0),
                                                  (Env.SecurityTypeDef (
                                                     "symkey",
                                                     [(Env.TySimple (
                                                         "cipher",
                                                         [(Env.TySecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                           ]
                                                         ))
                                                       ]
                                                     )));
                                                 (("sigkey_client_ta", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     )));
                                                 (("client_ta_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_img", 0),
                                                  (Env.SecurityTypeDef (
                                                     "image", [])));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("cipher", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("hash", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("symkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("list", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("filedescr", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("image", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("arg2", 18), (Env.Var (Syntax.Loc 18)));
                                     (("arg1", 17), (Env.Var (Syntax.Loc 17)));
                                     (("f", 16), (Env.Var (Syntax.Loc 16)));
                                     (("cid", 15), (Env.Var (Syntax.Loc 15)));
                                     (("connect_rpc", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 13)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamSecurity (
                                                 "conn_client", "connection",
                                                 []))
                                              ]
                                            ))));
                                     (("recv", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 11)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a")]
                                            ))));
                                     (("send", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped (
                                            [("c", 9); ("v", 10)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a");
                                              (Env.FParamSimple ("unit", []))
                                              ]
                                            ))));
                                     (("verify", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("signature",
                                                []));
                                              (Env.FParamSimple ("image", 
                                                 []));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("bool", []))
                                              ])));
                                     (("true", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("bool", []))])));
                                     (("snd", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'b")])));
                                     (("fst", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'a")])));
                                     (("sign", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "client_img", "image", 
                                                []));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "client_ta_sig",
                                                 "signature", []))
                                              ])));
                                     (("sdec", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("cipher",
                                                [(Env.FParamSecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("senc", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ))
                                              ])));
                                     (("vk", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("rpc_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TyProduct (
                                                (Env.TySimple ("string", [])),
                                                (Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                )),
                                             (Env.TySimple ("string", []))));
                                           (Env.TySecurity ("client_ta_sig",
                                              "signature", []))
                                           ]));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TySimple ("image", [])),
                                             (Env.TySimple ("signature", []))
                                             ))
                                           ]));
                                     (("ver_key_server", 0),
                                      (Env.SecurityTypeDef ("verkey",
                                         [(Env.TySimple ("image", []))])));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("symkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("symkey",
                                         [(Env.TySimple ("cipher",
                                             [(Env.TySecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                               ]
                                             ))
                                           ]
                                         )));
                                     (("sigkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         )));
                                     (("client_ta_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_img", 0),
                                      (Env.SecurityTypeDef ("image", [])));
                                     (("client_ta_t", 0), Env.ProcTypeDef);
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("server_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("cipher", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("hash", 0), (Env.SimpleTypeDef []));
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("symkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("list", 0), (Env.SimpleTypeDef ["'a"]));
                                     (("filedescr", 0),
                                      (Env.SimpleTypeDef []));
                                     (("image", 0), (Env.SimpleTypeDef []));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("False", (Env.Global, (Some 0)));
                                          ("ImgRecvInvalid",
                                           (Env.Global, (Some 1)));
                                          ("ImgRecvValid",
                                           (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("connect_rpc", 0),
                                                   (Env.ExtSyscall
                                                      (Env.DesSMFunTyped (
                                                         [("c", 13)],
                                                         [(Env.FParamChannel
                                                             [(Env.FParamPoly
                                                                 "'a")
                                                               ]);
                                                           (Env.FParamSecurity (
                                                              "conn_client",
                                                              "connection",
                                                              []))
                                                           ]
                                                         ))));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 11)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ]
                                                          ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("close_rpc", 0);
           fun_sig =
           (Env.DesSMFunTyped ([("cid", 21)],
              [(Env.FParamSecurity ("conn_client", "connection", []));
                (Env.FParamSimple ("unit", []))]
              ));
           cmd =
           { desc = (Typed.Get ([("c", 22)],
                       { desc = Typed.Ident {id = ("cid", 21);
                                  desc = (Env.Var (Syntax.Loc 21));
                                  param = None}; env = { Env.vars =
                                                         [(("cid", 21),
                                                           (Env.Var
                                                              (Syntax.Loc 21)));
                                                           (("invoke_rpc", 0),
                                                            (Env.ExtSyscall
                                                               (Env.DesSMFunTyped (
                                                                  [("cid", 15);
                                                                    (
                                                                    "f", 16);
                                                                    (
                                                                    "arg1",
                                                                    17);
                                                                    (
                                                                    "arg2",
                                                                    18)],
                                                                  [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a");
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'b");
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'c")]
                                                                  ))));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall
                                                               (Env.DesSMFunTyped (
                                                                  [("c", 13)],
                                                                  [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]
                                                                  ))));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall
                                                               (Env.DesSMFunTyped (
                                                                  [("c", 11)],
                                                                  [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a")]
                                                                  ))));
                                                           (("send", 0),
                                                            (Env.ExtSyscall
                                                               (Env.DesSMFunTyped (
                                                                  [("c", 9);
                                                                    (
                                                                    "v", 10)],
                                                                  [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a");
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "unit",
                                                                    []))]
                                                                  ))));
                                                           (("verify", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                           (("true", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                           (("snd", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'b")])));
                                                           (("fst", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a")])));
                                                           (("sign", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                           (("sdec", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                           (("senc", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (
                                                                    Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                           (("vk", 0),
                                                            (Env.ExtFun
                                                               (Env.DesugaredTypeSig
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (
                                                                    Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                           (("rpc_t", 0),
                                                            (Env.ChanTypeDef
                                                               [(Env.TyProduct (
                                                                   (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                   (Env.TySimple (
                                                                    "string",
                                                                    []))
                                                                   ));
                                                                 (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))
                                                                 ]));
                                                           (("udp_t", 0),
                                                            (Env.ChanTypeDef
                                                               [(Env.TyProduct (
                                                                   (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                   (Env.TySimple (
                                                                    "signature",
                                                                    []))
                                                                   ))
                                                                 ]));
                                                           (("ver_key_server",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               )));
                                                           (("conn_client", 0),
                                                            (Env.SecurityTypeDef (
                                                               "connection",
                                                               [])));
                                                           (("symkey_client_ta",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               )));
                                                           (("sigkey_client_ta",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               )));
                                                           (("client_ta_sig",
                                                             0),
                                                            (Env.SecurityTypeDef (
                                                               "signature",
                                                               [])));
                                                           (("client_img", 0),
                                                            (Env.SecurityTypeDef (
                                                               "image", 
                                                               [])));
                                                           (("client_ta_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("client_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("server_t", 0),
                                                            Env.ProcTypeDef);
                                                           (("readonly_t", 0),
                                                            Env.FilesysTypeDef);
                                                           (("cipher", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("hash", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("verkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("sigkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("symkey", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("list", 0),
                                                            (Env.SimpleTypeDef
                                                               ["'a"]));
                                                           (("filedescr", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("image", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("signature", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("connection", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("string", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("bool", 0),
                                                            (Env.SimpleTypeDef
                                                               []));
                                                           (("unit", 0),
                                                            (Env.SimpleTypeDef
                                                               []))
                                                           ];
                                                         facts =
                                                         ref ([("False",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("ImgRecvInvalid",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("ImgRecvValid",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Del (
                                               { desc = Typed.Ident {
                                                          id = ("cid", 21);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 21));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 22),
                                                   (Env.Var (Syntax.Loc 22)));
                                                   (("cid", 21),
                                                    (Env.Var (Syntax.Loc 21)));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("cid", 15);
                                                            ("f", 16);
                                                            ("arg1", 17);
                                                            ("arg2", 18)],
                                                          [(Env.FParamSecurity (
                                                              "conn_client",
                                                              "connection",
                                                              []));
                                                            (Env.FParamSimple (
                                                               "string", 
                                                               []));
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamPoly
                                                               "'b");
                                                            (Env.FParamPoly
                                                               "'c")
                                                            ]
                                                          ))));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 13)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamSecurity (
                                                               "conn_client",
                                                               "connection",
                                                               []))
                                                            ]
                                                          ))));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 11)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ]
                                                          ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               "chid")); env = { Env.vars =
                                                                 [(("c", 22),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    22)));
                                                                   ((
                                                                    "cid", 21),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    21)));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                   ((
                                                                    "true", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                   ((
                                                                    "sdec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                   ((
                                                                    "senc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                   ((
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                   ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                   ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                   ((
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                   ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                   ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                   ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                   ((
                                                                    "client_img",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                   ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "cipher",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "hash", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "symkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "list", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                   ((
                                                                    "filedescr",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "image",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                   ((
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("False",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } },
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 22);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    22));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 22),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    22)));
                                                               (("cid", 21),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    21)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                               (("verify", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("true", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("snd", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                               (("fst", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                               (("sign", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                               (("sdec", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                               (("senc", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                               (("vk", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                               (("ver_key_server",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "verkey",
                                                                   [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("symkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "symkey",
                                                                   [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                   )));
                                                               (("sigkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("client_ta_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_img",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "image",
                                                                   [])));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("cipher", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("hash", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("symkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("list", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("filedescr",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("image", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "exit";
                                                           args = []}; env = 
                                                 { Env.vars =
                                                   [(("c", 22),
                                                     (Env.Var (Syntax.Loc 22)));
                                                     (("cid", 21),
                                                      (Env.Var
                                                         (Syntax.Loc 21)));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("cid", 15);
                                                              ("f", 16);
                                                              ("arg1", 17);
                                                              ("arg2", 18)],
                                                            [(Env.FParamSecurity (
                                                                "conn_client",
                                                                "connection",
                                                                []));
                                                              (Env.FParamSimple (
                                                                 "string", 
                                                                 []));
                                                              (Env.FParamPoly
                                                                 "'a");
                                                              (Env.FParamPoly
                                                                 "'b");
                                                              (Env.FParamPoly
                                                                 "'c")
                                                              ]
                                                            ))));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 13)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []))
                                                              ]
                                                            ))));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 11)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ]
                                                            ))));
                                                     (("send", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 9);
                                                              ("v", 10)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamPoly
                                                                 "'a");
                                                              (Env.FParamSimple (
                                                                 "unit", 
                                                                 []))
                                                              ]
                                                            ))));
                                                     (("verify", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "signature",
                                                                []));
                                                              (Env.FParamSimple (
                                                                 "image", 
                                                                 []));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                              ])));
                                                     (("true", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                              ])));
                                                     (("snd", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ])));
                                                     (("fst", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ])));
                                                     (("sign", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "client_img",
                                                                "image", 
                                                                []));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ])));
                                                     (("sdec", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("senc", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("vk", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "string",
                                                                   [])),
                                                                (Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                )),
                                                             (Env.TySimple (
                                                                "string", 
                                                                []))
                                                             ));
                                                           (Env.TySecurity (
                                                              "client_ta_sig",
                                                              "signature", 
                                                              []))
                                                           ]));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TySimple (
                                                                "image", 
                                                                [])),
                                                             (Env.TySimple (
                                                                "signature",
                                                                []))
                                                             ))
                                                           ]));
                                                     (("ver_key_server", 0),
                                                      (Env.SecurityTypeDef (
                                                         "verkey",
                                                         [(Env.TySimple (
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("symkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "symkey",
                                                         [(Env.TySimple (
                                                             "cipher",
                                                             [(Env.TySecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                           ]
                                                         )));
                                                     (("sigkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("client_ta_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_img", 0),
                                                      (Env.SecurityTypeDef (
                                                         "image", [])));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("cipher", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("hash", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("symkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("list", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("filedescr", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("image", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 22),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    22)));
                                                               (("cid", 21),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    21)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                               (("verify", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("true", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                               (("snd", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                               (("fst", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                               (("sign", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                               (("sdec", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                               (("senc", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                               (("vk", 0),
                                                                (Env.ExtFun
                                                                   (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                               (("rpc_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                               (("ver_key_server",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "verkey",
                                                                   [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("conn_client",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "connection",
                                                                   [])));
                                                               (("symkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "symkey",
                                                                   [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                   )));
                                                               (("sigkey_client_ta",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   )));
                                                               (("client_ta_sig",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "signature",
                                                                   [])));
                                                               (("client_img",
                                                                 0),
                                                                (Env.SecurityTypeDef (
                                                                   "image",
                                                                   [])));
                                                               (("client_ta_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("server_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("cipher", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("hash", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("verkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("sigkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("symkey", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("list", 0),
                                                                (Env.SimpleTypeDef
                                                                   ["'a"]));
                                                               (("filedescr",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("image", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("signature",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("connection",
                                                                 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("string", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("bool", 0),
                                                                (Env.SimpleTypeDef
                                                                   []));
                                                               (("unit", 0),
                                                                (Env.SimpleTypeDef
                                                                   []))
                                                               ];
                                                             facts =
                                                             ref ([("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 22),
                                                 (Env.Var (Syntax.Loc 22)));
                                                 (("cid", 21),
                                                  (Env.Var (Syntax.Loc 21)));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall
                                                     (Env.DesSMFunTyped (
                                                        [("cid", 15);
                                                          ("f", 16);
                                                          ("arg1", 17);
                                                          ("arg2", 18)],
                                                        [(Env.FParamSecurity (
                                                            "conn_client",
                                                            "connection", 
                                                            []));
                                                          (Env.FParamSimple (
                                                             "string", 
                                                             []));
                                                          (Env.FParamPoly
                                                             "'a");
                                                          (Env.FParamPoly
                                                             "'b");
                                                          (Env.FParamPoly
                                                             "'c")
                                                          ]
                                                        ))));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall
                                                     (Env.DesSMFunTyped (
                                                        [("c", 13)],
                                                        [(Env.FParamChannel
                                                            [(Env.FParamPoly
                                                                "'a")
                                                              ]);
                                                          (Env.FParamSecurity (
                                                             "conn_client",
                                                             "connection", 
                                                             []))
                                                          ]
                                                        ))));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall
                                                     (Env.DesSMFunTyped (
                                                        [("c", 11)],
                                                        [(Env.FParamChannel
                                                            [(Env.FParamPoly
                                                                "'a")
                                                              ]);
                                                          (Env.FParamPoly
                                                             "'a")
                                                          ]
                                                        ))));
                                                 (("send", 0),
                                                  (Env.ExtSyscall
                                                     (Env.DesSMFunTyped (
                                                        [("c", 9); ("v", 10)],
                                                        [(Env.FParamChannel
                                                            [(Env.FParamPoly
                                                                "'a")
                                                              ]);
                                                          (Env.FParamPoly
                                                             "'a");
                                                          (Env.FParamSimple (
                                                             "unit", 
                                                             []))
                                                          ]
                                                        ))));
                                                 (("verify", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSimple (
                                                            "signature", 
                                                            []));
                                                          (Env.FParamSimple (
                                                             "image", 
                                                             []));
                                                          (Env.FParamSecurity (
                                                             "ver_key_server",
                                                             "verkey",
                                                             [(Env.TySimple (
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ));
                                                          (Env.FParamSimple (
                                                             "bool", 
                                                             []))
                                                          ])));
                                                 (("true", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSimple (
                                                            "bool", []))
                                                          ])));
                                                 (("snd", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamProduct (
                                                            (Env.FParamPoly
                                                               "'a"),
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ));
                                                          (Env.FParamPoly
                                                             "'b")
                                                          ])));
                                                 (("fst", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamProduct (
                                                            (Env.FParamPoly
                                                               "'a"),
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ));
                                                          (Env.FParamPoly
                                                             "'a")
                                                          ])));
                                                 (("sign", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSecurity (
                                                            "client_img",
                                                            "image", 
                                                            []));
                                                          (Env.FParamSecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ));
                                                          (Env.FParamSecurity (
                                                             "client_ta_sig",
                                                             "signature", 
                                                             []))
                                                          ])));
                                                 (("sdec", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSimple (
                                                            "cipher",
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ));
                                                          (Env.FParamSecurity (
                                                             "symkey_client_ta",
                                                             "symkey",
                                                             [(Env.TySimple (
                                                                 "cipher",
                                                                 [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ));
                                                          (Env.FParamSecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                          ])));
                                                 (("senc", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ));
                                                          (Env.FParamSecurity (
                                                             "symkey_client_ta",
                                                             "symkey",
                                                             [(Env.TySimple (
                                                                 "cipher",
                                                                 [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ));
                                                          (Env.FParamSimple (
                                                             "cipher",
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                          ])));
                                                 (("vk", 0),
                                                  (Env.ExtFun
                                                     (Env.DesugaredTypeSig
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ));
                                                          (Env.FParamSecurity (
                                                             "ver_key_server",
                                                             "verkey",
                                                             [(Env.TySimple (
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                          ])));
                                                 (("rpc_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyProduct (
                                                         (Env.TyProduct (
                                                            (Env.TySimple (
                                                               "string", 
                                                               [])),
                                                            (Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                            )),
                                                         (Env.TySimple (
                                                            "string", 
                                                            []))
                                                         ));
                                                       (Env.TySecurity (
                                                          "client_ta_sig",
                                                          "signature", 
                                                          []))
                                                       ]));
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef
                                                     [(Env.TyProduct (
                                                         (Env.TySimple (
                                                            "image", 
                                                            [])),
                                                         (Env.TySimple (
                                                            "signature", 
                                                            []))
                                                         ))
                                                       ]));
                                                 (("ver_key_server", 0),
                                                  (Env.SecurityTypeDef (
                                                     "verkey",
                                                     [(Env.TySimple ("image",
                                                         []))
                                                       ]
                                                     )));
                                                 (("conn_client", 0),
                                                  (Env.SecurityTypeDef (
                                                     "connection", [])));
                                                 (("symkey_client_ta", 0),
                                                  (Env.SecurityTypeDef (
                                                     "symkey",
                                                     [(Env.TySimple (
                                                         "cipher",
                                                         [(Env.TySecurity (
                                                             "sigkey_client_ta",
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             ))
                                                           ]
                                                         ))
                                                       ]
                                                     )));
                                                 (("sigkey_client_ta", 0),
                                                  (Env.SecurityTypeDef (
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     )));
                                                 (("client_ta_sig", 0),
                                                  (Env.SecurityTypeDef (
                                                     "signature", [])));
                                                 (("client_img", 0),
                                                  (Env.SecurityTypeDef (
                                                     "image", [])));
                                                 (("client_ta_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("server_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("cipher", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("hash", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("verkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("sigkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("symkey", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("list", 0),
                                                  (Env.SimpleTypeDef ["'a"]));
                                                 (("filedescr", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("image", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("signature", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("connection", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("string", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("bool", 0),
                                                  (Env.SimpleTypeDef []));
                                                 (("unit", 0),
                                                  (Env.SimpleTypeDef []))
                                                 ];
                                               facts =
                                               ref ([("False",
                                                      (Env.Global, (Some 0)));
                                                      ("ImgRecvInvalid",
                                                       (Env.Global, (Some 1)));
                                                      ("ImgRecvValid",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("cid", 21), (Env.Var (Syntax.Loc 21)));
                                     (("invoke_rpc", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped (
                                            [("cid", 15); ("f", 16);
                                              ("arg1", 17); ("arg2", 18)],
                                            [(Env.FParamSecurity (
                                                "conn_client", "connection",
                                                []));
                                              (Env.FParamSimple ("string", 
                                                 []));
                                              (Env.FParamPoly "'a");
                                              (Env.FParamPoly "'b");
                                              (Env.FParamPoly "'c")]
                                            ))));
                                     (("connect_rpc", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 13)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamSecurity (
                                                 "conn_client", "connection",
                                                 []))
                                              ]
                                            ))));
                                     (("recv", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 11)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a")]
                                            ))));
                                     (("send", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped (
                                            [("c", 9); ("v", 10)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a");
                                              (Env.FParamSimple ("unit", []))
                                              ]
                                            ))));
                                     (("verify", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("signature",
                                                []));
                                              (Env.FParamSimple ("image", 
                                                 []));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("bool", []))
                                              ])));
                                     (("true", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("bool", []))])));
                                     (("snd", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'b")])));
                                     (("fst", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'a")])));
                                     (("sign", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "client_img", "image", 
                                                []));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "client_ta_sig",
                                                 "signature", []))
                                              ])));
                                     (("sdec", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("cipher",
                                                [(Env.FParamSecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("senc", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ))
                                              ])));
                                     (("vk", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("rpc_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TyProduct (
                                                (Env.TySimple ("string", [])),
                                                (Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                )),
                                             (Env.TySimple ("string", []))));
                                           (Env.TySecurity ("client_ta_sig",
                                              "signature", []))
                                           ]));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TySimple ("image", [])),
                                             (Env.TySimple ("signature", []))
                                             ))
                                           ]));
                                     (("ver_key_server", 0),
                                      (Env.SecurityTypeDef ("verkey",
                                         [(Env.TySimple ("image", []))])));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("symkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("symkey",
                                         [(Env.TySimple ("cipher",
                                             [(Env.TySecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                               ]
                                             ))
                                           ]
                                         )));
                                     (("sigkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         )));
                                     (("client_ta_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_img", 0),
                                      (Env.SecurityTypeDef ("image", [])));
                                     (("client_ta_t", 0), Env.ProcTypeDef);
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("server_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("cipher", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("hash", 0), (Env.SimpleTypeDef []));
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("symkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("list", 0), (Env.SimpleTypeDef ["'a"]));
                                     (("filedescr", 0),
                                      (Env.SimpleTypeDef []));
                                     (("image", 0), (Env.SimpleTypeDef []));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("False", (Env.Global, (Some 0)));
                                          ("ImgRecvInvalid",
                                           (Env.Global, (Some 1)));
                                          ("ImgRecvValid",
                                           (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("invoke_rpc", 0),
                                                   (Env.ExtSyscall
                                                      (Env.DesSMFunTyped (
                                                         [("cid", 15);
                                                           ("f", 16);
                                                           ("arg1", 17);
                                                           ("arg2", 18)],
                                                         [(Env.FParamSecurity (
                                                             "conn_client",
                                                             "connection", 
                                                             []));
                                                           (Env.FParamSimple (
                                                              "string", 
                                                              []));
                                                           (Env.FParamPoly
                                                              "'a");
                                                           (Env.FParamPoly
                                                              "'b");
                                                           (Env.FParamPoly
                                                              "'c")
                                                           ]
                                                         ))));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 13)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamSecurity (
                                                               "conn_client",
                                                               "connection",
                                                               []))
                                                            ]
                                                          ))));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 11)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ]
                                                          ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("accept_rpc", 0);
           fun_sig =
           (Env.DesSMFunTyped ([("c", 23)],
              [(Env.FParamChannel [(Env.FParamPoly "'a")]);
                (Env.FParamSimple ("unit", []))]
              ));
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 23);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 23));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("c", 23),
                                          (Env.Var (Syntax.Loc 23)));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall
                                              (Env.DesSMFunTyped (
                                                 [("cid", 21)],
                                                 [(Env.FParamSecurity (
                                                     "conn_client",
                                                     "connection", []));
                                                   (Env.FParamSimple ("unit",
                                                      []))
                                                   ]
                                                 ))));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall
                                              (Env.DesSMFunTyped (
                                                 [("cid", 15); ("f", 16);
                                                   ("arg1", 17); ("arg2", 18)
                                                   ],
                                                 [(Env.FParamSecurity (
                                                     "conn_client",
                                                     "connection", []));
                                                   (Env.FParamSimple (
                                                      "string", []));
                                                   (Env.FParamPoly "'a");
                                                   (Env.FParamPoly "'b");
                                                   (Env.FParamPoly "'c")]
                                                 ))));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall
                                              (Env.DesSMFunTyped (
                                                 [("c", 13)],
                                                 [(Env.FParamChannel
                                                     [(Env.FParamPoly "'a")]);
                                                   (Env.FParamSecurity (
                                                      "conn_client",
                                                      "connection", []))
                                                   ]
                                                 ))));
                                          (("recv", 0),
                                           (Env.ExtSyscall
                                              (Env.DesSMFunTyped (
                                                 [("c", 11)],
                                                 [(Env.FParamChannel
                                                     [(Env.FParamPoly "'a")]);
                                                   (Env.FParamPoly "'a")]
                                                 ))));
                                          (("send", 0),
                                           (Env.ExtSyscall
                                              (Env.DesSMFunTyped (
                                                 [("c", 9); ("v", 10)],
                                                 [(Env.FParamChannel
                                                     [(Env.FParamPoly "'a")]);
                                                   (Env.FParamPoly "'a");
                                                   (Env.FParamSimple ("unit",
                                                      []))
                                                   ]
                                                 ))));
                                          (("verify", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple (
                                                     "signature", []));
                                                   (Env.FParamSimple (
                                                      "image", []));
                                                   (Env.FParamSecurity (
                                                      "ver_key_server",
                                                      "verkey",
                                                      [(Env.TySimple (
                                                          "image", []))
                                                        ]
                                                      ));
                                                   (Env.FParamSimple ("bool",
                                                      []))
                                                   ])));
                                          (("true", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple ("bool",
                                                     []))
                                                   ])));
                                          (("snd", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamProduct (
                                                     (Env.FParamPoly "'a"),
                                                     (Env.FParamPoly "'b")));
                                                   (Env.FParamPoly "'b")])));
                                          (("fst", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamProduct (
                                                     (Env.FParamPoly "'a"),
                                                     (Env.FParamPoly "'b")));
                                                   (Env.FParamPoly "'a")])));
                                          (("sign", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "client_img", "image",
                                                     []));
                                                   (Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ));
                                                   (Env.FParamSecurity (
                                                      "client_ta_sig",
                                                      "signature", []))
                                                   ])));
                                          (("sdec", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSimple (
                                                     "cipher",
                                                     [(Env.FParamSecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "symkey_client_ta",
                                                      "symkey",
                                                      [(Env.TySimple (
                                                          "cipher",
                                                          [(Env.TySecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                   (Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                   ])));
                                          (("senc", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "symkey_client_ta",
                                                      "symkey",
                                                      [(Env.TySimple (
                                                          "cipher",
                                                          [(Env.TySecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ))
                                                            ]
                                                          ))
                                                        ]
                                                      ));
                                                   (Env.FParamSimple (
                                                      "cipher",
                                                      [(Env.FParamSecurity (
                                                          "sigkey_client_ta",
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          ))
                                                        ]
                                                      ))
                                                   ])));
                                          (("vk", 0),
                                           (Env.ExtFun
                                              (Env.DesugaredTypeSig
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ));
                                                   (Env.FParamSecurity (
                                                      "ver_key_server",
                                                      "verkey",
                                                      [(Env.TySimple (
                                                          "image", []))
                                                        ]
                                                      ))
                                                   ])));
                                          (("rpc_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyProduct (
                                                  (Env.TyProduct (
                                                     (Env.TySimple ("string",
                                                        [])),
                                                     (Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                     )),
                                                  (Env.TySimple ("string", 
                                                     []))
                                                  ));
                                                (Env.TySecurity (
                                                   "client_ta_sig",
                                                   "signature", []))
                                                ]));
                                          (("udp_t", 0),
                                           (Env.ChanTypeDef
                                              [(Env.TyProduct (
                                                  (Env.TySimple ("image", 
                                                     [])),
                                                  (Env.TySimple ("signature",
                                                     []))
                                                  ))
                                                ]));
                                          (("ver_key_server", 0),
                                           (Env.SecurityTypeDef ("verkey",
                                              [(Env.TySimple ("image", []))]
                                              )));
                                          (("conn_client", 0),
                                           (Env.SecurityTypeDef (
                                              "connection", [])));
                                          (("symkey_client_ta", 0),
                                           (Env.SecurityTypeDef ("symkey",
                                              [(Env.TySimple ("cipher",
                                                  [(Env.TySecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ))
                                                ]
                                              )));
                                          (("sigkey_client_ta", 0),
                                           (Env.SecurityTypeDef ("sigkey",
                                              [(Env.TySecurity ("client_img",
                                                  "image", []))
                                                ]
                                              )));
                                          (("client_ta_sig", 0),
                                           (Env.SecurityTypeDef ("signature",
                                              [])));
                                          (("client_img", 0),
                                           (Env.SecurityTypeDef ("image", 
                                              [])));
                                          (("client_ta_t", 0),
                                           Env.ProcTypeDef);
                                          (("client_t", 0), Env.ProcTypeDef);
                                          (("server_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("cipher", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("hash", 0),
                                           (Env.SimpleTypeDef []));
                                          (("verkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("sigkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("symkey", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("list", 0),
                                           (Env.SimpleTypeDef ["'a"]));
                                          (("filedescr", 0),
                                           (Env.SimpleTypeDef []));
                                          (("image", 0),
                                           (Env.SimpleTypeDef []));
                                          (("signature", 0),
                                           (Env.SimpleTypeDef []));
                                          (("connection", 0),
                                           (Env.SimpleTypeDef []));
                                          (("string", 0),
                                           (Env.SimpleTypeDef []));
                                          (("bool", 0),
                                           (Env.SimpleTypeDef []));
                                          (("unit", 0),
                                           (Env.SimpleTypeDef []))
                                          ];
                                        facts =
                                        ref ([("False",
                                               (Env.Global, (Some 0)));
                                               ("ImgRecvInvalid",
                                                (Env.Global, (Some 1)));
                                               ("ImgRecvValid",
                                                (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "req"; args = []}; env = 
                            { Env.vars =
                              [(("c", 23), (Env.Var (Syntax.Loc 23)));
                                (("close_rpc", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped ([("cid", 21)],
                                       [(Env.FParamSecurity ("conn_client",
                                           "connection", []));
                                         (Env.FParamSimple ("unit", []))]
                                       ))));
                                (("invoke_rpc", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped (
                                       [("cid", 15); ("f", 16); ("arg1", 17);
                                         ("arg2", 18)],
                                       [(Env.FParamSecurity ("conn_client",
                                           "connection", []));
                                         (Env.FParamSimple ("string", []));
                                         (Env.FParamPoly "'a");
                                         (Env.FParamPoly "'b");
                                         (Env.FParamPoly "'c")]
                                       ))));
                                (("connect_rpc", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped ([("c", 13)],
                                       [(Env.FParamChannel
                                           [(Env.FParamPoly "'a")]);
                                         (Env.FParamSecurity ("conn_client",
                                            "connection", []))
                                         ]
                                       ))));
                                (("recv", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped ([("c", 11)],
                                       [(Env.FParamChannel
                                           [(Env.FParamPoly "'a")]);
                                         (Env.FParamPoly "'a")]
                                       ))));
                                (("send", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped (
                                       [("c", 9); ("v", 10)],
                                       [(Env.FParamChannel
                                           [(Env.FParamPoly "'a")]);
                                         (Env.FParamPoly "'a");
                                         (Env.FParamSimple ("unit", []))]
                                       ))));
                                (("verify", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSimple ("signature", []));
                                         (Env.FParamSimple ("image", []));
                                         (Env.FParamSecurity (
                                            "ver_key_server", "verkey",
                                            [(Env.TySimple ("image", []))]));
                                         (Env.FParamSimple ("bool", []))])));
                                (("true", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSimple ("bool", []))])));
                                (("snd", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamProduct (
                                           (Env.FParamPoly "'a"),
                                           (Env.FParamPoly "'b")));
                                         (Env.FParamPoly "'b")])));
                                (("fst", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamProduct (
                                           (Env.FParamPoly "'a"),
                                           (Env.FParamPoly "'b")));
                                         (Env.FParamPoly "'a")])));
                                (("sign", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSecurity ("client_img",
                                           "image", []));
                                         (Env.FParamSecurity (
                                            "sigkey_client_ta", "sigkey",
                                            [(Env.TySecurity ("client_img",
                                                "image", []))
                                              ]
                                            ));
                                         (Env.FParamSecurity (
                                            "client_ta_sig", "signature", 
                                            []))
                                         ])));
                                (("sdec", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSimple ("cipher",
                                           [(Env.FParamSecurity (
                                               "sigkey_client_ta", "sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               ))
                                             ]
                                           ));
                                         (Env.FParamSecurity (
                                            "symkey_client_ta", "symkey",
                                            [(Env.TySimple ("cipher",
                                                [(Env.TySecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ))
                                              ]
                                            ));
                                         (Env.FParamSecurity (
                                            "sigkey_client_ta", "sigkey",
                                            [(Env.TySecurity ("client_img",
                                                "image", []))
                                              ]
                                            ))
                                         ])));
                                (("senc", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSecurity (
                                           "sigkey_client_ta", "sigkey",
                                           [(Env.TySecurity ("client_img",
                                               "image", []))
                                             ]
                                           ));
                                         (Env.FParamSecurity (
                                            "symkey_client_ta", "symkey",
                                            [(Env.TySimple ("cipher",
                                                [(Env.TySecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ))
                                              ]
                                            ));
                                         (Env.FParamSimple ("cipher",
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ))
                                              ]
                                            ))
                                         ])));
                                (("vk", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSecurity (
                                           "sigkey_client_ta", "sigkey",
                                           [(Env.TySecurity ("client_img",
                                               "image", []))
                                             ]
                                           ));
                                         (Env.FParamSecurity (
                                            "ver_key_server", "verkey",
                                            [(Env.TySimple ("image", []))]))
                                         ])));
                                (("rpc_t", 0),
                                 (Env.ChanTypeDef
                                    [(Env.TyProduct (
                                        (Env.TyProduct (
                                           (Env.TySimple ("string", [])),
                                           (Env.TySecurity ("client_img",
                                              "image", []))
                                           )),
                                        (Env.TySimple ("string", []))));
                                      (Env.TySecurity ("client_ta_sig",
                                         "signature", []))
                                      ]));
                                (("udp_t", 0),
                                 (Env.ChanTypeDef
                                    [(Env.TyProduct (
                                        (Env.TySimple ("image", [])),
                                        (Env.TySimple ("signature", []))))
                                      ]));
                                (("ver_key_server", 0),
                                 (Env.SecurityTypeDef ("verkey",
                                    [(Env.TySimple ("image", []))])));
                                (("conn_client", 0),
                                 (Env.SecurityTypeDef ("connection", [])));
                                (("symkey_client_ta", 0),
                                 (Env.SecurityTypeDef ("symkey",
                                    [(Env.TySimple ("cipher",
                                        [(Env.TySecurity ("sigkey_client_ta",
                                            "sigkey",
                                            [(Env.TySecurity ("client_img",
                                                "image", []))
                                              ]
                                            ))
                                          ]
                                        ))
                                      ]
                                    )));
                                (("sigkey_client_ta", 0),
                                 (Env.SecurityTypeDef ("sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    )));
                                (("client_ta_sig", 0),
                                 (Env.SecurityTypeDef ("signature", [])));
                                (("client_img", 0),
                                 (Env.SecurityTypeDef ("image", [])));
                                (("client_ta_t", 0), Env.ProcTypeDef);
                                (("client_t", 0), Env.ProcTypeDef);
                                (("server_t", 0), Env.ProcTypeDef);
                                (("readonly_t", 0), Env.FilesysTypeDef);
                                (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                                (("hash", 0), (Env.SimpleTypeDef []));
                                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("list", 0), (Env.SimpleTypeDef ["'a"]));
                                (("filedescr", 0), (Env.SimpleTypeDef []));
                                (("image", 0), (Env.SimpleTypeDef []));
                                (("signature", 0), (Env.SimpleTypeDef []));
                                (("connection", 0), (Env.SimpleTypeDef []));
                                (("string", 0), (Env.SimpleTypeDef []));
                                (("bool", 0), (Env.SimpleTypeDef []));
                                (("unit", 0), (Env.SimpleTypeDef []))];
                              facts =
                              ref ([("False", (Env.Global, (Some 0)));
                                     ("ImgRecvInvalid",
                                      (Env.Global, (Some 1)));
                                     ("ImgRecvValid", (Env.Global, (Some 1)));
                                     ("exit", (Env.Channel, (Some 0)));
                                     ("Returned", (Env.Channel, (Some 1)));
                                     ("invoke", (Env.Channel, (Some 3)));
                                     ("conn", (Env.Channel, (Some 0)));
                                     ("chid", (Env.Structure, (Some 1)));
                                     ("ack", (Env.Channel, (Some 0)));
                                     ("req", (Env.Channel, (Some 0)));
                                     ("store", (Env.Channel, (Some 1)))])
                              } }
                            ];
                          cmd =
                          { desc = (Typed.Put
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 23);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   23));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 23),
                                                      (Env.Var
                                                         (Syntax.Loc 23)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 21)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 15);
                                                               ("f", 16);
                                                               ("arg1", 17);
                                                               ("arg2", 18)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "string",
                                                                  []));
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamPoly
                                                                  "'b");
                                                               (Env.FParamPoly
                                                                  "'c")
                                                               ]
                                                             ))));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 13)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamSecurity (
                                                                  "conn_client",
                                                                  "connection",
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 11)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ]
                                                             ))));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 23),
                                            (Env.Var (Syntax.Loc 23)));
                                            (("close_rpc", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("cid", 21)],
                                                   [(Env.FParamSecurity (
                                                       "conn_client",
                                                       "connection", 
                                                       []));
                                                     (Env.FParamSimple (
                                                        "unit", []))
                                                     ]
                                                   ))));
                                            (("invoke_rpc", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("cid", 15); ("f", 16);
                                                     ("arg1", 17);
                                                     ("arg2", 18)],
                                                   [(Env.FParamSecurity (
                                                       "conn_client",
                                                       "connection", 
                                                       []));
                                                     (Env.FParamSimple (
                                                        "string", []));
                                                     (Env.FParamPoly "'a");
                                                     (Env.FParamPoly "'b");
                                                     (Env.FParamPoly "'c")]
                                                   ))));
                                            (("connect_rpc", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("c", 13)],
                                                   [(Env.FParamChannel
                                                       [(Env.FParamPoly "'a")
                                                         ]);
                                                     (Env.FParamSecurity (
                                                        "conn_client",
                                                        "connection", 
                                                        []))
                                                     ]
                                                   ))));
                                            (("recv", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("c", 11)],
                                                   [(Env.FParamChannel
                                                       [(Env.FParamPoly "'a")
                                                         ]);
                                                     (Env.FParamPoly "'a")]
                                                   ))));
                                            (("send", 0),
                                             (Env.ExtSyscall
                                                (Env.DesSMFunTyped (
                                                   [("c", 9); ("v", 10)],
                                                   [(Env.FParamChannel
                                                       [(Env.FParamPoly "'a")
                                                         ]);
                                                     (Env.FParamPoly "'a");
                                                     (Env.FParamSimple (
                                                        "unit", []))
                                                     ]
                                                   ))));
                                            (("verify", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "signature", []));
                                                     (Env.FParamSimple (
                                                        "image", []));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "bool", []))
                                                     ])));
                                            (("true", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "bool", []))
                                                     ])));
                                            (("snd", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'b")])));
                                            (("fst", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamProduct (
                                                       (Env.FParamPoly "'a"),
                                                       (Env.FParamPoly "'b")
                                                       ));
                                                     (Env.FParamPoly "'a")])));
                                            (("sign", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "client_img", "image",
                                                       []));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "client_ta_sig",
                                                        "signature", 
                                                        []))
                                                     ])));
                                            (("sdec", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSimple (
                                                       "cipher",
                                                       [(Env.FParamSecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("senc", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "symkey_client_ta",
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        ));
                                                     (Env.FParamSimple (
                                                        "cipher",
                                                        [(Env.FParamSecurity (
                                                            "sigkey_client_ta",
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            ))
                                                          ]
                                                        ))
                                                     ])));
                                            (("vk", 0),
                                             (Env.ExtFun
                                                (Env.DesugaredTypeSig
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ));
                                                     (Env.FParamSecurity (
                                                        "ver_key_server",
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                     ])));
                                            (("rpc_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TyProduct (
                                                       (Env.TySimple (
                                                          "string", [])),
                                                       (Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                       )),
                                                    (Env.TySimple ("string",
                                                       []))
                                                    ));
                                                  (Env.TySecurity (
                                                     "client_ta_sig",
                                                     "signature", []))
                                                  ]));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef
                                                [(Env.TyProduct (
                                                    (Env.TySimple ("image",
                                                       [])),
                                                    (Env.TySimple (
                                                       "signature", []))
                                                    ))
                                                  ]));
                                            (("ver_key_server", 0),
                                             (Env.SecurityTypeDef ("verkey",
                                                [(Env.TySimple ("image", []))
                                                  ]
                                                )));
                                            (("conn_client", 0),
                                             (Env.SecurityTypeDef (
                                                "connection", [])));
                                            (("symkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("symkey",
                                                [(Env.TySimple ("cipher",
                                                    [(Env.TySecurity (
                                                        "sigkey_client_ta",
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        ))
                                                      ]
                                                    ))
                                                  ]
                                                )));
                                            (("sigkey_client_ta", 0),
                                             (Env.SecurityTypeDef ("sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                )));
                                            (("client_ta_sig", 0),
                                             (Env.SecurityTypeDef (
                                                "signature", [])));
                                            (("client_img", 0),
                                             (Env.SecurityTypeDef ("image",
                                                [])));
                                            (("client_ta_t", 0),
                                             Env.ProcTypeDef);
                                            (("client_t", 0), Env.ProcTypeDef);
                                            (("server_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("cipher", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("hash", 0),
                                             (Env.SimpleTypeDef []));
                                            (("verkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("sigkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("symkey", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("list", 0),
                                             (Env.SimpleTypeDef ["'a"]));
                                            (("filedescr", 0),
                                             (Env.SimpleTypeDef []));
                                            (("image", 0),
                                             (Env.SimpleTypeDef []));
                                            (("signature", 0),
                                             (Env.SimpleTypeDef []));
                                            (("connection", 0),
                                             (Env.SimpleTypeDef []));
                                            (("string", 0),
                                             (Env.SimpleTypeDef []));
                                            (("bool", 0),
                                             (Env.SimpleTypeDef []));
                                            (("unit", 0),
                                             (Env.SimpleTypeDef []))
                                            ];
                                          facts =
                                          ref ([("False",
                                                 (Env.Global, (Some 0)));
                                                 ("ImgRecvInvalid",
                                                  (Env.Global, (Some 1)));
                                                 ("ImgRecvValid",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]); env = { Env.vars =
                                                    [(("c", 23),
                                                      (Env.Var
                                                         (Syntax.Loc 23)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 21)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 15);
                                                               ("f", 16);
                                                               ("arg1", 17);
                                                               ("arg2", 18)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "string",
                                                                  []));
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamPoly
                                                                  "'b");
                                                               (Env.FParamPoly
                                                                  "'c")
                                                               ]
                                                             ))));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 13)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamSecurity (
                                                                  "conn_client",
                                                                  "connection",
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 11)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ]
                                                             ))));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 23), (Env.Var (Syntax.Loc 23)));
                                       (("close_rpc", 0),
                                        (Env.ExtSyscall
                                           (Env.DesSMFunTyped ([("cid", 21)],
                                              [(Env.FParamSecurity (
                                                  "conn_client",
                                                  "connection", []));
                                                (Env.FParamSimple ("unit", 
                                                   []))
                                                ]
                                              ))));
                                       (("invoke_rpc", 0),
                                        (Env.ExtSyscall
                                           (Env.DesSMFunTyped (
                                              [("cid", 15); ("f", 16);
                                                ("arg1", 17); ("arg2", 18)],
                                              [(Env.FParamSecurity (
                                                  "conn_client",
                                                  "connection", []));
                                                (Env.FParamSimple ("string",
                                                   []));
                                                (Env.FParamPoly "'a");
                                                (Env.FParamPoly "'b");
                                                (Env.FParamPoly "'c")]
                                              ))));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall
                                           (Env.DesSMFunTyped ([("c", 13)],
                                              [(Env.FParamChannel
                                                  [(Env.FParamPoly "'a")]);
                                                (Env.FParamSecurity (
                                                   "conn_client",
                                                   "connection", []))
                                                ]
                                              ))));
                                       (("recv", 0),
                                        (Env.ExtSyscall
                                           (Env.DesSMFunTyped ([("c", 11)],
                                              [(Env.FParamChannel
                                                  [(Env.FParamPoly "'a")]);
                                                (Env.FParamPoly "'a")]
                                              ))));
                                       (("send", 0),
                                        (Env.ExtSyscall
                                           (Env.DesSMFunTyped (
                                              [("c", 9); ("v", 10)],
                                              [(Env.FParamChannel
                                                  [(Env.FParamPoly "'a")]);
                                                (Env.FParamPoly "'a");
                                                (Env.FParamSimple ("unit", 
                                                   []))
                                                ]
                                              ))));
                                       (("verify", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple (
                                                  "signature", []));
                                                (Env.FParamSimple ("image",
                                                   []));
                                                (Env.FParamSecurity (
                                                   "ver_key_server",
                                                   "verkey",
                                                   [(Env.TySimple ("image",
                                                       []))
                                                     ]
                                                   ));
                                                (Env.FParamSimple ("bool", 
                                                   []))
                                                ])));
                                       (("true", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple ("bool", 
                                                  []))
                                                ])));
                                       (("snd", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamProduct (
                                                  (Env.FParamPoly "'a"),
                                                  (Env.FParamPoly "'b")));
                                                (Env.FParamPoly "'b")])));
                                       (("fst", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamProduct (
                                                  (Env.FParamPoly "'a"),
                                                  (Env.FParamPoly "'b")));
                                                (Env.FParamPoly "'a")])));
                                       (("sign", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "client_img", "image", 
                                                  []));
                                                (Env.FParamSecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ));
                                                (Env.FParamSecurity (
                                                   "client_ta_sig",
                                                   "signature", []))
                                                ])));
                                       (("sdec", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSimple ("cipher",
                                                  [(Env.FParamSecurity (
                                                      "sigkey_client_ta",
                                                      "sigkey",
                                                      [(Env.TySecurity (
                                                          "client_img",
                                                          "image", []))
                                                        ]
                                                      ))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "symkey_client_ta",
                                                   "symkey",
                                                   [(Env.TySimple ("cipher",
                                                       [(Env.TySecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                     ]
                                                   ));
                                                (Env.FParamSecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ))
                                                ])));
                                       (("senc", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "symkey_client_ta",
                                                   "symkey",
                                                   [(Env.TySimple ("cipher",
                                                       [(Env.TySecurity (
                                                           "sigkey_client_ta",
                                                           "sigkey",
                                                           [(Env.TySecurity (
                                                               "client_img",
                                                               "image", 
                                                               []))
                                                             ]
                                                           ))
                                                         ]
                                                       ))
                                                     ]
                                                   ));
                                                (Env.FParamSimple ("cipher",
                                                   [(Env.FParamSecurity (
                                                       "sigkey_client_ta",
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       ))
                                                     ]
                                                   ))
                                                ])));
                                       (("vk", 0),
                                        (Env.ExtFun
                                           (Env.DesugaredTypeSig
                                              [(Env.FParamSecurity (
                                                  "sigkey_client_ta",
                                                  "sigkey",
                                                  [(Env.TySecurity (
                                                      "client_img", "image",
                                                      []))
                                                    ]
                                                  ));
                                                (Env.FParamSecurity (
                                                   "ver_key_server",
                                                   "verkey",
                                                   [(Env.TySimple ("image",
                                                       []))
                                                     ]
                                                   ))
                                                ])));
                                       (("rpc_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyProduct (
                                               (Env.TyProduct (
                                                  (Env.TySimple ("string", 
                                                     [])),
                                                  (Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                  )),
                                               (Env.TySimple ("string", []))
                                               ));
                                             (Env.TySecurity (
                                                "client_ta_sig", "signature",
                                                []))
                                             ]));
                                       (("udp_t", 0),
                                        (Env.ChanTypeDef
                                           [(Env.TyProduct (
                                               (Env.TySimple ("image", [])),
                                               (Env.TySimple ("signature", 
                                                  []))
                                               ))
                                             ]));
                                       (("ver_key_server", 0),
                                        (Env.SecurityTypeDef ("verkey",
                                           [(Env.TySimple ("image", []))])));
                                       (("conn_client", 0),
                                        (Env.SecurityTypeDef ("connection",
                                           [])));
                                       (("symkey_client_ta", 0),
                                        (Env.SecurityTypeDef ("symkey",
                                           [(Env.TySimple ("cipher",
                                               [(Env.TySecurity (
                                                   "sigkey_client_ta",
                                                   "sigkey",
                                                   [(Env.TySecurity (
                                                       "client_img", "image",
                                                       []))
                                                     ]
                                                   ))
                                                 ]
                                               ))
                                             ]
                                           )));
                                       (("sigkey_client_ta", 0),
                                        (Env.SecurityTypeDef ("sigkey",
                                           [(Env.TySecurity ("client_img",
                                               "image", []))
                                             ]
                                           )));
                                       (("client_ta_sig", 0),
                                        (Env.SecurityTypeDef ("signature", 
                                           [])));
                                       (("client_img", 0),
                                        (Env.SecurityTypeDef ("image", [])));
                                       (("client_ta_t", 0), Env.ProcTypeDef);
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("server_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("cipher", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("hash", 0), (Env.SimpleTypeDef []));
                                       (("verkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("sigkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("symkey", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("list", 0),
                                        (Env.SimpleTypeDef ["'a"]));
                                       (("filedescr", 0),
                                        (Env.SimpleTypeDef []));
                                       (("image", 0), (Env.SimpleTypeDef []));
                                       (("signature", 0),
                                        (Env.SimpleTypeDef []));
                                       (("connection", 0),
                                        (Env.SimpleTypeDef []));
                                       (("string", 0), (Env.SimpleTypeDef []));
                                       (("bool", 0), (Env.SimpleTypeDef []));
                                       (("unit", 0), (Env.SimpleTypeDef []))];
                                     facts =
                                     ref ([("False", (Env.Global, (Some 0)));
                                            ("ImgRecvInvalid",
                                             (Env.Global, (Some 1)));
                                            ("ImgRecvValid",
                                             (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("close_rpc", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("cid", 21)],
                                                           [(Env.FParamSecurity (
                                                               "conn_client",
                                                               "connection",
                                                               []));
                                                             (Env.FParamSimple (
                                                                "unit", 
                                                                []))
                                                             ]
                                                           ))));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("cid", 15);
                                                              ("f", 16);
                                                              ("arg1", 17);
                                                              ("arg2", 18)],
                                                            [(Env.FParamSecurity (
                                                                "conn_client",
                                                                "connection",
                                                                []));
                                                              (Env.FParamSimple (
                                                                 "string", 
                                                                 []));
                                                              (Env.FParamPoly
                                                                 "'a");
                                                              (Env.FParamPoly
                                                                 "'b");
                                                              (Env.FParamPoly
                                                                 "'c")
                                                              ]
                                                            ))));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 13)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []))
                                                              ]
                                                            ))));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 11)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ]
                                                            ))));
                                                     (("send", 0),
                                                      (Env.ExtSyscall
                                                         (Env.DesSMFunTyped (
                                                            [("c", 9);
                                                              ("v", 10)],
                                                            [(Env.FParamChannel
                                                                [(Env.FParamPoly
                                                                    "'a")
                                                                  ]);
                                                              (Env.FParamPoly
                                                                 "'a");
                                                              (Env.FParamSimple (
                                                                 "unit", 
                                                                 []))
                                                              ]
                                                            ))));
                                                     (("verify", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "signature",
                                                                []));
                                                              (Env.FParamSimple (
                                                                 "image", 
                                                                 []));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                              ])));
                                                     (("true", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                              ])));
                                                     (("snd", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ])));
                                                     (("fst", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamProduct (
                                                                (Env.FParamPoly
                                                                   "'a"),
                                                                (Env.FParamPoly
                                                                   "'b")
                                                                ));
                                                              (Env.FParamPoly
                                                                 "'a")
                                                              ])));
                                                     (("sign", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "client_img",
                                                                "image", 
                                                                []));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ])));
                                                     (("sdec", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("senc", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "symkey_client_ta",
                                                                 "symkey",
                                                                 [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                   ]
                                                                 ));
                                                              (Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("vk", 0),
                                                      (Env.ExtFun
                                                         (Env.DesugaredTypeSig
                                                            [(Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                              (Env.FParamSecurity (
                                                                 "ver_key_server",
                                                                 "verkey",
                                                                 [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                              ])));
                                                     (("rpc_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "string",
                                                                   [])),
                                                                (Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                )),
                                                             (Env.TySimple (
                                                                "string", 
                                                                []))
                                                             ));
                                                           (Env.TySecurity (
                                                              "client_ta_sig",
                                                              "signature", 
                                                              []))
                                                           ]));
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef
                                                         [(Env.TyProduct (
                                                             (Env.TySimple (
                                                                "image", 
                                                                [])),
                                                             (Env.TySimple (
                                                                "signature",
                                                                []))
                                                             ))
                                                           ]));
                                                     (("ver_key_server", 0),
                                                      (Env.SecurityTypeDef (
                                                         "verkey",
                                                         [(Env.TySimple (
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("conn_client", 0),
                                                      (Env.SecurityTypeDef (
                                                         "connection", 
                                                         [])));
                                                     (("symkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "symkey",
                                                         [(Env.TySimple (
                                                             "cipher",
                                                             [(Env.TySecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ))
                                                               ]
                                                             ))
                                                           ]
                                                         )));
                                                     (("sigkey_client_ta", 0),
                                                      (Env.SecurityTypeDef (
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         )));
                                                     (("client_ta_sig", 0),
                                                      (Env.SecurityTypeDef (
                                                         "signature", 
                                                         [])));
                                                     (("client_img", 0),
                                                      (Env.SecurityTypeDef (
                                                         "image", [])));
                                                     (("client_ta_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("server_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("cipher", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("hash", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("verkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("sigkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("symkey", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("list", 0),
                                                      (Env.SimpleTypeDef
                                                         ["'a"]));
                                                     (("filedescr", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("image", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("signature", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("connection", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("string", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("bool", 0),
                                                      (Env.SimpleTypeDef []));
                                                     (("unit", 0),
                                                      (Env.SimpleTypeDef []))
                                                     ];
                                                   facts =
                                                   ref ([("False",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("ImgRecvInvalid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("ImgRecvValid",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("recv_verify_loop", 0);
           fun_sig =
           (Env.DesSMFunTyped ([("ch_net", 24); ("pubkey", 25)],
              [(Env.FParamChannel
                  [(Env.FParamProduct ((Env.FParamSimple ("image", [])),
                      (Env.FParamSimple ("signature", []))))
                    ]);
                (Env.FParamSecurity ("ver_key_server", "verkey",
                   [(Env.TySimple ("image", []))]));
                (Env.FParamSimple ("unit", []))]
              ));
           cmd =
           { desc = (Typed.While (
                       [{ Typed.fresh = []; facts = [];
                          cmd =
                          { desc = (Typed.Let (("sig_img_pair", 26),
                                      { desc = (Typed.Apply (("recv", 0),
                                                  [{ desc = Typed.Ident {
                                                              id =
                                                              ("ch_net", 24);
                                                              desc =
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    24));
                                                              param = None}; env = 
                                                    { Env.vars =
                                                      [(("pubkey", 25),
                                                        (Env.Var
                                                           (Syntax.Loc 25)));
                                                        (("ch_net", 24),
                                                         (Env.Var
                                                            (Syntax.Loc 24)));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 23)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                 ]
                                                               ))));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("cid", 21)],
                                                               [(Env.FParamSecurity (
                                                                   "conn_client",
                                                                   "connection",
                                                                   []));
                                                                 (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                 ]
                                                               ))));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("cid", 15);
                                                                 ("f", 16);
                                                                 ("arg1", 17);
                                                                 ("arg2", 18)
                                                                 ],
                                                               [(Env.FParamSecurity (
                                                                   "conn_client",
                                                                   "connection",
                                                                   []));
                                                                 (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                 (Env.FParamPoly
                                                                    "'a");
                                                                 (Env.FParamPoly
                                                                    "'b");
                                                                 (Env.FParamPoly
                                                                    "'c")
                                                                 ]
                                                               ))));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 13)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))
                                                                 ]
                                                               ))));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 11)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamPoly
                                                                    "'a")
                                                                 ]
                                                               ))));
                                                        (("send", 0),
                                                         (Env.ExtSyscall
                                                            (Env.DesSMFunTyped (
                                                               [("c", 9);
                                                                 ("v", 10)],
                                                               [(Env.FParamChannel
                                                                   [(Env.FParamPoly
                                                                    "'a")]);
                                                                 (Env.FParamPoly
                                                                    "'a");
                                                                 (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                 ]
                                                               ))));
                                                        (("verify", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "signature",
                                                                   []));
                                                                 (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                 (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                 (Env.FParamSimple (
                                                                    "bool",
                                                                    []))
                                                                 ])));
                                                        (("true", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "bool", 
                                                                   []))
                                                                 ])));
                                                        (("snd", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamProduct (
                                                                   (Env.FParamPoly
                                                                    "'a"),
                                                                   (Env.FParamPoly
                                                                    "'b")
                                                                   ));
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ])));
                                                        (("fst", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamProduct (
                                                                   (Env.FParamPoly
                                                                    "'a"),
                                                                   (Env.FParamPoly
                                                                    "'b")
                                                                   ));
                                                                 (Env.FParamPoly
                                                                    "'a")
                                                                 ])));
                                                        (("sign", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []));
                                                                 (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                 (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))
                                                                 ])));
                                                        (("sdec", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSimple (
                                                                   "cipher",
                                                                   [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                 (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                 ])));
                                                        (("senc", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                 (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                 ])));
                                                        (("vk", 0),
                                                         (Env.ExtFun
                                                            (Env.DesugaredTypeSig
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ));
                                                                 (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))
                                                                 ])));
                                                        (("rpc_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyProduct (
                                                                (Env.TyProduct (
                                                                   (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                   (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   )),
                                                                (Env.TySimple (
                                                                   "string",
                                                                   []))
                                                                ));
                                                              (Env.TySecurity (
                                                                 "client_ta_sig",
                                                                 "signature",
                                                                 []))
                                                              ]));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef
                                                            [(Env.TyProduct (
                                                                (Env.TySimple (
                                                                   "image",
                                                                   [])),
                                                                (Env.TySimple (
                                                                   "signature",
                                                                   []))
                                                                ))
                                                              ]));
                                                        (("ver_key_server", 0),
                                                         (Env.SecurityTypeDef (
                                                            "verkey",
                                                            [(Env.TySimple (
                                                                "image", 
                                                                []))
                                                              ]
                                                            )));
                                                        (("conn_client", 0),
                                                         (Env.SecurityTypeDef (
                                                            "connection", 
                                                            [])));
                                                        (("symkey_client_ta",
                                                          0),
                                                         (Env.SecurityTypeDef (
                                                            "symkey",
                                                            [(Env.TySimple (
                                                                "cipher",
                                                                [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ))
                                                              ]
                                                            )));
                                                        (("sigkey_client_ta",
                                                          0),
                                                         (Env.SecurityTypeDef (
                                                            "sigkey",
                                                            [(Env.TySecurity (
                                                                "client_img",
                                                                "image", 
                                                                []))
                                                              ]
                                                            )));
                                                        (("client_ta_sig", 0),
                                                         (Env.SecurityTypeDef (
                                                            "signature", 
                                                            [])));
                                                        (("client_img", 0),
                                                         (Env.SecurityTypeDef (
                                                            "image", 
                                                            [])));
                                                        (("client_ta_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("client_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("server_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("cipher", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("hash", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("verkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("sigkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("symkey", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("list", 0),
                                                         (Env.SimpleTypeDef
                                                            ["'a"]));
                                                        (("filedescr", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("image", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("signature", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("connection", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("string", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("bool", 0),
                                                         (Env.SimpleTypeDef
                                                            []));
                                                        (("unit", 0),
                                                         (Env.SimpleTypeDef
                                                            []))
                                                        ];
                                                      facts =
                                                      ref ([("False",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("ImgRecvInvalid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("ImgRecvValid",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ]
                                                  )); env = { Env.vars =
                                                              [(("pubkey", 25),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    25)));
                                                                (("ch_net",
                                                                  24),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    24)));
                                                                (("accept_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                (("close_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                (("invoke_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                (("connect_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                (("recv", 0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                (("send", 0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                (("verify", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                (("true", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                (("snd", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                (("fst", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                (("sign", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                (("sdec", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                (("senc", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                (("vk", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                (("rpc_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                (("udp_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                (("ver_key_server",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                (("conn_client",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                (("symkey_client_ta",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                (("sigkey_client_ta",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                (("client_ta_sig",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                (("client_img",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                (("client_ta_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("client_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("server_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("readonly_t",
                                                                  0),
                                                                 Env.FilesysTypeDef);
                                                                (("cipher", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("hash", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("verkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("sigkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("symkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("list", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("filedescr",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("image", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("signature",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("connection",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("string", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("bool", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("unit", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []))
                                                                ];
                                                              facts =
                                                              ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } },
                                      { desc = (Typed.Let (("res", 27),
                                                  { desc = (Typed.Apply (
                                                              ("verify", 0),
                                                              [{ desc = (
                                                                Typed.Apply (
                                                                  ("fst", 0),
                                                                  [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig_img_pair",
                                                                    26);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    26));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                  )); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    (
                                                                    (
                                                                    "pubkey",
                                                                    25),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    24),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "sdec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "senc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    (
                                                                    (
                                                                    "ver_key_server",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_img",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "cipher",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "hash", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "symkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "list", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "filedescr",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } };
                                                                { desc = (
                                                                Typed.Apply (
                                                                  ("snd", 0),
                                                                  [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig_img_pair",
                                                                    26);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    26));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                  )); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    (
                                                                    (
                                                                    "pubkey",
                                                                    25),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    24),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "sdec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "senc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    (
                                                                    (
                                                                    "ver_key_server",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_img",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "cipher",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "hash", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "symkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "list", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "filedescr",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } };
                                                                { desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("pubkey",
                                                                   25);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    25));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    (
                                                                    (
                                                                    "pubkey",
                                                                    25),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    24),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "sdec", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "senc", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "vk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    (
                                                                    (
                                                                    "rpc_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    (
                                                                    (
                                                                    "ver_key_server",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "conn_client",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    (
                                                                    (
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    (
                                                                    (
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_img",
                                                                    0),
                                                                    (
                                                                    Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    (
                                                                    (
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "cipher",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "hash", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "verkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "sigkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "symkey",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "list", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    (
                                                                    (
                                                                    "filedescr",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "image",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "signature",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "connection",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "string",
                                                                    0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "bool", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "unit", 0),
                                                                    (
                                                                    Env.SimpleTypeDef
                                                                    []))];
                                                                  facts =
                                                                  ref (
                                                                  [("False",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "ImgRecvInvalid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "ImgRecvValid",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ]
                                                              )); env = 
                                                  { Env.vars =
                                                    [(("sig_img_pair", 26),
                                                      (Env.Var
                                                         (Syntax.Loc 26)));
                                                      (("pubkey", 25),
                                                       (Env.Var
                                                          (Syntax.Loc 25)));
                                                      (("ch_net", 24),
                                                       (Env.Var
                                                          (Syntax.Loc 24)));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 23)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 21)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 15);
                                                               ("f", 16);
                                                               ("arg1", 17);
                                                               ("arg2", 18)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "string",
                                                                  []));
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamPoly
                                                                  "'b");
                                                               (Env.FParamPoly
                                                                  "'c")
                                                               ]
                                                             ))));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 13)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamSecurity (
                                                                  "conn_client",
                                                                  "connection",
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 11)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ]
                                                             ))));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } },
                                                  { desc = (Typed.Case
                                                              [{ Typed.fresh =
                                                                 [];
                                                                 facts =
                                                                 [{ desc = (
                                                                   Typed.Eq (
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 27);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    27));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))]));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   ];
                                                                 cmd =
                                                                 { desc = (
                                                                 Typed.Event
                                                                   [{ desc = (
                                                                    Typed.Global (
                                                                    "ImgRecvValid",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("snd", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig_img_pair",
                                                                    26);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    26));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                   facts =
                                                                   ref (
                                                                   [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 };
                                                                { Typed.fresh =
                                                                  [];
                                                                  facts =
                                                                  [{ desc = (
                                                                    Typed.Neq (
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 27);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    27));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    (
                                                                    Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))]));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } })); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }];
                                                                  cmd =
                                                                  { desc = (
                                                                  Typed.Event
                                                                    [{ desc = (
                                                                    Typed.Global (
                                                                    "ImgRecvInvalid",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("snd", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig_img_pair",
                                                                    26);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    26));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "res", 27),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    27)));
                                                                    ((
                                                                    "sig_img_pair",
                                                                    26),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    26)));
                                                                    ((
                                                                    "pubkey",
                                                                    25),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    25)));
                                                                    ((
                                                                    "ch_net",
                                                                    24),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    24)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    (Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "true", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                    ((
                                                                    "sdec", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "senc", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "vk", 0),
                                                                    (Env.ExtFun
                                                                    (Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                    ((
                                                                    "rpc_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                    ((
                                                                    "ver_key_server",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "conn_client",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                    ((
                                                                    "symkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                    ((
                                                                    "sigkey_client_ta",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                    ((
                                                                    "client_ta_sig",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                    ((
                                                                    "client_img",
                                                                    0),
                                                                    (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                    ((
                                                                    "client_ta_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "server_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "cipher",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "hash", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "verkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "sigkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "symkey",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "list", 0),
                                                                    (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                    ((
                                                                    "filedescr",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "image",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "signature",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "connection",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "string",
                                                                    0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "bool", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []));
                                                                    ((
                                                                    "unit", 0),
                                                                    (Env.SimpleTypeDef
                                                                    []))];
                                                                    facts =
                                                                    ref (
                                                                    [("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  }
                                                                ]); env = 
                                                  { Env.vars =
                                                    [(("res", 27),
                                                      (Env.Var
                                                         (Syntax.Loc 27)));
                                                      (("sig_img_pair", 26),
                                                       (Env.Var
                                                          (Syntax.Loc 26)));
                                                      (("pubkey", 25),
                                                       (Env.Var
                                                          (Syntax.Loc 25)));
                                                      (("ch_net", 24),
                                                       (Env.Var
                                                          (Syntax.Loc 24)));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 23)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 21)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("cid", 15);
                                                               ("f", 16);
                                                               ("arg1", 17);
                                                               ("arg2", 18)],
                                                             [(Env.FParamSecurity (
                                                                 "conn_client",
                                                                 "connection",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "string",
                                                                  []));
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamPoly
                                                                  "'b");
                                                               (Env.FParamPoly
                                                                  "'c")
                                                               ]
                                                             ))));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 13)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamSecurity (
                                                                  "conn_client",
                                                                  "connection",
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 11)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ]
                                                             ))));
                                                      (("send", 0),
                                                       (Env.ExtSyscall
                                                          (Env.DesSMFunTyped (
                                                             [("c", 9);
                                                               ("v", 10)],
                                                             [(Env.FParamChannel
                                                                 [(Env.FParamPoly
                                                                    "'a")
                                                                   ]);
                                                               (Env.FParamPoly
                                                                  "'a");
                                                               (Env.FParamSimple (
                                                                  "unit", 
                                                                  []))
                                                               ]
                                                             ))));
                                                      (("verify", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "signature",
                                                                 []));
                                                               (Env.FParamSimple (
                                                                  "image", 
                                                                  []));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "bool", 
                                                                  []))
                                                               ])));
                                                      (("true", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "bool", 
                                                                 []))
                                                               ])));
                                                      (("snd", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ])));
                                                      (("fst", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamProduct (
                                                                 (Env.FParamPoly
                                                                    "'a"),
                                                                 (Env.FParamPoly
                                                                    "'b")
                                                                 ));
                                                               (Env.FParamPoly
                                                                  "'a")
                                                               ])));
                                                      (("sign", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ])));
                                                      (("sdec", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSimple (
                                                                 "cipher",
                                                                 [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("senc", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "symkey_client_ta",
                                                                  "symkey",
                                                                  [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]
                                                                  ));
                                                               (Env.FParamSimple (
                                                                  "cipher",
                                                                  [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                  ))
                                                               ])));
                                                      (("vk", 0),
                                                       (Env.ExtFun
                                                          (Env.DesugaredTypeSig
                                                             [(Env.FParamSecurity (
                                                                 "sigkey_client_ta",
                                                                 "sigkey",
                                                                 [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                   ]
                                                                 ));
                                                               (Env.FParamSecurity (
                                                                  "ver_key_server",
                                                                  "verkey",
                                                                  [(Env.TySimple (
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                               ])));
                                                      (("rpc_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                 (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                 )),
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 []))
                                                              ));
                                                            (Env.TySecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ]));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef
                                                          [(Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "image", 
                                                                 [])),
                                                              (Env.TySimple (
                                                                 "signature",
                                                                 []))
                                                              ))
                                                            ]));
                                                      (("ver_key_server", 0),
                                                       (Env.SecurityTypeDef (
                                                          "verkey",
                                                          [(Env.TySimple (
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("conn_client", 0),
                                                       (Env.SecurityTypeDef (
                                                          "connection", 
                                                          [])));
                                                      (("symkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "symkey",
                                                          [(Env.TySimple (
                                                              "cipher",
                                                              [(Env.TySecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ))
                                                            ]
                                                          )));
                                                      (("sigkey_client_ta", 0),
                                                       (Env.SecurityTypeDef (
                                                          "sigkey",
                                                          [(Env.TySecurity (
                                                              "client_img",
                                                              "image", 
                                                              []))
                                                            ]
                                                          )));
                                                      (("client_ta_sig", 0),
                                                       (Env.SecurityTypeDef (
                                                          "signature", 
                                                          [])));
                                                      (("client_img", 0),
                                                       (Env.SecurityTypeDef (
                                                          "image", [])));
                                                      (("client_ta_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("server_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("cipher", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("hash", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("verkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("sigkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("symkey", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("list", 0),
                                                       (Env.SimpleTypeDef
                                                          ["'a"]));
                                                      (("filedescr", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("image", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("signature", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("connection", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("string", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("bool", 0),
                                                       (Env.SimpleTypeDef []));
                                                      (("unit", 0),
                                                       (Env.SimpleTypeDef []))
                                                      ];
                                                    facts =
                                                    ref ([("False",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("ImgRecvInvalid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("ImgRecvValid",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  )); env = { Env.vars =
                                                              [(("sig_img_pair",
                                                                 26),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    26)));
                                                                (("pubkey",
                                                                  25),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    25)));
                                                                (("ch_net",
                                                                  24),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    24)));
                                                                (("accept_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 23)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                (("close_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    21)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                (("invoke_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("cid",
                                                                    15);
                                                                    ("f", 16);
                                                                    ("arg1",
                                                                    17);
                                                                    ("arg2",
                                                                    18)],
                                                                    [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamPoly
                                                                    "'b");
                                                                    (Env.FParamPoly
                                                                    "'c")]))));
                                                                (("connect_rpc",
                                                                  0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 13)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))]))));
                                                                (("recv", 0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 11)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a")]))));
                                                                (("send", 0),
                                                                 (Env.ExtSyscall
                                                                    (
                                                                    Env.DesSMFunTyped (
                                                                    [("c", 9);
                                                                    ("v", 10)
                                                                    ],
                                                                    [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                    (Env.FParamPoly
                                                                    "'a");
                                                                    (Env.FParamSimple (
                                                                    "unit",
                                                                    []))]))));
                                                                (("verify", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                    (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                (("true", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))])));
                                                                (("snd", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'b")])));
                                                                (("fst", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamProduct (
                                                                    (Env.FParamPoly
                                                                    "'a"),
                                                                    (Env.FParamPoly
                                                                    "'b")));
                                                                    (Env.FParamPoly
                                                                    "'a")])));
                                                                (("sign", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))])));
                                                                (("sdec", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))])));
                                                                (("senc", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                    (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                (("vk", 0),
                                                                 (Env.ExtFun
                                                                    (
                                                                    Env.DesugaredTypeSig
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                    (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))])));
                                                                (("rpc_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                    (Env.TySimple (
                                                                    "string",
                                                                    []))));
                                                                    (Env.TySecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))]));
                                                                (("udp_t", 0),
                                                                 (Env.ChanTypeDef
                                                                    [(Env.TyProduct (
                                                                    (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                    (Env.TySimple (
                                                                    "signature",
                                                                    []))))]));
                                                                (("ver_key_server",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))])));
                                                                (("conn_client",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "connection",
                                                                    [])));
                                                                (("symkey_client_ta",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))])));
                                                                (("sigkey_client_ta",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))])));
                                                                (("client_ta_sig",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "signature",
                                                                    [])));
                                                                (("client_img",
                                                                  0),
                                                                 (Env.SecurityTypeDef (
                                                                    "image",
                                                                    [])));
                                                                (("client_ta_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("client_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("server_t",
                                                                  0),
                                                                 Env.ProcTypeDef);
                                                                (("readonly_t",
                                                                  0),
                                                                 Env.FilesysTypeDef);
                                                                (("cipher", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("hash", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("verkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("sigkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("symkey", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("list", 0),
                                                                 (Env.SimpleTypeDef
                                                                    ["'a"]));
                                                                (("filedescr",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("image", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("signature",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("connection",
                                                                  0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("string", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("bool", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []));
                                                                (("unit", 0),
                                                                 (Env.SimpleTypeDef
                                                                    []))
                                                                ];
                                                              facts =
                                                              ref ([("False",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("ImgRecvInvalid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("ImgRecvValid",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } }
                                      )); env = { Env.vars =
                                                  [(("pubkey", 25),
                                                    (Env.Var (Syntax.Loc 25)));
                                                    (("ch_net", 24),
                                                     (Env.Var (Syntax.Loc 24)));
                                                    (("accept_rpc", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("c", 23)],
                                                           [(Env.FParamChannel
                                                               [(Env.FParamPoly
                                                                   "'a")
                                                                 ]);
                                                             (Env.FParamSimple (
                                                                "unit", 
                                                                []))
                                                             ]
                                                           ))));
                                                    (("close_rpc", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("cid", 21)],
                                                           [(Env.FParamSecurity (
                                                               "conn_client",
                                                               "connection",
                                                               []));
                                                             (Env.FParamSimple (
                                                                "unit", 
                                                                []))
                                                             ]
                                                           ))));
                                                    (("invoke_rpc", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("cid", 15);
                                                             ("f", 16);
                                                             ("arg1", 17);
                                                             ("arg2", 18)],
                                                           [(Env.FParamSecurity (
                                                               "conn_client",
                                                               "connection",
                                                               []));
                                                             (Env.FParamSimple (
                                                                "string", 
                                                                []));
                                                             (Env.FParamPoly
                                                                "'a");
                                                             (Env.FParamPoly
                                                                "'b");
                                                             (Env.FParamPoly
                                                                "'c")
                                                             ]
                                                           ))));
                                                    (("connect_rpc", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("c", 13)],
                                                           [(Env.FParamChannel
                                                               [(Env.FParamPoly
                                                                   "'a")
                                                                 ]);
                                                             (Env.FParamSecurity (
                                                                "conn_client",
                                                                "connection",
                                                                []))
                                                             ]
                                                           ))));
                                                    (("recv", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("c", 11)],
                                                           [(Env.FParamChannel
                                                               [(Env.FParamPoly
                                                                   "'a")
                                                                 ]);
                                                             (Env.FParamPoly
                                                                "'a")
                                                             ]
                                                           ))));
                                                    (("send", 0),
                                                     (Env.ExtSyscall
                                                        (Env.DesSMFunTyped (
                                                           [("c", 9);
                                                             ("v", 10)],
                                                           [(Env.FParamChannel
                                                               [(Env.FParamPoly
                                                                   "'a")
                                                                 ]);
                                                             (Env.FParamPoly
                                                                "'a");
                                                             (Env.FParamSimple (
                                                                "unit", 
                                                                []))
                                                             ]
                                                           ))));
                                                    (("verify", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSimple (
                                                               "signature",
                                                               []));
                                                             (Env.FParamSimple (
                                                                "image", 
                                                                []));
                                                             (Env.FParamSecurity (
                                                                "ver_key_server",
                                                                "verkey",
                                                                [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                             (Env.FParamSimple (
                                                                "bool", 
                                                                []))
                                                             ])));
                                                    (("true", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                             ])));
                                                    (("snd", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamProduct (
                                                               (Env.FParamPoly
                                                                  "'a"),
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ));
                                                             (Env.FParamPoly
                                                                "'b")
                                                             ])));
                                                    (("fst", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamProduct (
                                                               (Env.FParamPoly
                                                                  "'a"),
                                                               (Env.FParamPoly
                                                                  "'b")
                                                               ));
                                                             (Env.FParamPoly
                                                                "'a")
                                                             ])));
                                                    (("sign", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSecurity (
                                                               "client_img",
                                                               "image", 
                                                               []));
                                                             (Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ));
                                                             (Env.FParamSecurity (
                                                                "client_ta_sig",
                                                                "signature",
                                                                []))
                                                             ])));
                                                    (("sdec", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ));
                                                             (Env.FParamSecurity (
                                                                "symkey_client_ta",
                                                                "symkey",
                                                                [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                  ]
                                                                ));
                                                             (Env.FParamSecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                             ])));
                                                    (("senc", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                             (Env.FParamSecurity (
                                                                "symkey_client_ta",
                                                                "symkey",
                                                                [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                  ]
                                                                ));
                                                             (Env.FParamSimple (
                                                                "cipher",
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ]
                                                                ))
                                                             ])));
                                                    (("vk", 0),
                                                     (Env.ExtFun
                                                        (Env.DesugaredTypeSig
                                                           [(Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                             (Env.FParamSecurity (
                                                                "ver_key_server",
                                                                "verkey",
                                                                [(Env.TySimple (
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                             ])));
                                                    (("rpc_t", 0),
                                                     (Env.ChanTypeDef
                                                        [(Env.TyProduct (
                                                            (Env.TyProduct (
                                                               (Env.TySimple (
                                                                  "string",
                                                                  [])),
                                                               (Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                               )),
                                                            (Env.TySimple (
                                                               "string", 
                                                               []))
                                                            ));
                                                          (Env.TySecurity (
                                                             "client_ta_sig",
                                                             "signature", 
                                                             []))
                                                          ]));
                                                    (("udp_t", 0),
                                                     (Env.ChanTypeDef
                                                        [(Env.TyProduct (
                                                            (Env.TySimple (
                                                               "image", 
                                                               [])),
                                                            (Env.TySimple (
                                                               "signature",
                                                               []))
                                                            ))
                                                          ]));
                                                    (("ver_key_server", 0),
                                                     (Env.SecurityTypeDef (
                                                        "verkey",
                                                        [(Env.TySimple (
                                                            "image", 
                                                            []))
                                                          ]
                                                        )));
                                                    (("conn_client", 0),
                                                     (Env.SecurityTypeDef (
                                                        "connection", 
                                                        [])));
                                                    (("symkey_client_ta", 0),
                                                     (Env.SecurityTypeDef (
                                                        "symkey",
                                                        [(Env.TySimple (
                                                            "cipher",
                                                            [(Env.TySecurity (
                                                                "sigkey_client_ta",
                                                                "sigkey",
                                                                [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))
                                                                  ]
                                                                ))
                                                              ]
                                                            ))
                                                          ]
                                                        )));
                                                    (("sigkey_client_ta", 0),
                                                     (Env.SecurityTypeDef (
                                                        "sigkey",
                                                        [(Env.TySecurity (
                                                            "client_img",
                                                            "image", 
                                                            []))
                                                          ]
                                                        )));
                                                    (("client_ta_sig", 0),
                                                     (Env.SecurityTypeDef (
                                                        "signature", 
                                                        [])));
                                                    (("client_img", 0),
                                                     (Env.SecurityTypeDef (
                                                        "image", [])));
                                                    (("client_ta_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("client_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("server_t", 0),
                                                     Env.ProcTypeDef);
                                                    (("readonly_t", 0),
                                                     Env.FilesysTypeDef);
                                                    (("cipher", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("hash", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("verkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("sigkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("symkey", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("list", 0),
                                                     (Env.SimpleTypeDef
                                                        ["'a"]));
                                                    (("filedescr", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("image", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("signature", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("connection", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("string", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("bool", 0),
                                                     (Env.SimpleTypeDef []));
                                                    (("unit", 0),
                                                     (Env.SimpleTypeDef []))
                                                    ];
                                                  facts =
                                                  ref ([("False",
                                                         (Env.Global,
                                                          (Some 0)));
                                                         ("ImgRecvInvalid",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("ImgRecvValid",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("Returned",
                                                          (Env.Channel,
                                                           (Some 1)));
                                                         ("invoke",
                                                          (Env.Channel,
                                                           (Some 3)));
                                                         ("conn",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("chid",
                                                          (Env.Structure,
                                                           (Some 1)));
                                                         ("ack",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("req",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("store",
                                                          (Env.Channel,
                                                           (Some 1)))
                                                         ])
                                                  } }
                          }
                         ],
                       [{ Typed.fresh = [];
                          facts =
                          [{ desc = (Typed.Global ("False", [])); env = 
                            { Env.vars =
                              [(("pubkey", 25), (Env.Var (Syntax.Loc 25)));
                                (("ch_net", 24), (Env.Var (Syntax.Loc 24)));
                                (("accept_rpc", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped ([("c", 23)],
                                       [(Env.FParamChannel
                                           [(Env.FParamPoly "'a")]);
                                         (Env.FParamSimple ("unit", []))]
                                       ))));
                                (("close_rpc", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped ([("cid", 21)],
                                       [(Env.FParamSecurity ("conn_client",
                                           "connection", []));
                                         (Env.FParamSimple ("unit", []))]
                                       ))));
                                (("invoke_rpc", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped (
                                       [("cid", 15); ("f", 16); ("arg1", 17);
                                         ("arg2", 18)],
                                       [(Env.FParamSecurity ("conn_client",
                                           "connection", []));
                                         (Env.FParamSimple ("string", []));
                                         (Env.FParamPoly "'a");
                                         (Env.FParamPoly "'b");
                                         (Env.FParamPoly "'c")]
                                       ))));
                                (("connect_rpc", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped ([("c", 13)],
                                       [(Env.FParamChannel
                                           [(Env.FParamPoly "'a")]);
                                         (Env.FParamSecurity ("conn_client",
                                            "connection", []))
                                         ]
                                       ))));
                                (("recv", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped ([("c", 11)],
                                       [(Env.FParamChannel
                                           [(Env.FParamPoly "'a")]);
                                         (Env.FParamPoly "'a")]
                                       ))));
                                (("send", 0),
                                 (Env.ExtSyscall
                                    (Env.DesSMFunTyped (
                                       [("c", 9); ("v", 10)],
                                       [(Env.FParamChannel
                                           [(Env.FParamPoly "'a")]);
                                         (Env.FParamPoly "'a");
                                         (Env.FParamSimple ("unit", []))]
                                       ))));
                                (("verify", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSimple ("signature", []));
                                         (Env.FParamSimple ("image", []));
                                         (Env.FParamSecurity (
                                            "ver_key_server", "verkey",
                                            [(Env.TySimple ("image", []))]));
                                         (Env.FParamSimple ("bool", []))])));
                                (("true", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSimple ("bool", []))])));
                                (("snd", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamProduct (
                                           (Env.FParamPoly "'a"),
                                           (Env.FParamPoly "'b")));
                                         (Env.FParamPoly "'b")])));
                                (("fst", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamProduct (
                                           (Env.FParamPoly "'a"),
                                           (Env.FParamPoly "'b")));
                                         (Env.FParamPoly "'a")])));
                                (("sign", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSecurity ("client_img",
                                           "image", []));
                                         (Env.FParamSecurity (
                                            "sigkey_client_ta", "sigkey",
                                            [(Env.TySecurity ("client_img",
                                                "image", []))
                                              ]
                                            ));
                                         (Env.FParamSecurity (
                                            "client_ta_sig", "signature", 
                                            []))
                                         ])));
                                (("sdec", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSimple ("cipher",
                                           [(Env.FParamSecurity (
                                               "sigkey_client_ta", "sigkey",
                                               [(Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                 ]
                                               ))
                                             ]
                                           ));
                                         (Env.FParamSecurity (
                                            "symkey_client_ta", "symkey",
                                            [(Env.TySimple ("cipher",
                                                [(Env.TySecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ))
                                              ]
                                            ));
                                         (Env.FParamSecurity (
                                            "sigkey_client_ta", "sigkey",
                                            [(Env.TySecurity ("client_img",
                                                "image", []))
                                              ]
                                            ))
                                         ])));
                                (("senc", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSecurity (
                                           "sigkey_client_ta", "sigkey",
                                           [(Env.TySecurity ("client_img",
                                               "image", []))
                                             ]
                                           ));
                                         (Env.FParamSecurity (
                                            "symkey_client_ta", "symkey",
                                            [(Env.TySimple ("cipher",
                                                [(Env.TySecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ))
                                              ]
                                            ));
                                         (Env.FParamSimple ("cipher",
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ))
                                              ]
                                            ))
                                         ])));
                                (("vk", 0),
                                 (Env.ExtFun
                                    (Env.DesugaredTypeSig
                                       [(Env.FParamSecurity (
                                           "sigkey_client_ta", "sigkey",
                                           [(Env.TySecurity ("client_img",
                                               "image", []))
                                             ]
                                           ));
                                         (Env.FParamSecurity (
                                            "ver_key_server", "verkey",
                                            [(Env.TySimple ("image", []))]))
                                         ])));
                                (("rpc_t", 0),
                                 (Env.ChanTypeDef
                                    [(Env.TyProduct (
                                        (Env.TyProduct (
                                           (Env.TySimple ("string", [])),
                                           (Env.TySecurity ("client_img",
                                              "image", []))
                                           )),
                                        (Env.TySimple ("string", []))));
                                      (Env.TySecurity ("client_ta_sig",
                                         "signature", []))
                                      ]));
                                (("udp_t", 0),
                                 (Env.ChanTypeDef
                                    [(Env.TyProduct (
                                        (Env.TySimple ("image", [])),
                                        (Env.TySimple ("signature", []))))
                                      ]));
                                (("ver_key_server", 0),
                                 (Env.SecurityTypeDef ("verkey",
                                    [(Env.TySimple ("image", []))])));
                                (("conn_client", 0),
                                 (Env.SecurityTypeDef ("connection", [])));
                                (("symkey_client_ta", 0),
                                 (Env.SecurityTypeDef ("symkey",
                                    [(Env.TySimple ("cipher",
                                        [(Env.TySecurity ("sigkey_client_ta",
                                            "sigkey",
                                            [(Env.TySecurity ("client_img",
                                                "image", []))
                                              ]
                                            ))
                                          ]
                                        ))
                                      ]
                                    )));
                                (("sigkey_client_ta", 0),
                                 (Env.SecurityTypeDef ("sigkey",
                                    [(Env.TySecurity ("client_img", "image",
                                        []))
                                      ]
                                    )));
                                (("client_ta_sig", 0),
                                 (Env.SecurityTypeDef ("signature", [])));
                                (("client_img", 0),
                                 (Env.SecurityTypeDef ("image", [])));
                                (("client_ta_t", 0), Env.ProcTypeDef);
                                (("client_t", 0), Env.ProcTypeDef);
                                (("server_t", 0), Env.ProcTypeDef);
                                (("readonly_t", 0), Env.FilesysTypeDef);
                                (("cipher", 0), (Env.SimpleTypeDef ["'a"]));
                                (("hash", 0), (Env.SimpleTypeDef []));
                                (("verkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("sigkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("symkey", 0), (Env.SimpleTypeDef ["'a"]));
                                (("list", 0), (Env.SimpleTypeDef ["'a"]));
                                (("filedescr", 0), (Env.SimpleTypeDef []));
                                (("image", 0), (Env.SimpleTypeDef []));
                                (("signature", 0), (Env.SimpleTypeDef []));
                                (("connection", 0), (Env.SimpleTypeDef []));
                                (("string", 0), (Env.SimpleTypeDef []));
                                (("bool", 0), (Env.SimpleTypeDef []));
                                (("unit", 0), (Env.SimpleTypeDef []))];
                              facts =
                              ref ([("False", (Env.Global, (Some 0)));
                                     ("ImgRecvInvalid",
                                      (Env.Global, (Some 1)));
                                     ("ImgRecvValid", (Env.Global, (Some 1)));
                                     ("exit", (Env.Channel, (Some 0)));
                                     ("Returned", (Env.Channel, (Some 1)));
                                     ("invoke", (Env.Channel, (Some 3)));
                                     ("conn", (Env.Channel, (Some 0)));
                                     ("chid", (Env.Structure, (Some 1)));
                                     ("ack", (Env.Channel, (Some 0)));
                                     ("req", (Env.Channel, (Some 0)));
                                     ("store", (Env.Channel, (Some 1)))])
                              } }
                            ];
                          cmd =
                          { desc = Typed.Skip; env = { Env.vars =
                                                       [(("pubkey", 25),
                                                         (Env.Var
                                                            (Syntax.Loc 25)));
                                                         (("ch_net", 24),
                                                          (Env.Var
                                                             (Syntax.Loc 24)));
                                                         (("accept_rpc", 0),
                                                          (Env.ExtSyscall
                                                             (Env.DesSMFunTyped (
                                                                [("c", 23)],
                                                                [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                  (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                  ]
                                                                ))));
                                                         (("close_rpc", 0),
                                                          (Env.ExtSyscall
                                                             (Env.DesSMFunTyped (
                                                                [("cid", 21)],
                                                                [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                  (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                  ]
                                                                ))));
                                                         (("invoke_rpc", 0),
                                                          (Env.ExtSyscall
                                                             (Env.DesSMFunTyped (
                                                                [("cid", 15);
                                                                  ("f", 16);
                                                                  ("arg1", 17);
                                                                  ("arg2", 18)
                                                                  ],
                                                                [(Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []));
                                                                  (Env.FParamSimple (
                                                                    "string",
                                                                    []));
                                                                  (Env.FParamPoly
                                                                    "'a");
                                                                  (Env.FParamPoly
                                                                    "'b");
                                                                  (Env.FParamPoly
                                                                    "'c")
                                                                  ]
                                                                ))));
                                                         (("connect_rpc", 0),
                                                          (Env.ExtSyscall
                                                             (Env.DesSMFunTyped (
                                                                [("c", 13)],
                                                                [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                  (Env.FParamSecurity (
                                                                    "conn_client",
                                                                    "connection",
                                                                    []))
                                                                  ]
                                                                ))));
                                                         (("recv", 0),
                                                          (Env.ExtSyscall
                                                             (Env.DesSMFunTyped (
                                                                [("c", 11)],
                                                                [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                  (Env.FParamPoly
                                                                    "'a")
                                                                  ]
                                                                ))));
                                                         (("send", 0),
                                                          (Env.ExtSyscall
                                                             (Env.DesSMFunTyped (
                                                                [("c", 9);
                                                                  ("v", 10)],
                                                                [(Env.FParamChannel
                                                                    [(Env.FParamPoly
                                                                    "'a")]);
                                                                  (Env.FParamPoly
                                                                    "'a");
                                                                  (Env.FParamSimple (
                                                                    "unit",
                                                                    []))
                                                                  ]
                                                                ))));
                                                         (("verify", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamSimple (
                                                                    "signature",
                                                                    []));
                                                                  (Env.FParamSimple (
                                                                    "image",
                                                                    []));
                                                                  (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]));
                                                                  (Env.FParamSimple (
                                                                    "bool",
                                                                    []))
                                                                  ])));
                                                         (("true", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamSimple (
                                                                    "bool",
                                                                    []))
                                                                  ])));
                                                         (("snd", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamProduct (
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a"),
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'b")));
                                                                  (Env.FParamPoly
                                                                    "'b")
                                                                  ])));
                                                         (("fst", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamProduct (
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'a"),
                                                                    (
                                                                    Env.FParamPoly
                                                                    "'b")));
                                                                  (Env.FParamPoly
                                                                    "'a")
                                                                  ])));
                                                         (("sign", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamSecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []));
                                                                  (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                  (Env.FParamSecurity (
                                                                    "client_ta_sig",
                                                                    "signature",
                                                                    []))
                                                                  ])));
                                                         (("sdec", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ));
                                                                  (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                  (Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                  ])));
                                                         (("senc", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                  (Env.FParamSecurity (
                                                                    "symkey_client_ta",
                                                                    "symkey",
                                                                    [(Env.TySimple (
                                                                    "cipher",
                                                                    [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))]));
                                                                  (Env.FParamSimple (
                                                                    "cipher",
                                                                    [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                    ))
                                                                  ])));
                                                         (("vk", 0),
                                                          (Env.ExtFun
                                                             (Env.DesugaredTypeSig
                                                                [(Env.FParamSecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]));
                                                                  (Env.FParamSecurity (
                                                                    "ver_key_server",
                                                                    "verkey",
                                                                    [(Env.TySimple (
                                                                    "image",
                                                                    []))]))
                                                                  ])));
                                                         (("rpc_t", 0),
                                                          (Env.ChanTypeDef
                                                             [(Env.TyProduct (
                                                                 (Env.TyProduct (
                                                                    (
                                                                    Env.TySimple (
                                                                    "string",
                                                                    [])),
                                                                    (
                                                                    Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    [])))),
                                                                 (Env.TySimple (
                                                                    "string",
                                                                    []))
                                                                 ));
                                                               (Env.TySecurity (
                                                                  "client_ta_sig",
                                                                  "signature",
                                                                  []))
                                                               ]));
                                                         (("udp_t", 0),
                                                          (Env.ChanTypeDef
                                                             [(Env.TyProduct (
                                                                 (Env.TySimple (
                                                                    "image",
                                                                    [])),
                                                                 (Env.TySimple (
                                                                    "signature",
                                                                    []))
                                                                 ))
                                                               ]));
                                                         (("ver_key_server",
                                                           0),
                                                          (Env.SecurityTypeDef (
                                                             "verkey",
                                                             [(Env.TySimple (
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             )));
                                                         (("conn_client", 0),
                                                          (Env.SecurityTypeDef (
                                                             "connection", 
                                                             [])));
                                                         (("symkey_client_ta",
                                                           0),
                                                          (Env.SecurityTypeDef (
                                                             "symkey",
                                                             [(Env.TySimple (
                                                                 "cipher",
                                                                 [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))
                                                                   ]
                                                                 ))
                                                               ]
                                                             )));
                                                         (("sigkey_client_ta",
                                                           0),
                                                          (Env.SecurityTypeDef (
                                                             "sigkey",
                                                             [(Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                               ]
                                                             )));
                                                         (("client_ta_sig", 0),
                                                          (Env.SecurityTypeDef (
                                                             "signature", 
                                                             [])));
                                                         (("client_img", 0),
                                                          (Env.SecurityTypeDef (
                                                             "image", 
                                                             [])));
                                                         (("client_ta_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("client_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("server_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("readonly_t", 0),
                                                          Env.FilesysTypeDef);
                                                         (("cipher", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("hash", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("verkey", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("sigkey", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("symkey", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("list", 0),
                                                          (Env.SimpleTypeDef
                                                             ["'a"]));
                                                         (("filedescr", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("image", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("signature", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("connection", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("string", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("bool", 0),
                                                          (Env.SimpleTypeDef
                                                             []));
                                                         (("unit", 0),
                                                          (Env.SimpleTypeDef
                                                             []))
                                                         ];
                                                       facts =
                                                       ref ([("False",
                                                              (Env.Global,
                                                               (Some 0)));
                                                              ("ImgRecvInvalid",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("ImgRecvValid",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("exit",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("Returned",
                                                               (Env.Channel,
                                                                (Some 1)));
                                                              ("invoke",
                                                               (Env.Channel,
                                                                (Some 3)));
                                                              ("conn",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("chid",
                                                               (Env.Structure,
                                                                (Some 1)));
                                                              ("ack",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("req",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("store",
                                                               (Env.Channel,
                                                                (Some 1)))
                                                              ])
                                                       } }
                          }
                         ]
                       )); env = { Env.vars =
                                   [(("pubkey", 25),
                                     (Env.Var (Syntax.Loc 25)));
                                     (("ch_net", 24),
                                      (Env.Var (Syntax.Loc 24)));
                                     (("accept_rpc", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 23)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamSimple ("unit", []))
                                              ]
                                            ))));
                                     (("close_rpc", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("cid", 21)],
                                            [(Env.FParamSecurity (
                                                "conn_client", "connection",
                                                []));
                                              (Env.FParamSimple ("unit", []))
                                              ]
                                            ))));
                                     (("invoke_rpc", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped (
                                            [("cid", 15); ("f", 16);
                                              ("arg1", 17); ("arg2", 18)],
                                            [(Env.FParamSecurity (
                                                "conn_client", "connection",
                                                []));
                                              (Env.FParamSimple ("string", 
                                                 []));
                                              (Env.FParamPoly "'a");
                                              (Env.FParamPoly "'b");
                                              (Env.FParamPoly "'c")]
                                            ))));
                                     (("connect_rpc", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 13)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamSecurity (
                                                 "conn_client", "connection",
                                                 []))
                                              ]
                                            ))));
                                     (("recv", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped ([("c", 11)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a")]
                                            ))));
                                     (("send", 0),
                                      (Env.ExtSyscall
                                         (Env.DesSMFunTyped (
                                            [("c", 9); ("v", 10)],
                                            [(Env.FParamChannel
                                                [(Env.FParamPoly "'a")]);
                                              (Env.FParamPoly "'a");
                                              (Env.FParamSimple ("unit", []))
                                              ]
                                            ))));
                                     (("verify", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("signature",
                                                []));
                                              (Env.FParamSimple ("image", 
                                                 []));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("bool", []))
                                              ])));
                                     (("true", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("bool", []))])));
                                     (("snd", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'b")])));
                                     (("fst", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamProduct (
                                                (Env.FParamPoly "'a"),
                                                (Env.FParamPoly "'b")));
                                              (Env.FParamPoly "'a")])));
                                     (("sign", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "client_img", "image", 
                                                []));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "client_ta_sig",
                                                 "signature", []))
                                              ])));
                                     (("sdec", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSimple ("cipher",
                                                [(Env.FParamSecurity (
                                                    "sigkey_client_ta",
                                                    "sigkey",
                                                    [(Env.TySecurity (
                                                        "client_img",
                                                        "image", []))
                                                      ]
                                                    ))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("senc", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "symkey_client_ta",
                                                 "symkey",
                                                 [(Env.TySimple ("cipher",
                                                     [(Env.TySecurity (
                                                         "sigkey_client_ta",
                                                         "sigkey",
                                                         [(Env.TySecurity (
                                                             "client_img",
                                                             "image", 
                                                             []))
                                                           ]
                                                         ))
                                                       ]
                                                     ))
                                                   ]
                                                 ));
                                              (Env.FParamSimple ("cipher",
                                                 [(Env.FParamSecurity (
                                                     "sigkey_client_ta",
                                                     "sigkey",
                                                     [(Env.TySecurity (
                                                         "client_img",
                                                         "image", []))
                                                       ]
                                                     ))
                                                   ]
                                                 ))
                                              ])));
                                     (("vk", 0),
                                      (Env.ExtFun
                                         (Env.DesugaredTypeSig
                                            [(Env.FParamSecurity (
                                                "sigkey_client_ta", "sigkey",
                                                [(Env.TySecurity (
                                                    "client_img", "image", 
                                                    []))
                                                  ]
                                                ));
                                              (Env.FParamSecurity (
                                                 "ver_key_server", "verkey",
                                                 [(Env.TySimple ("image", 
                                                     []))
                                                   ]
                                                 ))
                                              ])));
                                     (("rpc_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TyProduct (
                                                (Env.TySimple ("string", [])),
                                                (Env.TySecurity (
                                                   "client_img", "image", 
                                                   []))
                                                )),
                                             (Env.TySimple ("string", []))));
                                           (Env.TySecurity ("client_ta_sig",
                                              "signature", []))
                                           ]));
                                     (("udp_t", 0),
                                      (Env.ChanTypeDef
                                         [(Env.TyProduct (
                                             (Env.TySimple ("image", [])),
                                             (Env.TySimple ("signature", []))
                                             ))
                                           ]));
                                     (("ver_key_server", 0),
                                      (Env.SecurityTypeDef ("verkey",
                                         [(Env.TySimple ("image", []))])));
                                     (("conn_client", 0),
                                      (Env.SecurityTypeDef ("connection", 
                                         [])));
                                     (("symkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("symkey",
                                         [(Env.TySimple ("cipher",
                                             [(Env.TySecurity (
                                                 "sigkey_client_ta",
                                                 "sigkey",
                                                 [(Env.TySecurity (
                                                     "client_img", "image",
                                                     []))
                                                   ]
                                                 ))
                                               ]
                                             ))
                                           ]
                                         )));
                                     (("sigkey_client_ta", 0),
                                      (Env.SecurityTypeDef ("sigkey",
                                         [(Env.TySecurity ("client_img",
                                             "image", []))
                                           ]
                                         )));
                                     (("client_ta_sig", 0),
                                      (Env.SecurityTypeDef ("signature", [])));
                                     (("client_img", 0),
                                      (Env.SecurityTypeDef ("image", [])));
                                     (("client_ta_t", 0), Env.ProcTypeDef);
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("server_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("cipher", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("hash", 0), (Env.SimpleTypeDef []));
                                     (("verkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("sigkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("symkey", 0),
                                      (Env.SimpleTypeDef ["'a"]));
                                     (("list", 0), (Env.SimpleTypeDef ["'a"]));
                                     (("filedescr", 0),
                                      (Env.SimpleTypeDef []));
                                     (("image", 0), (Env.SimpleTypeDef []));
                                     (("signature", 0),
                                      (Env.SimpleTypeDef []));
                                     (("connection", 0),
                                      (Env.SimpleTypeDef []));
                                     (("string", 0), (Env.SimpleTypeDef []));
                                     (("bool", 0), (Env.SimpleTypeDef []));
                                     (("unit", 0), (Env.SimpleTypeDef []))];
                                   facts =
                                   ref ([("False", (Env.Global, (Some 0)));
                                          ("ImgRecvInvalid",
                                           (Env.Global, (Some 1)));
                                          ("ImgRecvValid",
                                           (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("accept_rpc", 0),
                                                   (Env.ExtSyscall
                                                      (Env.DesSMFunTyped (
                                                         [("c", 23)],
                                                         [(Env.FParamChannel
                                                             [(Env.FParamPoly
                                                                 "'a")
                                                               ]);
                                                           (Env.FParamSimple (
                                                              "unit", 
                                                              []))
                                                           ]
                                                         ))));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("cid", 21)],
                                                          [(Env.FParamSecurity (
                                                              "conn_client",
                                                              "connection",
                                                              []));
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("cid", 15);
                                                            ("f", 16);
                                                            ("arg1", 17);
                                                            ("arg2", 18)],
                                                          [(Env.FParamSecurity (
                                                              "conn_client",
                                                              "connection",
                                                              []));
                                                            (Env.FParamSimple (
                                                               "string", 
                                                               []));
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamPoly
                                                               "'b");
                                                            (Env.FParamPoly
                                                               "'c")
                                                            ]
                                                          ))));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 13)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamSecurity (
                                                               "conn_client",
                                                               "connection",
                                                               []))
                                                            ]
                                                          ))));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 11)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ]
                                                          ))));
                                                   (("send", 0),
                                                    (Env.ExtSyscall
                                                       (Env.DesSMFunTyped (
                                                          [("c", 9);
                                                            ("v", 10)],
                                                          [(Env.FParamChannel
                                                              [(Env.FParamPoly
                                                                  "'a")
                                                                ]);
                                                            (Env.FParamPoly
                                                               "'a");
                                                            (Env.FParamSimple (
                                                               "unit", 
                                                               []))
                                                            ]
                                                          ))));
                                                   (("verify", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "signature", 
                                                              []));
                                                            (Env.FParamSimple (
                                                               "image", 
                                                               []));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "bool", 
                                                               []))
                                                            ])));
                                                   (("true", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "bool", 
                                                              []))
                                                            ])));
                                                   (("snd", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'b")
                                                            ])));
                                                   (("fst", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamProduct (
                                                              (Env.FParamPoly
                                                                 "'a"),
                                                              (Env.FParamPoly
                                                                 "'b")
                                                              ));
                                                            (Env.FParamPoly
                                                               "'a")
                                                            ])));
                                                   (("sign", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "client_img",
                                                              "image", 
                                                              []));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "client_ta_sig",
                                                               "signature",
                                                               []))
                                                            ])));
                                                   (("sdec", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSimple (
                                                              "cipher",
                                                              [(Env.FParamSecurity (
                                                                  "sigkey_client_ta",
                                                                  "sigkey",
                                                                  [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                  ))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("senc", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "symkey_client_ta",
                                                               "symkey",
                                                               [(Env.TySimple (
                                                                   "cipher",
                                                                   [(Env.TySecurity (
                                                                    "sigkey_client_ta",
                                                                    "sigkey",
                                                                    [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]))]
                                                                   ))
                                                                 ]
                                                               ));
                                                            (Env.FParamSimple (
                                                               "cipher",
                                                               [(Env.FParamSecurity (
                                                                   "sigkey_client_ta",
                                                                   "sigkey",
                                                                   [(Env.TySecurity (
                                                                    "client_img",
                                                                    "image",
                                                                    []))]
                                                                   ))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("vk", 0),
                                                    (Env.ExtFun
                                                       (Env.DesugaredTypeSig
                                                          [(Env.FParamSecurity (
                                                              "sigkey_client_ta",
                                                              "sigkey",
                                                              [(Env.TySecurity (
                                                                  "client_img",
                                                                  "image", 
                                                                  []))
                                                                ]
                                                              ));
                                                            (Env.FParamSecurity (
                                                               "ver_key_server",
                                                               "verkey",
                                                               [(Env.TySimple (
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                            ])));
                                                   (("rpc_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TyProduct (
                                                              (Env.TySimple (
                                                                 "string", 
                                                                 [])),
                                                              (Env.TySecurity (
                                                                 "client_img",
                                                                 "image", 
                                                                 []))
                                                              )),
                                                           (Env.TySimple (
                                                              "string", 
                                                              []))
                                                           ));
                                                         (Env.TySecurity (
                                                            "client_ta_sig",
                                                            "signature", 
                                                            []))
                                                         ]));
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef
                                                       [(Env.TyProduct (
                                                           (Env.TySimple (
                                                              "image", 
                                                              [])),
                                                           (Env.TySimple (
                                                              "signature", 
                                                              []))
                                                           ))
                                                         ]));
                                                   (("ver_key_server", 0),
                                                    (Env.SecurityTypeDef (
                                                       "verkey",
                                                       [(Env.TySimple (
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("conn_client", 0),
                                                    (Env.SecurityTypeDef (
                                                       "connection", 
                                                       [])));
                                                   (("symkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "symkey",
                                                       [(Env.TySimple (
                                                           "cipher",
                                                           [(Env.TySecurity (
                                                               "sigkey_client_ta",
                                                               "sigkey",
                                                               [(Env.TySecurity (
                                                                   "client_img",
                                                                   "image",
                                                                   []))
                                                                 ]
                                                               ))
                                                             ]
                                                           ))
                                                         ]
                                                       )));
                                                   (("sigkey_client_ta", 0),
                                                    (Env.SecurityTypeDef (
                                                       "sigkey",
                                                       [(Env.TySecurity (
                                                           "client_img",
                                                           "image", []))
                                                         ]
                                                       )));
                                                   (("client_ta_sig", 0),
                                                    (Env.SecurityTypeDef (
                                                       "signature", [])));
                                                   (("client_img", 0),
                                                    (Env.SecurityTypeDef (
                                                       "image", [])));
                                                   (("client_ta_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("server_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("cipher", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("hash", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("verkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("sigkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("symkey", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("list", 0),
                                                    (Env.SimpleTypeDef ["'a"]));
                                                   (("filedescr", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("image", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("signature", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("connection", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("string", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("bool", 0),
                                                    (Env.SimpleTypeDef []));
                                                   (("unit", 0),
                                                    (Env.SimpleTypeDef []))
                                                   ];
                                                 facts =
                                                 ref ([("False",
                                                        (Env.Global, (Some 0)));
                                                        ("ImgRecvInvalid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("ImgRecvValid",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
Tryng to convert examples/camserver_typed.rab to CST
Loading complete..
