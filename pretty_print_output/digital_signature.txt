{ desc = Typed.Syscall {id = ("send", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 7); ("v", 8)]);
           cmd =
           { desc = (Typed.Put
                       [{ desc = Typed.Channel {
                                   channel =
                                   { desc = Typed.Ident {id = ("c", 7);
                                              desc = (Env.Var (Syntax.Loc 7));
                                              param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 8),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    8)));
                                                                    ((
                                                                    "c", 7),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    7)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                   name = "store";
                                   args =
                                   [{ desc = Typed.Ident {id = ("v", 8);
                                               desc =
                                               (Env.Var (Syntax.Loc 8));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 8),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    8)));
                                                                    ((
                                                                    "c", 7),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    7)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]}; env = { Env.vars =
                                                 [(("v", 8),
                                                   (Env.Var (Syntax.Loc 8)));
                                                   (("c", 7),
                                                    (Env.Var (Syntax.Loc 7)));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                         ]); env = { Env.vars =
                                     [(("v", 8), (Env.Var (Syntax.Loc 8)));
                                       (("c", 7), (Env.Var (Syntax.Loc 7)));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("verify", 0),
                                                     (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("recv", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 9)]);
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [("v", 10)];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 9);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 9));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 10),
                                          (Env.Var (Syntax.Meta 10)));
                                          (("c", 9), (Env.Var (Syntax.Loc 9)));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("exit",
                                               (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "store";
                                      args =
                                      [{ desc = Typed.Ident {id = ("v", 10);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 10));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("v", 10),
                                            (Env.Var (Syntax.Meta 10)));
                                            (("c", 9),
                                             (Env.Var (Syntax.Loc 9)));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("exit",
                                                 (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]}; env = { Env.vars =
                                                    [(("v", 10),
                                                      (Env.Var
                                                         (Syntax.Meta 10)));
                                                      (("c", 9),
                                                       (Env.Var
                                                          (Syntax.Loc 9)));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                            ];
                          cmd =
                          { desc = (Typed.Return
                                      { desc = Typed.Ident {id = ("v", 10);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 10));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 10),
                                          (Env.Var (Syntax.Meta 10)));
                                          (("c", 9), (Env.Var (Syntax.Loc 9)));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("exit",
                                               (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }); env = { Env.vars =
                                                      [(("v", 10),
                                                        (Env.Var
                                                           (Syntax.Meta 10)));
                                                        (("c", 9),
                                                         (Env.Var
                                                            (Syntax.Loc 9)));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("exit",
                                                             (Env.Channel,
                                                              (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 9), (Env.Var (Syntax.Loc 9)));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("send", 0),
                                                     (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("connect_rpc", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 11)]);
           cmd =
           { desc = (Typed.Sequence (
                       { desc = (Typed.Put
                                   [{ desc = Typed.Channel {
                                               channel =
                                               { desc = Typed.Ident {
                                                          id = ("c", 11);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 11));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                                               name = "req"; args = []}; env = 
                                     { Env.vars =
                                       [(("c", 11), (Env.Var (Syntax.Loc 11)));
                                         (("recv", 0), (Env.ExtSyscall 1));
                                         (("send", 0), (Env.ExtSyscall 2));
                                         (("verify", 0), (Env.ExtFun 3));
                                         (("true", 0), Env.ExtConst);
                                         (("snd", 0), (Env.ExtFun 1));
                                         (("fst", 0), (Env.ExtFun 1));
                                         (("sign", 0), (Env.ExtFun 2));
                                         (("pk", 0), (Env.ExtFun 1))];
                                       facts =
                                       ref ([("exit", (Env.Channel, (Some 0)));
                                              ("Returned",
                                               (Env.Channel, (Some 1)));
                                              ("invoke",
                                               (Env.Channel, (Some 3)));
                                              ("conn",
                                               (Env.Channel, (Some 0)));
                                              ("chid",
                                               (Env.Structure, (Some 1)));
                                              ("ack", (Env.Channel, (Some 0)));
                                              ("req", (Env.Channel, (Some 0)));
                                              ("store",
                                               (Env.Channel, (Some 1)))
                                              ])
                                       } }
                                     ]); env = { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                       { desc = (Typed.Case
                                   [{ Typed.fresh = [];
                                      facts =
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 11);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   11));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 11),
                                                      (Env.Var
                                                         (Syntax.Loc 11)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 11),
                                            (Env.Var (Syntax.Loc 11)));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("exit",
                                                 (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ];
                                      cmd =
                                      { desc = (Typed.New (("x", 12), None,
                                                  (Some ("chid",
                                                         [{ desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 11);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 11),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    11)));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                                           ])),
                                                  { desc = (Typed.Sequence (
                                                              { desc = (
                                                              Typed.Put
                                                                [{ desc = 
                                                                  Typed.Channel {
                                                                    channel =
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 11);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "x", 12),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    ((
                                                                    "c", 11),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    name =
                                                                    "conn";
                                                                    args = []}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "x", 12),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    ((
                                                                    "c", 11),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  ]); env = 
                                                              { Env.vars =
                                                                [(("x", 12),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                  (("c", 11),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("exit",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } },
                                                              { desc = (
                                                              Typed.Return
                                                                { desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("x", 12);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "x", 12),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    (
                                                                    (
                                                                    "c", 11),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }); env = 
                                                              { Env.vars =
                                                                [(("x", 12),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                  (("c", 11),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("exit",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              )); env = 
                                                  { Env.vars =
                                                    [(("x", 12),
                                                      (Env.Var
                                                         (Syntax.Loc 12)));
                                                      (("c", 11),
                                                       (Env.Var
                                                          (Syntax.Loc 11)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  )); env = { Env.vars =
                                                              [(("c", 11),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    11)));
                                                                (("recv", 0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("send", 0),
                                                                 (Env.ExtSyscall
                                                                    2));
                                                                (("verify", 0),
                                                                 (Env.ExtFun
                                                                    3));
                                                                (("true", 0),
                                                                 Env.ExtConst);
                                                                (("snd", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("fst", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("sign", 0),
                                                                 (Env.ExtFun
                                                                    2));
                                                                (("pk", 0),
                                                                 (Env.ExtFun
                                                                    1))
                                                                ];
                                                              facts =
                                                              ref ([("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } }
                                      }
                                     ]); env = { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                       )); env = { Env.vars =
                                   [(("c", 11), (Env.Var (Syntax.Loc 11)));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("recv", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("invoke_rpc", 0);
           fun_sig =
           (Typed.DesSMFunUntyped
              [("cid", 13); ("f", 14); ("arg1", 15); ("arg2", 16)]);
           cmd =
           { desc = (Typed.Get ([("c", 17)],
                       { desc = Typed.Ident {id = ("cid", 13);
                                  desc = (Env.Var (Syntax.Loc 13));
                                  param = None}; env = { Env.vars =
                                                         [(("arg2", 16),
                                                           (Env.Var
                                                              (Syntax.Loc 16)));
                                                           (("arg1", 15),
                                                            (Env.Var
                                                               (Syntax.Loc 15)));
                                                           (("f", 14),
                                                            (Env.Var
                                                               (Syntax.Loc 14)));
                                                           (("cid", 13),
                                                            (Env.Var
                                                               (Syntax.Loc 13)));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("send", 0),
                                                            (Env.ExtSyscall 2));
                                                           (("verify", 0),
                                                            (Env.ExtFun 3));
                                                           (("true", 0),
                                                            Env.ExtConst);
                                                           (("snd", 0),
                                                            (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("exit",
                                                                (Env.Channel,
                                                                 (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 17);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    17));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "invoke";
                                                           args =
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id = ("f", 14);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    14));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg1", 15);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    15));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg2", 16);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    16));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]}; env = 
                                                 { Env.vars =
                                                   [(("c", 17),
                                                     (Env.Var (Syntax.Loc 17)));
                                                     (("arg2", 16),
                                                      (Env.Var
                                                         (Syntax.Loc 16)));
                                                     (("arg1", 15),
                                                      (Env.Var
                                                         (Syntax.Loc 15)));
                                                     (("f", 14),
                                                      (Env.Var
                                                         (Syntax.Loc 14)));
                                                     (("cid", 13),
                                                      (Env.Var
                                                         (Syntax.Loc 13)));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
                                   { desc = (Typed.Case
                                               [{ Typed.fresh = [("v", 18)];
                                                  facts =
                                                  [{ desc = Typed.Channel {
                                                              channel =
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("c", 17);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    17));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 18),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                  (("c", 17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("arg2",
                                                                    16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("arg1",
                                                                    15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("f", 14),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("cid", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("exit",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } };
                                                              name =
                                                              "Returned";
                                                              args =
                                                              [{ desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("v", 18);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "v", 18),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                    (
                                                                    (
                                                                    "c", 17),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                    (
                                                                    (
                                                                    "arg2",
                                                                    16),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                    (
                                                                    (
                                                                    "arg1",
                                                                    15),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                    (
                                                                    (
                                                                    "f", 14),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                    (
                                                                    (
                                                                    "cid", 13),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ]}; env = 
                                                    { Env.vars =
                                                      [(("v", 18),
                                                        (Env.Var
                                                           (Syntax.Meta 18)));
                                                        (("c", 17),
                                                         (Env.Var
                                                            (Syntax.Loc 17)));
                                                        (("arg2", 16),
                                                         (Env.Var
                                                            (Syntax.Loc 16)));
                                                        (("arg1", 15),
                                                         (Env.Var
                                                            (Syntax.Loc 15)));
                                                        (("f", 14),
                                                         (Env.Var
                                                            (Syntax.Loc 14)));
                                                        (("cid", 13),
                                                         (Env.Var
                                                            (Syntax.Loc 13)));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("exit",
                                                             (Env.Channel,
                                                              (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ];
                                                  cmd =
                                                  { desc = (Typed.Return
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("v", 18);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Meta
                                                                    18));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 18),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                  (("c", 17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("arg2",
                                                                    16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("arg1",
                                                                    15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("f", 14),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("cid", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("exit",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }); env = 
                                                  { Env.vars =
                                                    [(("v", 18),
                                                      (Env.Var
                                                         (Syntax.Meta 18)));
                                                      (("c", 17),
                                                       (Env.Var
                                                          (Syntax.Loc 17)));
                                                      (("arg2", 16),
                                                       (Env.Var
                                                          (Syntax.Loc 16)));
                                                      (("arg1", 15),
                                                       (Env.Var
                                                          (Syntax.Loc 15)));
                                                      (("f", 14),
                                                       (Env.Var
                                                          (Syntax.Loc 14)));
                                                      (("cid", 13),
                                                       (Env.Var
                                                          (Syntax.Loc 13)));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ]); env = { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 17),
                                                 (Env.Var (Syntax.Loc 17)));
                                                 (("arg2", 16),
                                                  (Env.Var (Syntax.Loc 16)));
                                                 (("arg1", 15),
                                                  (Env.Var (Syntax.Loc 15)));
                                                 (("f", 14),
                                                  (Env.Var (Syntax.Loc 14)));
                                                 (("cid", 13),
                                                  (Env.Var (Syntax.Loc 13)));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("exit",
                                                      (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("arg2", 16), (Env.Var (Syntax.Loc 16)));
                                     (("arg1", 15), (Env.Var (Syntax.Loc 15)));
                                     (("f", 14), (Env.Var (Syntax.Loc 14)));
                                     (("cid", 13), (Env.Var (Syntax.Loc 13)));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("connect_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("close_rpc", 0);
           fun_sig = (Typed.DesSMFunUntyped [("cid", 19)]);
           cmd =
           { desc = (Typed.Get ([("c", 20)],
                       { desc = Typed.Ident {id = ("cid", 19);
                                  desc = (Env.Var (Syntax.Loc 19));
                                  param = None}; env = { Env.vars =
                                                         [(("cid", 19),
                                                           (Env.Var
                                                              (Syntax.Loc 19)));
                                                           (("invoke_rpc", 0),
                                                            (Env.ExtSyscall 4));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("send", 0),
                                                            (Env.ExtSyscall 2));
                                                           (("verify", 0),
                                                            (Env.ExtFun 3));
                                                           (("true", 0),
                                                            Env.ExtConst);
                                                           (("snd", 0),
                                                            (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("exit",
                                                                (Env.Channel,
                                                                 (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Del (
                                               { desc = Typed.Ident {
                                                          id = ("cid", 19);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 19));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 20),
                                                   (Env.Var (Syntax.Loc 20)));
                                                   (("cid", 19),
                                                    (Env.Var (Syntax.Loc 19)));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               "chid")); env = { Env.vars =
                                                                 [(("c", 20),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    20)));
                                                                   ((
                                                                    "cid", 19),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    19)));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } },
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 20);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    20));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 20),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    20)));
                                                               (("cid", 19),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    19)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "exit";
                                                           args = []}; env = 
                                                 { Env.vars =
                                                   [(("c", 20),
                                                     (Env.Var (Syntax.Loc 20)));
                                                     (("cid", 19),
                                                      (Env.Var
                                                         (Syntax.Loc 19)));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 20),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    20)));
                                                               (("cid", 19),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    19)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 20),
                                                 (Env.Var (Syntax.Loc 20)));
                                                 (("cid", 19),
                                                  (Env.Var (Syntax.Loc 19)));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("exit",
                                                      (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("cid", 19), (Env.Var (Syntax.Loc 19)));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("invoke_rpc", 0),
                                                   (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("accept_rpc", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 21)]);
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 21);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 21));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("c", 21),
                                          (Env.Var (Syntax.Loc 21)));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("exit",
                                               (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "req"; args = []}; env = 
                            { Env.vars =
                              [(("c", 21), (Env.Var (Syntax.Loc 21)));
                                (("close_rpc", 0), (Env.ExtSyscall 1));
                                (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                (("connect_rpc", 0), (Env.ExtSyscall 1));
                                (("recv", 0), (Env.ExtSyscall 1));
                                (("send", 0), (Env.ExtSyscall 2));
                                (("verify", 0), (Env.ExtFun 3));
                                (("true", 0), Env.ExtConst);
                                (("snd", 0), (Env.ExtFun 1));
                                (("fst", 0), (Env.ExtFun 1));
                                (("sign", 0), (Env.ExtFun 2));
                                (("pk", 0), (Env.ExtFun 1))];
                              facts =
                              ref ([("exit", (Env.Channel, (Some 0)));
                                     ("Returned", (Env.Channel, (Some 1)));
                                     ("invoke", (Env.Channel, (Some 3)));
                                     ("conn", (Env.Channel, (Some 0)));
                                     ("chid", (Env.Structure, (Some 1)));
                                     ("ack", (Env.Channel, (Some 0)));
                                     ("req", (Env.Channel, (Some 0)));
                                     ("store", (Env.Channel, (Some 1)))])
                              } }
                            ];
                          cmd =
                          { desc = (Typed.Put
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 21);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   21));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 21),
                                                      (Env.Var
                                                         (Syntax.Loc 21)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 21),
                                            (Env.Var (Syntax.Loc 21)));
                                            (("close_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("invoke_rpc", 0),
                                             (Env.ExtSyscall 4));
                                            (("connect_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("exit",
                                                 (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]); env = { Env.vars =
                                                    [(("c", 21),
                                                      (Env.Var
                                                         (Syntax.Loc 21)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 21), (Env.Var (Syntax.Loc 21)));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("close_rpc", 0),
                                                     (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.EqThyFunc {id = ("pk", 0); fun_desc = (Typed.DesugaredArity 1)}; env = 
{ Env.vars = [];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.EqThyFunc {id = ("sign", 0);
           fun_desc = (Typed.DesugaredArity 2)}; env = { Env.vars =
                                                         [(("pk", 0),
                                                           (Env.ExtFun 1))];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } }
{ desc = Typed.EqThyFunc {id = ("fst", 0);
           fun_desc = (Typed.DesugaredArity 1)}; env = { Env.vars =
                                                         [(("sign", 0),
                                                           (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } }
{ desc = Typed.EqThyFunc {id = ("snd", 0);
           fun_desc = (Typed.DesugaredArity 1)}; env = { Env.vars =
                                                         [(("fst", 0),
                                                           (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("fst", 0),
                        [{ desc = (Typed.Tuple
                                     [{ desc = Typed.Ident {id = ("x", 1);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 1));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("y", 2),
                                           (Env.Var (Syntax.Meta 2)));
                                           (("x", 1),
                                            (Env.Var (Syntax.Meta 1)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("pk", 0), (Env.ExtFun 1))];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("y", 2);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 2));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("y", 2),
                                           (Env.Var (Syntax.Meta 2)));
                                           (("x", 1),
                                            (Env.Var (Syntax.Meta 1)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("pk", 0), (Env.ExtFun 1))];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]); env = { Env.vars =
                                                   [(("y", 2),
                                                     (Env.Var (Syntax.Meta 2)));
                                                     (("x", 1),
                                                      (Env.Var
                                                         (Syntax.Meta 1)));
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                          ]
                        )); env = { Env.vars =
                                    [(("y", 2), (Env.Var (Syntax.Meta 2)));
                                      (("x", 1), (Env.Var (Syntax.Meta 1)));
                                      (("snd", 0), (Env.ExtFun 1));
                                      (("fst", 0), (Env.ExtFun 1));
                                      (("sign", 0), (Env.ExtFun 2));
                                      (("pk", 0), (Env.ExtFun 1))];
                                    facts =
                                    ref ([("BobClose", (Env.Global, (Some 0)));
                                           ("IntegrityFail",
                                            (Env.Global, (Some 1)));
                                           ("IntegritySuccess",
                                            (Env.Global, (Some 1)));
                                           ("AliceClose",
                                            (Env.Global, (Some 0)));
                                           ("MsgSend", (Env.Global, (Some 1)));
                                           ("Out", (Env.Global, (Some 1)));
                                           ("In", (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("x", 1);
                       desc = (Env.Var (Syntax.Meta 1)); param = None}; env = 
            { Env.vars =
              [(("y", 2), (Env.Var (Syntax.Meta 2)));
                (("x", 1), (Env.Var (Syntax.Meta 1)));
                (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
                (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
              facts =
              ref ([("BobClose", (Env.Global, (Some 0)));
                     ("IntegrityFail", (Env.Global, (Some 1)));
                     ("IntegritySuccess", (Env.Global, (Some 1)));
                     ("AliceClose", (Env.Global, (Some 0)));
                     ("MsgSend", (Env.Global, (Some 1)));
                     ("Out", (Env.Global, (Some 1)));
                     ("In", (Env.Global, (Some 1)));
                     ("exit", (Env.Channel, (Some 0)));
                     ("Returned", (Env.Channel, (Some 1)));
                     ("invoke", (Env.Channel, (Some 3)));
                     ("conn", (Env.Channel, (Some 0)));
                     ("chid", (Env.Structure, (Some 1)));
                     ("ack", (Env.Channel, (Some 0)));
                     ("req", (Env.Channel, (Some 0)));
                     ("store", (Env.Channel, (Some 1)))])
              } }
            )); env = { Env.vars =
                        [(("y", 2), (Env.Var (Syntax.Meta 2)));
                          (("x", 1), (Env.Var (Syntax.Meta 1)));
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("pk", 0), (Env.ExtFun 1))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("snd", 0),
                        [{ desc = (Typed.Tuple
                                     [{ desc = Typed.Ident {id = ("x", 3);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 3));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("y", 4),
                                           (Env.Var (Syntax.Meta 4)));
                                           (("x", 3),
                                            (Env.Var (Syntax.Meta 3)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("pk", 0), (Env.ExtFun 1))];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("y", 4);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 4));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("y", 4),
                                           (Env.Var (Syntax.Meta 4)));
                                           (("x", 3),
                                            (Env.Var (Syntax.Meta 3)));
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("pk", 0), (Env.ExtFun 1))];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]); env = { Env.vars =
                                                   [(("y", 4),
                                                     (Env.Var (Syntax.Meta 4)));
                                                     (("x", 3),
                                                      (Env.Var
                                                         (Syntax.Meta 3)));
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                          ]
                        )); env = { Env.vars =
                                    [(("y", 4), (Env.Var (Syntax.Meta 4)));
                                      (("x", 3), (Env.Var (Syntax.Meta 3)));
                                      (("snd", 0), (Env.ExtFun 1));
                                      (("fst", 0), (Env.ExtFun 1));
                                      (("sign", 0), (Env.ExtFun 2));
                                      (("pk", 0), (Env.ExtFun 1))];
                                    facts =
                                    ref ([("BobClose", (Env.Global, (Some 0)));
                                           ("IntegrityFail",
                                            (Env.Global, (Some 1)));
                                           ("IntegritySuccess",
                                            (Env.Global, (Some 1)));
                                           ("AliceClose",
                                            (Env.Global, (Some 0)));
                                           ("MsgSend", (Env.Global, (Some 1)));
                                           ("Out", (Env.Global, (Some 1)));
                                           ("In", (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("y", 4);
                       desc = (Env.Var (Syntax.Meta 4)); param = None}; env = 
            { Env.vars =
              [(("y", 4), (Env.Var (Syntax.Meta 4)));
                (("x", 3), (Env.Var (Syntax.Meta 3)));
                (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
                (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
              facts =
              ref ([("BobClose", (Env.Global, (Some 0)));
                     ("IntegrityFail", (Env.Global, (Some 1)));
                     ("IntegritySuccess", (Env.Global, (Some 1)));
                     ("AliceClose", (Env.Global, (Some 0)));
                     ("MsgSend", (Env.Global, (Some 1)));
                     ("Out", (Env.Global, (Some 1)));
                     ("In", (Env.Global, (Some 1)));
                     ("exit", (Env.Channel, (Some 0)));
                     ("Returned", (Env.Channel, (Some 1)));
                     ("invoke", (Env.Channel, (Some 3)));
                     ("conn", (Env.Channel, (Some 0)));
                     ("chid", (Env.Structure, (Some 1)));
                     ("ack", (Env.Channel, (Some 0)));
                     ("req", (Env.Channel, (Some 0)));
                     ("store", (Env.Channel, (Some 1)))])
              } }
            )); env = { Env.vars =
                        [(("y", 4), (Env.Var (Syntax.Meta 4)));
                          (("x", 3), (Env.Var (Syntax.Meta 3)));
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("pk", 0), (Env.ExtFun 1))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = Typed.EqThyFunc {id = ("true", 0);
           fun_desc = (Typed.DesugaredArity 0)}; env = { Env.vars =
                                                         [(("snd", 0),
                                                           (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } }
{ desc = Typed.EqThyFunc {id = ("verify", 0);
           fun_desc = (Typed.DesugaredArity 3)}; env = { Env.vars =
                                                         [(("true", 0),
                                                           Env.ExtConst);
                                                           (("snd", 0),
                                                            (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } }
{ desc = (Typed.Equation (
            { desc = (Typed.Apply (("verify", 0),
                        [{ desc = (Typed.Apply (("sign", 0),
                                     [{ desc = Typed.Ident {id = ("d", 5);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 5));
                                                 param = None}; env = 
                                       { Env.vars =
                                         [(("k", 6),
                                           (Env.Var (Syntax.Meta 6)));
                                           (("d", 5),
                                            (Env.Var (Syntax.Meta 5)));
                                           (("verify", 0), (Env.ExtFun 3));
                                           (("true", 0), Env.ExtConst);
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("pk", 0), (Env.ExtFun 1))];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } };
                                       { desc = Typed.Ident {id = ("k", 6);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 6));
                                                  param = None}; env = 
                                       { Env.vars =
                                         [(("k", 6),
                                           (Env.Var (Syntax.Meta 6)));
                                           (("d", 5),
                                            (Env.Var (Syntax.Meta 5)));
                                           (("verify", 0), (Env.ExtFun 3));
                                           (("true", 0), Env.ExtConst);
                                           (("snd", 0), (Env.ExtFun 1));
                                           (("fst", 0), (Env.ExtFun 1));
                                           (("sign", 0), (Env.ExtFun 2));
                                           (("pk", 0), (Env.ExtFun 1))];
                                         facts =
                                         ref ([("BobClose",
                                                (Env.Global, (Some 0)));
                                                ("IntegrityFail",
                                                 (Env.Global, (Some 1)));
                                                ("IntegritySuccess",
                                                 (Env.Global, (Some 1)));
                                                ("AliceClose",
                                                 (Env.Global, (Some 0)));
                                                ("MsgSend",
                                                 (Env.Global, (Some 1)));
                                                ("Out",
                                                 (Env.Global, (Some 1)));
                                                ("In", (Env.Global, (Some 1)));
                                                ("exit",
                                                 (Env.Channel, (Some 0)));
                                                ("Returned",
                                                 (Env.Channel, (Some 1)));
                                                ("invoke",
                                                 (Env.Channel, (Some 3)));
                                                ("conn",
                                                 (Env.Channel, (Some 0)));
                                                ("chid",
                                                 (Env.Structure, (Some 1)));
                                                ("ack",
                                                 (Env.Channel, (Some 0)));
                                                ("req",
                                                 (Env.Channel, (Some 0)));
                                                ("store",
                                                 (Env.Channel, (Some 1)))
                                                ])
                                         } }
                                       ]
                                     )); env = { Env.vars =
                                                 [(("k", 6),
                                                   (Env.Var (Syntax.Meta 6)));
                                                   (("d", 5),
                                                    (Env.Var (Syntax.Meta 5)));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                          { desc = Typed.Ident {id = ("d", 5);
                                     desc = (Env.Var (Syntax.Meta 5));
                                     param = None}; env = { Env.vars =
                                                            [(("k", 6),
                                                              (Env.Var
                                                                 (Syntax.Meta
                                                                    6)));
                                                              (("d", 5),
                                                               (Env.Var
                                                                  (Syntax.Meta
                                                                    5)));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("pk", 0),
                                                               (Env.ExtFun 1))
                                                              ];
                                                            facts =
                                                            ref ([("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } };
                          { desc = (Typed.Apply (("pk", 0),
                                      [{ desc = Typed.Ident {id = ("k", 6);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 6));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("k", 6),
                                            (Env.Var (Syntax.Meta 6)));
                                            (("d", 5),
                                             (Env.Var (Syntax.Meta 5)));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]
                                      )); env = { Env.vars =
                                                  [(("k", 6),
                                                    (Env.Var (Syntax.Meta 6)));
                                                    (("d", 5),
                                                     (Env.Var (Syntax.Meta 5)));
                                                    (("verify", 0),
                                                     (Env.ExtFun 3));
                                                    (("true", 0),
                                                     Env.ExtConst);
                                                    (("snd", 0),
                                                     (Env.ExtFun 1));
                                                    (("fst", 0),
                                                     (Env.ExtFun 1));
                                                    (("sign", 0),
                                                     (Env.ExtFun 2));
                                                    (("pk", 0),
                                                     (Env.ExtFun 1))
                                                    ];
                                                  facts =
                                                  ref ([("BobClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                         ("IntegrityFail",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("IntegritySuccess",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("AliceClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                         ("MsgSend",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("Out",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("In",
                                                          (Env.Global,
                                                           (Some 1)));
                                                         ("exit",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("Returned",
                                                          (Env.Channel,
                                                           (Some 1)));
                                                         ("invoke",
                                                          (Env.Channel,
                                                           (Some 3)));
                                                         ("conn",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("chid",
                                                          (Env.Structure,
                                                           (Some 1)));
                                                         ("ack",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("req",
                                                          (Env.Channel,
                                                           (Some 0)));
                                                         ("store",
                                                          (Env.Channel,
                                                           (Some 1)))
                                                         ])
                                                  } }
                          ]
                        )); env = { Env.vars =
                                    [(("k", 6), (Env.Var (Syntax.Meta 6)));
                                      (("d", 5), (Env.Var (Syntax.Meta 5)));
                                      (("verify", 0), (Env.ExtFun 3));
                                      (("true", 0), Env.ExtConst);
                                      (("snd", 0), (Env.ExtFun 1));
                                      (("fst", 0), (Env.ExtFun 1));
                                      (("sign", 0), (Env.ExtFun 2));
                                      (("pk", 0), (Env.ExtFun 1))];
                                    facts =
                                    ref ([("BobClose", (Env.Global, (Some 0)));
                                           ("IntegrityFail",
                                            (Env.Global, (Some 1)));
                                           ("IntegritySuccess",
                                            (Env.Global, (Some 1)));
                                           ("AliceClose",
                                            (Env.Global, (Some 0)));
                                           ("MsgSend", (Env.Global, (Some 1)));
                                           ("Out", (Env.Global, (Some 1)));
                                           ("In", (Env.Global, (Some 1)));
                                           ("exit", (Env.Channel, (Some 0)));
                                           ("Returned",
                                            (Env.Channel, (Some 1)));
                                           ("invoke", (Env.Channel, (Some 3)));
                                           ("conn", (Env.Channel, (Some 0)));
                                           ("chid", (Env.Structure, (Some 1)));
                                           ("ack", (Env.Channel, (Some 0)));
                                           ("req", (Env.Channel, (Some 0)));
                                           ("store", (Env.Channel, (Some 1)))
                                           ])
                                    } },
            { desc = Typed.Ident {id = ("true", 0); desc = Env.ExtConst;
                       param = None}; env = { Env.vars =
                                              [(("k", 6),
                                                (Env.Var (Syntax.Meta 6)));
                                                (("d", 5),
                                                 (Env.Var (Syntax.Meta 5)));
                                                (("verify", 0),
                                                 (Env.ExtFun 3));
                                                (("true", 0), Env.ExtConst);
                                                (("snd", 0), (Env.ExtFun 1));
                                                (("fst", 0), (Env.ExtFun 1));
                                                (("sign", 0), (Env.ExtFun 2));
                                                (("pk", 0), (Env.ExtFun 1))];
                                              facts =
                                              ref ([("BobClose",
                                                     (Env.Global, (Some 0)));
                                                     ("IntegrityFail",
                                                      (Env.Global, (Some 1)));
                                                     ("IntegritySuccess",
                                                      (Env.Global, (Some 1)));
                                                     ("AliceClose",
                                                      (Env.Global, (Some 0)));
                                                     ("MsgSend",
                                                      (Env.Global, (Some 1)));
                                                     ("Out",
                                                      (Env.Global, (Some 1)));
                                                     ("In",
                                                      (Env.Global, (Some 1)));
                                                     ("exit",
                                                      (Env.Channel, (Some 0)));
                                                     ("Returned",
                                                      (Env.Channel, (Some 1)));
                                                     ("invoke",
                                                      (Env.Channel, (Some 3)));
                                                     ("conn",
                                                      (Env.Channel, (Some 0)));
                                                     ("chid",
                                                      (Env.Structure,
                                                       (Some 1)));
                                                     ("ack",
                                                      (Env.Channel, (Some 0)));
                                                     ("req",
                                                      (Env.Channel, (Some 0)));
                                                     ("store",
                                                      (Env.Channel, (Some 1)))
                                                     ])
                                              } }
            )); env = { Env.vars =
                        [(("k", 6), (Env.Var (Syntax.Meta 6)));
                          (("d", 5), (Env.Var (Syntax.Meta 5)));
                          (("verify", 0), (Env.ExtFun 3));
                          (("true", 0), Env.ExtConst);
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("pk", 0), (Env.ExtFun 1))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
{ desc = Typed.Syscall {id = ("send", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 7); ("v", 8)]);
           cmd =
           { desc = (Typed.Put
                       [{ desc = Typed.Channel {
                                   channel =
                                   { desc = Typed.Ident {id = ("c", 7);
                                              desc = (Env.Var (Syntax.Loc 7));
                                              param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 8),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    8)));
                                                                    ((
                                                                    "c", 7),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    7)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                   name = "store";
                                   args =
                                   [{ desc = Typed.Ident {id = ("v", 8);
                                               desc =
                                               (Env.Var (Syntax.Loc 8));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 8),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    8)));
                                                                    ((
                                                                    "c", 7),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    7)));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]}; env = { Env.vars =
                                                 [(("v", 8),
                                                   (Env.Var (Syntax.Loc 8)));
                                                   (("c", 7),
                                                    (Env.Var (Syntax.Loc 7)));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                         ]); env = { Env.vars =
                                     [(("v", 8), (Env.Var (Syntax.Loc 8)));
                                       (("c", 7), (Env.Var (Syntax.Loc 7)));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("verify", 0),
                                                     (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("recv", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 9)]);
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [("v", 10)];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 9);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 9));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 10),
                                          (Env.Var (Syntax.Meta 10)));
                                          (("c", 9), (Env.Var (Syntax.Loc 9)));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "store";
                                      args =
                                      [{ desc = Typed.Ident {id = ("v", 10);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 10));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("v", 10),
                                            (Env.Var (Syntax.Meta 10)));
                                            (("c", 9),
                                             (Env.Var (Syntax.Loc 9)));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]}; env = { Env.vars =
                                                    [(("v", 10),
                                                      (Env.Var
                                                         (Syntax.Meta 10)));
                                                      (("c", 9),
                                                       (Env.Var
                                                          (Syntax.Loc 9)));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                            ];
                          cmd =
                          { desc = (Typed.Return
                                      { desc = Typed.Ident {id = ("v", 10);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 10));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("v", 10),
                                          (Env.Var (Syntax.Meta 10)));
                                          (("c", 9), (Env.Var (Syntax.Loc 9)));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }); env = { Env.vars =
                                                      [(("v", 10),
                                                        (Env.Var
                                                           (Syntax.Meta 10)));
                                                        (("c", 9),
                                                         (Env.Var
                                                            (Syntax.Loc 9)));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 9), (Env.Var (Syntax.Loc 9)));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("send", 0),
                                                     (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("connect_rpc", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 11)]);
           cmd =
           { desc = (Typed.Sequence (
                       { desc = (Typed.Put
                                   [{ desc = Typed.Channel {
                                               channel =
                                               { desc = Typed.Ident {
                                                          id = ("c", 11);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 11));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } };
                                               name = "req"; args = []}; env = 
                                     { Env.vars =
                                       [(("c", 11), (Env.Var (Syntax.Loc 11)));
                                         (("recv", 0), (Env.ExtSyscall 1));
                                         (("send", 0), (Env.ExtSyscall 2));
                                         (("verify", 0), (Env.ExtFun 3));
                                         (("true", 0), Env.ExtConst);
                                         (("snd", 0), (Env.ExtFun 1));
                                         (("fst", 0), (Env.ExtFun 1));
                                         (("sign", 0), (Env.ExtFun 2));
                                         (("pk", 0), (Env.ExtFun 1))];
                                       facts =
                                       ref ([("BobClose",
                                              (Env.Global, (Some 0)));
                                              ("IntegrityFail",
                                               (Env.Global, (Some 1)));
                                              ("IntegritySuccess",
                                               (Env.Global, (Some 1)));
                                              ("AliceClose",
                                               (Env.Global, (Some 0)));
                                              ("MsgSend",
                                               (Env.Global, (Some 1)));
                                              ("Out", (Env.Global, (Some 1)));
                                              ("In", (Env.Global, (Some 1)));
                                              ("exit",
                                               (Env.Channel, (Some 0)));
                                              ("Returned",
                                               (Env.Channel, (Some 1)));
                                              ("invoke",
                                               (Env.Channel, (Some 3)));
                                              ("conn",
                                               (Env.Channel, (Some 0)));
                                              ("chid",
                                               (Env.Structure, (Some 1)));
                                              ("ack", (Env.Channel, (Some 0)));
                                              ("req", (Env.Channel, (Some 0)));
                                              ("store",
                                               (Env.Channel, (Some 1)))
                                              ])
                                       } }
                                     ]); env = { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                       { desc = (Typed.Case
                                   [{ Typed.fresh = [];
                                      facts =
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 11);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   11));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 11),
                                                      (Env.Var
                                                         (Syntax.Loc 11)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 11),
                                            (Env.Var (Syntax.Loc 11)));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ];
                                      cmd =
                                      { desc = (Typed.New (("x", 12), None,
                                                  (Some ("chid",
                                                         [{ desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 11);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 11),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    11)));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                                           ])),
                                                  { desc = (Typed.Sequence (
                                                              { desc = (
                                                              Typed.Put
                                                                [{ desc = 
                                                                  Typed.Channel {
                                                                    channel =
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 11);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "x", 12),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    ((
                                                                    "c", 11),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    name =
                                                                    "conn";
                                                                    args = []}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "x", 12),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    ((
                                                                    "c", 11),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  ]); env = 
                                                              { Env.vars =
                                                                [(("x", 12),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                  (("c", 11),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } },
                                                              { desc = (
                                                              Typed.Return
                                                                { desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("x", 12);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "x", 12),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                    (
                                                                    (
                                                                    "c", 11),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }); env = 
                                                              { Env.vars =
                                                                [(("x", 12),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    12)));
                                                                  (("c", 11),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    11)));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              )); env = 
                                                  { Env.vars =
                                                    [(("x", 12),
                                                      (Env.Var
                                                         (Syntax.Loc 12)));
                                                      (("c", 11),
                                                       (Env.Var
                                                          (Syntax.Loc 11)));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  )); env = { Env.vars =
                                                              [(("c", 11),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    11)));
                                                                (("recv", 0),
                                                                 (Env.ExtSyscall
                                                                    1));
                                                                (("send", 0),
                                                                 (Env.ExtSyscall
                                                                    2));
                                                                (("verify", 0),
                                                                 (Env.ExtFun
                                                                    3));
                                                                (("true", 0),
                                                                 Env.ExtConst);
                                                                (("snd", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("fst", 0),
                                                                 (Env.ExtFun
                                                                    1));
                                                                (("sign", 0),
                                                                 (Env.ExtFun
                                                                    2));
                                                                (("pk", 0),
                                                                 (Env.ExtFun
                                                                    1))
                                                                ];
                                                              facts =
                                                              ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                              } }
                                      }
                                     ]); env = { Env.vars =
                                                 [(("c", 11),
                                                   (Env.Var (Syntax.Loc 11)));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                       )); env = { Env.vars =
                                   [(("c", 11), (Env.Var (Syntax.Loc 11)));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("recv", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("invoke_rpc", 0);
           fun_sig =
           (Typed.DesSMFunUntyped
              [("cid", 13); ("f", 14); ("arg1", 15); ("arg2", 16)]);
           cmd =
           { desc = (Typed.Get ([("c", 17)],
                       { desc = Typed.Ident {id = ("cid", 13);
                                  desc = (Env.Var (Syntax.Loc 13));
                                  param = None}; env = { Env.vars =
                                                         [(("arg2", 16),
                                                           (Env.Var
                                                              (Syntax.Loc 16)));
                                                           (("arg1", 15),
                                                            (Env.Var
                                                               (Syntax.Loc 15)));
                                                           (("f", 14),
                                                            (Env.Var
                                                               (Syntax.Loc 14)));
                                                           (("cid", 13),
                                                            (Env.Var
                                                               (Syntax.Loc 13)));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("send", 0),
                                                            (Env.ExtSyscall 2));
                                                           (("verify", 0),
                                                            (Env.ExtFun 3));
                                                           (("true", 0),
                                                            Env.ExtConst);
                                                           (("snd", 0),
                                                            (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 17);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    17));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "invoke";
                                                           args =
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id = ("f", 14);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    14));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg1", 15);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    15));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("arg2", 16);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    16));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("c", 17),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    17)));
                                                                 (("arg2", 16),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                 (("arg1", 15),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                 (("f", 14),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                 (("cid", 13),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]}; env = 
                                                 { Env.vars =
                                                   [(("c", 17),
                                                     (Env.Var (Syntax.Loc 17)));
                                                     (("arg2", 16),
                                                      (Env.Var
                                                         (Syntax.Loc 16)));
                                                     (("arg1", 15),
                                                      (Env.Var
                                                         (Syntax.Loc 15)));
                                                     (("f", 14),
                                                      (Env.Var
                                                         (Syntax.Loc 14)));
                                                     (("cid", 13),
                                                      (Env.Var
                                                         (Syntax.Loc 13)));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
                                   { desc = (Typed.Case
                                               [{ Typed.fresh = [("v", 18)];
                                                  facts =
                                                  [{ desc = Typed.Channel {
                                                              channel =
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("c", 17);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    17));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 18),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                  (("c", 17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("arg2",
                                                                    16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("arg1",
                                                                    15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("f", 14),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("cid", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } };
                                                              name =
                                                              "Returned";
                                                              args =
                                                              [{ desc = 
                                                                Typed.Ident {
                                                                  id =
                                                                  ("v", 18);
                                                                  desc =
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18));
                                                                  param =
                                                                  None}; env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "v", 18),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                    (
                                                                    (
                                                                    "c", 17),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                    (
                                                                    (
                                                                    "arg2",
                                                                    16),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                    (
                                                                    (
                                                                    "arg1",
                                                                    15),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                    (
                                                                    (
                                                                    "f", 14),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                    (
                                                                    (
                                                                    "cid", 13),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ]}; env = 
                                                    { Env.vars =
                                                      [(("v", 18),
                                                        (Env.Var
                                                           (Syntax.Meta 18)));
                                                        (("c", 17),
                                                         (Env.Var
                                                            (Syntax.Loc 17)));
                                                        (("arg2", 16),
                                                         (Env.Var
                                                            (Syntax.Loc 16)));
                                                        (("arg1", 15),
                                                         (Env.Var
                                                            (Syntax.Loc 15)));
                                                        (("f", 14),
                                                         (Env.Var
                                                            (Syntax.Loc 14)));
                                                        (("cid", 13),
                                                         (Env.Var
                                                            (Syntax.Loc 13)));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                                                    ];
                                                  cmd =
                                                  { desc = (Typed.Return
                                                              { desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("v", 18);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Meta
                                                                    18));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("v", 18),
                                                                  (Env.Var
                                                                    (Syntax.Meta
                                                                    18)));
                                                                  (("c", 17),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    17)));
                                                                  (("arg2",
                                                                    16),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    16)));
                                                                  (("arg1",
                                                                    15),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    15)));
                                                                  (("f", 14),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    14)));
                                                                  (("cid", 13),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    13)));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }); env = 
                                                  { Env.vars =
                                                    [(("v", 18),
                                                      (Env.Var
                                                         (Syntax.Meta 18)));
                                                      (("c", 17),
                                                       (Env.Var
                                                          (Syntax.Loc 17)));
                                                      (("arg2", 16),
                                                       (Env.Var
                                                          (Syntax.Loc 16)));
                                                      (("arg1", 15),
                                                       (Env.Var
                                                          (Syntax.Loc 15)));
                                                      (("f", 14),
                                                       (Env.Var
                                                          (Syntax.Loc 14)));
                                                      (("cid", 13),
                                                       (Env.Var
                                                          (Syntax.Loc 13)));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                                                  }
                                                 ]); env = { Env.vars =
                                                             [(("c", 17),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    17)));
                                                               (("arg2", 16),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    16)));
                                                               (("arg1", 15),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    15)));
                                                               (("f", 14),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    14)));
                                                               (("cid", 13),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    13)));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 17),
                                                 (Env.Var (Syntax.Loc 17)));
                                                 (("arg2", 16),
                                                  (Env.Var (Syntax.Loc 16)));
                                                 (("arg1", 15),
                                                  (Env.Var (Syntax.Loc 15)));
                                                 (("f", 14),
                                                  (Env.Var (Syntax.Loc 14)));
                                                 (("cid", 13),
                                                  (Env.Var (Syntax.Loc 13)));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("arg2", 16), (Env.Var (Syntax.Loc 16)));
                                     (("arg1", 15), (Env.Var (Syntax.Loc 15)));
                                     (("f", 14), (Env.Var (Syntax.Loc 14)));
                                     (("cid", 13), (Env.Var (Syntax.Loc 13)));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("connect_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("close_rpc", 0);
           fun_sig = (Typed.DesSMFunUntyped [("cid", 19)]);
           cmd =
           { desc = (Typed.Get ([("c", 20)],
                       { desc = Typed.Ident {id = ("cid", 19);
                                  desc = (Env.Var (Syntax.Loc 19));
                                  param = None}; env = { Env.vars =
                                                         [(("cid", 19),
                                                           (Env.Var
                                                              (Syntax.Loc 19)));
                                                           (("invoke_rpc", 0),
                                                            (Env.ExtSyscall 4));
                                                           (("connect_rpc", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("recv", 0),
                                                            (Env.ExtSyscall 1));
                                                           (("send", 0),
                                                            (Env.ExtSyscall 2));
                                                           (("verify", 0),
                                                            (Env.ExtFun 3));
                                                           (("true", 0),
                                                            Env.ExtConst);
                                                           (("snd", 0),
                                                            (Env.ExtFun 1));
                                                           (("fst", 0),
                                                            (Env.ExtFun 1));
                                                           (("sign", 0),
                                                            (Env.ExtFun 2));
                                                           (("pk", 0),
                                                            (Env.ExtFun 1))
                                                           ];
                                                         facts =
                                                         ref ([("BobClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                                ("IntegrityFail",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("IntegritySuccess",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("AliceClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                ("MsgSend",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("Out",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("In",
                                                                 (Env.Global,
                                                                  (Some 1)));
                                                                ("exit",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("Returned",
                                                                 (Env.Channel,
                                                                  (Some 1)));
                                                                ("invoke",
                                                                 (Env.Channel,
                                                                  (Some 3)));
                                                                ("conn",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("chid",
                                                                 (Env.Structure,
                                                                  (Some 1)));
                                                                ("ack",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("req",
                                                                 (Env.Channel,
                                                                  (Some 0)));
                                                                ("store",
                                                                 (Env.Channel,
                                                                  (Some 1)))
                                                                ])
                                                         } },
                       "chid",
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Del (
                                               { desc = Typed.Ident {
                                                          id = ("cid", 19);
                                                          desc =
                                                          (Env.Var
                                                             (Syntax.Loc 19));
                                                          param = None}; env = 
                                               { Env.vars =
                                                 [(("c", 20),
                                                   (Env.Var (Syntax.Loc 20)));
                                                   (("cid", 19),
                                                    (Env.Var (Syntax.Loc 19)));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               "chid")); env = { Env.vars =
                                                                 [(("c", 20),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    20)));
                                                                   ((
                                                                    "cid", 19),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    19)));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } },
                                   { desc = (Typed.Put
                                               [{ desc = Typed.Channel {
                                                           channel =
                                                           { desc = Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "c", 20);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    20));
                                                                    param =
                                                                    None}; env = 
                                                           { Env.vars =
                                                             [(("c", 20),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    20)));
                                                               (("cid", 19),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    19)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } };
                                                           name = "exit";
                                                           args = []}; env = 
                                                 { Env.vars =
                                                   [(("c", 20),
                                                     (Env.Var (Syntax.Loc 20)));
                                                     (("cid", 19),
                                                      (Env.Var
                                                         (Syntax.Loc 19)));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]); env = { Env.vars =
                                                             [(("c", 20),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    20)));
                                                               (("cid", 19),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    19)));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                   )); env = { Env.vars =
                                               [(("c", 20),
                                                 (Env.Var (Syntax.Loc 20)));
                                                 (("cid", 19),
                                                  (Env.Var (Syntax.Loc 19)));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("cid", 19), (Env.Var (Syntax.Loc 19)));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("invoke_rpc", 0),
                                                   (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Syscall {id = ("accept_rpc", 0);
           fun_sig = (Typed.DesSMFunUntyped [("c", 21)]);
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 21);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 21));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("c", 21),
                                          (Env.Var (Syntax.Loc 21)));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "req"; args = []}; env = 
                            { Env.vars =
                              [(("c", 21), (Env.Var (Syntax.Loc 21)));
                                (("close_rpc", 0), (Env.ExtSyscall 1));
                                (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                (("connect_rpc", 0), (Env.ExtSyscall 1));
                                (("recv", 0), (Env.ExtSyscall 1));
                                (("send", 0), (Env.ExtSyscall 2));
                                (("verify", 0), (Env.ExtFun 3));
                                (("true", 0), Env.ExtConst);
                                (("snd", 0), (Env.ExtFun 1));
                                (("fst", 0), (Env.ExtFun 1));
                                (("sign", 0), (Env.ExtFun 2));
                                (("pk", 0), (Env.ExtFun 1))];
                              facts =
                              ref ([("BobClose", (Env.Global, (Some 0)));
                                     ("IntegrityFail", (Env.Global, (Some 1)));
                                     ("IntegritySuccess",
                                      (Env.Global, (Some 1)));
                                     ("AliceClose", (Env.Global, (Some 0)));
                                     ("MsgSend", (Env.Global, (Some 1)));
                                     ("Out", (Env.Global, (Some 1)));
                                     ("In", (Env.Global, (Some 1)));
                                     ("exit", (Env.Channel, (Some 0)));
                                     ("Returned", (Env.Channel, (Some 1)));
                                     ("invoke", (Env.Channel, (Some 3)));
                                     ("conn", (Env.Channel, (Some 0)));
                                     ("chid", (Env.Structure, (Some 1)));
                                     ("ack", (Env.Channel, (Some 0)));
                                     ("req", (Env.Channel, (Some 0)));
                                     ("store", (Env.Channel, (Some 1)))])
                              } }
                            ];
                          cmd =
                          { desc = (Typed.Put
                                      [{ desc = Typed.Channel {
                                                  channel =
                                                  { desc = Typed.Ident {
                                                             id = ("c", 21);
                                                             desc =
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   21));
                                                             param = None}; env = 
                                                  { Env.vars =
                                                    [(("c", 21),
                                                      (Env.Var
                                                         (Syntax.Loc 21)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                                                  name = "ack"; args = []}; env = 
                                        { Env.vars =
                                          [(("c", 21),
                                            (Env.Var (Syntax.Loc 21)));
                                            (("close_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("invoke_rpc", 0),
                                             (Env.ExtSyscall 4));
                                            (("connect_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]); env = { Env.vars =
                                                    [(("c", 21),
                                                      (Env.Var
                                                         (Syntax.Loc 21)));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 21), (Env.Var (Syntax.Loc 21)));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("close_rpc", 0),
                                                     (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Syscall {id = ("message", 0);
           fun_sig = (Typed.DesSMFunUntyped []);
           cmd =
           { desc = (Typed.New (("v", 22), None, None,
                       { desc = (Typed.Return
                                   { desc = Typed.Ident {id = ("v", 22);
                                              desc =
                                              (Env.Var (Syntax.Loc 22));
                                              param = None}; env = { Env.vars =
                                                                    [((
                                                                    "v", 22),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    22)));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }); env = 
                       { Env.vars =
                         [(("v", 22), (Env.Var (Syntax.Loc 22)));
                           (("accept_rpc", 0), (Env.ExtSyscall 1));
                           (("close_rpc", 0), (Env.ExtSyscall 1));
                           (("invoke_rpc", 0), (Env.ExtSyscall 4));
                           (("connect_rpc", 0), (Env.ExtSyscall 1));
                           (("recv", 0), (Env.ExtSyscall 1));
                           (("send", 0), (Env.ExtSyscall 2));
                           (("verify", 0), (Env.ExtFun 3));
                           (("true", 0), Env.ExtConst);
                           (("snd", 0), (Env.ExtFun 1));
                           (("fst", 0), (Env.ExtFun 1));
                           (("sign", 0), (Env.ExtFun 2));
                           (("pk", 0), (Env.ExtFun 1))];
                         facts =
                         ref ([("BobClose", (Env.Global, (Some 0)));
                                ("IntegrityFail", (Env.Global, (Some 1)));
                                ("IntegritySuccess", (Env.Global, (Some 1)));
                                ("AliceClose", (Env.Global, (Some 0)));
                                ("MsgSend", (Env.Global, (Some 1)));
                                ("Out", (Env.Global, (Some 1)));
                                ("In", (Env.Global, (Some 1)));
                                ("exit", (Env.Channel, (Some 0)));
                                ("Returned", (Env.Channel, (Some 1)));
                                ("invoke", (Env.Channel, (Some 3)));
                                ("conn", (Env.Channel, (Some 0)));
                                ("chid", (Env.Structure, (Some 1)));
                                ("ack", (Env.Channel, (Some 0)));
                                ("req", (Env.Channel, (Some 0)));
                                ("store", (Env.Channel, (Some 1)))])
                         } }
                       )); env = { Env.vars =
                                   [(("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("accept_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Type {id = ("readonly_t", 0); typclass = Input.CFsys}; env = 
{ Env.vars =
  [(("message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Type {id = ("client_t", 0); typclass = Input.CProc}; env = 
{ Env.vars =
  [(("readonly_t", 0), Env.FilesysTypeDef);
    (("message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Type {id = ("udp_t", 0); typclass = (Input.CChan [])}; env = 
{ Env.vars =
  [(("client_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Allow {process_typ = ("client_t", 0);
           target_typs = [("udp_t", 0)];
           syscalls = (Some [("send", 0); ("recv", 0)])}; env = { Env.vars =
                                                                  [((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
{ desc = Typed.Allow {process_typ = ("client_t", 0); target_typs = [];
           syscalls = (Some [("message", 0)])}; env = { Env.vars =
                                                        [(("udp_t", 0),
                                                          (Env.ChanTypeDef []));
                                                          (("client_t", 0),
                                                           Env.ProcTypeDef);
                                                          (("readonly_t", 0),
                                                           Env.FilesysTypeDef);
                                                          (("message", 0),
                                                           (Env.ExtSyscall 0));
                                                          (("accept_rpc", 0),
                                                           (Env.ExtSyscall 1));
                                                          (("close_rpc", 0),
                                                           (Env.ExtSyscall 1));
                                                          (("invoke_rpc", 0),
                                                           (Env.ExtSyscall 4));
                                                          (("connect_rpc", 0),
                                                           (Env.ExtSyscall 1));
                                                          (("recv", 0),
                                                           (Env.ExtSyscall 1));
                                                          (("send", 0),
                                                           (Env.ExtSyscall 2));
                                                          (("verify", 0),
                                                           (Env.ExtFun 3));
                                                          (("true", 0),
                                                           Env.ExtConst);
                                                          (("snd", 0),
                                                           (Env.ExtFun 1));
                                                          (("fst", 0),
                                                           (Env.ExtFun 1));
                                                          (("sign", 0),
                                                           (Env.ExtFun 2));
                                                          (("pk", 0),
                                                           (Env.ExtFun 1))
                                                          ];
                                                        facts =
                                                        ref ([("BobClose",
                                                               (Env.Global,
                                                                (Some 0)));
                                                               ("IntegrityFail",
                                                                (Env.Global,
                                                                 (Some 1)));
                                                               ("IntegritySuccess",
                                                                (Env.Global,
                                                                 (Some 1)));
                                                               ("AliceClose",
                                                                (Env.Global,
                                                                 (Some 0)));
                                                               ("MsgSend",
                                                                (Env.Global,
                                                                 (Some 1)));
                                                               ("Out",
                                                                (Env.Global,
                                                                 (Some 1)));
                                                               ("In",
                                                                (Env.Global,
                                                                 (Some 1)));
                                                               ("exit",
                                                                (Env.Channel,
                                                                 (Some 0)));
                                                               ("Returned",
                                                                (Env.Channel,
                                                                 (Some 1)));
                                                               ("invoke",
                                                                (Env.Channel,
                                                                 (Some 3)));
                                                               ("conn",
                                                                (Env.Channel,
                                                                 (Some 0)));
                                                               ("chid",
                                                                (Env.Structure,
                                                                 (Some 1)));
                                                               ("ack",
                                                                (Env.Channel,
                                                                 (Some 0)));
                                                               ("req",
                                                                (Env.Channel,
                                                                 (Some 0)));
                                                               ("store",
                                                                (Env.Channel,
                                                                 (Some 1)))
                                                               ])
                                                        } }
{ desc = Typed.Attack {id = ("tamper_channel", 0); syscall = ("recv", 0);
           args = [("c", 23)];
           cmd =
           { desc = (Typed.Case
                       [{ Typed.fresh = [("w", 25); ("j", 24)];
                          facts =
                          [{ desc = Typed.Channel {
                                      channel =
                                      { desc = Typed.Ident {id = ("c", 23);
                                                 desc =
                                                 (Env.Var (Syntax.Loc 23));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("j", 24),
                                          (Env.Var (Syntax.Meta 24)));
                                          (("w", 25),
                                           (Env.Var (Syntax.Meta 25)));
                                          (("c", 23),
                                           (Env.Var (Syntax.Loc 23)));
                                          (("udp_t", 0), (Env.ChanTypeDef []));
                                          (("client_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("message", 0), (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } };
                                      name = "store";
                                      args =
                                      [{ desc = Typed.Ident {id = ("j", 24);
                                                  desc =
                                                  (Env.Var (Syntax.Meta 24));
                                                  param = None}; env = 
                                        { Env.vars =
                                          [(("j", 24),
                                            (Env.Var (Syntax.Meta 24)));
                                            (("w", 25),
                                             (Env.Var (Syntax.Meta 25)));
                                            (("c", 23),
                                             (Env.Var (Syntax.Loc 23)));
                                            (("udp_t", 0),
                                             (Env.ChanTypeDef []));
                                            (("client_t", 0), Env.ProcTypeDef);
                                            (("readonly_t", 0),
                                             Env.FilesysTypeDef);
                                            (("message", 0),
                                             (Env.ExtSyscall 0));
                                            (("accept_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("close_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("invoke_rpc", 0),
                                             (Env.ExtSyscall 4));
                                            (("connect_rpc", 0),
                                             (Env.ExtSyscall 1));
                                            (("recv", 0), (Env.ExtSyscall 1));
                                            (("send", 0), (Env.ExtSyscall 2));
                                            (("verify", 0), (Env.ExtFun 3));
                                            (("true", 0), Env.ExtConst);
                                            (("snd", 0), (Env.ExtFun 1));
                                            (("fst", 0), (Env.ExtFun 1));
                                            (("sign", 0), (Env.ExtFun 2));
                                            (("pk", 0), (Env.ExtFun 1))];
                                          facts =
                                          ref ([("BobClose",
                                                 (Env.Global, (Some 0)));
                                                 ("IntegrityFail",
                                                  (Env.Global, (Some 1)));
                                                 ("IntegritySuccess",
                                                  (Env.Global, (Some 1)));
                                                 ("AliceClose",
                                                  (Env.Global, (Some 0)));
                                                 ("MsgSend",
                                                  (Env.Global, (Some 1)));
                                                 ("Out",
                                                  (Env.Global, (Some 1)));
                                                 ("In",
                                                  (Env.Global, (Some 1)));
                                                 ("exit",
                                                  (Env.Channel, (Some 0)));
                                                 ("Returned",
                                                  (Env.Channel, (Some 1)));
                                                 ("invoke",
                                                  (Env.Channel, (Some 3)));
                                                 ("conn",
                                                  (Env.Channel, (Some 0)));
                                                 ("chid",
                                                  (Env.Structure, (Some 1)));
                                                 ("ack",
                                                  (Env.Channel, (Some 0)));
                                                 ("req",
                                                  (Env.Channel, (Some 0)));
                                                 ("store",
                                                  (Env.Channel, (Some 1)))
                                                 ])
                                          } }
                                        ]}; env = { Env.vars =
                                                    [(("j", 24),
                                                      (Env.Var
                                                         (Syntax.Meta 24)));
                                                      (("w", 25),
                                                       (Env.Var
                                                          (Syntax.Meta 25)));
                                                      (("c", 23),
                                                       (Env.Var
                                                          (Syntax.Loc 23)));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("message", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } };
                            { desc = (Typed.Global ("In",
                                        [{ desc = Typed.Ident {
                                                    id = ("w", 25);
                                                    desc =
                                                    (Env.Var (Syntax.Meta 25));
                                                    param = None}; env = 
                                          { Env.vars =
                                            [(("j", 24),
                                              (Env.Var (Syntax.Meta 24)));
                                              (("w", 25),
                                               (Env.Var (Syntax.Meta 25)));
                                              (("c", 23),
                                               (Env.Var (Syntax.Loc 23)));
                                              (("udp_t", 0),
                                               (Env.ChanTypeDef []));
                                              (("client_t", 0),
                                               Env.ProcTypeDef);
                                              (("readonly_t", 0),
                                               Env.FilesysTypeDef);
                                              (("message", 0),
                                               (Env.ExtSyscall 0));
                                              (("accept_rpc", 0),
                                               (Env.ExtSyscall 1));
                                              (("close_rpc", 0),
                                               (Env.ExtSyscall 1));
                                              (("invoke_rpc", 0),
                                               (Env.ExtSyscall 4));
                                              (("connect_rpc", 0),
                                               (Env.ExtSyscall 1));
                                              (("recv", 0),
                                               (Env.ExtSyscall 1));
                                              (("send", 0),
                                               (Env.ExtSyscall 2));
                                              (("verify", 0), (Env.ExtFun 3));
                                              (("true", 0), Env.ExtConst);
                                              (("snd", 0), (Env.ExtFun 1));
                                              (("fst", 0), (Env.ExtFun 1));
                                              (("sign", 0), (Env.ExtFun 2));
                                              (("pk", 0), (Env.ExtFun 1))];
                                            facts =
                                            ref ([("BobClose",
                                                   (Env.Global, (Some 0)));
                                                   ("IntegrityFail",
                                                    (Env.Global, (Some 1)));
                                                   ("IntegritySuccess",
                                                    (Env.Global, (Some 1)));
                                                   ("AliceClose",
                                                    (Env.Global, (Some 0)));
                                                   ("MsgSend",
                                                    (Env.Global, (Some 1)));
                                                   ("Out",
                                                    (Env.Global, (Some 1)));
                                                   ("In",
                                                    (Env.Global, (Some 1)));
                                                   ("exit",
                                                    (Env.Channel, (Some 0)));
                                                   ("Returned",
                                                    (Env.Channel, (Some 1)));
                                                   ("invoke",
                                                    (Env.Channel, (Some 3)));
                                                   ("conn",
                                                    (Env.Channel, (Some 0)));
                                                   ("chid",
                                                    (Env.Structure, (Some 1)));
                                                   ("ack",
                                                    (Env.Channel, (Some 0)));
                                                   ("req",
                                                    (Env.Channel, (Some 0)));
                                                   ("store",
                                                    (Env.Channel, (Some 1)))
                                                   ])
                                            } }
                                          ]
                                        )); env = { Env.vars =
                                                    [(("j", 24),
                                                      (Env.Var
                                                         (Syntax.Meta 24)));
                                                      (("w", 25),
                                                       (Env.Var
                                                          (Syntax.Meta 25)));
                                                      (("c", 23),
                                                       (Env.Var
                                                          (Syntax.Loc 23)));
                                                      (("udp_t", 0),
                                                       (Env.ChanTypeDef []));
                                                      (("client_t", 0),
                                                       Env.ProcTypeDef);
                                                      (("readonly_t", 0),
                                                       Env.FilesysTypeDef);
                                                      (("message", 0),
                                                       (Env.ExtSyscall 0));
                                                      (("accept_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("close_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("invoke_rpc", 0),
                                                       (Env.ExtSyscall 4));
                                                      (("connect_rpc", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("recv", 0),
                                                       (Env.ExtSyscall 1));
                                                      (("send", 0),
                                                       (Env.ExtSyscall 2));
                                                      (("verify", 0),
                                                       (Env.ExtFun 3));
                                                      (("true", 0),
                                                       Env.ExtConst);
                                                      (("snd", 0),
                                                       (Env.ExtFun 1));
                                                      (("fst", 0),
                                                       (Env.ExtFun 1));
                                                      (("sign", 0),
                                                       (Env.ExtFun 2));
                                                      (("pk", 0),
                                                       (Env.ExtFun 1))
                                                      ];
                                                    facts =
                                                    ref ([("BobClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                           ("IntegrityFail",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("IntegritySuccess",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("AliceClose",
                                                            (Env.Global,
                                                             (Some 0)));
                                                           ("MsgSend",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("Out",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("In",
                                                            (Env.Global,
                                                             (Some 1)));
                                                           ("exit",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("Returned",
                                                            (Env.Channel,
                                                             (Some 1)));
                                                           ("invoke",
                                                            (Env.Channel,
                                                             (Some 3)));
                                                           ("conn",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("chid",
                                                            (Env.Structure,
                                                             (Some 1)));
                                                           ("ack",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("req",
                                                            (Env.Channel,
                                                             (Some 0)));
                                                           ("store",
                                                            (Env.Channel,
                                                             (Some 1)))
                                                           ])
                                                    } }
                            ];
                          cmd =
                          { desc = (Typed.Return
                                      { desc = Typed.Ident {id = ("w", 25);
                                                 desc =
                                                 (Env.Var (Syntax.Meta 25));
                                                 param = None}; env = 
                                      { Env.vars =
                                        [(("j", 24),
                                          (Env.Var (Syntax.Meta 24)));
                                          (("w", 25),
                                           (Env.Var (Syntax.Meta 25)));
                                          (("c", 23),
                                           (Env.Var (Syntax.Loc 23)));
                                          (("udp_t", 0), (Env.ChanTypeDef []));
                                          (("client_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("message", 0), (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }); env = { Env.vars =
                                                      [(("j", 24),
                                                        (Env.Var
                                                           (Syntax.Meta 24)));
                                                        (("w", 25),
                                                         (Env.Var
                                                            (Syntax.Meta 25)));
                                                        (("c", 23),
                                                         (Env.Var
                                                            (Syntax.Loc 23)));
                                                        (("udp_t", 0),
                                                         (Env.ChanTypeDef []));
                                                        (("client_t", 0),
                                                         Env.ProcTypeDef);
                                                        (("readonly_t", 0),
                                                         Env.FilesysTypeDef);
                                                        (("message", 0),
                                                         (Env.ExtSyscall 0));
                                                        (("accept_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("close_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("invoke_rpc", 0),
                                                         (Env.ExtSyscall 4));
                                                        (("connect_rpc", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("recv", 0),
                                                         (Env.ExtSyscall 1));
                                                        (("send", 0),
                                                         (Env.ExtSyscall 2));
                                                        (("verify", 0),
                                                         (Env.ExtFun 3));
                                                        (("true", 0),
                                                         Env.ExtConst);
                                                        (("snd", 0),
                                                         (Env.ExtFun 1));
                                                        (("fst", 0),
                                                         (Env.ExtFun 1));
                                                        (("sign", 0),
                                                         (Env.ExtFun 2));
                                                        (("pk", 0),
                                                         (Env.ExtFun 1))
                                                        ];
                                                      facts =
                                                      ref ([("BobClose",
                                                             (Env.Global,
                                                              (Some 0)));
                                                             ("IntegrityFail",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("IntegritySuccess",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("AliceClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                             ("MsgSend",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("Out",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("In",
                                                              (Env.Global,
                                                               (Some 1)));
                                                             ("exit",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("Returned",
                                                              (Env.Channel,
                                                               (Some 1)));
                                                             ("invoke",
                                                              (Env.Channel,
                                                               (Some 3)));
                                                             ("conn",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("chid",
                                                              (Env.Structure,
                                                               (Some 1)));
                                                             ("ack",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("req",
                                                              (Env.Channel,
                                                               (Some 0)));
                                                             ("store",
                                                              (Env.Channel,
                                                               (Some 1)))
                                                             ])
                                                      } }
                          }
                         ]); env = { Env.vars =
                                     [(("c", 23), (Env.Var (Syntax.Loc 23)));
                                       (("udp_t", 0), (Env.ChanTypeDef []));
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("message", 0), (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("udp_t", 0),
                                                     (Env.ChanTypeDef []));
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.AllowAttack {process_typs = [("client_t", 0)];
           attacks = [("tamper_channel", 0)]}; env = { Env.vars =
                                                       [(("tamper_channel", 0),
                                                         Env.Attack);
                                                         (("udp_t", 0),
                                                          (Env.ChanTypeDef []));
                                                         (("client_t", 0),
                                                          Env.ProcTypeDef);
                                                         (("readonly_t", 0),
                                                          Env.FilesysTypeDef);
                                                         (("message", 0),
                                                          (Env.ExtSyscall 0));
                                                         (("accept_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("close_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("invoke_rpc", 0),
                                                          (Env.ExtSyscall 4));
                                                         (("connect_rpc", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("recv", 0),
                                                          (Env.ExtSyscall 1));
                                                         (("send", 0),
                                                          (Env.ExtSyscall 2));
                                                         (("verify", 0),
                                                          (Env.ExtFun 3));
                                                         (("true", 0),
                                                          Env.ExtConst);
                                                         (("snd", 0),
                                                          (Env.ExtFun 1));
                                                         (("fst", 0),
                                                          (Env.ExtFun 1));
                                                         (("sign", 0),
                                                          (Env.ExtFun 2));
                                                         (("pk", 0),
                                                          (Env.ExtFun 1))
                                                         ];
                                                       facts =
                                                       ref ([("BobClose",
                                                              (Env.Global,
                                                               (Some 0)));
                                                              ("IntegrityFail",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("IntegritySuccess",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("AliceClose",
                                                               (Env.Global,
                                                                (Some 0)));
                                                              ("MsgSend",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("Out",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("In",
                                                               (Env.Global,
                                                                (Some 1)));
                                                              ("exit",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("Returned",
                                                               (Env.Channel,
                                                                (Some 1)));
                                                              ("invoke",
                                                               (Env.Channel,
                                                                (Some 3)));
                                                              ("conn",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("chid",
                                                               (Env.Structure,
                                                                (Some 1)));
                                                              ("ack",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("req",
                                                               (Env.Channel,
                                                                (Some 0)));
                                                              ("store",
                                                               (Env.Channel,
                                                                (Some 1)))
                                                              ])
                                                       } }
{ desc = Typed.Syscall {id = ("eaves_mem", 0);
           fun_sig = (Typed.DesSMFunUntyped [("v", 26)]);
           cmd =
           { desc = (Typed.Put
                       [{ desc = (Typed.Global ("Out",
                                    [{ desc = Typed.Ident {id = ("v", 26);
                                                desc =
                                                (Env.Var (Syntax.Loc 26));
                                                param = None}; env = 
                                      { Env.vars =
                                        [(("v", 26),
                                          (Env.Var (Syntax.Loc 26)));
                                          (("tamper_channel", 0), Env.Attack);
                                          (("udp_t", 0), (Env.ChanTypeDef []));
                                          (("client_t", 0), Env.ProcTypeDef);
                                          (("readonly_t", 0),
                                           Env.FilesysTypeDef);
                                          (("message", 0), (Env.ExtSyscall 0));
                                          (("accept_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("close_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("invoke_rpc", 0),
                                           (Env.ExtSyscall 4));
                                          (("connect_rpc", 0),
                                           (Env.ExtSyscall 1));
                                          (("recv", 0), (Env.ExtSyscall 1));
                                          (("send", 0), (Env.ExtSyscall 2));
                                          (("verify", 0), (Env.ExtFun 3));
                                          (("true", 0), Env.ExtConst);
                                          (("snd", 0), (Env.ExtFun 1));
                                          (("fst", 0), (Env.ExtFun 1));
                                          (("sign", 0), (Env.ExtFun 2));
                                          (("pk", 0), (Env.ExtFun 1))];
                                        facts =
                                        ref ([("BobClose",
                                               (Env.Global, (Some 0)));
                                               ("IntegrityFail",
                                                (Env.Global, (Some 1)));
                                               ("IntegritySuccess",
                                                (Env.Global, (Some 1)));
                                               ("AliceClose",
                                                (Env.Global, (Some 0)));
                                               ("MsgSend",
                                                (Env.Global, (Some 1)));
                                               ("Out", (Env.Global, (Some 1)));
                                               ("In", (Env.Global, (Some 1)));
                                               ("exit",
                                                (Env.Channel, (Some 0)));
                                               ("Returned",
                                                (Env.Channel, (Some 1)));
                                               ("invoke",
                                                (Env.Channel, (Some 3)));
                                               ("conn",
                                                (Env.Channel, (Some 0)));
                                               ("chid",
                                                (Env.Structure, (Some 1)));
                                               ("ack",
                                                (Env.Channel, (Some 0)));
                                               ("req",
                                                (Env.Channel, (Some 0)));
                                               ("store",
                                                (Env.Channel, (Some 1)))
                                               ])
                                        } }
                                      ]
                                    )); env = { Env.vars =
                                                [(("v", 26),
                                                  (Env.Var (Syntax.Loc 26)));
                                                  (("tamper_channel", 0),
                                                   Env.Attack);
                                                  (("udp_t", 0),
                                                   (Env.ChanTypeDef []));
                                                  (("client_t", 0),
                                                   Env.ProcTypeDef);
                                                  (("readonly_t", 0),
                                                   Env.FilesysTypeDef);
                                                  (("message", 0),
                                                   (Env.ExtSyscall 0));
                                                  (("accept_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("close_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("invoke_rpc", 0),
                                                   (Env.ExtSyscall 4));
                                                  (("connect_rpc", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("recv", 0),
                                                   (Env.ExtSyscall 1));
                                                  (("send", 0),
                                                   (Env.ExtSyscall 2));
                                                  (("verify", 0),
                                                   (Env.ExtFun 3));
                                                  (("true", 0), Env.ExtConst);
                                                  (("snd", 0), (Env.ExtFun 1));
                                                  (("fst", 0), (Env.ExtFun 1));
                                                  (("sign", 0),
                                                   (Env.ExtFun 2));
                                                  (("pk", 0), (Env.ExtFun 1))
                                                  ];
                                                facts =
                                                ref ([("BobClose",
                                                       (Env.Global, (Some 0)));
                                                       ("IntegrityFail",
                                                        (Env.Global, (Some 1)));
                                                       ("IntegritySuccess",
                                                        (Env.Global, (Some 1)));
                                                       ("AliceClose",
                                                        (Env.Global, (Some 0)));
                                                       ("MsgSend",
                                                        (Env.Global, (Some 1)));
                                                       ("Out",
                                                        (Env.Global, (Some 1)));
                                                       ("In",
                                                        (Env.Global, (Some 1)));
                                                       ("exit",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("Returned",
                                                        (Env.Channel,
                                                         (Some 1)));
                                                       ("invoke",
                                                        (Env.Channel,
                                                         (Some 3)));
                                                       ("conn",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("chid",
                                                        (Env.Structure,
                                                         (Some 1)));
                                                       ("ack",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("req",
                                                        (Env.Channel,
                                                         (Some 0)));
                                                       ("store",
                                                        (Env.Channel,
                                                         (Some 1)))
                                                       ])
                                                } }
                         ]); env = { Env.vars =
                                     [(("v", 26), (Env.Var (Syntax.Loc 26)));
                                       (("tamper_channel", 0), Env.Attack);
                                       (("udp_t", 0), (Env.ChanTypeDef []));
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("message", 0), (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } }}; env = { Env.vars =
                                                   [(("tamper_channel", 0),
                                                     Env.Attack);
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
{ desc = Typed.Allow {process_typ = ("client_t", 0); target_typs = [];
           syscalls = (Some [("eaves_mem", 0)])}; env = { Env.vars =
                                                          [(("eaves_mem", 0),
                                                            (Env.ExtSyscall 1));
                                                            (("tamper_channel",
                                                              0),
                                                             Env.Attack);
                                                            (("udp_t", 0),
                                                             (Env.ChanTypeDef
                                                                []));
                                                            (("client_t", 0),
                                                             Env.ProcTypeDef);
                                                            (("readonly_t", 0),
                                                             Env.FilesysTypeDef);
                                                            (("message", 0),
                                                             (Env.ExtSyscall
                                                                0));
                                                            (("accept_rpc", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("close_rpc", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("invoke_rpc", 0),
                                                             (Env.ExtSyscall
                                                                4));
                                                            (("connect_rpc",
                                                              0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("recv", 0),
                                                             (Env.ExtSyscall
                                                                1));
                                                            (("send", 0),
                                                             (Env.ExtSyscall
                                                                2));
                                                            (("verify", 0),
                                                             (Env.ExtFun 3));
                                                            (("true", 0),
                                                             Env.ExtConst);
                                                            (("snd", 0),
                                                             (Env.ExtFun 1));
                                                            (("fst", 0),
                                                             (Env.ExtFun 1));
                                                            (("sign", 0),
                                                             (Env.ExtFun 2));
                                                            (("pk", 0),
                                                             (Env.ExtFun 1))
                                                            ];
                                                          facts =
                                                          ref ([("BobClose",
                                                                 (Env.Global,
                                                                  (Some 0)));
                                                                 ("IntegrityFail",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("IntegritySuccess",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("AliceClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                 ("MsgSend",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("Out",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("In",
                                                                  (Env.Global,
                                                                   (Some 1)));
                                                                 ("exit",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("Returned",
                                                                  (Env.Channel,
                                                                   (Some 1)));
                                                                 ("invoke",
                                                                  (Env.Channel,
                                                                   (Some 3)));
                                                                 ("conn",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("chid",
                                                                  (Env.Structure,
                                                                   (Some 1)));
                                                                 ("ack",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("req",
                                                                  (Env.Channel,
                                                                   (Some 0)));
                                                                 ("store",
                                                                  (Env.Channel,
                                                                   (Some 1)))
                                                                 ])
                                                          } }
{ desc = Typed.Init {id = ("priv_key_alice", 0); desc = Typed.Fresh}; env = 
{ Env.vars =
  [(("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("udp_t", 0), (Env.ChanTypeDef [])); (("client_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Channel {id = ("udp", 0); param = None; typ = ("udp_t", 0)}; env = 
{ Env.vars =
  [(("priv_key_alice", 0), (Env.Const (false, None)));
    (("eaves_mem", 0), (Env.ExtSyscall 1));
    (("tamper_channel", 0), Env.Attack);
    (("udp_t", 0), (Env.ChanTypeDef [])); (("client_t", 0), Env.ProcTypeDef);
    (("readonly_t", 0), Env.FilesysTypeDef);
    (("message", 0), (Env.ExtSyscall 0));
    (("accept_rpc", 0), (Env.ExtSyscall 1));
    (("close_rpc", 0), (Env.ExtSyscall 1));
    (("invoke_rpc", 0), (Env.ExtSyscall 4));
    (("connect_rpc", 0), (Env.ExtSyscall 1));
    (("recv", 0), (Env.ExtSyscall 1)); (("send", 0), (Env.ExtSyscall 2));
    (("verify", 0), (Env.ExtFun 3)); (("true", 0), Env.ExtConst);
    (("snd", 0), (Env.ExtFun 1)); (("fst", 0), (Env.ExtFun 1));
    (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
  facts =
  ref ([("BobClose", (Env.Global, (Some 0)));
         ("IntegrityFail", (Env.Global, (Some 1)));
         ("IntegritySuccess", (Env.Global, (Some 1)));
         ("AliceClose", (Env.Global, (Some 0)));
         ("MsgSend", (Env.Global, (Some 1)));
         ("Out", (Env.Global, (Some 1))); ("In", (Env.Global, (Some 1)));
         ("exit", (Env.Channel, (Some 0)));
         ("Returned", (Env.Channel, (Some 1)));
         ("invoke", (Env.Channel, (Some 3)));
         ("conn", (Env.Channel, (Some 0)));
         ("chid", (Env.Structure, (Some 1)));
         ("ack", (Env.Channel, (Some 0))); ("req", (Env.Channel, (Some 0)));
         ("store", (Env.Channel, (Some 1)))])
  } }
{ desc = Typed.Process {id = ("alice", 0); param = None;
           args =
           [{ Typed.channel = ("ch_net", 27); param = None;
              typ = ("udp_t", 0) }
             ];
           typ = ("client_t", 0); files = [];
           vars =
           [(("n", 28), None,
             { desc = Typed.Ident {id = ("priv_key_alice", 0);
                        desc = (Env.Const (false, None)); param = None}; env = 
             { Env.vars =
               [(("ch_net", 27), (Env.Channel (false, ("udp_t", 0))));
                 (("udp", 0), (Env.Channel (false, ("udp_t", 0))));
                 (("priv_key_alice", 0), (Env.Const (false, None)));
                 (("eaves_mem", 0), (Env.ExtSyscall 1));
                 (("tamper_channel", 0), Env.Attack);
                 (("udp_t", 0), (Env.ChanTypeDef []));
                 (("client_t", 0), Env.ProcTypeDef);
                 (("readonly_t", 0), Env.FilesysTypeDef);
                 (("message", 0), (Env.ExtSyscall 0));
                 (("accept_rpc", 0), (Env.ExtSyscall 1));
                 (("close_rpc", 0), (Env.ExtSyscall 1));
                 (("invoke_rpc", 0), (Env.ExtSyscall 4));
                 (("connect_rpc", 0), (Env.ExtSyscall 1));
                 (("recv", 0), (Env.ExtSyscall 1));
                 (("send", 0), (Env.ExtSyscall 2));
                 (("verify", 0), (Env.ExtFun 3));
                 (("true", 0), Env.ExtConst); (("snd", 0), (Env.ExtFun 1));
                 (("fst", 0), (Env.ExtFun 1)); (("sign", 0), (Env.ExtFun 2));
                 (("pk", 0), (Env.ExtFun 1))];
               facts =
               ref ([("BobClose", (Env.Global, (Some 0)));
                      ("IntegrityFail", (Env.Global, (Some 1)));
                      ("IntegritySuccess", (Env.Global, (Some 1)));
                      ("AliceClose", (Env.Global, (Some 0)));
                      ("MsgSend", (Env.Global, (Some 1)));
                      ("Out", (Env.Global, (Some 1)));
                      ("In", (Env.Global, (Some 1)));
                      ("exit", (Env.Channel, (Some 0)));
                      ("Returned", (Env.Channel, (Some 1)));
                      ("invoke", (Env.Channel, (Some 3)));
                      ("conn", (Env.Channel, (Some 0)));
                      ("chid", (Env.Structure, (Some 1)));
                      ("ack", (Env.Channel, (Some 0)));
                      ("req", (Env.Channel, (Some 0)));
                      ("store", (Env.Channel, (Some 1)))])
               } })
             ];
           funcs = [];
           main =
           { desc = (Typed.Let (("msg", 29),
                       { desc = (Typed.Apply (("message", 0), [])); env = 
                       { Env.vars =
                         [(("n", 28), (Env.Var (Syntax.Loc 28)));
                           (("ch_net", 27),
                            (Env.Channel (false, ("udp_t", 0))));
                           (("udp", 0), (Env.Channel (false, ("udp_t", 0))));
                           (("priv_key_alice", 0), (Env.Const (false, None)));
                           (("eaves_mem", 0), (Env.ExtSyscall 1));
                           (("tamper_channel", 0), Env.Attack);
                           (("udp_t", 0), (Env.ChanTypeDef []));
                           (("client_t", 0), Env.ProcTypeDef);
                           (("readonly_t", 0), Env.FilesysTypeDef);
                           (("message", 0), (Env.ExtSyscall 0));
                           (("accept_rpc", 0), (Env.ExtSyscall 1));
                           (("close_rpc", 0), (Env.ExtSyscall 1));
                           (("invoke_rpc", 0), (Env.ExtSyscall 4));
                           (("connect_rpc", 0), (Env.ExtSyscall 1));
                           (("recv", 0), (Env.ExtSyscall 1));
                           (("send", 0), (Env.ExtSyscall 2));
                           (("verify", 0), (Env.ExtFun 3));
                           (("true", 0), Env.ExtConst);
                           (("snd", 0), (Env.ExtFun 1));
                           (("fst", 0), (Env.ExtFun 1));
                           (("sign", 0), (Env.ExtFun 2));
                           (("pk", 0), (Env.ExtFun 1))];
                         facts =
                         ref ([("BobClose", (Env.Global, (Some 0)));
                                ("IntegrityFail", (Env.Global, (Some 1)));
                                ("IntegritySuccess", (Env.Global, (Some 1)));
                                ("AliceClose", (Env.Global, (Some 0)));
                                ("MsgSend", (Env.Global, (Some 1)));
                                ("Out", (Env.Global, (Some 1)));
                                ("In", (Env.Global, (Some 1)));
                                ("exit", (Env.Channel, (Some 0)));
                                ("Returned", (Env.Channel, (Some 1)));
                                ("invoke", (Env.Channel, (Some 3)));
                                ("conn", (Env.Channel, (Some 0)));
                                ("chid", (Env.Structure, (Some 1)));
                                ("ack", (Env.Channel, (Some 0)));
                                ("req", (Env.Channel, (Some 0)));
                                ("store", (Env.Channel, (Some 1)))])
                         } },
                       { desc = (Typed.Sequence (
                                   { desc = (Typed.Assign (None,
                                               { desc = (Typed.Apply (
                                                           ("eaves_mem", 0),
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("msg", 29);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    29));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("msg", 29),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    29)));
                                                                 (("n", 28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("priv_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    None)));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]
                                                           )); env = 
                                               { Env.vars =
                                                 [(("msg", 29),
                                                   (Env.Var (Syntax.Loc 29)));
                                                   (("n", 28),
                                                    (Env.Var (Syntax.Loc 28)));
                                                   (("ch_net", 27),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("priv_key_alice", 0),
                                                    (Env.Const (false, None)));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                                               )); env = { Env.vars =
                                                           [(("msg", 29),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   29)));
                                                             (("n", 28),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    28)));
                                                             (("ch_net", 27),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("priv_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false, None
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("message", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } },
                                   { desc = (Typed.Let (("sig", 30),
                                               { desc = (Typed.Apply (
                                                           ("sign", 0),
                                                           [{ desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("msg", 29);
                                                               desc =
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    29));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("msg", 29),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    29)));
                                                                 (("n", 28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("priv_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    None)));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } };
                                                             { desc = 
                                                             Typed.Ident {
                                                               id =
                                                               ("priv_key_alice",
                                                                0);
                                                               desc =
                                                               (Env.Const (
                                                                  false, None
                                                                  ));
                                                               param = None}; env = 
                                                             { Env.vars =
                                                               [(("msg", 29),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    29)));
                                                                 (("n", 28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("priv_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    None)));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]
                                                           )); env = 
                                               { Env.vars =
                                                 [(("msg", 29),
                                                   (Env.Var (Syntax.Loc 29)));
                                                   (("n", 28),
                                                    (Env.Var (Syntax.Loc 28)));
                                                   (("ch_net", 27),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("priv_key_alice", 0),
                                                    (Env.Const (false, None)));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               { desc = (Typed.Sequence (
                                                           { desc = (
                                                           Typed.Assign (
                                                             None,
                                                             { desc = (
                                                             Typed.Apply (
                                                               ("eaves_mem",
                                                                0),
                                                               [{ desc = 
                                                                 Typed.Ident {
                                                                   id =
                                                                   ("sig", 30);
                                                                   desc =
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    30));
                                                                   param =
                                                                   None}; env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 ]
                                                               )); env = 
                                                             { Env.vars =
                                                               [(("sig", 30),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    30)));
                                                                 (("msg", 29),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                 (("n", 28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("priv_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    None)));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             )); env = 
                                                           { Env.vars =
                                                             [(("sig", 30),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    30)));
                                                               (("msg", 29),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    29)));
                                                               (("n", 28),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    28)));
                                                               (("ch_net", 27),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("priv_key_alice",
                                                                 0),
                                                                (Env.Const (
                                                                   false,
                                                                   None)));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("message", 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } },
                                                           { desc = (
                                                           Typed.Sequence (
                                                             { desc = (
                                                             Typed.Event
                                                               [{ desc = (
                                                                 Typed.Global (
                                                                   "MsgSend",
                                                                   [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg", 29);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 ]); env = 
                                                             { Env.vars =
                                                               [(("sig", 30),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    30)));
                                                                 (("msg", 29),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                 (("n", 28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("priv_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    None)));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } },
                                                             { desc = (
                                                             Typed.Sequence (
                                                               { desc = (
                                                               Typed.Assign (
                                                                 None,
                                                                 { desc = (
                                                                 Typed.Apply (
                                                                   ("send", 0),
                                                                   [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "ch_net",
                                                                    27);
                                                                    desc =
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0)));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = (
                                                                    Typed.Tuple
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg", 29);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } };
                                                                    { desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "sig", 30);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    30));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }]
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 )); env = 
                                                               { Env.vars =
                                                                 [(("sig", 30),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                   ((
                                                                    "msg", 29),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                   ((
                                                                    "n", 28),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                   ((
                                                                    "ch_net",
                                                                    27),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    None)));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } },
                                                               { desc = (
                                                               Typed.Event
                                                                 [{ desc = (
                                                                   Typed.Global (
                                                                    "AliceClose",
                                                                    [])); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "sig", 30),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                    ((
                                                                    "msg", 29),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                    ((
                                                                    "n", 28),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                    ((
                                                                    "ch_net",
                                                                    27),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   ]); env = 
                                                               { Env.vars =
                                                                 [(("sig", 30),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    30)));
                                                                   ((
                                                                    "msg", 29),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                   ((
                                                                    "n", 28),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                   ((
                                                                    "ch_net",
                                                                    27),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    None)));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               )); env = 
                                                             { Env.vars =
                                                               [(("sig", 30),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    30)));
                                                                 (("msg", 29),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    29)));
                                                                 (("n", 28),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    28)));
                                                                 (("ch_net",
                                                                   27),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("priv_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    None)));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             )); env = 
                                                           { Env.vars =
                                                             [(("sig", 30),
                                                               (Env.Var
                                                                  (Syntax.Loc
                                                                    30)));
                                                               (("msg", 29),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    29)));
                                                               (("n", 28),
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    28)));
                                                               (("ch_net", 27),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("udp", 0),
                                                                (Env.Channel (
                                                                   false,
                                                                   ("udp_t",
                                                                    0)
                                                                   )));
                                                               (("priv_key_alice",
                                                                 0),
                                                                (Env.Const (
                                                                   false,
                                                                   None)));
                                                               (("eaves_mem",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("tamper_channel",
                                                                 0),
                                                                Env.Attack);
                                                               (("udp_t", 0),
                                                                (Env.ChanTypeDef
                                                                   []));
                                                               (("client_t",
                                                                 0),
                                                                Env.ProcTypeDef);
                                                               (("readonly_t",
                                                                 0),
                                                                Env.FilesysTypeDef);
                                                               (("message", 0),
                                                                (Env.ExtSyscall
                                                                   0));
                                                               (("accept_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("close_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("invoke_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   4));
                                                               (("connect_rpc",
                                                                 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("recv", 0),
                                                                (Env.ExtSyscall
                                                                   1));
                                                               (("send", 0),
                                                                (Env.ExtSyscall
                                                                   2));
                                                               (("verify", 0),
                                                                (Env.ExtFun 3));
                                                               (("true", 0),
                                                                Env.ExtConst);
                                                               (("snd", 0),
                                                                (Env.ExtFun 1));
                                                               (("fst", 0),
                                                                (Env.ExtFun 1));
                                                               (("sign", 0),
                                                                (Env.ExtFun 2));
                                                               (("pk", 0),
                                                                (Env.ExtFun 1))
                                                               ];
                                                             facts =
                                                             ref ([("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                             } }
                                                           )); env = 
                                               { Env.vars =
                                                 [(("sig", 30),
                                                   (Env.Var (Syntax.Loc 30)));
                                                   (("msg", 29),
                                                    (Env.Var (Syntax.Loc 29)));
                                                   (("n", 28),
                                                    (Env.Var (Syntax.Loc 28)));
                                                   (("ch_net", 27),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("priv_key_alice", 0),
                                                    (Env.Const (false, None)));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                                               )); env = { Env.vars =
                                                           [(("msg", 29),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   29)));
                                                             (("n", 28),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    28)));
                                                             (("ch_net", 27),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("priv_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false, None
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("message", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } }
                                   )); env = { Env.vars =
                                               [(("msg", 29),
                                                 (Env.Var (Syntax.Loc 29)));
                                                 (("n", 28),
                                                  (Env.Var (Syntax.Loc 28)));
                                                 (("ch_net", 27),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("priv_key_alice", 0),
                                                  (Env.Const (false, None)));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("message", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("n", 28), (Env.Var (Syntax.Loc 28)));
                                     (("ch_net", 27),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("udp", 0),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("priv_key_alice", 0),
                                      (Env.Const (false, None)));
                                     (("eaves_mem", 0), (Env.ExtSyscall 1));
                                     (("tamper_channel", 0), Env.Attack);
                                     (("udp_t", 0), (Env.ChanTypeDef []));
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("message", 0), (Env.ExtSyscall 0));
                                     (("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("udp", 0),
                                                   (Env.Channel (false,
                                                      ("udp_t", 0))));
                                                   (("priv_key_alice", 0),
                                                    (Env.Const (false, None)));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = Typed.Process {id = ("bob", 0); param = None;
           args =
           [{ Typed.channel = ("ch_net", 31); param = None;
              typ = ("udp_t", 0) }
             ];
           typ = ("client_t", 0); files = [];
           vars =
           [(("pub_key_alice", 32), None,
             { desc = (Typed.Apply (("pk", 0),
                         [{ desc = Typed.Ident {id = ("priv_key_alice", 0);
                                     desc = (Env.Const (false, None));
                                     param = None}; env = { Env.vars =
                                                            [(("ch_net", 31),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                              (("alice", 0),
                                                               Env.Process);
                                                              (("udp", 0),
                                                               (Env.Channel (
                                                                  false,
                                                                  ("udp_t", 0)
                                                                  )));
                                                              (("priv_key_alice",
                                                                0),
                                                               (Env.Const (
                                                                  false, None
                                                                  )));
                                                              (("eaves_mem",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("tamper_channel",
                                                                0),
                                                               Env.Attack);
                                                              (("udp_t", 0),
                                                               (Env.ChanTypeDef
                                                                  []));
                                                              (("client_t", 0),
                                                               Env.ProcTypeDef);
                                                              (("readonly_t",
                                                                0),
                                                               Env.FilesysTypeDef);
                                                              (("message", 0),
                                                               (Env.ExtSyscall
                                                                  0));
                                                              (("accept_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("close_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("invoke_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  4));
                                                              (("connect_rpc",
                                                                0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("recv", 0),
                                                               (Env.ExtSyscall
                                                                  1));
                                                              (("send", 0),
                                                               (Env.ExtSyscall
                                                                  2));
                                                              (("verify", 0),
                                                               (Env.ExtFun 3));
                                                              (("true", 0),
                                                               Env.ExtConst);
                                                              (("snd", 0),
                                                               (Env.ExtFun 1));
                                                              (("fst", 0),
                                                               (Env.ExtFun 1));
                                                              (("sign", 0),
                                                               (Env.ExtFun 2));
                                                              (("pk", 0),
                                                               (Env.ExtFun 1))
                                                              ];
                                                            facts =
                                                            ref ([("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                            } }
                           ]
                         )); env = { Env.vars =
                                     [(("ch_net", 31),
                                       (Env.Channel (false, ("udp_t", 0))));
                                       (("alice", 0), Env.Process);
                                       (("udp", 0),
                                        (Env.Channel (false, ("udp_t", 0))));
                                       (("priv_key_alice", 0),
                                        (Env.Const (false, None)));
                                       (("eaves_mem", 0), (Env.ExtSyscall 1));
                                       (("tamper_channel", 0), Env.Attack);
                                       (("udp_t", 0), (Env.ChanTypeDef []));
                                       (("client_t", 0), Env.ProcTypeDef);
                                       (("readonly_t", 0), Env.FilesysTypeDef);
                                       (("message", 0), (Env.ExtSyscall 0));
                                       (("accept_rpc", 0), (Env.ExtSyscall 1));
                                       (("close_rpc", 0), (Env.ExtSyscall 1));
                                       (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                       (("connect_rpc", 0),
                                        (Env.ExtSyscall 1));
                                       (("recv", 0), (Env.ExtSyscall 1));
                                       (("send", 0), (Env.ExtSyscall 2));
                                       (("verify", 0), (Env.ExtFun 3));
                                       (("true", 0), Env.ExtConst);
                                       (("snd", 0), (Env.ExtFun 1));
                                       (("fst", 0), (Env.ExtFun 1));
                                       (("sign", 0), (Env.ExtFun 2));
                                       (("pk", 0), (Env.ExtFun 1))];
                                     facts =
                                     ref ([("BobClose",
                                            (Env.Global, (Some 0)));
                                            ("IntegrityFail",
                                             (Env.Global, (Some 1)));
                                            ("IntegritySuccess",
                                             (Env.Global, (Some 1)));
                                            ("AliceClose",
                                             (Env.Global, (Some 0)));
                                            ("MsgSend",
                                             (Env.Global, (Some 1)));
                                            ("Out", (Env.Global, (Some 1)));
                                            ("In", (Env.Global, (Some 1)));
                                            ("exit", (Env.Channel, (Some 0)));
                                            ("Returned",
                                             (Env.Channel, (Some 1)));
                                            ("invoke",
                                             (Env.Channel, (Some 3)));
                                            ("conn", (Env.Channel, (Some 0)));
                                            ("chid",
                                             (Env.Structure, (Some 1)));
                                            ("ack", (Env.Channel, (Some 0)));
                                            ("req", (Env.Channel, (Some 0)));
                                            ("store", (Env.Channel, (Some 1)))
                                            ])
                                     } })
             ];
           funcs = [];
           main =
           { desc = (Typed.Let (("msg_with_sig", 33),
                       { desc = (Typed.Apply (("recv", 0),
                                   [{ desc = Typed.Ident {
                                               id = ("ch_net", 31);
                                               desc =
                                               (Env.Channel (false,
                                                  ("udp_t", 0)));
                                               param = None}; env = { Env.vars =
                                                                    [((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                     ]
                                   )); env = { Env.vars =
                                               [(("pub_key_alice", 32),
                                                 (Env.Var (Syntax.Loc 32)));
                                                 (("ch_net", 31),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("alice", 0), Env.Process);
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("priv_key_alice", 0),
                                                  (Env.Const (false, None)));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("message", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } },
                       { desc = (Typed.Let (("res", 34),
                                   { desc = (Typed.Apply (("verify", 0),
                                               [{ desc = (Typed.Apply (
                                                            ("snd", 0),
                                                            [{ desc = 
                                                              Typed.Ident {
                                                                id =
                                                                ("msg_with_sig",
                                                                 33);
                                                                desc =
                                                                (Env.Var
                                                                   (Syntax.Loc
                                                                    33));
                                                                param = None}; env = 
                                                              { Env.vars =
                                                                [(("msg_with_sig",
                                                                   33),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                  (("pub_key_alice",
                                                                    32),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                  (("ch_net",
                                                                    31),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("alice",
                                                                    0),
                                                                   Env.Process);
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("priv_key_alice",
                                                                    0),
                                                                   (Env.Const (
                                                                    false,
                                                                    None)));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("message",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              ]
                                                            )); env = 
                                                 { Env.vars =
                                                   [(("msg_with_sig", 33),
                                                     (Env.Var (Syntax.Loc 33)));
                                                     (("pub_key_alice", 32),
                                                      (Env.Var
                                                         (Syntax.Loc 32)));
                                                     (("ch_net", 31),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("alice", 0),
                                                      Env.Process);
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("priv_key_alice", 0),
                                                      (Env.Const (false, None
                                                         )));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } };
                                                 { desc = (Typed.Apply (
                                                             ("fst", 0),
                                                             [{ desc = 
                                                               Typed.Ident {
                                                                 id =
                                                                 ("msg_with_sig",
                                                                  33);
                                                                 desc =
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    33));
                                                                 param = None}; env = 
                                                               { Env.vars =
                                                                 [(("msg_with_sig",
                                                                    33),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                   ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                   ((
                                                                    "ch_net",
                                                                    31),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    None)));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               ]
                                                             )); env = 
                                                 { Env.vars =
                                                   [(("msg_with_sig", 33),
                                                     (Env.Var (Syntax.Loc 33)));
                                                     (("pub_key_alice", 32),
                                                      (Env.Var
                                                         (Syntax.Loc 32)));
                                                     (("ch_net", 31),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("alice", 0),
                                                      Env.Process);
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("priv_key_alice", 0),
                                                      (Env.Const (false, None
                                                         )));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } };
                                                 { desc = Typed.Ident {
                                                            id =
                                                            ("pub_key_alice",
                                                             32);
                                                            desc =
                                                            (Env.Var
                                                               (Syntax.Loc 32));
                                                            param = None}; env = 
                                                 { Env.vars =
                                                   [(("msg_with_sig", 33),
                                                     (Env.Var (Syntax.Loc 33)));
                                                     (("pub_key_alice", 32),
                                                      (Env.Var
                                                         (Syntax.Loc 32)));
                                                     (("ch_net", 31),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("alice", 0),
                                                      Env.Process);
                                                     (("udp", 0),
                                                      (Env.Channel (false,
                                                         ("udp_t", 0))));
                                                     (("priv_key_alice", 0),
                                                      (Env.Const (false, None
                                                         )));
                                                     (("eaves_mem", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("tamper_channel", 0),
                                                      Env.Attack);
                                                     (("udp_t", 0),
                                                      (Env.ChanTypeDef []));
                                                     (("client_t", 0),
                                                      Env.ProcTypeDef);
                                                     (("readonly_t", 0),
                                                      Env.FilesysTypeDef);
                                                     (("message", 0),
                                                      (Env.ExtSyscall 0));
                                                     (("accept_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("close_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("invoke_rpc", 0),
                                                      (Env.ExtSyscall 4));
                                                     (("connect_rpc", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("recv", 0),
                                                      (Env.ExtSyscall 1));
                                                     (("send", 0),
                                                      (Env.ExtSyscall 2));
                                                     (("verify", 0),
                                                      (Env.ExtFun 3));
                                                     (("true", 0),
                                                      Env.ExtConst);
                                                     (("snd", 0),
                                                      (Env.ExtFun 1));
                                                     (("fst", 0),
                                                      (Env.ExtFun 1));
                                                     (("sign", 0),
                                                      (Env.ExtFun 2));
                                                     (("pk", 0),
                                                      (Env.ExtFun 1))
                                                     ];
                                                   facts =
                                                   ref ([("BobClose",
                                                          (Env.Global,
                                                           (Some 0)));
                                                          ("IntegrityFail",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("IntegritySuccess",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("AliceClose",
                                                           (Env.Global,
                                                            (Some 0)));
                                                          ("MsgSend",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("Out",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("In",
                                                           (Env.Global,
                                                            (Some 1)));
                                                          ("exit",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("Returned",
                                                           (Env.Channel,
                                                            (Some 1)));
                                                          ("invoke",
                                                           (Env.Channel,
                                                            (Some 3)));
                                                          ("conn",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("chid",
                                                           (Env.Structure,
                                                            (Some 1)));
                                                          ("ack",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("req",
                                                           (Env.Channel,
                                                            (Some 0)));
                                                          ("store",
                                                           (Env.Channel,
                                                            (Some 1)))
                                                          ])
                                                   } }
                                                 ]
                                               )); env = { Env.vars =
                                                           [(("msg_with_sig",
                                                              33),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   33)));
                                                             (("pub_key_alice",
                                                               32),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    32)));
                                                             (("ch_net", 31),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("alice", 0),
                                                              Env.Process);
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("priv_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false, None
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("message", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } },
                                   { desc = (Typed.Sequence (
                                               { desc = (Typed.Case
                                                           [{ Typed.fresh =
                                                              [];
                                                              facts =
                                                              [{ desc = (
                                                                Typed.Eq (
                                                                  { desc = 
                                                                  Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 34);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    34));
                                                                    param =
                                                                    None}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                  { desc = 
                                                                  Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    Env.ExtConst;
                                                                    param =
                                                                    None}; env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  )); env = 
                                                                { Env.vars =
                                                                  [((
                                                                    "res", 34),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    (
                                                                    (
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    (
                                                                    (
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    (
                                                                    (
                                                                    "ch_net",
                                                                    31),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    (
                                                                    (
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    (
                                                                    (
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    None)));
                                                                    (
                                                                    (
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    (
                                                                    (
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                    (
                                                                    (
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    (
                                                                    (
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    (
                                                                    (
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                    (
                                                                    (
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                    (
                                                                    (
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                    (
                                                                    (
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                    (
                                                                    (
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                    (
                                                                    (
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    (
                                                                    (
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                    (
                                                                    (
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                    (
                                                                    (
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))];
                                                                  facts =
                                                                  ref (
                                                                  [("BobClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                    (
                                                                    "MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                    (
                                                                    "exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                    (
                                                                    "invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                    (
                                                                    "conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                    (
                                                                    "ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                    (
                                                                    "store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                  } }
                                                                ];
                                                              cmd =
                                                              { desc = (
                                                              Typed.Event
                                                                [{ desc = (
                                                                  Typed.Global (
                                                                    "IntegritySuccess",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("fst", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg_with_sig",
                                                                    33);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                  { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                  ]); env = 
                                                              { Env.vars =
                                                                [(("res", 34),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                  (("msg_with_sig",
                                                                    33),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                  (("pub_key_alice",
                                                                    32),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                  (("ch_net",
                                                                    31),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("alice",
                                                                    0),
                                                                   Env.Process);
                                                                  (("udp", 0),
                                                                   (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                  (("priv_key_alice",
                                                                    0),
                                                                   (Env.Const (
                                                                    false,
                                                                    None)));
                                                                  (("eaves_mem",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("tamper_channel",
                                                                    0),
                                                                   Env.Attack);
                                                                  (("udp_t",
                                                                    0),
                                                                   (Env.ChanTypeDef
                                                                    []));
                                                                  (("client_t",
                                                                    0),
                                                                   Env.ProcTypeDef);
                                                                  (("readonly_t",
                                                                    0),
                                                                   Env.FilesysTypeDef);
                                                                  (("message",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    0));
                                                                  (("accept_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("close_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("invoke_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    4));
                                                                  (("connect_rpc",
                                                                    0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("recv", 0),
                                                                   (Env.ExtSyscall
                                                                    1));
                                                                  (("send", 0),
                                                                   (Env.ExtSyscall
                                                                    2));
                                                                  (("verify",
                                                                    0),
                                                                   (Env.ExtFun
                                                                    3));
                                                                  (("true", 0),
                                                                   Env.ExtConst);
                                                                  (("snd", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("fst", 0),
                                                                   (Env.ExtFun
                                                                    1));
                                                                  (("sign", 0),
                                                                   (Env.ExtFun
                                                                    2));
                                                                  (("pk", 0),
                                                                   (Env.ExtFun
                                                                    1))
                                                                  ];
                                                                facts =
                                                                ref (
                                                                [("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                                } }
                                                              };
                                                             { Typed.fresh =
                                                               [];
                                                               facts =
                                                               [{ desc = (
                                                                 Typed.Neq (
                                                                   { desc = 
                                                                   Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "res", 34);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    34));
                                                                    param =
                                                                    None}; env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } },
                                                                   { desc = 
                                                                   Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "true", 0);
                                                                    desc =
                                                                    Env.ExtConst;
                                                                    param =
                                                                    None}; env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   )); env = 
                                                                 { Env.vars =
                                                                   [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                   facts =
                                                                   ref (
                                                                   [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                                   } }
                                                                 ];
                                                               cmd =
                                                               { desc = (
                                                               Typed.Event
                                                                 [{ desc = (
                                                                   Typed.Global (
                                                                    "IntegrityFail",
                                                                    [{ desc = (
                                                                    Typed.Apply (
                                                                    ("fst", 0),
                                                                    [{ desc = 
                                                                    Typed.Ident {
                                                                    id =
                                                                    (
                                                                    "msg_with_sig",
                                                                    33);
                                                                    desc =
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33));
                                                                    param =
                                                                    None}; env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                    { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }])); env = 
                                                                   { Env.vars =
                                                                    [((
                                                                    "res", 34),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                    ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                    ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                    ((
                                                                    "ch_net",
                                                                    31),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                    ((
                                                                    "udp", 0),
                                                                    (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                    ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (Env.Const (
                                                                    false,
                                                                    None)));
                                                                    ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                    ((
                                                                    "udp_t",
                                                                    0),
                                                                    (Env.ChanTypeDef
                                                                    []));
                                                                    ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                    ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                    ((
                                                                    "message",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    0));
                                                                    ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    4));
                                                                    ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "recv", 0),
                                                                    (Env.ExtSyscall
                                                                    1));
                                                                    ((
                                                                    "send", 0),
                                                                    (Env.ExtSyscall
                                                                    2));
                                                                    ((
                                                                    "verify",
                                                                    0),
                                                                    (Env.ExtFun
                                                                    3));
                                                                    ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                    ((
                                                                    "snd", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "fst", 0),
                                                                    (Env.ExtFun
                                                                    1));
                                                                    ((
                                                                    "sign", 0),
                                                                    (Env.ExtFun
                                                                    2));
                                                                    ((
                                                                    "pk", 0),
                                                                    (Env.ExtFun
                                                                    1))];
                                                                    facts =
                                                                    ref (
                                                                    [("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ]) } }
                                                                   ]); env = 
                                                               { Env.vars =
                                                                 [(("res", 34),
                                                                   (Env.Var
                                                                    (Syntax.Loc
                                                                    34)));
                                                                   ((
                                                                    "msg_with_sig",
                                                                    33),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                   ((
                                                                    "pub_key_alice",
                                                                    32),
                                                                    (
                                                                    Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                   ((
                                                                    "ch_net",
                                                                    31),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "alice",
                                                                    0),
                                                                    Env.Process);
                                                                   ((
                                                                    "udp", 0),
                                                                    (
                                                                    Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                   ((
                                                                    "priv_key_alice",
                                                                    0),
                                                                    (
                                                                    Env.Const (
                                                                    false,
                                                                    None)));
                                                                   ((
                                                                    "eaves_mem",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "tamper_channel",
                                                                    0),
                                                                    Env.Attack);
                                                                   ((
                                                                    "udp_t",
                                                                    0),
                                                                    (
                                                                    Env.ChanTypeDef
                                                                    []));
                                                                   ((
                                                                    "client_t",
                                                                    0),
                                                                    Env.ProcTypeDef);
                                                                   ((
                                                                    "readonly_t",
                                                                    0),
                                                                    Env.FilesysTypeDef);
                                                                   ((
                                                                    "message",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    0));
                                                                   ((
                                                                    "accept_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "close_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "invoke_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    4));
                                                                   ((
                                                                    "connect_rpc",
                                                                    0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "recv", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    1));
                                                                   ((
                                                                    "send", 0),
                                                                    (
                                                                    Env.ExtSyscall
                                                                    2));
                                                                   ((
                                                                    "verify",
                                                                    0),
                                                                    (
                                                                    Env.ExtFun
                                                                    3));
                                                                   ((
                                                                    "true", 0),
                                                                    Env.ExtConst);
                                                                   ((
                                                                    "snd", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "fst", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1));
                                                                   ((
                                                                    "sign", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    2));
                                                                   ((
                                                                    "pk", 0),
                                                                    (
                                                                    Env.ExtFun
                                                                    1))
                                                                   ];
                                                                 facts =
                                                                 ref (
                                                                 [("BobClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                   ("IntegrityFail",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("IntegritySuccess",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("AliceClose",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 0)));
                                                                   ("MsgSend",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("Out",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("In",
                                                                    (
                                                                    Env.Global,
                                                                    (Some 1)));
                                                                   ("exit",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("Returned",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)));
                                                                   ("invoke",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 3)));
                                                                   ("conn",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("chid",
                                                                    (
                                                                    Env.Structure,
                                                                    (Some 1)));
                                                                   ("ack",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("req",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 0)));
                                                                   ("store",
                                                                    (
                                                                    Env.Channel,
                                                                    (Some 1)))
                                                                   ])
                                                                 } }
                                                               }
                                                             ]); env = 
                                               { Env.vars =
                                                 [(("res", 34),
                                                   (Env.Var (Syntax.Loc 34)));
                                                   (("msg_with_sig", 33),
                                                    (Env.Var (Syntax.Loc 33)));
                                                   (("pub_key_alice", 32),
                                                    (Env.Var (Syntax.Loc 32)));
                                                   (("ch_net", 31),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("alice", 0), Env.Process);
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("priv_key_alice", 0),
                                                    (Env.Const (false, None)));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } },
                                               { desc = (Typed.Event
                                                           [{ desc = (
                                                             Typed.Global (
                                                               "BobClose", 
                                                               [])); env = 
                                                             { Env.vars =
                                                               [(("res", 34),
                                                                 (Env.Var
                                                                    (
                                                                    Syntax.Loc
                                                                    34)));
                                                                 (("msg_with_sig",
                                                                   33),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    33)));
                                                                 (("pub_key_alice",
                                                                   32),
                                                                  (Env.Var
                                                                    (Syntax.Loc
                                                                    32)));
                                                                 (("ch_net",
                                                                   31),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("alice", 0),
                                                                  Env.Process);
                                                                 (("udp", 0),
                                                                  (Env.Channel (
                                                                    false,
                                                                    ("udp_t",
                                                                    0))));
                                                                 (("priv_key_alice",
                                                                   0),
                                                                  (Env.Const (
                                                                    false,
                                                                    None)));
                                                                 (("eaves_mem",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("tamper_channel",
                                                                   0),
                                                                  Env.Attack);
                                                                 (("udp_t", 0),
                                                                  (Env.ChanTypeDef
                                                                    []));
                                                                 (("client_t",
                                                                   0),
                                                                  Env.ProcTypeDef);
                                                                 (("readonly_t",
                                                                   0),
                                                                  Env.FilesysTypeDef);
                                                                 (("message",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    0));
                                                                 (("accept_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("close_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("invoke_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    4));
                                                                 (("connect_rpc",
                                                                   0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("recv", 0),
                                                                  (Env.ExtSyscall
                                                                    1));
                                                                 (("send", 0),
                                                                  (Env.ExtSyscall
                                                                    2));
                                                                 (("verify",
                                                                   0),
                                                                  (Env.ExtFun
                                                                    3));
                                                                 (("true", 0),
                                                                  Env.ExtConst);
                                                                 (("snd", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("fst", 0),
                                                                  (Env.ExtFun
                                                                    1));
                                                                 (("sign", 0),
                                                                  (Env.ExtFun
                                                                    2));
                                                                 (("pk", 0),
                                                                  (Env.ExtFun
                                                                    1))
                                                                 ];
                                                               facts =
                                                               ref ([("BobClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("IntegrityFail",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("IntegritySuccess",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("AliceClose",
                                                                    (Env.Global,
                                                                    (Some 0)));
                                                                    ("MsgSend",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("Out",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("In",
                                                                    (Env.Global,
                                                                    (Some 1)));
                                                                    ("exit",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("Returned",
                                                                    (Env.Channel,
                                                                    (Some 1)));
                                                                    ("invoke",
                                                                    (Env.Channel,
                                                                    (Some 3)));
                                                                    ("conn",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("chid",
                                                                    (Env.Structure,
                                                                    (Some 1)));
                                                                    ("ack",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("req",
                                                                    (Env.Channel,
                                                                    (Some 0)));
                                                                    ("store",
                                                                    (Env.Channel,
                                                                    (Some 1)))
                                                                    ])
                                                               } }
                                                             ]); env = 
                                               { Env.vars =
                                                 [(("res", 34),
                                                   (Env.Var (Syntax.Loc 34)));
                                                   (("msg_with_sig", 33),
                                                    (Env.Var (Syntax.Loc 33)));
                                                   (("pub_key_alice", 32),
                                                    (Env.Var (Syntax.Loc 32)));
                                                   (("ch_net", 31),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("alice", 0), Env.Process);
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("priv_key_alice", 0),
                                                    (Env.Const (false, None)));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
                                               )); env = { Env.vars =
                                                           [(("res", 34),
                                                             (Env.Var
                                                                (Syntax.Loc
                                                                   34)));
                                                             (("msg_with_sig",
                                                               33),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    33)));
                                                             (("pub_key_alice",
                                                               32),
                                                              (Env.Var
                                                                 (Syntax.Loc
                                                                    32)));
                                                             (("ch_net", 31),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("alice", 0),
                                                              Env.Process);
                                                             (("udp", 0),
                                                              (Env.Channel (
                                                                 false,
                                                                 ("udp_t", 0)
                                                                 )));
                                                             (("priv_key_alice",
                                                               0),
                                                              (Env.Const (
                                                                 false, None
                                                                 )));
                                                             (("eaves_mem", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("tamper_channel",
                                                               0),
                                                              Env.Attack);
                                                             (("udp_t", 0),
                                                              (Env.ChanTypeDef
                                                                 []));
                                                             (("client_t", 0),
                                                              Env.ProcTypeDef);
                                                             (("readonly_t",
                                                               0),
                                                              Env.FilesysTypeDef);
                                                             (("message", 0),
                                                              (Env.ExtSyscall
                                                                 0));
                                                             (("accept_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("close_rpc", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("invoke_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 4));
                                                             (("connect_rpc",
                                                               0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("recv", 0),
                                                              (Env.ExtSyscall
                                                                 1));
                                                             (("send", 0),
                                                              (Env.ExtSyscall
                                                                 2));
                                                             (("verify", 0),
                                                              (Env.ExtFun 3));
                                                             (("true", 0),
                                                              Env.ExtConst);
                                                             (("snd", 0),
                                                              (Env.ExtFun 1));
                                                             (("fst", 0),
                                                              (Env.ExtFun 1));
                                                             (("sign", 0),
                                                              (Env.ExtFun 2));
                                                             (("pk", 0),
                                                              (Env.ExtFun 1))
                                                             ];
                                                           facts =
                                                           ref ([("BobClose",
                                                                  (Env.Global,
                                                                   (Some 0)));
                                                                  ("IntegrityFail",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("IntegritySuccess",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("AliceClose",
                                                                   (Env.Global,
                                                                    (Some 0)));
                                                                  ("MsgSend",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("Out",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("In",
                                                                   (Env.Global,
                                                                    (Some 1)));
                                                                  ("exit",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("Returned",
                                                                   (Env.Channel,
                                                                    (Some 1)));
                                                                  ("invoke",
                                                                   (Env.Channel,
                                                                    (Some 3)));
                                                                  ("conn",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("chid",
                                                                   (Env.Structure,
                                                                    (Some 1)));
                                                                  ("ack",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("req",
                                                                   (Env.Channel,
                                                                    (Some 0)));
                                                                  ("store",
                                                                   (Env.Channel,
                                                                    (Some 1)))
                                                                  ])
                                                           } }
                                   )); env = { Env.vars =
                                               [(("msg_with_sig", 33),
                                                 (Env.Var (Syntax.Loc 33)));
                                                 (("pub_key_alice", 32),
                                                  (Env.Var (Syntax.Loc 32)));
                                                 (("ch_net", 31),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("alice", 0), Env.Process);
                                                 (("udp", 0),
                                                  (Env.Channel (false,
                                                     ("udp_t", 0))));
                                                 (("priv_key_alice", 0),
                                                  (Env.Const (false, None)));
                                                 (("eaves_mem", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("tamper_channel", 0),
                                                  Env.Attack);
                                                 (("udp_t", 0),
                                                  (Env.ChanTypeDef []));
                                                 (("client_t", 0),
                                                  Env.ProcTypeDef);
                                                 (("readonly_t", 0),
                                                  Env.FilesysTypeDef);
                                                 (("message", 0),
                                                  (Env.ExtSyscall 0));
                                                 (("accept_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("close_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("invoke_rpc", 0),
                                                  (Env.ExtSyscall 4));
                                                 (("connect_rpc", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("recv", 0),
                                                  (Env.ExtSyscall 1));
                                                 (("send", 0),
                                                  (Env.ExtSyscall 2));
                                                 (("verify", 0),
                                                  (Env.ExtFun 3));
                                                 (("true", 0), Env.ExtConst);
                                                 (("snd", 0), (Env.ExtFun 1));
                                                 (("fst", 0), (Env.ExtFun 1));
                                                 (("sign", 0), (Env.ExtFun 2));
                                                 (("pk", 0), (Env.ExtFun 1))];
                                               facts =
                                               ref ([("BobClose",
                                                      (Env.Global, (Some 0)));
                                                      ("IntegrityFail",
                                                       (Env.Global, (Some 1)));
                                                      ("IntegritySuccess",
                                                       (Env.Global, (Some 1)));
                                                      ("AliceClose",
                                                       (Env.Global, (Some 0)));
                                                      ("MsgSend",
                                                       (Env.Global, (Some 1)));
                                                      ("Out",
                                                       (Env.Global, (Some 1)));
                                                      ("In",
                                                       (Env.Global, (Some 1)));
                                                      ("exit",
                                                       (Env.Channel, (Some 0)));
                                                      ("Returned",
                                                       (Env.Channel, (Some 1)));
                                                      ("invoke",
                                                       (Env.Channel, (Some 3)));
                                                      ("conn",
                                                       (Env.Channel, (Some 0)));
                                                      ("chid",
                                                       (Env.Structure,
                                                        (Some 1)));
                                                      ("ack",
                                                       (Env.Channel, (Some 0)));
                                                      ("req",
                                                       (Env.Channel, (Some 0)));
                                                      ("store",
                                                       (Env.Channel, (Some 1)))
                                                      ])
                                               } }
                       )); env = { Env.vars =
                                   [(("pub_key_alice", 32),
                                     (Env.Var (Syntax.Loc 32)));
                                     (("ch_net", 31),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("alice", 0), Env.Process);
                                     (("udp", 0),
                                      (Env.Channel (false, ("udp_t", 0))));
                                     (("priv_key_alice", 0),
                                      (Env.Const (false, None)));
                                     (("eaves_mem", 0), (Env.ExtSyscall 1));
                                     (("tamper_channel", 0), Env.Attack);
                                     (("udp_t", 0), (Env.ChanTypeDef []));
                                     (("client_t", 0), Env.ProcTypeDef);
                                     (("readonly_t", 0), Env.FilesysTypeDef);
                                     (("message", 0), (Env.ExtSyscall 0));
                                     (("accept_rpc", 0), (Env.ExtSyscall 1));
                                     (("close_rpc", 0), (Env.ExtSyscall 1));
                                     (("invoke_rpc", 0), (Env.ExtSyscall 4));
                                     (("connect_rpc", 0), (Env.ExtSyscall 1));
                                     (("recv", 0), (Env.ExtSyscall 1));
                                     (("send", 0), (Env.ExtSyscall 2));
                                     (("verify", 0), (Env.ExtFun 3));
                                     (("true", 0), Env.ExtConst);
                                     (("snd", 0), (Env.ExtFun 1));
                                     (("fst", 0), (Env.ExtFun 1));
                                     (("sign", 0), (Env.ExtFun 2));
                                     (("pk", 0), (Env.ExtFun 1))];
                                   facts =
                                   ref ([("BobClose", (Env.Global, (Some 0)));
                                          ("IntegrityFail",
                                           (Env.Global, (Some 1)));
                                          ("IntegritySuccess",
                                           (Env.Global, (Some 1)));
                                          ("AliceClose",
                                           (Env.Global, (Some 0)));
                                          ("MsgSend", (Env.Global, (Some 1)));
                                          ("Out", (Env.Global, (Some 1)));
                                          ("In", (Env.Global, (Some 1)));
                                          ("exit", (Env.Channel, (Some 0)));
                                          ("Returned",
                                           (Env.Channel, (Some 1)));
                                          ("invoke", (Env.Channel, (Some 3)));
                                          ("conn", (Env.Channel, (Some 0)));
                                          ("chid", (Env.Structure, (Some 1)));
                                          ("ack", (Env.Channel, (Some 0)));
                                          ("req", (Env.Channel, (Some 0)));
                                          ("store", (Env.Channel, (Some 1)))])
                                   } }}; env = { Env.vars =
                                                 [(("alice", 0), Env.Process);
                                                   (("udp", 0),
                                                    (Env.Channel (false,
                                                       ("udp_t", 0))));
                                                   (("priv_key_alice", 0),
                                                    (Env.Const (false, None)));
                                                   (("eaves_mem", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("tamper_channel", 0),
                                                    Env.Attack);
                                                   (("udp_t", 0),
                                                    (Env.ChanTypeDef []));
                                                   (("client_t", 0),
                                                    Env.ProcTypeDef);
                                                   (("readonly_t", 0),
                                                    Env.FilesysTypeDef);
                                                   (("message", 0),
                                                    (Env.ExtSyscall 0));
                                                   (("accept_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("close_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("invoke_rpc", 0),
                                                    (Env.ExtSyscall 4));
                                                   (("connect_rpc", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("recv", 0),
                                                    (Env.ExtSyscall 1));
                                                   (("send", 0),
                                                    (Env.ExtSyscall 2));
                                                   (("verify", 0),
                                                    (Env.ExtFun 3));
                                                   (("true", 0), Env.ExtConst);
                                                   (("snd", 0),
                                                    (Env.ExtFun 1));
                                                   (("fst", 0),
                                                    (Env.ExtFun 1));
                                                   (("sign", 0),
                                                    (Env.ExtFun 2));
                                                   (("pk", 0), (Env.ExtFun 1))
                                                   ];
                                                 facts =
                                                 ref ([("BobClose",
                                                        (Env.Global, (Some 0)));
                                                        ("IntegrityFail",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("IntegritySuccess",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("AliceClose",
                                                         (Env.Global,
                                                          (Some 0)));
                                                        ("MsgSend",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("Out",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("In",
                                                         (Env.Global,
                                                          (Some 1)));
                                                        ("exit",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("Returned",
                                                         (Env.Channel,
                                                          (Some 1)));
                                                        ("invoke",
                                                         (Env.Channel,
                                                          (Some 3)));
                                                        ("conn",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("chid",
                                                         (Env.Structure,
                                                          (Some 1)));
                                                        ("ack",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("req",
                                                         (Env.Channel,
                                                          (Some 0)));
                                                        ("store",
                                                         (Env.Channel,
                                                          (Some 1)))
                                                        ])
                                                 } }
{ desc = (Typed.System (
            [(Typed.Unbounded
                { Typed.id = ("alice", 0); parameter = None;
                  args =
                  [{ Typed.channel = ("udp", 0); parameter = None;
                     typ = ("udp_t", 0) }
                    ]
                  });
              (Typed.Unbounded
                 { Typed.id = ("bob", 0); parameter = None;
                   args =
                   [{ Typed.channel = ("udp", 0); parameter = None;
                      typ = ("udp_t", 0) }
                     ]
                   })
              ],
            [(("Reachable", 0),
              { desc = (Typed.Plain
                          "exists-trace \"Ex #i #j . AliceClose () @ #i & BobClose() @ #j\""); env = 
              { Env.vars =
                [(("bob", 0), Env.Process); (("alice", 0), Env.Process);
                  (("udp", 0), (Env.Channel (false, ("udp_t", 0))));
                  (("priv_key_alice", 0), (Env.Const (false, None)));
                  (("eaves_mem", 0), (Env.ExtSyscall 1));
                  (("tamper_channel", 0), Env.Attack);
                  (("udp_t", 0), (Env.ChanTypeDef []));
                  (("client_t", 0), Env.ProcTypeDef);
                  (("readonly_t", 0), Env.FilesysTypeDef);
                  (("message", 0), (Env.ExtSyscall 0));
                  (("accept_rpc", 0), (Env.ExtSyscall 1));
                  (("close_rpc", 0), (Env.ExtSyscall 1));
                  (("invoke_rpc", 0), (Env.ExtSyscall 4));
                  (("connect_rpc", 0), (Env.ExtSyscall 1));
                  (("recv", 0), (Env.ExtSyscall 1));
                  (("send", 0), (Env.ExtSyscall 2));
                  (("verify", 0), (Env.ExtFun 3));
                  (("true", 0), Env.ExtConst); (("snd", 0), (Env.ExtFun 1));
                  (("fst", 0), (Env.ExtFun 1));
                  (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))];
                facts =
                ref ([("BobClose", (Env.Global, (Some 0)));
                       ("IntegrityFail", (Env.Global, (Some 1)));
                       ("IntegritySuccess", (Env.Global, (Some 1)));
                       ("AliceClose", (Env.Global, (Some 0)));
                       ("MsgSend", (Env.Global, (Some 1)));
                       ("Out", (Env.Global, (Some 1)));
                       ("In", (Env.Global, (Some 1)));
                       ("exit", (Env.Channel, (Some 0)));
                       ("Returned", (Env.Channel, (Some 1)));
                       ("invoke", (Env.Channel, (Some 3)));
                       ("conn", (Env.Channel, (Some 0)));
                       ("chid", (Env.Structure, (Some 1)));
                       ("ack", (Env.Channel, (Some 0)));
                       ("req", (Env.Channel, (Some 0)));
                       ("store", (Env.Channel, (Some 1)))])
                } });
              (("Correspondence", 0),
               { desc = (Typed.Plain
                           "all-traces \"All msg #j  . IntegritySuccess(msg) @ #j ==> Ex #i . MsgSend (msg) @ i & i < j\""); env = 
               { Env.vars =
                 [(("Reachable", 0), Env.Process); (("bob", 0), Env.Process);
                   (("alice", 0), Env.Process);
                   (("udp", 0), (Env.Channel (false, ("udp_t", 0))));
                   (("priv_key_alice", 0), (Env.Const (false, None)));
                   (("eaves_mem", 0), (Env.ExtSyscall 1));
                   (("tamper_channel", 0), Env.Attack);
                   (("udp_t", 0), (Env.ChanTypeDef []));
                   (("client_t", 0), Env.ProcTypeDef);
                   (("readonly_t", 0), Env.FilesysTypeDef);
                   (("message", 0), (Env.ExtSyscall 0));
                   (("accept_rpc", 0), (Env.ExtSyscall 1));
                   (("close_rpc", 0), (Env.ExtSyscall 1));
                   (("invoke_rpc", 0), (Env.ExtSyscall 4));
                   (("connect_rpc", 0), (Env.ExtSyscall 1));
                   (("recv", 0), (Env.ExtSyscall 1));
                   (("send", 0), (Env.ExtSyscall 2));
                   (("verify", 0), (Env.ExtFun 3));
                   (("true", 0), Env.ExtConst); (("snd", 0), (Env.ExtFun 1));
                   (("fst", 0), (Env.ExtFun 1));
                   (("sign", 0), (Env.ExtFun 2)); (("pk", 0), (Env.ExtFun 1))
                   ];
                 facts =
                 ref ([("BobClose", (Env.Global, (Some 0)));
                        ("IntegrityFail", (Env.Global, (Some 1)));
                        ("IntegritySuccess", (Env.Global, (Some 1)));
                        ("AliceClose", (Env.Global, (Some 0)));
                        ("MsgSend", (Env.Global, (Some 1)));
                        ("Out", (Env.Global, (Some 1)));
                        ("In", (Env.Global, (Some 1)));
                        ("exit", (Env.Channel, (Some 0)));
                        ("Returned", (Env.Channel, (Some 1)));
                        ("invoke", (Env.Channel, (Some 3)));
                        ("conn", (Env.Channel, (Some 0)));
                        ("chid", (Env.Structure, (Some 1)));
                        ("ack", (Env.Channel, (Some 0)));
                        ("req", (Env.Channel, (Some 0)));
                        ("store", (Env.Channel, (Some 1)))])
                 } })
              ]
            )); env = { Env.vars =
                        [(("bob", 0), Env.Process);
                          (("alice", 0), Env.Process);
                          (("udp", 0), (Env.Channel (false, ("udp_t", 0))));
                          (("priv_key_alice", 0), (Env.Const (false, None)));
                          (("eaves_mem", 0), (Env.ExtSyscall 1));
                          (("tamper_channel", 0), Env.Attack);
                          (("udp_t", 0), (Env.ChanTypeDef []));
                          (("client_t", 0), Env.ProcTypeDef);
                          (("readonly_t", 0), Env.FilesysTypeDef);
                          (("message", 0), (Env.ExtSyscall 0));
                          (("accept_rpc", 0), (Env.ExtSyscall 1));
                          (("close_rpc", 0), (Env.ExtSyscall 1));
                          (("invoke_rpc", 0), (Env.ExtSyscall 4));
                          (("connect_rpc", 0), (Env.ExtSyscall 1));
                          (("recv", 0), (Env.ExtSyscall 1));
                          (("send", 0), (Env.ExtSyscall 2));
                          (("verify", 0), (Env.ExtFun 3));
                          (("true", 0), Env.ExtConst);
                          (("snd", 0), (Env.ExtFun 1));
                          (("fst", 0), (Env.ExtFun 1));
                          (("sign", 0), (Env.ExtFun 2));
                          (("pk", 0), (Env.ExtFun 1))];
                        facts =
                        ref ([("BobClose", (Env.Global, (Some 0)));
                               ("IntegrityFail", (Env.Global, (Some 1)));
                               ("IntegritySuccess", (Env.Global, (Some 1)));
                               ("AliceClose", (Env.Global, (Some 0)));
                               ("MsgSend", (Env.Global, (Some 1)));
                               ("Out", (Env.Global, (Some 1)));
                               ("In", (Env.Global, (Some 1)));
                               ("exit", (Env.Channel, (Some 0)));
                               ("Returned", (Env.Channel, (Some 1)));
                               ("invoke", (Env.Channel, (Some 3)));
                               ("conn", (Env.Channel, (Some 0)));
                               ("chid", (Env.Structure, (Some 1)));
                               ("ack", (Env.Channel, (Some 0)));
                               ("req", (Env.Channel, (Some 0)));
                               ("store", (Env.Channel, (Some 1)))])
                        } }
Loading complete..
Merging
- rule Bob__let_out_____6_____7__20[role="Bob"] : [State__Bob(<'rab_____6', param>, return__var__20, 'rab__', <l__0__20, l__1__20>, t__0__20)]-->[State__Bob(<'rab_____7', param>, return__var__20, 'rab__', l__1__20, t__0__20)] 

- rule Bob__let_out_____7_____8__21[role="Bob"] : [State__Bob(<'rab_____7', param>, return__var__21, 'rab__', l__0__21, t__0__21)]-->[State__Bob(<'rab_____8', param>, return__var__21, 'rab__', 'rab__', t__0__21)] 

Merged into:
- rule Bob__let_out_let_out_____6_____8__22[role="Bob"] : [State__Bob(<'rab_____6', param>, return__var__20, 'rab__', <l__0__20, l__1__20>, t__0__20)]-->[State__Bob(<'rab_____8', param>, return__var__20, 'rab__', 'rab__', t__0__20)] 

Merging
- rule Bob__event_____5_____6__19[role="Bob"] : [State__Bob(<'rab_____5', param>, return__var__19, 'rab__', <l__0__19, l__1__19>, t__0__19)]--[BobClose()]->[State__Bob(<'rab_____6', param>, 'rab__', 'rab__', <l__0__19, l__1__19>, t__0__19)] 

- rule Bob__let_out_let_out_____6_____8__22[role="Bob"] : [State__Bob(<'rab_____6', param>, return__var__20, 'rab__', <l__0__20, l__1__20>, t__0__20)]-->[State__Bob(<'rab_____8', param>, return__var__20, 'rab__', 'rab__', t__0__20)] 

Merged into:
- rule Bob__event_let_out_let_out_____5_____8__23[role="Bob"] : [State__Bob(<'rab_____5', param>, return__var__19, 'rab__', <l__0__19, l__1__19>, t__0__19)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__19)] 

Merging
- rule Bob__case_out_____4__1_1_____5__18[role="Bob"] : [State__Bob(<'rab_____4__1_1', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]-->[State__Bob(<'rab_____5', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)] 

- rule Bob__event_let_out_let_out_____5_____8__23[role="Bob"] : [State__Bob(<'rab_____5', param>, return__var__19, 'rab__', <l__0__19, l__1__19>, t__0__19)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__19)] 

Merged into:
- rule Bob__case_out_event_let_out_let_out_____4__1_1_____8__24[role="Bob"] : [State__Bob(<'rab_____4__1_1', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__18)] 

Not Merging
- rule Bob__event_____4__1_0_____4__1_1__17[role="Bob"] : [State__Bob(<'rab_____4__1_0', param>, return__var__17, 'rab__', <l__0__17, l__1__17>, t__0__17)]--[IntegrityFail(fst(l__1__17))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <l__0__17, l__1__17>, t__0__17)] 

- rule Bob__case_out_event_let_out_let_out_____4__1_1_____8__24[role="Bob"] : [State__Bob(<'rab_____4__1_1', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__18)] 

Merging
- rule Bob__case_out_____4__0_1_____5__15[role="Bob"] : [State__Bob(<'rab_____4__0_1', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)]-->[State__Bob(<'rab_____5', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)] 

- rule Bob__event_let_out_let_out_____5_____8__23[role="Bob"] : [State__Bob(<'rab_____5', param>, return__var__19, 'rab__', <l__0__19, l__1__19>, t__0__19)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__19)] 

Merged into:
- rule Bob__case_out_event_let_out_let_out_____4__0_1_____8__25[role="Bob"] : [State__Bob(<'rab_____4__0_1', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__15)] 

Not Merging
- rule Bob__event_____4__0_0_____4__0_1__14[role="Bob"] : [State__Bob(<'rab_____4__0_0', param>, return__var__14, 'rab__', <l__0__14, l__1__14>, t__0__14)]--[IntegritySuccess(fst(l__1__14))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <l__0__14, l__1__14>, t__0__14)] 

- rule Bob__case_out_event_let_out_let_out_____4__0_1_____8__25[role="Bob"] : [State__Bob(<'rab_____4__0_1', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__15)] 

Merging
- rule Bob__guarded_____4_____4__1_0__16[role="Bob"] : [State__Bob(<'rab_____4', param>, return__var__16, 'rab__', <l__0__16, l__1__16>, t__0__16), NEq__(l__0__16, true())]-->[State__Bob(<'rab_____4__1_0', param>, 'rab__', 'rab__', <l__0__16, l__1__16>, t__0__16)] 

- rule Bob__event_____4__1_0_____4__1_1__17[role="Bob"] : [State__Bob(<'rab_____4__1_0', param>, return__var__17, 'rab__', <l__0__17, l__1__17>, t__0__17)]--[IntegrityFail(fst(l__1__17))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <l__0__17, l__1__17>, t__0__17)] 

Merged into:
- rule Bob__guarded_event_____4_____4__1_1__26[role="Bob"] : [State__Bob(<'rab_____4', param>, return__var__16, 'rab__', <l__0__16, l__1__16>, t__0__16), NEq__(l__0__16, true())]--[IntegrityFail(fst(l__1__16))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <l__0__16, l__1__16>, t__0__16)] 

Merging
- rule Bob__guarded_____4_____4__0_0__13[role="Bob"] : [State__Bob(<'rab_____4', param>, return__var__13, 'rab__', <l__0__13, l__1__13>, t__0__13), Eq__(l__0__13, true())]-->[State__Bob(<'rab_____4__0_0', param>, 'rab__', 'rab__', <l__0__13, l__1__13>, t__0__13)] 

- rule Bob__event_____4__0_0_____4__0_1__14[role="Bob"] : [State__Bob(<'rab_____4__0_0', param>, return__var__14, 'rab__', <l__0__14, l__1__14>, t__0__14)]--[IntegritySuccess(fst(l__1__14))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <l__0__14, l__1__14>, t__0__14)] 

Merged into:
- rule Bob__guarded_event_____4_____4__0_1__27[role="Bob"] : [State__Bob(<'rab_____4', param>, return__var__13, 'rab__', <l__0__13, l__1__13>, t__0__13), Eq__(l__0__13, true())]--[IntegritySuccess(fst(l__1__13))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <l__0__13, l__1__13>, t__0__13)] 

Merging
- rule Bob__let_intro_____3_____4__12[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12)]-->[State__Bob(<'rab_____4', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__guarded_event_____4_____4__0_1__27[role="Bob"] : [State__Bob(<'rab_____4', param>, return__var__13, 'rab__', <l__0__13, l__1__13>, t__0__13), Eq__(l__0__13, true())]--[IntegritySuccess(fst(l__1__13))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <l__0__13, l__1__13>, t__0__13)] 

Merged into:
- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Merging
- rule Bob__let_intro_____3_____4__12[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12)]-->[State__Bob(<'rab_____4', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__guarded_event_____4_____4__1_1__26[role="Bob"] : [State__Bob(<'rab_____4', param>, return__var__16, 'rab__', <l__0__16, l__1__16>, t__0__16), NEq__(l__0__16, true())]--[IntegrityFail(fst(l__1__16))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <l__0__16, l__1__16>, t__0__16)] 

Merged into:
- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Not Merging
- rule Bob__attack_out_____2__1_1_____3__11[role="Bob"] : [State__Bob(<'rab_____2__1_1', param>, return__var__11, 'rab__', <l__0__11, l__1__11>, t__0__11)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__11, t__0__11)] 

- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Not Merging
- rule Bob__attack_out_____2__1_1_____3__11[role="Bob"] : [State__Bob(<'rab_____2__1_1', param>, return__var__11, 'rab__', <l__0__11, l__1__11>, t__0__11)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__11, t__0__11)] 

- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Merging
- rule Bob__case_out_____2__1_0__0_1_____2__1_1__10[role="Bob"] : [State__Bob(<'rab_____2__1_0__0_1', param>, return__var__10, <m__0__10, m__1__10>, <l__0__10, l__1__10>, t__0__10)]-->[State__Bob(<'rab_____2__1_1', param>, return__var__10, 'rab__', <l__0__10, l__1__10>, t__0__10)] 

- rule Bob__attack_out_____2__1_1_____3__11[role="Bob"] : [State__Bob(<'rab_____2__1_1', param>, return__var__11, 'rab__', <l__0__11, l__1__11>, t__0__11)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__11, t__0__11)] 

Merged into:
- rule Bob__case_out_attack_out_____2__1_0__0_1_____3__30[role="Bob"] : [State__Bob(<'rab_____2__1_0__0_1', param>, return__var__10, <m__0__10, m__1__10>, <l__0__10, l__1__10>, t__0__10)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__10, t__0__10)] 

Merging
- rule Bob__return_____2__1_0__0_0_____2__1_0__0_1__9[role="Bob"] : [State__Bob(<'rab_____2__1_0__0_0', param>, return__var__9, <m__0__9, m__1__9>, <l__0__9, l__1__9>, t__0__9)]-->[State__Bob(<'rab_____2__1_0__0_1', param>, m__1__9, <m__0__9, m__1__9>, <l__0__9, l__1__9>, t__0__9)] 

- rule Bob__case_out_attack_out_____2__1_0__0_1_____3__30[role="Bob"] : [State__Bob(<'rab_____2__1_0__0_1', param>, return__var__10, <m__0__10, m__1__10>, <l__0__10, l__1__10>, t__0__10)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__10, t__0__10)] 

Merged into:
- rule Bob__return_case_out_attack_out_____2__1_0__0_0_____3__31[role="Bob"] : [State__Bob(<'rab_____2__1_0__0_0', param>, return__var__9, <m__0__9, m__1__9>, <l__0__9, l__1__9>, t__0__9)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', m__1__9, t__0__9)] 

Merging
- rule Bob__guarded_____2__1_0_____2__1_0__0_0__8[role="Bob"] : [State__Bob(<'rab_____2__1_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), Store(l__0__8, n__0__8), In(n__1__8), !ACP__(<'rab__Bob', param>, l__0__8, 'rab__recv')]-->[State__Bob(<'rab_____2__1_0__0_0', param>, 'rab__', <n__0__8, n__1__8>, <l__0__8, l__1__8>, t__0__8)] 

- rule Bob__return_case_out_attack_out_____2__1_0__0_0_____3__31[role="Bob"] : [State__Bob(<'rab_____2__1_0__0_0', param>, return__var__9, <m__0__9, m__1__9>, <l__0__9, l__1__9>, t__0__9)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', m__1__9, t__0__9)] 

Merged into:
- rule Bob__guarded_return_case_out_attack_out_____2__1_0_____3__32[role="Bob"] : [State__Bob(<'rab_____2__1_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), Store(l__0__8, n__0__8), In(n__1__8), !ACP__(<'rab__Bob', param>, l__0__8, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__1__8, t__0__8)] 

Not Merging
- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__case_out_event_let_out_let_out_____4__1_1_____8__24[role="Bob"] : [State__Bob(<'rab_____4__1_1', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__18)] 

Not Merging
- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__case_out_event_let_out_let_out_____4__0_1_____8__25[role="Bob"] : [State__Bob(<'rab_____4__0_1', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__15)] 

Not Merging
- rule Bob__scall_out_____2__0_1_____3__6[role="Bob"] : [State__Bob(<'rab_____2__0_1', param>, return__var__6, 'rab__', <l__0__6, l__1__6>, t__0__6)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__6, t__0__6)] 

- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Not Merging
- rule Bob__scall_out_____2__0_1_____3__6[role="Bob"] : [State__Bob(<'rab_____2__0_1', param>, return__var__6, 'rab__', <l__0__6, l__1__6>, t__0__6)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__6, t__0__6)] 

- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Merging
- rule Bob__case_out_____2__0_0__0_1_____2__0_1__5[role="Bob"] : [State__Bob(<'rab_____2__0_0__0_1', param>, return__var__5, m__0__5, <l__0__5, l__1__5>, t__0__5)]-->[State__Bob(<'rab_____2__0_1', param>, return__var__5, 'rab__', <l__0__5, l__1__5>, t__0__5)] 

- rule Bob__scall_out_____2__0_1_____3__6[role="Bob"] : [State__Bob(<'rab_____2__0_1', param>, return__var__6, 'rab__', <l__0__6, l__1__6>, t__0__6)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__6, t__0__6)] 

Merged into:
- rule Bob__case_out_scall_out_____2__0_0__0_1_____3__33[role="Bob"] : [State__Bob(<'rab_____2__0_0__0_1', param>, return__var__5, m__0__5, <l__0__5, l__1__5>, t__0__5)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__5, t__0__5)] 

Merging
- rule Bob__return_____2__0_0__0_0_____2__0_0__0_1__4[role="Bob"] : [State__Bob(<'rab_____2__0_0__0_0', param>, return__var__4, m__0__4, <l__0__4, l__1__4>, t__0__4)]-->[State__Bob(<'rab_____2__0_0__0_1', param>, m__0__4, m__0__4, <l__0__4, l__1__4>, t__0__4)] 

- rule Bob__case_out_scall_out_____2__0_0__0_1_____3__33[role="Bob"] : [State__Bob(<'rab_____2__0_0__0_1', param>, return__var__5, m__0__5, <l__0__5, l__1__5>, t__0__5)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', return__var__5, t__0__5)] 

Merged into:
- rule Bob__return_case_out_scall_out_____2__0_0__0_0_____3__34[role="Bob"] : [State__Bob(<'rab_____2__0_0__0_0', param>, return__var__4, m__0__4, <l__0__4, l__1__4>, t__0__4)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', m__0__4, t__0__4)] 

Merging
- rule Bob__guarded_____2__0_0_____2__0_0__0_0__3[role="Bob"] : [State__Bob(<'rab_____2__0_0', param>, return__var__3, 'rab__', <l__0__3, l__1__3>, t__0__3), Store(l__0__3, n__0__3), !ACP__(<'rab__Bob', param>, l__0__3, 'rab__recv')]-->[State__Bob(<'rab_____2__0_0__0_0', param>, 'rab__', n__0__3, <l__0__3, l__1__3>, t__0__3)] 

- rule Bob__return_case_out_scall_out_____2__0_0__0_0_____3__34[role="Bob"] : [State__Bob(<'rab_____2__0_0__0_0', param>, return__var__4, m__0__4, <l__0__4, l__1__4>, t__0__4)]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', m__0__4, t__0__4)] 

Merged into:
- rule Bob__guarded_return_case_out_scall_out_____2__0_0_____3__35[role="Bob"] : [State__Bob(<'rab_____2__0_0', param>, return__var__3, 'rab__', <l__0__3, l__1__3>, t__0__3), Store(l__0__3, n__0__3), !ACP__(<'rab__Bob', param>, l__0__3, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__0__3, t__0__3)] 

Not Merging
- rule Bob__attack_intro_____2_____2__1_0__7[role="Bob"] : [State__Bob(<'rab_____2', param>, return__var__7, 'rab__', l__0__7, t__0__7)]-->[State__Bob(<'rab_____2__1_0', param>, 'rab__', 'rab__', <'rab__udp', l__0__7>, t__0__7)] 

- rule Bob__guarded_return_case_out_attack_out_____2__1_0_____3__32[role="Bob"] : [State__Bob(<'rab_____2__1_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), Store(l__0__8, n__0__8), In(n__1__8), !ACP__(<'rab__Bob', param>, l__0__8, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__1__8, t__0__8)] 

Not Merging
- rule Bob__scall_intro_____2_____2__0_0__2[role="Bob"] : [State__Bob(<'rab_____2', param>, return__var__2, 'rab__', l__0__2, t__0__2)]-->[State__Bob(<'rab_____2__0_0', param>, 'rab__', 'rab__', <'rab__udp', l__0__2>, t__0__2)] 

- rule Bob__guarded_return_case_out_scall_out_____2__0_0_____3__35[role="Bob"] : [State__Bob(<'rab_____2__0_0', param>, return__var__3, 'rab__', <l__0__3, l__1__3>, t__0__3), Store(l__0__3, n__0__3), !ACP__(<'rab__Bob', param>, l__0__3, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__0__3, t__0__3)] 

Merging
- rule Bob__let_intro_____1_____2__1[role="Bob"] : [State__Bob(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1)]-->[State__Bob(<'rab_____2', param>, 'rab__', 'rab__', 'rab__', t__0__1)] 

- rule Bob__attack_intro_____2_____2__1_0__7[role="Bob"] : [State__Bob(<'rab_____2', param>, return__var__7, 'rab__', l__0__7, t__0__7)]-->[State__Bob(<'rab_____2__1_0', param>, 'rab__', 'rab__', <'rab__udp', l__0__7>, t__0__7)] 

Merged into:
- rule Bob__let_intro_attack_intro_____1_____2__1_0__36[role="Bob"] : [State__Bob(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1)]-->[State__Bob(<'rab_____2__1_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, t__0__1)] 

Merging
- rule Bob__let_intro_____1_____2__1[role="Bob"] : [State__Bob(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1)]-->[State__Bob(<'rab_____2', param>, 'rab__', 'rab__', 'rab__', t__0__1)] 

- rule Bob__scall_intro_____2_____2__0_0__2[role="Bob"] : [State__Bob(<'rab_____2', param>, return__var__2, 'rab__', l__0__2, t__0__2)]-->[State__Bob(<'rab_____2__0_0', param>, 'rab__', 'rab__', <'rab__udp', l__0__2>, t__0__2)] 

Merged into:
- rule Bob__let_intro_scall_intro_____1_____2__0_0__37[role="Bob"] : [State__Bob(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1)]-->[State__Bob(<'rab_____2__0_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, t__0__1)] 

Merging
- rule Bob__init_mem_____0_____1__0[role="Bob"] : [State__Bob(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0)]-->[State__Bob(<'rab_____1', param>, 'rab__', 'rab__', 'rab__', pk(priv_key_alice__0))] 

- rule Bob__let_intro_scall_intro_____1_____2__0_0__37[role="Bob"] : [State__Bob(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1)]-->[State__Bob(<'rab_____2__0_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, t__0__1)] 

Merged into:
- rule Bob__init_mem_let_intro_scall_intro_____0_____2__0_0__38[role="Bob"] : [State__Bob(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0)]-->[State__Bob(<'rab_____2__0_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, pk(priv_key_alice__0))] 

Merging
- rule Bob__init_mem_____0_____1__0[role="Bob"] : [State__Bob(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0)]-->[State__Bob(<'rab_____1', param>, 'rab__', 'rab__', 'rab__', pk(priv_key_alice__0))] 

- rule Bob__let_intro_attack_intro_____1_____2__1_0__36[role="Bob"] : [State__Bob(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1)]-->[State__Bob(<'rab_____2__1_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, t__0__1)] 

Merged into:
- rule Bob__init_mem_let_intro_attack_intro_____0_____2__1_0__39[role="Bob"] : [State__Bob(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0)]-->[State__Bob(<'rab_____2__1_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, pk(priv_key_alice__0))] 

Not Merging
- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__case_out_event_let_out_let_out_____4__1_1_____8__24[role="Bob"] : [State__Bob(<'rab_____4__1_1', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__18)] 

Not Merging
- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__case_out_event_let_out_let_out_____4__0_1_____8__25[role="Bob"] : [State__Bob(<'rab_____4__0_1', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__15)] 

Not Merging
- rule Bob__guarded_return_case_out_attack_out_____2__1_0_____3__32[role="Bob"] : [State__Bob(<'rab_____2__1_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), Store(l__0__8, n__0__8), In(n__1__8), !ACP__(<'rab__Bob', param>, l__0__8, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__1__8, t__0__8)] 

- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Not Merging
- rule Bob__guarded_return_case_out_attack_out_____2__1_0_____3__32[role="Bob"] : [State__Bob(<'rab_____2__1_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), Store(l__0__8, n__0__8), In(n__1__8), !ACP__(<'rab__Bob', param>, l__0__8, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__1__8, t__0__8)] 

- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Not Merging
- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__case_out_event_let_out_let_out_____4__1_1_____8__24[role="Bob"] : [State__Bob(<'rab_____4__1_1', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__18)] 

Not Merging
- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

- rule Bob__case_out_event_let_out_let_out_____4__0_1_____8__25[role="Bob"] : [State__Bob(<'rab_____4__0_1', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)]--[BobClose()]->[State__Bob(<'rab_____8', param>, 'rab__', 'rab__', 'rab__', t__0__15)] 

Not Merging
- rule Bob__guarded_return_case_out_scall_out_____2__0_0_____3__35[role="Bob"] : [State__Bob(<'rab_____2__0_0', param>, return__var__3, 'rab__', <l__0__3, l__1__3>, t__0__3), Store(l__0__3, n__0__3), !ACP__(<'rab__Bob', param>, l__0__3, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__0__3, t__0__3)] 

- rule Bob__let_intro_guarded_event_____3_____4__1_1__29[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), NEq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegrityFail(fst(l__0__12))]->[State__Bob(<'rab_____4__1_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Not Merging
- rule Bob__guarded_return_case_out_scall_out_____2__0_0_____3__35[role="Bob"] : [State__Bob(<'rab_____2__0_0', param>, return__var__3, 'rab__', <l__0__3, l__1__3>, t__0__3), Store(l__0__3, n__0__3), !ACP__(<'rab__Bob', param>, l__0__3, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__0__3, t__0__3)] 

- rule Bob__let_intro_guarded_event_____3_____4__0_1__28[role="Bob"] : [State__Bob(<'rab_____3', param>, return__var__12, 'rab__', l__0__12, t__0__12), Eq__(verify(snd(l__0__12), fst(l__0__12), t__0__12), true())]--[IntegritySuccess(fst(l__0__12))]->[State__Bob(<'rab_____4__0_1', param>, 'rab__', 'rab__', <verify(snd(l__0__12), fst(l__0__12), t__0__12), l__0__12>, t__0__12)] 

Not Merging
- rule Bob__init_mem_let_intro_attack_intro_____0_____2__1_0__39[role="Bob"] : [State__Bob(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0)]-->[State__Bob(<'rab_____2__1_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, pk(priv_key_alice__0))] 

- rule Bob__guarded_return_case_out_attack_out_____2__1_0_____3__32[role="Bob"] : [State__Bob(<'rab_____2__1_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), Store(l__0__8, n__0__8), In(n__1__8), !ACP__(<'rab__Bob', param>, l__0__8, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__1__8, t__0__8)] 

Not Merging
- rule Bob__init_mem_let_intro_scall_intro_____0_____2__0_0__38[role="Bob"] : [State__Bob(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0)]-->[State__Bob(<'rab_____2__0_0', param>, 'rab__', 'rab__', <'rab__udp', 'rab__'>, pk(priv_key_alice__0))] 

- rule Bob__guarded_return_case_out_scall_out_____2__0_0_____3__35[role="Bob"] : [State__Bob(<'rab_____2__0_0', param>, return__var__3, 'rab__', <l__0__3, l__1__3>, t__0__3), Store(l__0__3, n__0__3), !ACP__(<'rab__Bob', param>, l__0__3, 'rab__recv')]-->[State__Bob(<'rab_____3', param>, 'rab__', 'rab__', n__0__3, t__0__3)] 

Merging
- rule Alice__let_out_____9_____10__19[role="Alice"] : [State__Alice(<'rab_____9', param>, return__var__19, 'rab__', <l__0__19, l__1__19>, t__0__19)]-->[State__Alice(<'rab_____10', param>, return__var__19, 'rab__', l__1__19, t__0__19)] 

- rule Alice__let_out_____10_____11__20[role="Alice"] : [State__Alice(<'rab_____10', param>, return__var__20, 'rab__', l__0__20, t__0__20)]-->[State__Alice(<'rab_____11', param>, return__var__20, 'rab__', 'rab__', t__0__20)] 

Merged into:
- rule Alice__let_out_let_out_____9_____11__21[role="Alice"] : [State__Alice(<'rab_____9', param>, return__var__19, 'rab__', <l__0__19, l__1__19>, t__0__19)]-->[State__Alice(<'rab_____11', param>, return__var__19, 'rab__', 'rab__', t__0__19)] 

Merging
- rule Alice__event_____8_____9__18[role="Alice"] : [State__Alice(<'rab_____8', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[AliceClose()]->[State__Alice(<'rab_____9', param>, 'rab__', 'rab__', <l__0__18, l__1__18>, t__0__18)] 

- rule Alice__let_out_let_out_____9_____11__21[role="Alice"] : [State__Alice(<'rab_____9', param>, return__var__19, 'rab__', <l__0__19, l__1__19>, t__0__19)]-->[State__Alice(<'rab_____11', param>, return__var__19, 'rab__', 'rab__', t__0__19)] 

Merged into:
- rule Alice__event_let_out_let_out_____8_____11__22[role="Alice"] : [State__Alice(<'rab_____8', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[AliceClose()]->[State__Alice(<'rab_____11', param>, 'rab__', 'rab__', 'rab__', t__0__18)] 

Merging
- rule Alice__scall_out_____7__0_1_____8__17[role="Alice"] : [State__Alice(<'rab_____7__0_1', param>, return__var__17, 'rab__', <l__0__17, l__1__17, l__2__17, l__3__17>, t__0__17)]-->[State__Alice(<'rab_____8', param>, return__var__17, 'rab__', <l__2__17, l__3__17>, t__0__17)] 

- rule Alice__event_let_out_let_out_____8_____11__22[role="Alice"] : [State__Alice(<'rab_____8', param>, return__var__18, 'rab__', <l__0__18, l__1__18>, t__0__18)]--[AliceClose()]->[State__Alice(<'rab_____11', param>, 'rab__', 'rab__', 'rab__', t__0__18)] 

Merged into:
- rule Alice__scall_out_event_let_out_let_out_____7__0_1_____11__23[role="Alice"] : [State__Alice(<'rab_____7__0_1', param>, return__var__17, 'rab__', <l__0__17, l__1__17, l__2__17, l__3__17>, t__0__17)]--[AliceClose()]->[State__Alice(<'rab_____11', param>, 'rab__', 'rab__', 'rab__', t__0__17)] 

Not Merging
- rule Alice__put_____7__0_0_____7__0_1__16[role="Alice"] : [State__Alice(<'rab_____7__0_0', param>, return__var__16, 'rab__', <l__0__16, l__1__16, l__2__16, l__3__16>, t__0__16), !ACP__(<'rab__Alice', param>, l__1__16, 'rab__send')]-->[State__Alice(<'rab_____7__0_1', param>, 'rab__', 'rab__', <l__0__16, l__1__16, l__2__16, l__3__16>, t__0__16), Store(l__1__16, l__0__16)] 

- rule Alice__scall_out_event_let_out_let_out_____7__0_1_____11__23[role="Alice"] : [State__Alice(<'rab_____7__0_1', param>, return__var__17, 'rab__', <l__0__17, l__1__17, l__2__17, l__3__17>, t__0__17)]--[AliceClose()]->[State__Alice(<'rab_____11', param>, 'rab__', 'rab__', 'rab__', t__0__17)] 

Merging
- rule Alice__scall_intro_____7_____7__0_0__15[role="Alice"] : [State__Alice(<'rab_____7', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15)]-->[State__Alice(<'rab_____7__0_0', param>, 'rab__', 'rab__', <<l__1__15, l__0__15>, 'rab__udp', l__0__15, l__1__15>, t__0__15)] 

- rule Alice__put_____7__0_0_____7__0_1__16[role="Alice"] : [State__Alice(<'rab_____7__0_0', param>, return__var__16, 'rab__', <l__0__16, l__1__16, l__2__16, l__3__16>, t__0__16), !ACP__(<'rab__Alice', param>, l__1__16, 'rab__send')]-->[State__Alice(<'rab_____7__0_1', param>, 'rab__', 'rab__', <l__0__16, l__1__16, l__2__16, l__3__16>, t__0__16), Store(l__1__16, l__0__16)] 

Merged into:
- rule Alice__scall_intro_put_____7_____7__0_1__24[role="Alice"] : [State__Alice(<'rab_____7', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15), !ACP__(<'rab__Alice', param>, 'rab__udp', 'rab__send')]-->[State__Alice(<'rab_____7__0_1', param>, 'rab__', 'rab__', <<l__1__15, l__0__15>, 'rab__udp', l__0__15, l__1__15>, t__0__15), Store('rab__udp', <l__1__15, l__0__15>)] 

Not Merging
- rule Alice__event_____6_____7__14[role="Alice"] : [State__Alice(<'rab_____6', param>, return__var__14, 'rab__', <l__0__14, l__1__14>, t__0__14)]--[MsgSend(l__1__14)]->[State__Alice(<'rab_____7', param>, 'rab__', 'rab__', <l__0__14, l__1__14>, t__0__14)] 

- rule Alice__scall_intro_put_____7_____7__0_1__24[role="Alice"] : [State__Alice(<'rab_____7', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15), !ACP__(<'rab__Alice', param>, 'rab__udp', 'rab__send')]-->[State__Alice(<'rab_____7__0_1', param>, 'rab__', 'rab__', <<l__1__15, l__0__15>, 'rab__udp', l__0__15, l__1__15>, t__0__15), Store('rab__udp', <l__1__15, l__0__15>)] 

Merging
- rule Alice__scall_out_____5__0_1_____6__13[role="Alice"] : [State__Alice(<'rab_____5__0_1', param>, return__var__13, 'rab__', <l__0__13, l__1__13, l__2__13>, t__0__13)]-->[State__Alice(<'rab_____6', param>, return__var__13, 'rab__', <l__1__13, l__2__13>, t__0__13)] 

- rule Alice__event_____6_____7__14[role="Alice"] : [State__Alice(<'rab_____6', param>, return__var__14, 'rab__', <l__0__14, l__1__14>, t__0__14)]--[MsgSend(l__1__14)]->[State__Alice(<'rab_____7', param>, 'rab__', 'rab__', <l__0__14, l__1__14>, t__0__14)] 

Merged into:
- rule Alice__scall_out_event_____5__0_1_____7__25[role="Alice"] : [State__Alice(<'rab_____5__0_1', param>, return__var__13, 'rab__', <l__0__13, l__1__13, l__2__13>, t__0__13)]--[MsgSend(l__2__13)]->[State__Alice(<'rab_____7', param>, 'rab__', 'rab__', <l__1__13, l__2__13>, t__0__13)] 

Not Merging
- rule Alice__put_____5__0_0_____5__0_1__12[role="Alice"] : [State__Alice(<'rab_____5__0_0', param>, return__var__12, 'rab__', <l__0__12, l__1__12, l__2__12>, t__0__12)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <l__0__12, l__1__12, l__2__12>, t__0__12), Out(l__0__12)] 

- rule Alice__scall_out_event_____5__0_1_____7__25[role="Alice"] : [State__Alice(<'rab_____5__0_1', param>, return__var__13, 'rab__', <l__0__13, l__1__13, l__2__13>, t__0__13)]--[MsgSend(l__2__13)]->[State__Alice(<'rab_____7', param>, 'rab__', 'rab__', <l__1__13, l__2__13>, t__0__13)] 

Merging
- rule Alice__scall_intro_____5_____5__0_0__11[role="Alice"] : [State__Alice(<'rab_____5', param>, return__var__11, 'rab__', <l__0__11, l__1__11>, t__0__11)]-->[State__Alice(<'rab_____5__0_0', param>, 'rab__', 'rab__', <l__0__11, l__0__11, l__1__11>, t__0__11)] 

- rule Alice__put_____5__0_0_____5__0_1__12[role="Alice"] : [State__Alice(<'rab_____5__0_0', param>, return__var__12, 'rab__', <l__0__12, l__1__12, l__2__12>, t__0__12)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <l__0__12, l__1__12, l__2__12>, t__0__12), Out(l__0__12)] 

Merged into:
- rule Alice__scall_intro_put_____5_____5__0_1__26[role="Alice"] : [State__Alice(<'rab_____5', param>, return__var__11, 'rab__', <l__0__11, l__1__11>, t__0__11)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <l__0__11, l__0__11, l__1__11>, t__0__11), Out(l__0__11)] 

Merging
- rule Alice__let_intro_____4_____5__10[role="Alice"] : [State__Alice(<'rab_____4', param>, return__var__10, 'rab__', l__0__10, t__0__10), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5', param>, 'rab__', 'rab__', <sign(l__0__10, priv_key_alice__10), l__0__10>, t__0__10)] 

- rule Alice__scall_intro_put_____5_____5__0_1__26[role="Alice"] : [State__Alice(<'rab_____5', param>, return__var__11, 'rab__', <l__0__11, l__1__11>, t__0__11)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <l__0__11, l__0__11, l__1__11>, t__0__11), Out(l__0__11)] 

Merged into:
- rule Alice__let_intro_scall_intro_put_____4_____5__0_1__27[role="Alice"] : [State__Alice(<'rab_____4', param>, return__var__10, 'rab__', l__0__10, t__0__10), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__0__10, priv_key_alice__10), sign(l__0__10, priv_key_alice__10), l__0__10>, t__0__10), Out(sign(l__0__10, priv_key_alice__10))] 

Merging
- rule Alice__scall_out_____3__0_1_____4__9[role="Alice"] : [State__Alice(<'rab_____3__0_1', param>, return__var__9, 'rab__', <l__0__9, l__1__9>, t__0__9)]-->[State__Alice(<'rab_____4', param>, return__var__9, 'rab__', l__1__9, t__0__9)] 

- rule Alice__let_intro_scall_intro_put_____4_____5__0_1__27[role="Alice"] : [State__Alice(<'rab_____4', param>, return__var__10, 'rab__', l__0__10, t__0__10), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__0__10, priv_key_alice__10), sign(l__0__10, priv_key_alice__10), l__0__10>, t__0__10), Out(sign(l__0__10, priv_key_alice__10))] 

Merged into:
- rule Alice__scall_out_let_intro_scall_intro_put_____3__0_1_____5__0_1__28[role="Alice"] : [State__Alice(<'rab_____3__0_1', param>, return__var__9, 'rab__', <l__0__9, l__1__9>, t__0__9), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__1__9, priv_key_alice__10), sign(l__1__9, priv_key_alice__10), l__1__9>, t__0__9), Out(sign(l__1__9, priv_key_alice__10))] 

Merging
- rule Alice__put_____3__0_0_____3__0_1__8[role="Alice"] : [State__Alice(<'rab_____3__0_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8)]-->[State__Alice(<'rab_____3__0_1', param>, 'rab__', 'rab__', <l__0__8, l__1__8>, t__0__8), Out(l__0__8)] 

- rule Alice__scall_out_let_intro_scall_intro_put_____3__0_1_____5__0_1__28[role="Alice"] : [State__Alice(<'rab_____3__0_1', param>, return__var__9, 'rab__', <l__0__9, l__1__9>, t__0__9), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__1__9, priv_key_alice__10), sign(l__1__9, priv_key_alice__10), l__1__9>, t__0__9), Out(sign(l__1__9, priv_key_alice__10))] 

Merged into:
- rule Alice__put_scall_out_let_intro_scall_intro_put_____3__0_0_____5__0_1__29[role="Alice"] : [State__Alice(<'rab_____3__0_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__1__8, priv_key_alice__10), sign(l__1__8, priv_key_alice__10), l__1__8>, t__0__8), Out(l__0__8), Out(sign(l__1__8, priv_key_alice__10))] 

Merging
- rule Alice__scall_intro_____3_____3__0_0__7[role="Alice"] : [State__Alice(<'rab_____3', param>, return__var__7, 'rab__', l__0__7, t__0__7)]-->[State__Alice(<'rab_____3__0_0', param>, 'rab__', 'rab__', <l__0__7, l__0__7>, t__0__7)] 

- rule Alice__put_scall_out_let_intro_scall_intro_put_____3__0_0_____5__0_1__29[role="Alice"] : [State__Alice(<'rab_____3__0_0', param>, return__var__8, 'rab__', <l__0__8, l__1__8>, t__0__8), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__1__8, priv_key_alice__10), sign(l__1__8, priv_key_alice__10), l__1__8>, t__0__8), Out(l__0__8), Out(sign(l__1__8, priv_key_alice__10))] 

Merged into:
- rule Alice__scall_intro_put_scall_out_let_intro_scall_intro_put_____3_____5__0_1__30[role="Alice"] : [State__Alice(<'rab_____3', param>, return__var__7, 'rab__', l__0__7, t__0__7), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__0__7, priv_key_alice__10), sign(l__0__7, priv_key_alice__10), l__0__7>, t__0__7), Out(l__0__7), Out(sign(l__0__7, priv_key_alice__10))] 

Merging
- rule Alice__scall_out_____2__0_3_____3__6[role="Alice"] : [State__Alice(<'rab_____2__0_3', param>, return__var__6, 'rab__', l__0__6, t__0__6)]-->[State__Alice(<'rab_____3', param>, 'rab__', 'rab__', return__var__6, t__0__6)] 

- rule Alice__scall_intro_put_scall_out_let_intro_scall_intro_put_____3_____5__0_1__30[role="Alice"] : [State__Alice(<'rab_____3', param>, return__var__7, 'rab__', l__0__7, t__0__7), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(l__0__7, priv_key_alice__10), sign(l__0__7, priv_key_alice__10), l__0__7>, t__0__7), Out(l__0__7), Out(sign(l__0__7, priv_key_alice__10))] 

Merged into:
- rule Alice__scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_3_____5__0_1__31[role="Alice"] : [State__Alice(<'rab_____2__0_3', param>, return__var__6, 'rab__', l__0__6, t__0__6), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(return__var__6, priv_key_alice__10), sign(return__var__6, priv_key_alice__10), return__var__6>, t__0__6), Out(return__var__6), Out(sign(return__var__6, priv_key_alice__10))] 

Merging
- rule Alice__new_out_____2__0_2_____2__0_3__5[role="Alice"] : [State__Alice(<'rab_____2__0_2', param>, return__var__5, m__0__5, l__0__5, t__0__5)]-->[State__Alice(<'rab_____2__0_3', param>, return__var__5, 'rab__', l__0__5, t__0__5)] 

- rule Alice__scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_3_____5__0_1__31[role="Alice"] : [State__Alice(<'rab_____2__0_3', param>, return__var__6, 'rab__', l__0__6, t__0__6), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(return__var__6, priv_key_alice__10), sign(return__var__6, priv_key_alice__10), return__var__6>, t__0__6), Out(return__var__6), Out(sign(return__var__6, priv_key_alice__10))] 

Merged into:
- rule Alice__new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_2_____5__0_1__32[role="Alice"] : [State__Alice(<'rab_____2__0_2', param>, return__var__5, m__0__5, l__0__5, t__0__5), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(return__var__5, priv_key_alice__10), sign(return__var__5, priv_key_alice__10), return__var__5>, t__0__5), Out(return__var__5), Out(sign(return__var__5, priv_key_alice__10))] 

Merging
- rule Alice__return_____2__0_1_____2__0_2__4[role="Alice"] : [State__Alice(<'rab_____2__0_1', param>, return__var__4, m__0__4, l__0__4, t__0__4)]-->[State__Alice(<'rab_____2__0_2', param>, m__0__4, m__0__4, l__0__4, t__0__4)] 

- rule Alice__new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_2_____5__0_1__32[role="Alice"] : [State__Alice(<'rab_____2__0_2', param>, return__var__5, m__0__5, l__0__5, t__0__5), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(return__var__5, priv_key_alice__10), sign(return__var__5, priv_key_alice__10), return__var__5>, t__0__5), Out(return__var__5), Out(sign(return__var__5, priv_key_alice__10))] 

Merged into:
- rule Alice__return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_1_____5__0_1__33[role="Alice"] : [State__Alice(<'rab_____2__0_1', param>, return__var__4, m__0__4, l__0__4, t__0__4), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(m__0__4, priv_key_alice__10), sign(m__0__4, priv_key_alice__10), m__0__4>, t__0__4), Out(m__0__4), Out(sign(m__0__4, priv_key_alice__10))] 

Merging
- rule Alice__new_intro_____2__0_0_____2__0_1__3[role="Alice"] : [State__Alice(<'rab_____2__0_0', param>, return__var__3, 'rab__', l__0__3, t__0__3), Fr(n__0__3)]-->[State__Alice(<'rab_____2__0_1', param>, 'rab__', n__0__3, l__0__3, t__0__3)] 

- rule Alice__return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_1_____5__0_1__33[role="Alice"] : [State__Alice(<'rab_____2__0_1', param>, return__var__4, m__0__4, l__0__4, t__0__4), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(m__0__4, priv_key_alice__10), sign(m__0__4, priv_key_alice__10), m__0__4>, t__0__4), Out(m__0__4), Out(sign(m__0__4, priv_key_alice__10))] 

Merged into:
- rule Alice__new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_0_____5__0_1__34[role="Alice"] : [State__Alice(<'rab_____2__0_0', param>, return__var__3, 'rab__', l__0__3, t__0__3), Fr(n__0__3), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, t__0__3), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

Merging
- rule Alice__scall_intro_____2_____2__0_0__2[role="Alice"] : [State__Alice(<'rab_____2', param>, return__var__2, 'rab__', l__0__2, t__0__2)]-->[State__Alice(<'rab_____2__0_0', param>, 'rab__', 'rab__', l__0__2, t__0__2)] 

- rule Alice__new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2__0_0_____5__0_1__34[role="Alice"] : [State__Alice(<'rab_____2__0_0', param>, return__var__3, 'rab__', l__0__3, t__0__3), Fr(n__0__3), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, t__0__3), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

Merged into:
- rule Alice__scall_intro_new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2_____5__0_1__35[role="Alice"] : [State__Alice(<'rab_____2', param>, return__var__2, 'rab__', l__0__2, t__0__2), !Const__('rab__priv_key_alice', priv_key_alice__10), Fr(n__0__3)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, t__0__2), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

Merging
- rule Alice__let_intro_____1_____2__1[role="Alice"] : [State__Alice(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1)]-->[State__Alice(<'rab_____2', param>, 'rab__', 'rab__', 'rab__', t__0__1)] 

- rule Alice__scall_intro_new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____2_____5__0_1__35[role="Alice"] : [State__Alice(<'rab_____2', param>, return__var__2, 'rab__', l__0__2, t__0__2), !Const__('rab__priv_key_alice', priv_key_alice__10), Fr(n__0__3)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, t__0__2), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

Merged into:
- rule Alice__let_intro_scall_intro_new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____1_____5__0_1__36[role="Alice"] : [State__Alice(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1), Fr(n__0__3), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, t__0__1), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

Merging
- rule Alice__init_mem_____0_____1__0[role="Alice"] : [State__Alice(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0)]-->[State__Alice(<'rab_____1', param>, 'rab__', 'rab__', 'rab__', priv_key_alice__0)] 

- rule Alice__let_intro_scall_intro_new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____1_____5__0_1__36[role="Alice"] : [State__Alice(<'rab_____1', param>, return__var__1, 'rab__', 'rab__', t__0__1), Fr(n__0__3), !Const__('rab__priv_key_alice', priv_key_alice__10)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, t__0__1), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

Merged into:
- rule Alice__init_mem_let_intro_scall_intro_new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____0_____5__0_1__37[role="Alice"] : [State__Alice(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0), !Const__('rab__priv_key_alice', priv_key_alice__10), Fr(n__0__3)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, priv_key_alice__0), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

Not Merging
- rule Alice__scall_intro_put_____7_____7__0_1__24[role="Alice"] : [State__Alice(<'rab_____7', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15), !ACP__(<'rab__Alice', param>, 'rab__udp', 'rab__send')]-->[State__Alice(<'rab_____7__0_1', param>, 'rab__', 'rab__', <<l__1__15, l__0__15>, 'rab__udp', l__0__15, l__1__15>, t__0__15), Store('rab__udp', <l__1__15, l__0__15>)] 

- rule Alice__scall_out_event_let_out_let_out_____7__0_1_____11__23[role="Alice"] : [State__Alice(<'rab_____7__0_1', param>, return__var__17, 'rab__', <l__0__17, l__1__17, l__2__17, l__3__17>, t__0__17)]--[AliceClose()]->[State__Alice(<'rab_____11', param>, 'rab__', 'rab__', 'rab__', t__0__17)] 

Not Merging
- rule Alice__scall_out_event_____5__0_1_____7__25[role="Alice"] : [State__Alice(<'rab_____5__0_1', param>, return__var__13, 'rab__', <l__0__13, l__1__13, l__2__13>, t__0__13)]--[MsgSend(l__2__13)]->[State__Alice(<'rab_____7', param>, 'rab__', 'rab__', <l__1__13, l__2__13>, t__0__13)] 

- rule Alice__scall_intro_put_____7_____7__0_1__24[role="Alice"] : [State__Alice(<'rab_____7', param>, return__var__15, 'rab__', <l__0__15, l__1__15>, t__0__15), !ACP__(<'rab__Alice', param>, 'rab__udp', 'rab__send')]-->[State__Alice(<'rab_____7__0_1', param>, 'rab__', 'rab__', <<l__1__15, l__0__15>, 'rab__udp', l__0__15, l__1__15>, t__0__15), Store('rab__udp', <l__1__15, l__0__15>)] 

Not Merging
- rule Alice__init_mem_let_intro_scall_intro_new_intro_return_new_out_scall_out_scall_intro_put_scall_out_let_intro_scall_intro_put_____0_____5__0_1__37[role="Alice"] : [State__Alice(<'rab_____0', param>, return__var__0, 'rab__', 'rab__', 'rab__'), !Const__('rab__priv_key_alice', priv_key_alice__0), !Const__('rab__priv_key_alice', priv_key_alice__10), Fr(n__0__3)]-->[State__Alice(<'rab_____5__0_1', param>, 'rab__', 'rab__', <sign(n__0__3, priv_key_alice__10), sign(n__0__3, priv_key_alice__10), n__0__3>, priv_key_alice__0), Out(n__0__3), Out(sign(n__0__3, priv_key_alice__10))] 

- rule Alice__scall_out_event_____5__0_1_____7__25[role="Alice"] : [State__Alice(<'rab_____5__0_1', param>, return__var__13, 'rab__', <l__0__13, l__1__13, l__2__13>, t__0__13)]--[MsgSend(l__2__13)]->[State__Alice(<'rab_____7', param>, 'rab__', 'rab__', <l__1__13, l__2__13>, t__0__13)] 

